{"version":3,"sources":["color.js","cell.js","fretMarkers.js","util.js","pc.js","banjo.js","frettedInstrument.js","guitar.js","intro.js","multTableMod12.js","numpadMod12.js","useMidi.js","useMidiClock.js","useP5.js","mandelbrotP5.js","mandelbrot.js","mandolin.js","useMic.js","mic.js","icons/midiIcon.js","midi.js","ratioLightshipP5.js","ratioLightship.js","pitchClass.js","coltraneCircle.js","dod.js","pitchClassCollections.js","pcSpiralWindController.js","usePrevious.js","pitchClassSpiral.js","spiralFFTP5.js","spiralFFT.js","staff.js","lumatoneKeySync.js","tonnetz.js","ukulele.js","routes.js","camera.js","vr.js","fns.js","index.js"],"names":["_hsluv","Cell","withStyles","root","fontSize","fontFamily","display","height","width","alignItems","justifyContent","position","odd","left","cellSize","_ref","children","classes","_ref$className","className","isOdd","style","react_default","a","createElement","concat","FretMarkers","fretMarker","color","frets","_","range","last","map","f","includes","fret","ix","cell","key","toSymbol","note","equalDivisions","arguments","length","undefined","10","11","PC","_ref$isSolfege","isSolfege","_ref$showOctave","showOctave","n","_ref$style","borderStyle","borderWidth","0","1","2","3","4","5","6","7","8","9","toSolfege","bottom","right","Math","floor","Banjo","flexShrink","src_fretMarkers","pc0","pc0ix","Fragment","i","pc","src_pc","FrettedInstrument","fretCount","fretMarkers","tuning","Object","toConsumableArray","reverse","ixPc0","Guitar","frettedInstrument","Intro","overflowY","padding","MultTableMod12","flexWrap","margin","y","x","NumpadMod12","state","text","handleKeyPress","evt","char","Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadDivide","NumpadMultiply","NumpadDecimal","NumpadEnter","Enter","Space","code","preventDefault","_this","setState","handleChange","value","target","window","addEventListener","this","removeEventListener","cols","rows","onChange","background","Component","initialState","input","inputDevices","isMidiClockInSelectorOpen","isMidiInSelectorOpen","midiClockInDevice","midiInDevice","midiIn","zipObject","fill","Array","outputDevices","actions","setInputDevices","store","setOutputDevices","setMidiEvent","midiEvt","merge","setMidiClockInDevice","setMidiInDevice","toggleMidiInSelector","toggleMidiClockInSelector","globalHook","React","useMidiClock","onClock","onStop","onSongPos","_useMidi","useMidi","_useMidi2","slicedToArray","tick","useEffect","handleMidiClock","handleStop","console","log","handleSpp","_ref2","_ref2$data","data","beats","addListener","removeListener","reset","useP5","sketch","_useState","useState","_useState2","sketchState","setSketchState","_useState3","_useState4","sketchInstance","setSketchInstance","_useState5","_useState6","resizeObserver","setResizeObserver","ref","useCallback","el","instance","P5","_height","clientHeight","_width","clientWidth","ro","ResizeObserver","_ref2$0$contentRect","contentRect","resizeCanvas","prevState","objectSpread","isRegenNeeded","observe","disconnect","HSVtoHex","h","s","v","r","g","b","p","q","t","componentToHex","c","hex","toString","rgbToHex","round","getNoteColorHsl","oct","getNoteColorHex","l","Hsluv","hsluv_h","hsluv_s","hsluv_l","hsluvToHex","apply","timeouts","messageName","event","source","stopPropagation","shift","fn","setZeroTimeout","push","postMessage","audioPan","decayDuration","exciteEnergy","exciteDuration","fundamentalFreq","hilbertN","hilbMand","isControlPanelOpen","isPlaying","maxIters","midiClock","midiClocksPerTick","panX","panY","partials","partialsCountMax","isSmooth","tickDuration","tickLastMillis","zoom","audioCtx","AudioContext","oscs","masterGain","createGain","audioPanner","createStereoPanner","gain","connect","destination","p5","font","hilbGetRotatedVec","rx","ry","temp","dot","v1","v2","reduce","acc","val","idx","mandGetValFromNormalizedCoords","xN","yN","maxIterations","_mandGetDenormalizedC","mandGetDenormalizedCoords","cx","cy","z","log2","mandGetValSmooth","scaledX","scaledY","iter","xTemp","mandGetVal","genHilbertCoords","memoize","d","dist","hilbDistanceToCoords","getStrokeWeight","w","sideLength","min","getPartialOfOctaveStart","pow","dropWhile","first","getColorForMandelbrotVal","_ref3","m","isCursor","_p5$state2","octMax","setFillColorForMandelbrotVal","coordsWithVal","drawHilbertCoord","hilbertCoord","scaleX","scaleY","rect","drawHilbertMandelbrot","strokeWeight","stroke","getSideLengthForLinearizedMap","forEach","coordWithVal","translate","pop","drawLinearizedMandelbrotCoord","dMax","maxA","largestPossibleSide","sqrt","sqPerRow","valsPerRow","genAndDrawHilbertMandelbrot","_ref4","cancelScheduledValues","currentTime","linearRampToValueAtTime","_p5$state3","osc","stop","createOscillator","start","_p5$state","genHilbertMandelbrot","_ref5","filter","identity","uniq","sort","take","partial","amp","oscIdx","fromPairs","each","_ref6","decayTimerId","zeroGainTimerId","clearTimeout","frequency","nextState","prevD","cursorDraw","id","coordAndVal","maxD","prevCoordAndVal","cursorErasePrev","partialsDraw","noStroke","_p5$state5","_ref7","targetAmp","barH","barW","hue","wasPaused","preload","loadFont","setup","createCanvas","colorMode","HSB","textFont","incrementTick","isExternal","now","millis","_p5$state6","_p5$state4","pan","currGain","isNumber","targetGain","setTimeout","exponentialRampToValueAtTime","cursorExcite","prevTick","draw","_p5$state7","every","noFill","textSize","textAlign","CENTER","toggleAudio","resume","suspend","useStyles","makeStyles","paper","paddingBottom","FreqSlider","_ref2$initialVal","initialVal","_ref2$isInt","isInt","_ref2$isRegenRequired","isRegenRequired","_ref2$label","label","_ref2$max","max","Number","MAX_VALUE","_ref2$min","MIN_VALUE","_ref2$precision","precision","_ref2$size","size","stateKey","constrainVal","valToState","freq","logFreq","exp","deg","numberInputVal","defer","flex","marginBottom","paddingTop","onPointerUp","react_circular_slider_default","dataIndex","degPerExp","knobColor","knobSize","renderLabelValue","type","border","marginLeft","marginTop","top","zIndex","toPrecision","ev","onKeyDown","_objectSpread4","defineProperty","nextExp","progressColorFrom","progressColorTo","progressLineCap","trackColor","Mandelbrot","_useP","handleAction","action","panDelta","moveLeft","moveRight","moveUp","moveDown","resDec","resInc","toggleControlPanel","zoomIn","zoomOut","isEmpty","getHandleAction","document","title","handler","shiftKey","getAction","ArrowDown","ArrowLeft","ArrowRight","ArrowUp","handleKeyDown","beat","alignSelf","Button","onClick","Tune_default","Drawer","anchor","open","onClose","variant","ButtonGroup","fullWidth","PauseCircleOutline_default","PlayCircleOutline_default","ViewModuleOutlined_default","KeyboardArrowUpOutlined_default","ViewComfyOutlined_default","ZoomInOutlined_default","KeyboardArrowLeftOutlined_default","KeyboardArrowDownOutlined_default","KeyboardArrowRightOutlined_default","ZoomOutOutlined_default","mandelbrot_FreqSlider","Mandolin","mediaStream","setMediaStream","Mic","_useMic","useMic","_useMic2","isMicOn","IconButton","edge","getTracks","tr","navigator","mediaDevices","getUserMedia","audio","video","then","MicOffOutlined","esm_Mic","MidiIcon","transform","viewBox","points","Midi","WebMidi","enable","err","error","inputs","outputs","handleMidi","number","rawVelocity","_React$useState","_React$useState2","midiMenuAnchorEl","setMidiMenuAnchorEl","handleMidiMenuButtonClick","isBeatClock","currentTarget","handleMidiInputSelect","deviceIdx","aria-label","midiIcon","WatchLater","Menu","anchorEl","handleMidiMenuClose","name","MenuItem","selected","get","TWO_PI","PI","n2","blendMode","ADD","keyTyped","obj","join","split","parseInt","_obj","_obj2","phase","x1","y1","drawWave","_ref2$phase","dt","sin","cos","line","clear","BLEND","RatioLightship","handleOsc","components","onOsc","instrument","vel","onTick","time","timeDelta","has","setAttribute","pitchClass","_ref2$darkened","darkened","_ref2$position","_ref2$scale","scale","material","blending","opacity","primitive","radius","radius-tubular","look-at","align","negate","transparent","ColtraneCircle","is180","setIs180","toggle","midiInPitchClasses","pickBy","values","sum","animation","c1","c2","verts","Dod","_ref$rep","rep","sat","_ref$stack","stack","_ref$n","events","click","PitchClassCollections","objectDestructuringEmpty","collEl","setCollEl","collRef","object3D","set","handleKeyup","colls","coll","rotation","theta","_ref5$s","PcSpiralWindController","isNoteOffIgnored","noteToDimensions","_ref$notePoolSize","notePoolSize","noteEls","prevMidiInDevice","useRef","current","usePrevious","notePool","getNoteElAndKey","indexOf","ixEmpty","getPoolKey","pitchBendAmount","velocity","_getNoteElAndKey","_getNoteElAndKey2","noteEl","poolKey","_noteToDimensions","k","_noteToDimensions2","midiInRef","audioContext","PitchClassSpiral","_ref$depthMax","depthMax","_ref$isAlwaysCounterC","isAlwaysCounterClockwise","_ref$rMax","rMax","_ref$rMin","rMin","_ref$noteRange","noteRange","_ref$pcsHighlighted","pcsHighlighted","detector","setDetector","pitchDetectEl","setPitchDetectEl","step","PitchDetector","context","interpolateFrequency","onDebug","stats","pitchDetector","detected","rms","ftomf","isFinite","minCorrelationIncrease","normalize","stopAfterDetection","minNote","maxNote","minPeriod","maxPeriod","destroy","pitchDetectRef","pick","end","visible","pcSpiralWindController","analyser","createAnalyser","bands","filterBank","filterBank2","filterBank3","filterBank4","filterBank5","analysers","fftSize","dataArrays","Float32Array","dataArray","Uint8Array","frequencyBinCount","root24","c0","createBiquadFilter","Q","smoothingTimeConstant","isReady","noiseCancellation","echoCancellation","autoGainControl","stream","audioSource","createMediaStreamSource","catch","starSpawn","random","brightness","stars","MULTIPLY","getByteFrequencyData","hueOffset","analyzer","getFloatTimeDomainData","barHeight","j","abs","star","circle","angle","octave","rotate","SpiralFFT","VF","Vex","Flow","Staff","_useVexFlow","setContext","renderer","Renderer","Backends","SVG","resize","getContext","useVexFlow","setStrokeStyle","setFillStyle","treble","Stave","addClef","addKeySignature","addTimeSignature","bass","StaveConnector","setType","BRACE","SINGLE_LEFT","lumatoneRowStarts","boardRowLengths","boardsOnGrid","boardIndex","boardNum","boardStartX","boardStartY","boardRowLen","boardRow","boardX","setColor","lumatoneIn","lumatoneOut","board","rNorm","gNorm","bNorm","Promise","res","normTo255","norm","addOneTimeListener","sendSysex","changeBuffer","isPopping","changePush","asyncToGenerator","regenerator_default","mark","_callee","ch","chPop","wrap","_context","prev","next","abrupt","_x","LumatoneKeySync","lumaIn","lumaOut","lumaKey","timeoutId","culori","converter","midiChannel","typeByte","setNote","handleNoteOff","e","_e$dataBytes","dataBytes","nPlayed","repeat","repeatCount","pushChanges","handleNoteOn","_e$dataBytes2","formatHex","pcSetOpts","lumatoneRowLengths","layoutOpts","Tonnetz","_ref2$rows","_useMidi2$","xTouchIn","find","layoutKey","setLayoutKey","layout","pcSetKey","setPcSetKey","pitchSet","setPitchSet","notesCurr","handlePedalDown","_e$dataBytes3","rowStartX","pcSet","isInPcSet","colorHsl","mode","alpha","borderRadius","backgroundColor","lumatoneKeySync","Ukulele","routes2d","OSC","routesVr","Camera","look-controls","wasd-controls","acceleration","VR","match","path","react_router","component","camera","oculus-touch-controls","toOctave","intToRation","fraction","doWhenAframeLoaded","AFRAME","oscHost","host","location","hostname","port","secure","plugin","WebsocketClientPlugin","registerComponent","init","_onOscId","on","address","_ref$args","args","remove","off","_this2","_ref2$args","ReactDOM","render","prefersDarkMode","useMediaQuery","dark","palette","active","primary","main","light","theme","useMemo","createMuiTheme","menuAnchorEl","setMenuAnchorEl","handleMenuClose","ThemeProvider","CssBaseline","react_router_dom","basename","process","exact","AppBar","Toolbar","esm_Menu","Link","RouterLink","to","disabled","divider","url","_ref8","_ref9","midi","mic","querySelector"],"mappings":"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","file":"static/js/main.4ec903dc.chunk.js","sourcesContent":["export function HSVtoHex(h, s, v) {\r\n  function rgbToHex({ r, g, b }) {\r\n    function componentToHex(c) {\r\n      var hex = c.toString(16);\r\n      return hex.length == 1 ? \"0\" + hex : hex;\r\n    }\r\n\r\n    return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\r\n  }\r\n\r\n  var r, g, b, i, f, p, q, t;\r\n  if (arguments.length === 1) {\r\n    s = h.s;\r\n    v = h.v;\r\n    h = h.h;\r\n  }\r\n  i = Math.floor(h * 6);\r\n  f = h * 6 - i;\r\n  p = v * (1 - s);\r\n  q = v * (1 - f * s);\r\n  t = v * (1 - (1 - f) * s);\r\n  switch (i % 6) {\r\n    case 0: {\r\n      r = v;\r\n      g = t;\r\n      b = p;\r\n      break;\r\n    }\r\n    case 1: {\r\n      r = q;\r\n      g = v;\r\n      b = p;\r\n      break;\r\n    }\r\n    case 2: {\r\n      r = p;\r\n      g = v;\r\n      b = t;\r\n      break;\r\n    }\r\n    case 3: {\r\n      r = p;\r\n      g = q;\r\n      b = v;\r\n      break;\r\n    }\r\n    case 4: {\r\n      r = t;\r\n      g = p;\r\n      b = v;\r\n      break;\r\n    }\r\n    case 5: {\r\n      r = v;\r\n      g = p;\r\n      b = q;\r\n      break;\r\n    }\r\n  }\r\n  return rgbToHex({\r\n    r: Math.round(r * 255),\r\n    g: Math.round(g * 255),\r\n    b: Math.round(b * 255)\r\n  });\r\n}\r\n\r\n\r\nlet _hsluv;\r\nexport const hslToHex = (h, s, l) => {\r\n  if (!window.Hsluv) return \"#000\";\r\n  _hsluv = _hsluv || new window.Hsluv();\r\n  _hsluv.hsluv_h = (h * 360 + 12.2) % 360;\r\n  _hsluv.hsluv_s = s * 100;\r\n  _hsluv.hsluv_l = l * 100;\r\n  _hsluv.hsluvToHex();\r\n  return _hsluv.hex;\r\n};\r\n\r\nexport const hslToRgb = (h, s, l) => {\r\n  if (!window.Hsluv) return \"#000\";\r\n  _hsluv = _hsluv || new window.Hsluv();\r\n  _hsluv.hsluv_h = (h * 360 + 12.2) % 360;\r\n  _hsluv.hsluv_s = s * 100;\r\n  _hsluv.hsluv_l = l * 100;\r\n  _hsluv.hsluvToRgb();\r\n  return [_hsluv.rgb_r * 255, _hsluv.rgb_g * 255, _hsluv.rgb_b * 255];\r\n};\r\n\r\nexport const getNoteColorHsl = (n) => {\r\n\r\n  const oct = ((n - 60) / 12);\r\n\r\n  return [\r\n    360 * (((n * 5) % 12) / 12),\r\n    0.9 - (oct > 0 ? oct * .2 : 0),\r\n    0.4 + oct * .1,\r\n  ];\r\n};\r\n\r\nexport const getNoteColorHex = (n, isHighlighted = false, isFaded = false) =>\r\n  hslToHex(...getNoteColorHsl(n,isHighlighted,isFaded));\r\n","import React from \"react\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst cellSize = 30;\r\n\r\nconst Cell = withStyles({\r\n  root: {\r\n    fontSize: 20,\r\n    fontFamily: 'jetBrainsMono',\r\n    display: 'inline-flex',\r\n    height: cellSize,\r\n    width: cellSize,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    position: 'relative',\r\n    // border: '1px solid',\r\n  },\r\n  odd: {\r\n    left: cellSize / 2,\r\n  }\r\n})(({children, classes, className = '', isOdd, style}) => (\r\n  <div\r\n    className={`${classes.root} ${className} ${isOdd ? classes.odd : ''}`}\r\n    style={style}>\r\n    {children}\r\n  </div>\r\n));\r\n\r\nexport default Cell;\r\n","import _ from 'lodash';\r\nimport Cell from \"./cell\";\r\nimport React from \"react\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst FretMarkers = withStyles({\r\n  fretMarker: {color: 'purple'}\r\n})(\r\n  ({classes: {fretMarker}, frets}) => _.range(_.last(frets) + 1)\r\n    .map(f => _.includes(frets, f) ? f : '')\r\n    .map((fret, ix) => <Cell className={fretMarker} key={ix}>{fret}</Cell>));\r\n\r\nexport default FretMarkers;\r\n","/**\r\n *\r\n * Michael L. Friedmann - https://yalebooks.yale.edu/book/9780300045376/ear-training-twentieth-century-music/\r\n * (Friedmann uses \"lev\" for 11)\r\n * @param note {number} integer - MIDI note\r\n * @param equalDivisions {number} integer - note % equalDivisions\r\n * @returns {number}\r\n */\r\nexport const toSolfege = (note, equalDivisions = 12) => ({\r\n  0: 'oh',\r\n  1: 'one',\r\n  2: 'two',\r\n  3: 'three',\r\n  4: 'four',\r\n  5: 'five',\r\n  6: 'six',\r\n  7: 'sev',\r\n  8: 'eight',\r\n  9: 'nine',\r\n  10: 'ten',\r\n  11: 'el',\r\n})[note % equalDivisions] || note % equalDivisions;\r\n\r\n/**\r\n *\r\n * @param note {number} integer - MIDI note\r\n * @param equalDivisions {number} integer - note % equalDivisions\r\n * @returns {number}\r\n */\r\nexport const toSymbol = (note, equalDivisions = 12) => ({\r\n  10: '',\r\n  11: '',\r\n})[note % equalDivisions] || note % equalDivisions;\r\n\r\n// ripped from Tone/core/Conversions\r\nexport const ftomf = (frequency) => {\r\n  return 69 + 12 * Math.log2(frequency / 440);\r\n}\r\n","import Cell from './cell';\r\nimport React from \"react\";\r\nimport {toSolfege, toSymbol} from \"./util\";\r\n\r\nconst PC = ({\r\n  classes,\r\n  isOdd,\r\n  isSolfege = false,\r\n  showOctave = false,\r\n  n,\r\n  style = isSolfege ? {\r\n    borderStyle: 'solid',\r\n    borderWidth: 1,\r\n    width: 70,\r\n  } : null,\r\n}) => (\r\n  <Cell\r\n    isOdd={isOdd}\r\n    style={style}\r\n  >\r\n    {isSolfege ? toSolfege(n) : toSymbol(n)}\r\n    {showOctave && (\r\n      <div style={{\r\n        bottom: '15%',\r\n        fontSize: '0.4em',\r\n        position: 'absolute',\r\n        right: '10%',\r\n      }} >{Math.floor(n / 12)}</div>)}\r\n  </Cell>\r\n)\r\n\r\nexport default PC;\r\n","import _ from 'lodash';\r\nimport Cell from './cell';\r\nimport FretMarkers from \"./fretMarkers\";\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\nconst frets = [1,3,5,7,10,12,15,17,19];\r\n\r\nconst Banjo = () => (\r\n  <div style={{\r\n    display: 'block',\r\n    flexShrink: 0,\r\n  }}>\r\n    <FretMarkers frets={frets} />\r\n    <br/>\r\n    {[0, 9, 5, 0, 0].map((pc0, pc0ix) => (\r\n      <React.Fragment key={pc0ix}>\r\n        {_.range(23)\r\n          .map(i => (i + pc0) % 12)\r\n          .map((pc, ix) =>\r\n            pc0ix === 4 && ix < 5\r\n              ? <Cell key={ix}/>\r\n              : <PC key={ix} n={pc}/>\r\n          )}\r\n        <br/>\r\n      </React.Fragment>\r\n    ))}\r\n    <FretMarkers frets={frets} />\r\n  </div>\r\n);\r\n\r\nexport default Banjo;\r\n","import _ from 'lodash';\r\nimport FretMarkers from \"./fretMarkers\";\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\n\r\nconst FrettedInstrument = ({ fretCount, fretMarkers, tuning }) => (\r\n  <div style={{\r\n    display: 'block',\r\n    flexShrink: 0,\r\n  }}>\r\n    <FretMarkers frets={fretMarkers}/>\r\n    <br/>\r\n    {[...tuning]\r\n      .reverse() //mutates\r\n      .map((pc0, ixPc0) => (\r\n      <React.Fragment key={ixPc0}>\r\n        {_.range(fretCount + 1 /*for zeroth*/)\r\n          .map(i => (i + pc0) % 12)\r\n          .map((pc, ix) => (\r\n            <PC key={ix} n={pc}/>\r\n          ))}\r\n        <br/>\r\n      </React.Fragment>\r\n    ))}\r\n    <FretMarkers frets={fretMarkers}/>\r\n  </div>\r\n);\r\n\r\nexport default FrettedInstrument;\r\n","import React from 'react';\r\nimport FrettedInstrument from './frettedInstrument';\r\n\r\nconst tunings = {\r\n  standard: [4, 9, 2, 7, 11, 4],\r\n  chelseaSessionsTuning: [0, 5, 0, 5, 9, 5],\r\n  octoberSongTuning: [0, 7, 0, 4, 7, 0],\r\n};\r\n\r\nconst tuning = tunings['standard'];\r\n\r\nconst Guitar = () => (\r\n  <FrettedInstrument\r\n    fretCount={24}\r\n    fretMarkers={[0, 5, 7, 12, 15, 17, 19, 24]}\r\n    tuning={tuning}\r\n  />\r\n)\r\n\r\nexport default Guitar;\r\n","import _ from 'lodash';\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\nconst Intro = () => (\r\n  <div style={{height: '100%', overflowY: 'auto', padding: '20% 10%'}}>\r\n    <h1>musicality.computer</h1>\r\n\r\n    <h2>12ET pitch-class symbols:</h2>\r\n    <pre>{_.range(12).map(pc => <PC key={pc} n={pc}/>)}</pre>\r\n\r\n    <h3>12ET pitch-classes as solfege syllables:</h3>\r\n    {_.range(12).map(pc => <PC key={pc} isSolfege n={pc}/>)}\r\n  </div>\r\n);\r\n\r\nexport default Intro;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport { toSymbol } from \"./util\";\r\nimport PC from \"./pc\";\r\n\r\nconst MultTableMod12 = () => (\r\n  <div style={{\r\n    display: 'flex',\r\n    flexWrap: 'wrap',\r\n    justifyContent: 'center',\r\n  }}>\r\n    {_.range(6).map(n => (\r\n      <div style={{\r\n        margin: '1em',\r\n      }}>\r\n        {_.range(13).map(y => (\r\n          <>\r\n            {_.range(13).map(x => (\r\n              <PC key={x} n={n + x * y} />\r\n            ))}\r\n            <br />\r\n          </>\r\n        ))}\r\n\r\n      </div>\r\n    ))}\r\n  </div>);\r\n\r\nexport default MultTableMod12;\r\n","import _ from 'lodash';\r\nimport React, { Component } from 'react';\r\nimport { toSymbol } from \"./util\";\r\n\r\nclass NumpadMod12 extends Component {\r\n  state = {\r\n    text: '',\r\n  };\r\n\r\n  componentDidMount() {\r\n    window.addEventListener('keypress', this.handleKeyPress);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('keypress', this.handleKeyPress);\r\n  }\r\n\r\n  handleKeyPress = (evt) => {\r\n    // console.log(evt.code)\r\n    const char = {\r\n      Backquote: '0',\r\n      Digit1: '1',\r\n      Digit2: '2',\r\n      Digit3: '3',\r\n      Digit4: '4',\r\n      Digit5: '5',\r\n      Digit6: '6',\r\n      Digit7: '7',\r\n      Digit8: '8',\r\n      Digit9: '9',\r\n      Digit0: '',\r\n      Minus: '',\r\n      Equal: '0',\r\n      Numpad0: '0',\r\n      Numpad1: '1',\r\n      Numpad2: '2',\r\n      Numpad3: '3',\r\n      Numpad4: '4',\r\n      Numpad5: '5',\r\n      Numpad6: '6',\r\n      Numpad7: '7',\r\n      Numpad8: '8',\r\n      Numpad9: '9',\r\n      NumpadDivide: '',\r\n      NumpadMultiply: '',\r\n      NumpadDecimal: ' ',\r\n      NumpadEnter: '\\n',\r\n      Enter: '\\n',\r\n      Space: ' ',\r\n    }[evt.code];\r\n\r\n    if (char) {\r\n      evt.preventDefault();\r\n      this.setState({ text: this.state.text + char });\r\n    }\r\n  };\r\n\r\n  handleChange = ({ target: { value }}) => this.setState({ text: value });\r\n\r\n  render() {\r\n    return <div>\r\n      <h3>Use the numpad to enter pitch classes</h3>\r\n      <textarea\r\n        cols={24}\r\n        rows={20}\r\n        onChange={this.handleChange}\r\n        style={{\r\n          background: 'black',\r\n          color: 'darkgray',\r\n          fontSize: 20,\r\n        }}\r\n        value={this.state.text}\r\n      />\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default NumpadMod12;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport globalHook from 'use-global-hook';\r\n\r\nconst midiIn = _.zipObject(\r\n  _.range(128),\r\n  _.fill(new Array(128), 0));\r\n\r\nconst initialState = {\r\n  input: undefined,\r\n  inputDevices: [],\r\n  isMidiClockInSelectorOpen: false,\r\n  isMidiInSelectorOpen: false,\r\n  midiClockInDevice: undefined,\r\n  midiInDevice: undefined,\r\n  midiIn,\r\n  outputDevices: [],\r\n};\r\n\r\nconst actions = {\r\n  setInputDevices: (store, inputDevices) =>\r\n    store.setState({inputDevices}),\r\n\r\n  setOutputDevices: (store, outputDevices) =>\r\n    store.setState({outputDevices}),\r\n\r\n  setMidiEvent: (store, midiEvt) =>\r\n    store.setState({midiIn: _.merge(store.state.midiIn, midiEvt)}),\r\n\r\n  setMidiClockInDevice: (store, midiClockInDevice) => store.setState({midiClockInDevice}),\r\n\r\n  setMidiInDevice: (store, midiInDevice) => store.setState({midiInDevice}),\r\n\r\n  toggleMidiInSelector: (store) =>\r\n    store.setState({isMidiInSelectorOpen: !store.state.isMidiInSelectorOpen}),\r\n\r\n  // todo: only 1 selector\r\n  toggleMidiClockInSelector: (store) =>\r\n    store.setState({isMidiClockInSelectorOpen: !store.state.isMidiClockInSelectorOpen}),\r\n\r\n\r\n};\r\n\r\nexport default globalHook(React, initialState, actions);\r\n","import useMidi from \"./useMidi\";\r\nimport {useEffect} from \"react\";\r\n\r\nconst useMidiClock = (onClock, onStop, onSongPos) => {\r\n  const [{midiClockInDevice}, actions] = useMidi( // https://github.com/andregardi/use-global-hook#avoid-unnecessary-renders\r\n    ({midiClockInDevice}) => ({midiClockInDevice}),\r\n    actions => actions,\r\n  );\r\n\r\n  let tick = 0;\r\n\r\n  useEffect(() => {\r\n\r\n    const handleMidiClock = (evt) => {\r\n      tick++;\r\n      if (onClock) onClock({ tick });\r\n    };\r\n\r\n    const handleStop = (evt) => {\r\n      if (onStop) onStop();\r\n      console.log('stop')\r\n    };\r\n\r\n    const handleSpp = ({ data: [,lsb,msb] }) => {\r\n      const beats = (lsb + msb * 128) * 6;\r\n      console.log('SPP', beats);\r\n      if (onSongPos) onSongPos(beats);\r\n    };\r\n\r\n    if (midiClockInDevice) {\r\n      midiClockInDevice.addListener('clock', 'all', handleMidiClock);\r\n      // midiClockInDevice.addListener('start', 'all', handleStart); // wasn't getting called\r\n      midiClockInDevice.addListener('stop', 'all', handleStop);\r\n      midiClockInDevice.addListener('songposition', 'all', handleSpp);\r\n    }\r\n\r\n    return () => {\r\n      if (midiClockInDevice) {\r\n        midiClockInDevice.removeListener('clock', 'all', handleMidiClock);\r\n        midiClockInDevice.removeListener('stop', 'all', handleStop);\r\n        midiClockInDevice.removeListener('songposition', 'all', handleSpp);\r\n      }\r\n    }\r\n  }, [midiClockInDevice]);\r\n\r\n  return {\r\n    midiClockInDevice,\r\n    reset: () => {\r\n      tick = 0;\r\n    },\r\n  };\r\n};\r\n\r\nexport default useMidiClock;\r\n","import P5 from 'p5';\r\nimport {useCallback, useState} from \"react\";\r\n\r\nexport default (sketch, initialState) => {\r\n  const [sketchState, setSketchState] = useState(initialState);\r\n  const [sketchInstance, setSketchInstance] = useState(null);\r\n  const [resizeObserver, setResizeObserver] = useState(null);\r\n\r\n  if (sketchInstance) {\r\n    sketchInstance.setState = setSketchState;\r\n    sketchInstance.state = sketchState;\r\n  }\r\n\r\n  const ref = useCallback((el) => {\r\n    if (el) {\r\n      const instance = new P5(sketch, el);\r\n      setSketchInstance(instance);\r\n\r\n      instance._height = el.clientHeight;\r\n      instance._width = el.clientWidth;\r\n\r\n      const ro = new ResizeObserver(([{contentRect: {height, width}}]) => {\r\n        instance.resizeCanvas(width, height);\r\n        if (width + height > 0) setSketchState((prevState) => ({...prevState, isRegenNeeded: true}));\r\n      });\r\n\r\n      setResizeObserver(ro);\r\n      ro.observe(el);\r\n    } else {\r\n      if (resizeObserver) resizeObserver.disconnect();\r\n    }\r\n  }, []);\r\n\r\n  return {\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n    ref,\r\n  };\r\n};\r\n","import _ from 'lodash';\r\n\r\n\r\n/* TODO\r\n* high prio\r\n  * fine-tune freq\r\n  * don't require redraw on freq change\r\n  * params bound to urlParams\r\n  * option to auto-choose fundamentalFreq\r\n    based on which partials are present\r\n    to center around 500 - 1000hz\r\n  * MIDI beat clock\r\n  * spiral of any length instead of hilbert\r\n\r\n* med prio\r\n  * for hilbertN of 256 or 512, use the vals to fill an audio buffer and play the ~1 or ~5s of audio\r\n  * utonal partials\r\n\r\n* low prio\r\n  * option to add a second cursor for stereo effects\r\n  * alternate space-filling curves\r\n  * keep cursor in same location when switching resolutions\r\n  * manual cursor\r\n* */\r\n\r\n// Only add setZeroTimeout to the window object, and hide everything\r\n// else in a closure.\r\n(function() {\r\n  var timeouts = [];\r\n  var messageName = \"zero-timeout-message\";\r\n\r\n  // Like setTimeout, but only takes a function argument.  There's\r\n  // no time argument (always zero) and no arguments (you have to\r\n  // use a closure).\r\n  function setZeroTimeout(fn) {\r\n    timeouts.push(fn);\r\n    window.postMessage(messageName, \"*\");\r\n  }\r\n\r\n  function handleMessage(event) {\r\n    if (event.source == window && event.data == messageName) {\r\n      event.stopPropagation();\r\n      if (timeouts.length > 0) {\r\n        var fn = timeouts.shift();\r\n        fn();\r\n      }\r\n    }\r\n  }\r\n\r\n  window.addEventListener(\"message\", handleMessage, true);\r\n\r\n  // Add the one thing we want added to the window object.\r\n  window.setZeroTimeout = setZeroTimeout;\r\n})();\r\n\r\n\r\nexport const initialState = {\r\n  audioPan: 0, // -1 - 1\r\n  decayDuration: 1000,\r\n  exciteEnergy: 0.05,\r\n  exciteDuration: 50,\r\n  fundamentalFreq: 200,\r\n  hilbertN: 64, // hilbertN must be power of 2 in order to be square\r\n  hilbMand: [/*{ x, y, m }*/], // coordinates and associated mandelbrot val in hilbert traversal order\r\n  isControlPanelOpen: true,\r\n  isPlaying: false,\r\n  isRegenNeeded: true,\r\n  maxIters: 4096, // max number of steps to recurse the mandelbrot fn\r\n  midiClock: 0,\r\n  midiClocksPerTick: 24,\r\n  panX: -0.05,\r\n  panY: 0,\r\n  partials: {/* partial: { amp, oscIdx } */}, // the collection is updated in setState but values within are changed in drawLoop directly\r\n  partialsCountMax: 16,\r\n  isSmooth: false, // smooth technique https://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n  tick: 0, // updated in draw() bypasses setState\r\n  tickDuration: 100,\r\n  tickLastMillis: 0, // updated in draw() bypasses setState\r\n  zoom: 1.2,\r\n\r\n  // zoom: 3603.7157567397, panX: 0.18580280974577668, panY: 0.00036930706052212803,\r\n\r\n  // floating point errors here\r\n  // zoom: 279919582741326.66, panX: -0.014853203736137617, panY: 0.13451319076043783,\r\n\r\n  // panX: 0.0011548427778035686,\r\n  // panY: 0.025033026937542575,\r\n  // zoom: 319852972190.0951,\r\n  //\r\n  // panX: -0.18498767183730766,\r\n  // panY: 0.4722205531430409,\r\n  // zoom: 419013953.31772846,\r\n  //\r\n  //\r\n  // decay: 0.000075,\r\n  // exciteEnergy: 0.006,\r\n  // fundamentalFreq: 10,\r\n  // hilbertN: 256,\r\n  // maxIters: 4096,\r\n  // panX: 0.0011503007796323155,\r\n  // panY: 0.025033026938902938,\r\n  // tickDuration: 10,\r\n  // zoom: 836635.9887997985,\r\n  //\r\n  //\r\n  //\r\n  // panX: 0.08871194014553094,\r\n  // panY: -0.12829271146701177,\r\n  // zoom: 19736096.460687958,\r\n\r\n  // ...{zoom: 39422433.84662852, panX: 0.04670942760989286, panY: 0.13656218122372943},\r\n\r\n  // demo for 10 partials\r\n  // ...{zoom: 12371177.464729108, panX: 0.04671008941233588, panY: 0.13656133340058238},\r\n};\r\n\r\nlet audioCtx = new AudioContext();\r\nlet oscs = [];\r\n\r\nconst masterGain = audioCtx.createGain();\r\nconst audioPanner = audioCtx.createStereoPanner();\r\nwindow.masterGain = masterGain;\r\nmasterGain.gain.value = 1;\r\nmasterGain.connect(audioPanner);\r\naudioPanner.connect(audioCtx.destination);\r\n\r\n\r\nexport const sketch = (p5) => {\r\n  p5.state = initialState;\r\n\r\n  /* Border size and color */\r\n  const CURSOR_STROKE_COLOR_SEPARATION = 20;\r\n  const CURSOR_ALPHA = 0.7;\r\n  const STROKE_WEIGHT_COEF = 1;\r\n  const STROKE_COLOR = 0;\r\n\r\n  const setupOscillators = () => {\r\n    oscs.forEach(({osc, gain}) =>\r\n    {\r\n      osc.stop();\r\n    }); // TODO: gain.disconnect? delete osc and gain?\r\n\r\n    oscs = _.range(p5.state.partialsCountMax).map(() => {\r\n      const osc = audioCtx.createOscillator();\r\n      const gain = audioCtx.createGain();\r\n      gain.gain.value = 0;\r\n      osc.connect(gain);\r\n      gain.connect(masterGain);\r\n      osc.start();\r\n      return {osc, gain};\r\n    });\r\n\r\n    window.oscs = oscs;\r\n  }\r\n\r\n  //rotate/flip a quadrant appropriately\r\n  const hilbGetRotatedVec = (n, v, rx, ry) => {\r\n    if (ry === 0) {\r\n      if (rx === 1) {\r\n        v.x = n - 1 - v.x;\r\n        v.y = n - 1 - v.y;\r\n      }\r\n\r\n      //Swap x and y\r\n      let temp = v.x;\r\n      v.x = v.y;\r\n      v.y = temp;\r\n    }\r\n  }\r\n\r\n  const hilbDistanceToCoords = (hilbertN, dist) => {\r\n    //    TODO: get distanceToVector based on percentage of maxD so that the Hilbert cursor stays in the same place when changing Hilbert resolutions\r\n    //    TODO: also click the screen to set the cursor so need amp function to convert x,y to hilbert distance\r\n\r\n    const v = {x: 0, y: 0};\r\n    // _(size)\r\n    //   .range()\r\n    //   .map(v => Math.pow(2, v))\r\n    //   .takeWhile(v => v < size)\r\n    //   .value()\r\n\r\n    for (let s = 1; s < hilbertN; s *= 2) {\r\n      let rx = 1 & (dist / 2);\r\n      let ry = 1 & (dist ^ rx);\r\n      hilbGetRotatedVec(s, v, rx, ry);\r\n      v.x += s * rx;\r\n      v.y += s * ry;\r\n      dist /= 4;\r\n    }\r\n    return v;\r\n  }\r\n\r\n  /**\r\n   * Returns amp {@code Vec} representing the Euclidian coordinates of the given normalized \"Mandelbrot coordinates\"\r\n   * <br>Mandelbrot X scale: -2.5 to 1\r\n   * <br>Mandelbrot Y scale: -1 to 1\r\n   * @param x normalized x coordinate 0 to 1.0\r\n   * @param y normalized y coordinate 0 to 1.0\r\n   * @return\r\n   */\r\n  const mandGetDenormalizedCoords = (x, y) => ({\r\n    x: -2.5 + x * 3.5,\r\n    y: -1 + y * 2,\r\n  })\r\n\r\n\r\n  /**\r\n   * Returns the number of iterations to escape the Mandelbrot set at the given coordinates\r\n   * @param scaledX\r\n   * @param scaledY\r\n   * @param maxIterations\r\n   * @return\r\n   */\r\n  const mandGetVal = (scaledX, scaledY, maxIterations) => {\r\n    let x = 0, y = 0;\r\n    let iter = 0;\r\n\r\n    while (x * x + y * y < 4 && iter < maxIterations) {\r\n      let xTemp = x * x - y * y + scaledX;\r\n      y = 2 * x * y + scaledY;\r\n      x = xTemp;\r\n      iter++;\r\n    }\r\n    return iter;\r\n  }\r\n\r\n\r\n  const dot = (v1, v2) => _.reduce(v1, (acc, val, idx) => acc + val * v2[idx], 0);\r\n\r\n  /**\r\n   * https://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n   * @param cx\r\n   * @param cy\r\n   * @param maxIterations\r\n   * @returns {*|number}\r\n   */\r\n  const mandGetValSmooth = (cx, cy, maxIterations) => {\r\n    const Bsq = 256 * 256;\r\n    const z = [0,0];\r\n    let n = 0;\r\n    let x, y;\r\n\r\n    for (let i = 0; i < maxIterations; i++) {\r\n      [x, y] = z;\r\n      z[0] = x * x - y * y + cx;\r\n      z[1] = 2 * x * y + cy;\r\n      if (dot(z, z) > Bsq) break;\r\n      n++;\r\n    }\r\n\r\n    // return n - Math.log(Math.log(Math.sqrt(z[0] * z[0] + z[1] * z[1]) / Math.log(B) / Math.log(2)))\r\n    return n >= maxIterations\r\n      ? maxIterations\r\n      : n - Math.log2(Math.log2(dot(z,z))) + 4;\r\n  }\r\n\r\n  /**\r\n   * Returns the number of iterations required to escape the Mandelbrot set at the given coordinates\r\n   * @param xN normalized x coordinate 0 to 1.0\r\n   * @param yN normalized y coordinate 0 to 1.0\r\n   * @param panX < 0 pans left. > 0 pans right\r\n   * @param panY < 0 pans up. > 0 pans down\r\n   * @param zoom 1.0 is unzoomed\r\n   * @param maxIterations\r\n   * @return\r\n   */\r\n  const mandGetValFromNormalizedCoords = (xN, yN, panX, panY, zoom, maxIterations) => {\r\n    let x1 = 0.5 - panX + (xN - 0.5) / zoom;\r\n    let y1 = 0.5 - panY + (yN - 0.5) / zoom;\r\n    const {x, y} = mandGetDenormalizedCoords(x1, y1);\r\n    return p5.state.isSmooth\r\n      ? mandGetValSmooth(x, y, maxIterations)\r\n      : mandGetVal(x, y, maxIterations);\r\n  }\r\n\r\n  const genHilbertCoords = _.memoize((hilbertN) =>\r\n    _.range(hilbertN * hilbertN)\r\n      .map(d => hilbDistanceToCoords(hilbertN, d)));\r\n\r\n\r\n  const genHilbertMandelbrot = () => {\r\n    const {\r\n      hilbertN,\r\n      maxIters,\r\n      panX,\r\n      panY,\r\n      partialsCountMax,\r\n      zoom,\r\n    } = p5.state;\r\n\r\n\r\n    return genHilbertCoords(hilbertN).map(({ x, y }) => {\r\n      const m = mandGetValFromNormalizedCoords(x / hilbertN, y / hilbertN, panX, panY, zoom, maxIters);\r\n      return {\r\n        x,\r\n        y,\r\n        m,\r\n        p: m === maxIters\r\n          ? 0 // to be filtered out\r\n          : Math.floor(((m - 1) % partialsCountMax) + 1),\r\n      };\r\n    })\r\n  };\r\n\r\n  const getStrokeWeight = (w) => {\r\n    const sideLength = w / p5.state.hilbertN;\r\n    return STROKE_WEIGHT_COEF * Math.min(10, sideLength / 20);\r\n  };\r\n\r\n  const getPartialOfOctaveStart = _.memoize((f) =>\r\n    _(100)\r\n      .range()\r\n      .map(n => Math.pow(2, n))\r\n      .dropWhile(n => f / n >= 2)\r\n      .first());\r\n\r\n  const getColorForMandelbrotVal = ({m, p}, isCursor = false) => {\r\n    const {\r\n      maxIters,\r\n      partialsCountMax,\r\n    } = p5.state;\r\n\r\n    const octMax = getPartialOfOctaveStart(partialsCountMax);\r\n    const oct = getPartialOfOctaveStart(p);\r\n\r\n    // good looks with smooth but not relevant to partials\r\n    // const h = (m * 10) % 255;\r\n    // const s = isCursor ? 0 : 255 - (m / maxIters) * 225  //(p / partialsCountMax) * 225;\r\n\r\n    const h = 255 * Math.log2(p / oct);\r\n    const s = isCursor ? 0 : 255 - Math.pow(oct / octMax, 2) * 225  //(p / partialsCountMax) * 225;\r\n    const b = isCursor\r\n      ? 255\r\n      : m === maxIters ? 0\r\n        : 30 + Math.pow(oct / octMax, 2) * 225;\r\n\r\n    return p5.color(h, s, b, isCursor ? CURSOR_ALPHA : 255);\r\n  };\r\n\r\n  const setFillColorForMandelbrotVal = (coordsWithVal, isCursor = false) => {\r\n    p5.fill(getColorForMandelbrotVal(coordsWithVal, isCursor));\r\n  }\r\n\r\n  const drawHilbertCoord = (w, h, hilbertCoord, hilbertN) => {\r\n    const scaleX = w / hilbertN;\r\n    const scaleY = h / hilbertN;\r\n    p5.rect(hilbertCoord.x * scaleX, hilbertCoord.y * scaleY, scaleX, scaleY);\r\n    // p5.circle(hilbertCoord.x * scaleX + scaleX / 2, hilbertCoord.y * scaleY + scaleY / 2, scaleX);\r\n  }\r\n\r\n  const drawHilbertMandelbrot = (w, h, state) => {\r\n    const {\r\n      hilbertN,\r\n      hilbMand,\r\n    } = state;\r\n\r\n    const strokeWeight = getStrokeWeight(p5.width / 2);\r\n    p5.strokeWeight(strokeWeight);\r\n    p5.stroke(STROKE_COLOR);\r\n\r\n    const s = getSideLengthForLinearizedMap(hilbMand.length, p5.width / 4, p5.height);\r\n\r\n    hilbMand.forEach((coordWithVal, d) => {\r\n      setFillColorForMandelbrotVal(coordWithVal);\r\n\r\n      p5.push();\r\n      {\r\n        p5.translate(p5.width / 4, 0);\r\n        drawHilbertCoord(w, h, coordWithVal, hilbertN);\r\n      }\r\n      p5.pop();\r\n\r\n      p5.push(); // TODO: is it more expensive to push/pop 1000 times or iterate over hilbMand twice?\r\n      {\r\n        p5.translate((p5.width / 4) * 3, 0);\r\n        drawLinearizedMandelbrotCoord(p5.width / 4, s, d);\r\n      }\r\n      p5.pop();\r\n    })\r\n  };\r\n\r\n  const getSideLengthForLinearizedMap = (dMax, w, h) => {\r\n    const maxA = w * h;\r\n    const largestPossibleSide = Math.sqrt(maxA / dMax);\r\n\r\n    let s = 0;\r\n    for (let i = 1; i < w; i++) {\r\n      s = w / i;\r\n      if (s > largestPossibleSide) {\r\n        continue;\r\n      }\r\n\r\n      const sqPerRow = w / s;\r\n      const rows = dMax / sqPerRow;\r\n      const leftover = dMax % sqPerRow;\r\n\r\n      if (rows * s + (leftover > 0 ? s : 0) <= h) {\r\n        break;\r\n      }\r\n    }\r\n    return s;\r\n  }\r\n\r\n  const drawLinearizedMandelbrotCoord = (w, s, d) => {\r\n    const valsPerRow = w / s;\r\n\r\n    let x = d % valsPerRow;\r\n    const y = Math.floor(d / valsPerRow);\r\n\r\n    // snake around instead of starting from the left for each row\r\n    if (y % 2 === 1) {\r\n      x = valsPerRow - (x + 1);\r\n    }\r\n\r\n    p5.rect(x * s, y * s, s, s);\r\n  }\r\n\r\n  const genAndDrawHilbertMandelbrot = () => {\r\n    p5.background(32);\r\n\r\n    // fade out. this can probably move to partials _.each\r\n    oscs.forEach(({gain}) => {\r\n      gain.gain.cancelScheduledValues(audioCtx.currentTime);\r\n      gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);\r\n    })\r\n\r\n    const {\r\n      fundamentalFreq,\r\n      partialsCountMax,\r\n    } = p5.state;\r\n\r\n    if (oscs.length !== partialsCountMax) {\r\n      setupOscillators(); // TODO: fade out first\r\n    }\r\n\r\n    const hilbMand = genHilbertMandelbrot();\r\n\r\n    const partials = _(hilbMand)\r\n      .map(({p}) => p)\r\n      .filter(_.identity) // maxIters (black) are set as p: 0\r\n      .uniq()\r\n      .sort()\r\n      .take(partialsCountMax)\r\n      .map((partial, i) => [partial, {amp: 0, oscIdx: i}])\r\n      .fromPairs()\r\n      .value();\r\n\r\n    // slide to new freqs if partials change\r\n    _.each(partials, ({decayTimerId, oscIdx, zeroGainTimerId}, partial) => {\r\n      clearTimeout(decayTimerId);\r\n      clearTimeout(zeroGainTimerId);\r\n      oscs[oscIdx].osc.frequency.cancelScheduledValues(audioCtx.currentTime);\r\n      oscs[oscIdx].osc.frequency.linearRampToValueAtTime(partial * fundamentalFreq, audioCtx.currentTime + 1);\r\n    });\r\n\r\n    p5.setState(prevState => {\r\n      const nextState = {\r\n        ...prevState,\r\n        hilbMand,\r\n        isRegenNeeded: false,\r\n        partials,\r\n      };\r\n      drawHilbertMandelbrot( p5.width / 2, p5.height, nextState);\r\n      return nextState;\r\n    });\r\n  }\r\n\r\n\r\n  const cursorErasePrev = (maxD, s, prevD) => {\r\n    const {hilbMand} = p5.state;\r\n    const prevCoordAndVal = hilbMand[prevD % maxD];\r\n\r\n    setFillColorForMandelbrotVal(prevCoordAndVal);\r\n    p5.stroke(STROKE_COLOR);\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate(p5.width / 4, 0);\r\n      drawHilbertCoord(p5.width / 2, p5.height, prevCoordAndVal, p5.state.hilbertN);\r\n    }\r\n    p5.pop();\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate((p5.width / 4) * 3, 0);\r\n      drawLinearizedMandelbrotCoord(p5.width / 4, s, prevD);\r\n    }\r\n    p5.pop();\r\n  }\r\n\r\n  let prevD = 0;\r\n  const cursorDraw = (id) => {\r\n    const {hilbMand} = p5.state;\r\n    const d = p5.state.tick % hilbMand.length;\r\n    const coordAndVal = hilbMand[d];\r\n    const sideLength = getSideLengthForLinearizedMap(hilbMand.length, p5.width / 4, p5.height);\r\n    const strokeWeight = getStrokeWeight(p5.width / 2);\r\n\r\n    p5.strokeWeight(strokeWeight);\r\n    cursorErasePrev(hilbMand.length, sideLength, prevD);\r\n    prevD = d; // maybe multiple ticks per frame when external time sync\r\n    p5.stroke((CURSOR_STROKE_COLOR_SEPARATION * id) % 255, 0, 255);\r\n    setFillColorForMandelbrotVal(coordAndVal, true);\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate(p5.width / 4, 0);\r\n      drawHilbertCoord(p5.width / 2, p5.height, coordAndVal, p5.state.hilbertN);\r\n    }\r\n    p5.pop();\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate((p5.width / 4) * 3, 0);\r\n      drawLinearizedMandelbrotCoord(p5.width / 4, sideLength, d);\r\n    }\r\n    p5.pop();\r\n  }\r\n\r\n  const cursorExcite = (id) => {\r\n    const {\r\n      audioPan,\r\n      decayDuration,\r\n      exciteEnergy,\r\n      exciteDuration,\r\n      hilbMand,\r\n      partials,\r\n      tick,\r\n    } = p5.state;\r\n\r\n    audioPanner.pan.value = audioPan;\r\n\r\n    const d = tick % hilbMand.length;\r\n    const {p} = hilbMand[d];\r\n\r\n    if (p > 0) {\r\n      const partial = partials[p];\r\n      const {\r\n        amp,\r\n        decayTimerId,\r\n        oscIdx,\r\n        zeroGainTimerId,\r\n      } = partial;\r\n      const {gain} = oscs[oscIdx];\r\n\r\n      const isExcited = _.isNumber(decayTimerId);\r\n      const currGain = isExcited ? amp : gain.gain.value;\r\n\r\n      // console.log(p, currGain);\r\n\r\n      const targetGain = 0.8 * Math.min(1, currGain + exciteEnergy * (1 - currGain));\r\n      partial.amp = targetGain;\r\n\r\n      clearTimeout(decayTimerId); // further delay the decay\r\n      clearTimeout(zeroGainTimerId); // don't reset amp to zero\r\n      gain.gain.cancelScheduledValues(0);\r\n      gain.gain.linearRampToValueAtTime(targetGain, audioCtx.currentTime + exciteDuration / 1000);\r\n\r\n      partial.decayTimerId = setTimeout(() => {\r\n        gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + decayDuration / 1000);\r\n        partial.decayTimerId = null;\r\n\r\n        partial.zeroGainTimerId = setTimeout(() => {\r\n          partial.amp = 0;\r\n        }, decayDuration)\r\n      }, exciteDuration);\r\n    }\r\n  }\r\n\r\n  const partialsDraw = () => {\r\n    const h = p5.height;\r\n    const w = p5.width / 4;\r\n\r\n    p5.noStroke();\r\n\r\n    const { partials, partialsCountMax } = p5.state;\r\n\r\n    _.each(partials, ({ amp: targetAmp, oscIdx }, p) => {\r\n      const barH = h / partialsCountMax;\r\n      const y = h * ((p - 1) / partialsCountMax);\r\n      const barW = oscs[oscIdx].gain.gain.value * w;\r\n\r\n      const c = getColorForMandelbrotVal({ m: 1, p})\r\n      p5.fill(p5.color(p5.hue(c), 255, 8));\r\n      p5.rect(0, y, w, barH);\r\n\r\n      p5.fill(c);\r\n      p5.rect(0, y, barW, barH);\r\n      p5.fill(255);\r\n      p5.rect(targetAmp * w, y, 1, barH);\r\n    })\r\n\r\n  }\r\n\r\n  let wasPaused = true;\r\n  const pauseScreenDraw = () => {\r\n    if (!p5.state.isPlaying && !p5.state.isControlPanelOpen) {\r\n      wasPaused = true;\r\n      p5.background(0, 0.1);\r\n      p5.noFill();\r\n      p5.stroke(192, 127, 90);\r\n      p5.textSize(10);\r\n      p5.text('arrow keys to move', 0, p5.height / 2 - 50, p5.width, p5.height);\r\n      p5.text('shift+arrow for zoom/resolution', 0, p5.height / 2 - 35, p5.width, p5.height);\r\n      p5.text('shift+spacebar toggle controls', 0, p5.height / 2 - 20, p5.width, p5.height);\r\n      p5.textSize(20);\r\n      p5.textAlign(p5.CENTER);\r\n      p5.text('spacebar to start', 0, p5.height / 2, p5.width, p5.height);\r\n    } else {\r\n      if (wasPaused) {\r\n        partialsDraw();\r\n        drawHilbertMandelbrot(p5.width / 2, p5.height, p5.state);\r\n        wasPaused = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  let font;\r\n  p5.preload = () => {\r\n    font = p5.loadFont('JetBrainsMono-Regular.ttf');\r\n  }\r\n\r\n  p5.setup = () => {\r\n    p5.createCanvas(p5._width, p5._height);\r\n    p5.colorMode(p5.HSB);\r\n    p5.textFont(font);\r\n    p5.incrementTick();\r\n  }\r\n\r\n  p5.incrementTick = (isExternal = false) => {\r\n    const now = p5.millis();\r\n    const {\r\n      isPlaying,\r\n      isRegenNeeded,\r\n      midiClocksPerTick,\r\n      tickDuration,\r\n      tickLastMillis,\r\n    } = p5.state;\r\n\r\n    if (isExternal) {\r\n      p5.state.midiClock++;\r\n    }\r\n\r\n    const isReady = !isRegenNeeded && (isExternal\r\n      ? p5.state.midiClock % midiClocksPerTick === 0\r\n      : isPlaying && now > tickLastMillis + tickDuration);\r\n\r\n    if (isReady) {\r\n      p5.state.tick++;\r\n      p5.state.tickLastMillis = now;\r\n      cursorExcite(0);\r\n    }\r\n\r\n    if (!isExternal && p5.state.midiClock === 0) window.setZeroTimeout(p5.incrementTick)\r\n  }\r\n\r\n  let prevTick = 0;\r\n  p5.draw = () => {\r\n    const {\r\n      isPlaying,\r\n      isRegenNeeded,\r\n      midiClock,\r\n    } = p5.state;\r\n\r\n    if (isRegenNeeded) {\r\n      genAndDrawHilbertMandelbrot();\r\n    }\r\n\r\n    // if (midiClock === 0) p5.incrementTick();\r\n\r\n    if (_.every([\r\n      !isRegenNeeded,\r\n      p5.state.tick !== prevTick,\r\n    ])) {\r\n      cursorDraw(0);\r\n      prevTick = p5.state.tick;\r\n    }\r\n\r\n    if (isPlaying) partialsDraw();\r\n\r\n    pauseScreenDraw();\r\n  }\r\n\r\n  /**\r\n   * This needs to be called by a user event handler.\r\n   * @param isPlaying\r\n   */\r\n  p5.toggleAudio = () => {\r\n    p5.setState(prevState => {\r\n      const { isPlaying } = prevState;\r\n      if (!isPlaying && audioCtx.state !== 'running') {\r\n        audioCtx.resume();\r\n      }\r\n\r\n      if (isPlaying && audioCtx.state === 'running') {\r\n        audioCtx.suspend();\r\n      }\r\n\r\n      return { ...prevState, isPlaying: !prevState.isPlaying };\r\n    });\r\n\r\n  }\r\n}\r\n","import CircularSlider from '@fseehawer/react-circular-slider';\r\nimport KeyboardArrowDownOutlinedIcon from '@material-ui/icons/KeyboardArrowDownOutlined';\r\nimport KeyboardArrowLeftOutlinedIcon from '@material-ui/icons/KeyboardArrowLeftOutlined';\r\nimport KeyboardArrowRightOutlinedIcon from '@material-ui/icons/KeyboardArrowRightOutlined';\r\nimport KeyboardArrowUpOutlinedIcon from '@material-ui/icons/KeyboardArrowUpOutlined';\r\nimport PauseCircleOutlineIcon from '@material-ui/icons/PauseCircleOutline';\r\nimport PlayCircleOutlineIcon from '@material-ui/icons/PlayCircleOutline';\r\nimport React, {useEffect, useState} from 'react';\r\nimport TuneIcon from '@material-ui/icons/Tune';\r\nimport ViewComfyOutlinedIcon from '@material-ui/icons/ViewComfyOutlined';\r\nimport ViewModuleOutlinedIcon from '@material-ui/icons/ViewModuleOutlined';\r\nimport ZoomInOutlinedIcon from '@material-ui/icons/ZoomInOutlined';\r\nimport ZoomOutOutlinedIcon from '@material-ui/icons/ZoomOutOutlined';\r\nimport _ from 'lodash';\r\nimport useMidiClock from \"./useMidiClock\";\r\nimport useP5 from './useP5';\r\nimport { HSVtoHex } from './color';\r\nimport { initialState, sketch } from \"./mandelbrotP5\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport {Button, ButtonGroup, Drawer} from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles({\r\n  paper: {\r\n    background: \"rgba(0,0,0,0.7)\",\r\n    paddingBottom: 65,\r\n  }\r\n});\r\n\r\nconst getHandleAction = (sketchInstance) => (action) => () => {\r\n  if (action === 'toggleAudio') {\r\n    sketchInstance.toggleAudio();\r\n    return;\r\n  }\r\n\r\n  sketchInstance.setState(prevState => {\r\n    const {\r\n      hilbertN,\r\n      isControlPanelOpen,\r\n      isRegenNeeded,\r\n      panX,\r\n      panY,\r\n      zoom,\r\n    } = prevState;\r\n    const panDelta = 0.1 / zoom;\r\n\r\n    const nextState = {\r\n      moveLeft: {panX: panX + panDelta},\r\n      moveRight: {panX: panX - panDelta},\r\n      moveUp: {panY: panY + panDelta},\r\n      moveDown: {panY: panY - panDelta},\r\n      resDec: {hilbertN: Math.pow(2, Math.log2(hilbertN) - 1)},\r\n      resInc: {hilbertN: Math.min(256, Math.pow(2, Math.log2(hilbertN) + 1))},\r\n      toggleControlPanel: {isControlPanelOpen: !isControlPanelOpen, isRegenNeeded},\r\n      zoomIn: {zoom: zoom * (10 / 9)},\r\n      zoomOut: {zoom: zoom * (9 / 10)},\r\n    }[action];\r\n\r\n    return {\r\n      ...prevState,\r\n      isRegenNeeded: !_.isEmpty(nextState),\r\n      ...nextState,\r\n    };\r\n  })\r\n};\r\n\r\nconst handleKeyDown = (handleAction) => (evt) => {\r\n  // console.log(evt);\r\n  const {code, shiftKey, key} = evt;\r\n\r\n  if (code === 'Space') {\r\n    handleAction(shiftKey ? 'toggleControlPanel' : 'toggleAudio')();\r\n    return;\r\n  }\r\n\r\n  const getAction = {\r\n    'ArrowDown': () => shiftKey ? 'zoomOut' : 'moveDown',\r\n    'ArrowLeft': () => shiftKey ? 'resDec' : 'moveLeft',\r\n    'ArrowRight': () => shiftKey ? 'resInc' : 'moveRight',\r\n    'ArrowUp': () => shiftKey ? 'zoomIn' : 'moveUp',\r\n  }[key];\r\n\r\n  if (getAction) handleAction(getAction())();\r\n};\r\n\r\nconst Mandelbrot = () => {\r\n  const {\r\n    ref,\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n  } = useP5(sketch, initialState);\r\n\r\n  window.sketchInstance = sketchInstance;\r\n\r\n  const handleAction = getHandleAction(sketchInstance);\r\n\r\n  useEffect(() => {\r\n    document.title = 'Mandelbrot Muse';\r\n    if (sketchInstance) {\r\n      const handler = handleKeyDown(handleAction);\r\n      window.addEventListener('keydown', handler)\r\n      return () => { // cleanup\r\n        window.removeEventListener('keydown', handler);\r\n      };\r\n    }\r\n  }, [sketchInstance]);\r\n\r\n  const {midiClockInDevice} = useMidiClock(() => {\r\n    if (sketchInstance) {\r\n      if (!sketchInstance.state.isPlaying) {\r\n        setSketchState(state => ({\r\n          ...state,\r\n          isPlaying: true,\r\n        }));\r\n      }\r\n      sketchInstance.incrementTick(true);\r\n    }\r\n  }, () => {\r\n    setSketchState(state => ({\r\n      ...state,\r\n      isPlaying: false,\r\n    }));\r\n  }, (beat) => {\r\n    if (sketchInstance) {\r\n      const { midiClocksPerTick } = sketchInstance.state;\r\n      sketchInstance.state.midiClock = beat;\r\n      sketchInstance.state.tick = Math.floor(beat / midiClocksPerTick);\r\n    }\r\n  });\r\n\r\n  return (<>\r\n    <div\r\n      ref={ref}\r\n      style={{\r\n        alignSelf: 'start',\r\n        background: 'radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)',\r\n        height: '50vw',\r\n        width: '100vw',\r\n      }}\r\n    />\r\n\r\n    <div style={{\r\n      bottom: 10,\r\n      right: 10,\r\n      padding: 0,\r\n      position: 'absolute',\r\n      textAlign: 'center',\r\n      zIndex: 1000000,\r\n    }}>\r\n      {!sketchState.isControlPanelOpen && (\r\n        <Button onClick={handleAction('toggleControlPanel')}>\r\n          show\r\n          <TuneIcon/>\r\n          controls\r\n        </Button>\r\n      )}\r\n\r\n      <Drawer\r\n        anchor=\"bottom\"\r\n        classes={useStyles()}\r\n        color=\"transparent\"\r\n        open={sketchState.isControlPanelOpen}\r\n        onClose={handleAction('toggleControlPanel')}\r\n        variant=\"persistent\"\r\n\r\n        // onMouseEnter={ev => { ev.currentTarget.style.opacity = 1 }}\r\n        // onMouseLeave={ev => { ev.currentTarget.style.opacity = 0.5 }}\r\n      >\r\n        <ButtonGroup fullWidth size=\"large\">\r\n          <Button onClick={handleAction('toggleAudio')}>\r\n            {!sketchState.isPlaying ? <PlayCircleOutlineIcon /> : <PauseCircleOutlineIcon />}\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('toggleControlPanel')}>\r\n            hide controls\r\n          </Button>\r\n        </ButtonGroup>\r\n\r\n        <ButtonGroup fullWidth size=\"large\">\r\n\r\n          <Button onClick={handleAction('resDec')}>\r\n            <ViewModuleOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('moveUp')}>\r\n            <KeyboardArrowUpOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('resInc')}>\r\n            <ViewComfyOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('zoomIn')}>\r\n            <ZoomInOutlinedIcon/>\r\n          </Button>\r\n\r\n        </ButtonGroup>\r\n\r\n        <ButtonGroup fullWidth size=\"large\">\r\n\r\n          <Button onClick={handleAction('moveLeft')}>\r\n            <KeyboardArrowLeftOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('moveDown')}>\r\n            <KeyboardArrowDownOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('moveRight')}>\r\n            <KeyboardArrowRightOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('zoomOut')}>\r\n            <ZoomOutOutlinedIcon/>\r\n          </Button>\r\n\r\n        </ButtonGroup>\r\n\r\n        <br/>\r\n\r\n        <FreqSlider\r\n          initialVal={60}\r\n          isRegenRequired\r\n          label=\"Fundamental frequency (Hz)\"\r\n          stateKey={\"fundamentalFreq\"}\r\n          sketchState={sketchState}\r\n          setSketchState={setSketchState}\r\n        />\r\n\r\n\r\n        <div style={{\r\n          display: 'flex',\r\n          flexWrap: 'wrap',\r\n          justifyContent: 'space-around',\r\n        }}>\r\n\r\n          <FreqSlider\r\n            initialVal={16}\r\n            isInt\r\n            isRegenRequired\r\n            label=\"Number of partials\"\r\n            max={1024}\r\n            min={1}\r\n            precision={1}\r\n            setSketchState={setSketchState}\r\n            size={120}\r\n            sketchState={sketchState}\r\n            stateKey={\"partialsCountMax\"}\r\n          />\r\n\r\n          <FreqSlider\r\n            initialVal={4096}\r\n            isInt\r\n            isRegenRequired\r\n            label=\"Mandelbrot iterations\"\r\n            max={8192}\r\n            min={64}\r\n            setSketchState={setSketchState}\r\n            size={120}\r\n            sketchState={sketchState}\r\n            stateKey={\"maxIters\"}\r\n          />\r\n\r\n          {midiClockInDevice ? (\r\n            <FreqSlider\r\n              key={midiClockInDevice}\r\n              isInt\r\n              min={1}\r\n              max={1024}\r\n              initialVal={24}\r\n              label=\"MIDI clocks per tick\"\r\n              size={120}\r\n              stateKey={\"midiClocksPerTick\"}\r\n              sketchState={sketchState}\r\n              setSketchState={setSketchState}\r\n            />\r\n          ) : (\r\n            <FreqSlider\r\n              key={midiClockInDevice}\r\n              initialVal={100}\r\n              label=\"Tick duration (ms)\"\r\n              size={120}\r\n              stateKey={\"tickDuration\"}\r\n              sketchState={sketchState}\r\n              setSketchState={setSketchState}\r\n            />\r\n          )}\r\n\r\n          <FreqSlider\r\n            initialVal={50}\r\n            label=\"Excite duration (ms)\"\r\n            size={120}\r\n            stateKey={\"exciteDuration\"}\r\n            sketchState={sketchState}\r\n            setSketchState={setSketchState}\r\n          />\r\n          <FreqSlider\r\n            initialVal={1000}\r\n            label=\"Decay duration (ms)\"\r\n            size={120}\r\n            stateKey={\"decayDuration\"}\r\n            sketchState={sketchState}\r\n            setSketchState={setSketchState}\r\n          />\r\n\r\n          <FreqSlider\r\n            initialVal={0.05}\r\n            label=\"Excite energy\"\r\n            precision={4}\r\n            size={120}\r\n            stateKey={\"exciteEnergy\"}\r\n            sketchState={sketchState}\r\n            setSketchState={setSketchState}\r\n          />\r\n        </div>\r\n\r\n        <ButtonGroup fullWidth size=\"large\">\r\n          <Button onClick={handleAction('toggleAudio')}>\r\n            {!sketchState.isPlaying ? <PlayCircleOutlineIcon /> : <PauseCircleOutlineIcon />}\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('toggleControlPanel')}>\r\n            hide controls\r\n          </Button>\r\n        </ButtonGroup>\r\n      </Drawer>\r\n\r\n\r\n    </div>\r\n   </>);\r\n};\r\n\r\nconst Slider = ({ sketchState, setSketchState, stateKey, ...props }) => (\r\n    <div>\r\n      {stateKey}: {sketchState[stateKey]}\r\n      <br />\r\n      <input\r\n        type=\"range\"\r\n        style={{width: 400}}\r\n        value={sketchState[stateKey]}\r\n        onChange={ev => {\r\n          const value = Number(ev.target.value);\r\n          setSketchState(state => ({\r\n            ...state,\r\n            [stateKey]: value\r\n          }))\r\n        }}\r\n        {...props}\r\n      />\r\n    </div>\r\n  );\r\n\r\n\r\nconst FreqSlider = ({\r\n  initialVal = 1,\r\n  isInt = false,\r\n  isRegenRequired = false,\r\n  label = '',\r\n  max = Number.MAX_VALUE,\r\n  min = Number.MIN_VALUE,\r\n  precision = 6,\r\n  setSketchState,\r\n  size = 240,\r\n  sketchState,\r\n  stateKey,\r\n}) => {\r\n  const degPerExp = 2048;\r\n  const errMargin = degPerExp / 3;\r\n\r\n  const constrainVal = val => Math.min(Math.max(isInt ? Math.round(val) : val, min), max);\r\n\r\n  const valToState = val => {\r\n    const freq = constrainVal(val);\r\n    const logFreq = Math.log2(freq);\r\n    const exp = Math.floor(logFreq);\r\n\r\n    return {\r\n      deg: Math.floor(degPerExp * (logFreq - exp)),\r\n      exp,\r\n      numberInputVal: freq,\r\n    };\r\n  }\r\n\r\n  const [state, setState] = useState(() => valToState(initialVal));\r\n\r\n  useEffect(() => {  // hack because react-circle-slider invokes the onChange callback when its knob position changes even via props\r\n    _.defer(() => setState(valToState(initialVal)));\r\n  }, []);\r\n\r\n  const handleChange = v => {\r\n    const {deg, exp} = state;\r\n    const didCrossUp = v >= 0 && v < errMargin && deg > degPerExp - errMargin;\r\n    const didCrossDn = deg >= 0 && deg < errMargin && v > degPerExp - errMargin;\r\n    const nextExp = didCrossUp\r\n      ? exp + 1\r\n      : didCrossDn\r\n        ? exp - 1\r\n        : exp;\r\n\r\n    const freq = constrainVal(Math.pow(2, nextExp + v / degPerExp));\r\n    const nextState = {\r\n      deg: v,\r\n      exp: nextExp,\r\n      numberInputVal: freq\r\n    };\r\n    setState(nextState);\r\n    setSketchState(state => ({\r\n      ...state,\r\n      [stateKey]: freq,\r\n    }));\r\n  }\r\n\r\n  return (\r\n    <div style={{\r\n      flex: `0 ${size + 40}px`,\r\n      height: size + 40,\r\n      marginBottom: 40,\r\n    }}>\r\n      <div style={{\r\n        height: '3em',\r\n      }}>\r\n      {label || `${stateKey}: ${sketchState[stateKey]}`}\r\n      </div>\r\n\r\n      <div\r\n        style={{\r\n          paddingTop: 10,\r\n          position: 'relative',\r\n        }}\r\n        onPointerUp={() => {\r\n          sketchState.isRegenNeeded = isRegenRequired // TODO: isFreqChanged instead of full regen\r\n        }}\r\n      >\r\n        <CircularSlider\r\n          dataIndex={state.deg}\r\n          min={0}\r\n          max={degPerExp - 1}\r\n          knobColor=\"#AAA\"\r\n          knobSize={60}\r\n          label=\"Fundamental Frequency\"\r\n          renderLabelValue={\r\n            <input\r\n              type=\"number\"\r\n              style={{\r\n                background: 'none',\r\n                border: 'none',\r\n                color: 'white',\r\n                fontSize: `${size / 100}em`,\r\n                left: '50%',\r\n                marginLeft: '-40%',\r\n                marginTop: '-0.5em',\r\n                position: 'absolute',\r\n                textAlign: 'center',\r\n                top: '50%',\r\n                width: '80%',\r\n                zIndex: 3,\r\n              }}\r\n              value={isInt ? state.numberInputVal : state.numberInputVal.toPrecision(precision)}\r\n              onChange={ev => {\r\n                setState({\r\n                  ...state,\r\n                  numberInputVal: Number(ev.target.value),\r\n                });\r\n              }}\r\n              onKeyDown={({ key }) => {\r\n                if (key === 'Enter') {\r\n                  const nextState = valToState(state.numberInputVal);\r\n                  setState(nextState);\r\n                  _.defer(() => { // hack because react-circle-slider invokes the onChange callback when its knob position changes even via props\r\n                    setState(nextState);\r\n\r\n                    setSketchState(state => ({\r\n                      ...state,\r\n                      [stateKey]: nextState.numberInputVal,\r\n                      isRegenNeeded: isRegenRequired,\r\n                    }));\r\n                  })\r\n\r\n                }\r\n              }}\r\n            />\r\n          }\r\n          onChange={handleChange}\r\n          progressColorFrom={HSVtoHex(state.exp / 15, 1, 1)}\r\n          progressColorTo={HSVtoHex((state.exp + 1) / 15, 1, 1)}\r\n          progressLineCap=\"flat\"\r\n          trackColor=\"#666\"\r\n          height={size}\r\n          width={size}\r\n        />\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nexport default Mandelbrot;\r\n","import FrettedInstrument from './frettedInstrument';\r\nimport React from 'react';\r\n\r\nconst Mandolin = () => (\r\n  <FrettedInstrument\r\n    fretCount={20}\r\n    fretMarkers={[0, 3, 5, 7, 10, 12, 15]}\r\n    tuning={[7, 2, 9, 4]}\r\n  />\r\n);\r\n\r\nexport default Mandolin;\r\n","import React from 'react';\r\nimport globalHook from 'use-global-hook';\r\n\r\nconst initialState = {\r\n  mediaStream: undefined,\r\n};\r\n\r\nconst actions = {\r\n  setMediaStream: (store, mediaStream) =>\r\n    store.setState({mediaStream}),\r\n};\r\n\r\nexport default globalHook(React, initialState, actions);\r\n","import React from 'react';\r\nimport useMic from './useMic';\r\nimport {IconButton} from \"@material-ui/core\";\r\nimport {MicOffOutlined, Mic as MicIcon} from '@material-ui/icons';\r\n\r\nconst Mic = () => {\r\n\r\n  const [state, actions] = useMic( // https://github.com/andregardi/use-global-hook#avoid-unnecessary-renders\r\n    ({mediaStream}) => ({mediaStream}),\r\n    actions => actions,\r\n  );\r\n\r\n  const handleMicOnClick = () => {\r\n    navigator.mediaDevices.getUserMedia({\r\n      audio: true,\r\n      video: false\r\n    }).then(mediaStream => {\r\n      actions.setMediaStream(mediaStream)\r\n    });\r\n  }\r\n\r\n  const handleMicOffClick = () => {\r\n    state.mediaStream.getTracks().forEach(tr => tr.stop());\r\n    actions.setMediaStream(undefined);\r\n  }\r\n\r\n  const isMicOn = !!state.mediaStream;\r\n\r\n  return (\r\n    <>\r\n      <IconButton\r\n        edge=\"start\"\r\n        color=\"inherit\"\r\n        // aria-label=\"open drawer\"\r\n        onClick={isMicOn ? handleMicOffClick : handleMicOnClick}\r\n      >\r\n        {isMicOn ? <MicOffOutlined/> : <MicIcon/>}\r\n      </IconButton>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Mic;\r\n","import React from 'react';\r\n\r\n// theme-aware svgs https://github.com/mui/material-ui/issues/34487\r\n\r\nconst MidiIcon = () => (\r\n  <svg className=\"MuiSvgIcon-root\" style={{transform: 'scale(1.5)'}} viewBox=\"0 0 100 100\">\r\n    <path d=\"M-35.146,176.527c0.179,0.52,0.775,0.946,1.325,0.946h3.5c0.55,0,0.709,0.343,0.353,0.763l-9.706,11.446  c-0.356,0.419-0.945,0.426-1.31,0.014l-10.173-11.474c-0.365-0.412-0.213-0.748,0.337-0.748h4c0.55,0,0.835-0.419,0.634-0.931  l-10.269-26.138c-0.201-0.512,0.084-0.931,0.634-0.931h9c0.55,0,0.835-0.419,0.634-0.931l-10.269-26.138  c-0.201-0.512,0.084-0.931,0.634-0.931h14.5c0.55,0,1.127,0.432,1.282,0.959l11.186,38.081c0.155,0.528-0.168,0.959-0.718,0.959  h-9.75c-0.55,0-0.854,0.426-0.675,0.946L-35.146,176.527z\"></path>\r\n    <path\r\n      d=\"M-139.085,142.885c1.738,2.029,2.818,5.84,2.818,9.948c0,3.918-0.962,7.524-2.573,9.644l2.434,1.848  c2.001-2.633,3.196-6.93,3.196-11.493c0-4.877-1.328-9.34-3.552-11.936L-139.085,142.885z\"></path>\r\n    <path\r\n      d=\"M-129.131,133.308l-2.32,1.989c3.123,3.645,5.064,10.415,5.064,17.669c0,6.911-1.722,13.304-4.607,17.102l2.434,1.849  c3.275-4.31,5.23-11.395,5.23-18.95C-123.331,144.895-125.499,137.546-129.131,133.308z\"></path>\r\n    <path\r\n      d=\"M-121.011,126.306l-2.32,1.989c4.402,5.138,7.137,14.638,7.137,24.793c0,9.672-2.425,18.638-6.485,23.983l2.434,1.849  c4.45-5.857,7.107-15.514,7.107-25.831C-113.138,142.071-116.081,132.059-121.011,126.306z\"></path>\r\n    <path\r\n      d=\"M-164.222,138.428c-2.091,2.07-6.513,4.545-11.443,4.545v0.004c-2.465,0.081-4.531,4.357-4.531,9.622  s2.066,9.541,4.531,9.622v0.004c4.93,0,9.418,2.503,11.499,4.571c-1.708-3.721-2.737-8.701-2.737-14.246  C-166.903,147.066-165.896,142.136-164.222,138.428z\"></path>\r\n    <path\r\n      d=\"M-152.596,128.72c-5.631,0-10.196,10.473-10.196,23.392s4.565,23.392,10.196,23.392s10.196-10.473,10.196-23.392  S-146.965,128.72-152.596,128.72z M-156.715,159.95c-0.988-1.74-1.683-4.459-1.683-7.796s0.695-6.056,1.683-7.796  c2.938,0.025,5.315,3.505,5.315,7.796S-153.777,159.925-156.715,159.95z\"></path>\r\n    <path\r\n      d=\"M-207.989,143.385c1.738,2.029,2.818,5.84,2.818,9.948c0,3.918-0.962,7.524-2.573,9.644l2.434,1.848  c2.001-2.633,3.196-6.93,3.196-11.493c0-4.877-1.328-9.34-3.552-11.936L-207.989,143.385z\"></path>\r\n    <path\r\n      d=\"M-198.035,133.808l-2.32,1.989c3.123,3.645,5.064,10.415,5.064,17.669c0,6.911-1.722,13.304-4.607,17.102l2.434,1.849  c3.275-4.31,5.23-11.395,5.23-18.95C-192.234,145.395-194.402,138.046-198.035,133.808z\"></path>\r\n    <path\r\n      d=\"M-233.125,138.928c-2.091,2.07-6.513,4.545-11.443,4.545v0.004c-2.465,0.081-4.531,4.357-4.531,9.622  s2.066,9.541,4.531,9.622v0.004c4.93,0,9.418,2.503,11.499,4.571c-1.708-3.721-2.737-8.701-2.737-14.246  C-235.806,147.566-234.799,142.636-233.125,138.928z\"></path>\r\n    <path\r\n      d=\"M-221.499,129.22c-5.631,0-10.196,10.473-10.196,23.392s4.565,23.392,10.196,23.392s10.196-10.473,10.196-23.392  S-215.868,129.22-221.499,129.22z M-225.618,160.45c-0.988-1.74-1.683-4.459-1.683-7.796s0.695-6.056,1.683-7.796  c2.938,0.025,5.315,3.505,5.315,7.796C-220.304,156.945-222.68,160.425-225.618,160.45z\"></path>\r\n    <path\r\n      d=\"M37.144,150.017c1.738,2.029,2.818,5.84,2.818,9.948c0,3.918-0.962,7.524-2.573,9.644l2.434,1.848  c2.001-2.633,3.196-6.93,3.196-11.493c0-4.877-1.328-9.34-3.552-11.936L37.144,150.017z\"></path>\r\n    <path\r\n      d=\"M12.008,145.56c-2.091,2.07-6.513,4.545-11.443,4.545v0.004c-2.465,0.081-4.531,4.357-4.531,9.622s2.066,9.541,4.531,9.622  v0.004c4.93,0,9.418,2.503,11.499,4.571c-1.708-3.721-2.738-8.701-2.738-14.246C9.326,154.198,10.333,149.267,12.008,145.56z\"></path>\r\n    <path\r\n      d=\"M23.634,135.852c-5.631,0-10.196,10.473-10.196,23.392s4.565,23.392,10.196,23.392s10.196-10.473,10.196-23.392  S29.265,135.852,23.634,135.852z M19.515,167.081c-0.988-1.74-1.683-4.459-1.683-7.796s0.695-6.056,1.683-7.796  c2.938,0.025,5.315,3.505,5.315,7.796S22.453,167.056,19.515,167.081z\"></path>\r\n    <path\r\n      d=\"M284.762,158.47c-4.778,0-8.787,7.542-9.893,17.719l14.814-14.814C288.225,159.526,286.548,158.47,284.762,158.47z\"></path>\r\n    <path\r\n      d=\"M285.384,178.403c0.364,1.054,0.574,2.241,0.574,3.501c0,4.291-2.377,7.771-5.315,7.796c-0.7-1.232-1.246-2.962-1.51-5.047  l-4.115,4.115c1.284,9.548,5.161,16.486,9.744,16.486c5.631,0,10.196-10.473,10.196-23.392c0-4.253-0.497-8.236-1.362-11.673  L285.384,178.403z\"></path>\r\n    <polygon\r\n      points=\"283.842,175.702 292.611,166.933 300.121,159.423 298,157.302 291.329,163.973 281.152,174.15 280.14,175.161   274.579,180.723 270.532,184.77 263.24,192.061 252,203.302 254.121,205.423 266.735,192.809 270.93,188.614 274.654,184.89   279.003,180.541 \"></polygon>\r\n    <path\r\n      d=\"M270.495,180.564c0.189-4.785,1.146-9.075,2.642-12.386c-2.091,2.07-6.513,4.545-11.443,4.545v0.004  c-2.465,0.081-4.531,4.357-4.531,9.622c0,3.924,1.148,7.296,2.754,8.794L270.495,180.564z\"></path>\r\n    <path\r\n      d=\"M269.713,194.073c1.454,0.772,2.657,1.656,3.479,2.473c-0.606-1.32-1.122-2.805-1.541-4.411L269.713,194.073z\"></path>\r\n    <path\r\n      d=\"M330.843,167.678c-2.091,2.07-6.513,4.545-11.443,4.545v0.004c-2.465,0.081-4.531,4.357-4.531,9.622  s2.066,9.541,4.531,9.622v0.004c4.93,0,9.418,2.503,11.499,4.571c-1.708-3.721-2.737-8.701-2.737-14.246  C328.162,176.316,329.169,171.386,330.843,167.678z\"></path>\r\n    <path\r\n      d=\"M348.574,193.029l-1.414-1.414l-2.121-2.121l-1.414-1.414l1.414-1.414l5.303-5.303l-5.303-5.303l-1.414-1.414l1.414-1.414  l2.121-2.121l1.414-1.414l1.414,1.414l2.026,2.026c-1.451-8.859-5.177-15.165-9.546-15.165c-5.631,0-10.196,10.473-10.196,23.392  s4.565,23.392,10.196,23.392c4.369,0,8.094-6.306,9.546-15.165l-2.026,2.026L348.574,193.029z M338.35,189.2  c-0.988-1.74-1.683-4.459-1.683-7.796c0-3.336,0.695-6.056,1.683-7.796c2.938,0.025,5.315,3.505,5.315,7.796  C343.665,185.695,341.288,189.175,338.35,189.2z\"></path>\r\n    <polygon\r\n      points=\"364.131,174.645 362.009,172.523 355.292,179.241 348.574,172.523 346.453,174.645 352.659,180.851   353.171,181.362 346.453,188.08 348.574,190.201 355.292,183.484 362.009,190.201 364.131,188.08 357.413,181.362 \"></polygon>\r\n    <path\r\n      d=\"M532.913,169.595v-0.475c5.377-0.736,9.537-5.346,9.537-10.922c0-6.085-4.951-11.037-11.037-11.037  c-6.085,0-11.036,4.951-11.036,11.037c0,5.575,4.159,10.186,9.536,10.922v0.475c-5.108,0.331-9.764,2.334-13.43,5.468l-1.388-1.388  l0.625-0.625c0.391-0.391,0.391-1.024,0-1.414l-4.361-4.36c-0.391-0.391-1.024-0.391-1.414,0l-3.372,3.372  c-0.391,0.391-0.391,1.024,0,1.414l4.36,4.361c0.391,0.391,1.024,0.391,1.414,0l0.626-0.626l1.357,1.357  c-3.682,4.081-5.929,9.482-5.929,15.399c0,12.688,10.323,23.012,23.011,23.012s23.012-10.323,23.012-23.012  C554.425,180.368,544.905,170.371,532.913,169.595z M523.378,158.198c0-4.432,3.605-8.037,8.036-8.037  c4.432,0,8.037,3.605,8.037,8.037c0,3.918-2.821,7.185-6.537,7.891v-2.807h0.885c0.552,0,1-0.448,1-1v-6.167c0-0.552-0.448-1-1-1  h-4.769c-0.552,0-1,0.448-1,1v6.167c0,0.552,0.448,1,1,1h0.884v2.807C526.198,165.383,523.378,162.116,523.378,158.198z   M531.413,212.563c-11.034,0-20.011-8.978-20.011-20.012s8.977-20.011,20.011-20.011s20.012,8.977,20.012,20.011  S542.447,212.563,531.413,212.563z\"></path>\r\n    <path\r\n      d=\"M531.413,175.54c-0.239,0-0.471,0.026-0.707,0.036v10.275c0.233-0.024,0.468-0.038,0.707-0.038  c3.716,0,6.738,3.023,6.738,6.739c0,0.177-0.007,0.353-0.02,0.528l7.944,8.056c1.483-2.523,2.349-5.451,2.349-8.583  C548.425,183.172,540.794,175.54,531.413,175.54z\"></path>\r\n    <path\r\n      d=\"M535.152,192.552c0-2.065-1.674-3.739-3.738-3.739s-3.739,1.674-3.739,3.739s1.674,3.738,3.739,3.738  c0.435,0,0.846-0.089,1.234-0.225l9.58,9.714l2.137-2.107l-9.515-9.648C535.043,193.572,535.152,193.075,535.152,192.552z\"></path>\r\n    <path\r\n      d=\"M612.769,174.993L612.769,174.993c-0.172-0.407-0.356-0.807-0.55-1.202c-0.042-0.087-0.088-0.171-0.132-0.257  c-0.152-0.3-0.309-0.596-0.474-0.888c-0.061-0.109-0.124-0.217-0.187-0.325c-0.163-0.278-0.331-0.552-0.505-0.823  c-0.06-0.094-0.119-0.189-0.181-0.281c-0.231-0.349-0.469-0.692-0.718-1.027c-0.004-0.006-0.008-0.012-0.012-0.017  c-0.262-0.352-0.535-0.695-0.816-1.031c-0.054-0.065-0.111-0.127-0.166-0.191c-0.224-0.262-0.454-0.52-0.69-0.772  c-0.079-0.085-0.16-0.169-0.241-0.252c-0.229-0.237-0.463-0.47-0.702-0.697c-0.075-0.071-0.148-0.143-0.224-0.213  c-0.637-0.591-1.306-1.148-2.007-1.665c-0.053-0.039-0.107-0.076-0.161-0.114c-0.296-0.214-0.596-0.422-0.902-0.623  c-0.088-0.058-0.177-0.114-0.265-0.17c-0.29-0.185-0.585-0.363-0.884-0.535c-0.081-0.047-0.161-0.094-0.243-0.14  c-0.77-0.431-1.567-0.82-2.388-1.161c-0.045-0.019-0.092-0.036-0.137-0.054c-0.358-0.146-0.721-0.283-1.089-0.412  c-0.093-0.033-0.187-0.064-0.28-0.095c-0.339-0.114-0.68-0.219-1.025-0.317c-0.088-0.025-0.175-0.051-0.264-0.075  c-1.923-0.522-3.943-0.805-6.028-0.805s-4.105,0.283-6.028,0.805c-0.088,0.024-0.176,0.05-0.264,0.075  c-0.345,0.098-0.687,0.204-1.025,0.317c-0.094,0.031-0.187,0.062-0.28,0.095c-0.367,0.129-0.73,0.266-1.089,0.412  c-0.046,0.019-0.092,0.035-0.137,0.054c-0.821,0.342-1.618,0.73-2.388,1.161c-0.082,0.046-0.162,0.093-0.243,0.14  c-0.299,0.172-0.594,0.35-0.884,0.535c-0.089,0.056-0.177,0.113-0.265,0.17c-0.306,0.2-0.607,0.408-0.902,0.623  c-0.053,0.039-0.108,0.075-0.161,0.114c-0.7,0.517-1.37,1.074-2.007,1.665c-0.076,0.07-0.149,0.142-0.224,0.213  c-0.239,0.227-0.473,0.46-0.702,0.697c-0.081,0.084-0.161,0.167-0.241,0.252c-0.236,0.252-0.465,0.509-0.69,0.772  c-0.055,0.064-0.111,0.126-0.166,0.191c-0.281,0.336-0.554,0.679-0.816,1.031c-0.004,0.006-0.008,0.012-0.012,0.017  c-0.249,0.335-0.487,0.679-0.718,1.027c-0.062,0.093-0.12,0.188-0.181,0.281c-0.174,0.271-0.342,0.545-0.505,0.823  c-0.063,0.108-0.126,0.216-0.187,0.325c-0.164,0.292-0.322,0.588-0.474,0.888c-0.044,0.086-0.089,0.17-0.132,0.257  c-0.194,0.395-0.379,0.795-0.55,1.201l0,0l0,0c-1.158,2.747-1.8,5.764-1.8,8.926c0,12.725,10.354,23.069,23.069,23.069  s23.069-10.344,23.069-23.069C614.569,180.756,613.927,177.74,612.769,174.993L612.769,174.993z M611.594,183.919  c0,11.078-9.015,20.094-20.094,20.094s-20.094-9.015-20.094-20.094c0-2.582,0.507-5.043,1.398-7.313l0,0  c0.147-0.375,0.307-0.742,0.476-1.106c0.034-0.073,0.07-0.144,0.105-0.217c0.329-0.687,0.693-1.353,1.096-1.995  c0.023-0.037,0.045-0.075,0.068-0.112c0.211-0.331,0.431-0.655,0.66-0.972c0.046-0.063,0.094-0.125,0.14-0.187  c0.001-0.002,0.003-0.004,0.004-0.006c0.424-0.573,0.876-1.121,1.356-1.645c0.01-0.011,0.021-0.023,0.031-0.034  c0.056-0.061,0.109-0.123,0.166-0.183c0.257-0.273,0.521-0.537,0.792-0.795c0.056-0.053,0.115-0.103,0.171-0.155  c0.014-0.013,0.029-0.026,0.043-0.039c0.496-0.457,1.013-0.887,1.552-1.293c0.108-0.081,0.215-0.164,0.325-0.243  c0.295-0.213,0.593-0.419,0.9-0.615c0.083-0.053,0.169-0.102,0.253-0.154c0.567-0.352,1.151-0.675,1.754-0.97  c0.044-0.021,0.088-0.042,0.132-0.064c0.093-0.045,0.186-0.091,0.28-0.135c0.329-0.152,0.661-0.299,0.999-0.434  c0.063-0.025,0.129-0.046,0.192-0.07c0.654-0.252,1.323-0.468,2.007-0.652c0.128-0.034,0.257-0.067,0.386-0.1  c0.033-0.008,0.066-0.018,0.099-0.026c0.354-0.085,0.708-0.167,1.069-0.233l0,0c1.182-0.218,2.396-0.347,3.64-0.347  s2.457,0.13,3.64,0.347l0,0c0.361,0.066,0.715,0.148,1.069,0.233c0.033,0.008,0.066,0.017,0.099,0.026  c0.129,0.032,0.258,0.065,0.386,0.1c0.684,0.184,1.354,0.4,2.007,0.652c0.064,0.025,0.129,0.045,0.192,0.07  c0.339,0.135,0.67,0.281,0.999,0.434c0.094,0.044,0.187,0.09,0.28,0.135c0.044,0.021,0.088,0.042,0.132,0.064  c0.602,0.295,1.187,0.618,1.754,0.97c0.084,0.052,0.17,0.1,0.253,0.154c0.307,0.197,0.605,0.403,0.9,0.615  c0.11,0.079,0.217,0.162,0.325,0.243c0.539,0.405,1.056,0.836,1.552,1.292c0.035,0.032,0.069,0.063,0.104,0.095  c0.036,0.034,0.074,0.066,0.11,0.1c0.272,0.258,0.535,0.523,0.792,0.795c0.056,0.06,0.11,0.122,0.166,0.183  c0.01,0.012,0.021,0.023,0.031,0.034c0.481,0.524,0.933,1.072,1.356,1.645c0.001,0.002,0.003,0.004,0.004,0.006  c0.046,0.063,0.095,0.124,0.14,0.187c0.229,0.318,0.449,0.641,0.66,0.972c0.023,0.037,0.045,0.075,0.068,0.112  c0.402,0.642,0.767,1.307,1.096,1.995c0.035,0.072,0.071,0.144,0.105,0.217c0.169,0.364,0.328,0.731,0.476,1.106l0,0  C611.087,178.876,611.594,181.337,611.594,183.919z\"></path>\r\n    <path\r\n      d=\"M605.757,155.737c-2.922,0-5.573,1.151-7.528,3.024c7.348,1.967,13.424,7.072,16.697,13.787  c1.099-1.701,1.741-3.724,1.741-5.901C616.667,160.621,611.782,155.737,605.757,155.737z\"></path>\r\n    <path\r\n      d=\"M602.513,171.216l-9.651,9.651c-0.417-0.186-0.876-0.295-1.362-0.295c-0.516,0-0.999,0.126-1.436,0.335l-5.955-5.68  l-2.054,2.153l6.164,5.88c-0.043,0.213-0.066,0.434-0.066,0.66c0,1.849,1.499,3.347,3.347,3.347s3.347-1.499,3.347-3.347  c0-0.256-0.034-0.502-0.089-0.741l9.858-9.858L602.513,171.216z\"></path>\r\n    <path\r\n      d=\"M584.771,158.76c-1.956-1.872-4.606-3.024-7.528-3.024c-6.025,0-10.91,4.884-10.91,10.91c0,2.177,0.641,4.2,1.741,5.901  C571.347,165.832,577.424,160.727,584.771,158.76z\"></path>\r\n    <polygon\r\n      points=\"-88.662,165.331 -70.751,147.482 -70.751,147.482 -56.52,133.299 -58.637,131.174 -71.714,144.206 -71.714,144.206   -89.857,162.287 -89.857,162.287 -104.796,177.174 -102.679,179.299 \"></polygon>\r\n    <path\r\n      d=\"M-84.891,149.473h-9c-0.55,0-0.835,0.419-0.634,0.931l3.473,8.84l18.377-18.314l-5.434-18.497  c-0.155-0.528-0.732-0.959-1.282-0.959h-14.5c-0.55,0-0.835,0.419-0.634,0.931l10.269,26.139  C-84.056,149.054-84.341,149.473-84.891,149.473z\"></path>\r\n    <path\r\n      d=\"M-69.789,150.758l-17.677,17.616l3.209,8.168c0.201,0.512-0.084,0.931-0.634,0.931h-4c-0.55,0-0.701,0.337-0.337,0.748  l10.173,11.474c0.365,0.412,0.954,0.405,1.31-0.014l9.706-11.446c0.356-0.419,0.197-0.763-0.353-0.763h-3.5  c-0.55,0-1.146-0.426-1.325-0.946l-4.85-14.109c-0.179-0.52,0.125-0.946,0.675-0.946h9.75c0.55,0,0.873-0.432,0.718-0.959  L-69.789,150.758z\"></path>\r\n    <path\r\n      d=\"M667.283,152.612h-29.565c-1.225,0-2.217,1.127-2.217,2.518v52.464c0,1.391,0.993,2.518,2.217,2.518h29.565  c1.225,0,2.217-1.128,2.217-2.518V155.13C669.5,153.74,668.507,152.612,667.283,152.612z M652.5,199.612c-5.238,0-9.5-4.262-9.5-9.5  s4.262-9.5,9.5-9.5s9.5,4.262,9.5,9.5S657.738,199.612,652.5,199.612z M652.5,161.158c1.905,0,3.455,1.55,3.455,3.455  s-1.55,3.455-3.455,3.455s-3.455-1.55-3.455-3.455S650.595,161.158,652.5,161.158z\"></path>\r\n    <circle cx=\"652.5\" cy=\"190.112\" r=\"4.955\"></circle>\r\n    <path\r\n      d=\"M740.401,182.582c0-15.109-12.292-27.401-27.401-27.401s-27.401,12.292-27.401,27.401c0,1.802,0.177,3.606,0.542,5.436  l2.71,10.726c0.193,2.308,1.797,4.354,4.163,4.988c0.969,0.26,1.946,0.248,2.854,0.016l0.421,1.571  c0.429,1.6,2.074,2.55,3.674,2.121l4.186-1.122c1.6-0.429,2.55-2.074,2.121-3.674l-4.141-15.455c-0.429-1.6-2.074-2.55-3.674-2.121  l-4.186,1.122c-1.6,0.429-2.55,2.074-2.121,3.674l0.798,2.976c-0.81,0.229-1.561,0.632-2.194,1.185l-1.685-6.667  c-0.31-1.563-0.467-3.17-0.467-4.777c0-13.455,10.946-24.401,24.401-24.401s24.401,10.946,24.401,24.401  c0,1.654-0.167,3.31-0.48,4.852l-1.686,6.655c-0.609-0.553-1.348-0.978-2.186-1.227l0.803-2.998c0.429-1.6-0.521-3.245-2.121-3.674  l-4.186-1.122c-1.6-0.429-3.245,0.521-3.674,2.121l-4.141,15.455c-0.429,1.6,0.521,3.245,2.121,3.674l4.186,1.122  c1.6,0.429,3.245-0.521,3.674-2.121l0.417-1.556c2.957,0.709,5.955-1.05,6.763-3.996l0,0l0.001-0.004  c0.003-0.009,0.006-0.018,0.009-0.027c0.004-0.016,0.006-0.032,0.01-0.048l2.933-11.585  C740.214,186.296,740.401,184.438,740.401,182.582z\"></path>\r\n    <path\r\n      d=\"M783.051,181.505c3.89-4.31,3.883-8.716,3.803-9.476c-0.04-1.27-0.61-13.342-13.25-13.342c-10.62,0-13.43,8.78-13.43,13.33  c-0.01,0.25-0.34,6.07,3.46,10.34c1.27,1.43,0.66,2.89-0.94,5.65c-1.16,1.99-2.657,4.591-1.817,6.671  c1.06,2.63,3.127,3.629,5.117,3.679c0.04,0,0.08,0,0.11,0c2.93,0,5.8-3.09,8.77-9.45c1.82-3.89,2.25-6.64,1.35-8.69  c-1.04-2.37-3.52-3.15-5.92-3.9c-3.53-1.12-7.466-2.549-6.64-7.34c0.88-3.08,3.29-7.29,9.94-7.29  c10.26,0,10.556,9.983,10.578,10.409c0,0,0.719,4.875-2.237,8.411L783.051,181.505z\"></path>\r\n    <path\r\n      d=\"M773.604,152.117c-19.77,0-19.188,19.8-19.188,20h1.375c0-0.05,0.62-4.307,2.75-8.567c2.79-5.59,8.002-8.433,15.062-8.433  c16.75,0,17,16.31,17,17c0,9.17-4.24,12.97-9.16,17.38c-1.96,1.76-3.5,4.52-5.13,7.43c-2.94,5.26-5.922,10.977-11.502,10.977  c-3.402,0-4.313-0.397-6.208-2.292c-2.35-2.36-2.794-6.106-2.794-6.146l-1.415-0.019c0,0.2,0,4.914,3.125,8.289  c1.888,2.039,3.913,2.87,7.233,2.87c7.34,0,10.97-6.49,14.17-12.21c1.51-2.69,2.94-5.24,4.53-6.67c4.99-4.48,10.15-9.11,10.15-19.61  C793.604,171.917,793.374,152.117,773.604,152.117z\"></path>\r\n    <polygon\r\n      points=\"804.908,201.531 812.765,193.531 825.461,180.604 825.461,180.604 838.891,166.93 838.891,166.93 840.004,165.796   847.174,158.495 845.034,156.393 839.896,161.624 839.896,161.624 837.722,163.837 837.722,163.837 834.892,166.719   834.892,166.719 832.729,168.921 832.729,168.921 818.57,183.338 809.88,192.187 809.88,192.187 799.034,203.231 801.174,205.332   803.925,202.532 803.925,202.532 \"></polygon>\r\n    <path\r\n      d=\"M839.597,170.492c0.102,0.902,0.111,1.505,0.111,1.625c0,9.17-4.24,12.97-9.16,17.38c-1.96,1.76-3.5,4.52-5.13,7.43  c-2.94,5.26-5.922,10.977-11.502,10.977c-3.402,0-4.313-0.397-6.208-2.292c-0.451-0.453-0.831-0.958-1.152-1.478l-1.447,1.473  c0.399,0.732,0.893,1.458,1.516,2.13c1.888,2.039,3.913,2.87,7.233,2.87c7.34,0,10.97-6.49,14.17-12.21  c1.51-2.69,2.94-5.24,4.53-6.67c4.99-4.48,10.15-9.11,10.15-19.61c0-0.059-0.024-1.804-0.548-4.235L839.597,170.492z\"></path>\r\n    <path\r\n      d=\"M804.896,172.117c0-0.05,0.62-4.307,2.75-8.568c2.79-5.59,8.002-8.432,15.062-8.432c6.891,0,10.985,2.762,13.423,6.059  l2.101-2.14c-2.896-3.785-7.661-6.92-15.524-6.92c-19.77,0-19.188,19.8-19.188,20L804.896,172.117L804.896,172.117z\"></path>\r\n    <path\r\n      d=\"M822.708,161.687c4.632,0,7.229,2.035,8.691,4.307l2.06-2.098c-1.856-2.787-5.091-5.209-10.751-5.209  c-10.62,0-13.43,8.78-13.43,13.33c-0.01,0.25-0.34,6.07,3.46,10.34c0.548,0.618,0.729,1.247,0.648,1.979l7.425-7.56  c-0.464-0.161-0.933-0.312-1.403-0.459c-3.53-1.12-7.466-2.549-6.64-7.34C813.648,165.897,816.058,161.687,822.708,161.687z\"></path>\r\n    <path\r\n      d=\"M832.155,181.505c2.37-2.626,3.29-5.282,3.632-7.133l-3.077,3.133c-0.349,1.018-0.871,2.058-1.661,3.003L832.155,181.505z\"></path>\r\n    <path\r\n      d=\"M815.098,198.357c0.04,0,0.08,0,0.11,0c2.93,0,5.8-3.09,8.77-9.45c0.704-1.505,1.195-2.836,1.486-4.025l-12.691,12.922  C813.517,198.162,814.312,198.338,815.098,198.357z\"></path>\r\n    <path\r\n      d=\"M857.5,157.362v48h68.75v-48H857.5z M871.119,184.737v-25.375h3.286v25.375h2.125v18.625h-7.535v-18.625H871.119z   M878.529,184.737h2.125v-25.375h5.411v44h-7.536V184.737z M888.065,159.362h5.411v25.375h2.125v18.625h-7.536V159.362z   M897.602,184.737h2.125v-25.375h3.286v25.375h2.125v18.625h-7.535v-18.625H897.602z M907.137,184.737h2.125v-25.375h3.286v25.375  h2.125v18.625h-7.536V184.737z M859.5,159.362h5.369v25.375h2.125v18.625H859.5V159.362z M924.25,203.362h-7.577v-18.625h2.125  v-25.375h5.452V203.362z\"></path>\r\n    <g><polygon points=\"-421.569,177.979 -426.233,163.208 -429.591,173.085 -434.319,165.33 -437.268,169.644 -443.712,162.577    -441.496,160.556 -437.606,164.822 -434.174,159.803 -430.367,166.048 -426.127,153.579 -421.84,167.154 -417.795,151.671    -412.486,165.512 -408.769,158.754 -403.676,165.884 -399.929,159.986 -395.431,165.632 -397.777,167.501 -399.654,165.147    -403.532,171.249 -408.439,164.378 -412.972,172.621 -417.252,161.462  \"></polygon></g>\r\n    <g><polygon points=\"-409.561,-58.915 -419.572,-82.993 -416.802,-84.144 -409.35,-66.222 -400.721,-84.005 -391.99,-66.004    -383.147,-84.22 -373.13,-60.145 -375.9,-58.992 -383.358,-76.917 -391.99,-59.132 -400.721,-77.132  \"></polygon></g>\r\n    <g><polygon points=\"-287.095,-57.809 -304.842,-82.61 -302.403,-84.356 -290.095,-67.157 -290.096,-84.793 -275.842,-66.793    -275.839,-85.327 -258.719,-60.331 -261.194,-58.635 -272.841,-75.639 -272.842,-58.173 -287.096,-76.172  \"></polygon></g>\r\n    <g><path d=\"M-430.636-58.068c-3.541,0-4.659-5.833-6.075-13.218c-0.673-3.508-1.914-9.984-3.128-10.757   c-1.214,0.773-2.456,7.249-3.128,10.757c-1.416,7.385-2.534,13.218-6.075,13.218c-3.539,0-4.656-5.833-6.071-13.217   c-0.672-3.507-1.913-9.98-3.125-10.758c-1.214,0.776-2.455,7.25-3.127,10.758c-1.416,7.385-2.533,13.217-6.073,13.217   c-3.539,0-4.657-5.833-6.072-13.218c-0.685-3.572-1.958-10.22-3.192-10.794l0.067-2.988c3.539,0,4.656,5.833,6.071,13.217   c0.672,3.507,1.913,9.98,3.125,10.758c1.213-0.777,2.454-7.25,3.126-10.757c1.416-7.385,2.533-13.218,6.073-13.218   c3.539,0,4.657,5.833,6.072,13.218c0.672,3.507,1.912,9.98,3.125,10.757c1.214-0.774,2.456-7.25,3.128-10.758   c1.416-7.385,2.534-13.217,6.075-13.217s4.659,5.833,6.075,13.218c0.685,3.572,1.96,10.222,3.195,10.794L-430.636-58.068z\"></path></g>\r\n    <rect x=\"-362.191\" y=\"157.027\" width=\"6.333\" height=\"19.085\"></rect>\r\n    <rect x=\"-351.913\" y=\"143.362\" width=\"6.333\" height=\"32.75\"></rect>\r\n    <rect x=\"-341.635\" y=\"130.112\" width=\"6.333\" height=\"46\"></rect>\r\n    <rect x=\"-331.358\" y=\"148.708\" width=\"6.333\" height=\"27.404\"></rect>\r\n    <rect x=\"-321.08\" y=\"137.942\" width=\"6.333\" height=\"38.17\"></rect>\r\n    <rect x=\"-310.802\" y=\"162.41\" width=\"6.333\" height=\"13.702\"></rect>\r\n    <rect x=\"-300.524\" y=\"157.027\" width=\"6.333\" height=\"19.085\"></rect>\r\n    <g><path d=\"M-1020.055-86.386c5.171-3.442,11.794-3.932,17.395-1.429l-2.85,3.21l11.721,2.405l-3.776-11.353l-3.014,3.395   c-6.704-3.368-14.845-2.916-21.14,1.276c-8.138,5.419-11.494,15.964-7.979,25.074l2.799-1.08   C-1029.911-72.698-1027.033-81.739-1020.055-86.386z\"></path>\r\n      <path\r\n        d=\"M-989.966-78.352l-2.799,1.08c3.013,7.809,0.135,16.85-6.844,21.497c-5.17,3.442-11.793,3.932-17.395,1.429l2.85-3.21   l-11.721-2.405l3.776,11.353l3.015-3.396c2.968,1.491,6.217,2.235,9.465,2.235c4.085,0,8.167-1.175,11.673-3.51   C-989.808-58.697-986.452-69.242-989.966-78.352z\"></path></g>\r\n    <g><path d=\"M50,19.827c-16.637,0-30.173,13.536-30.173,30.173c0,16.638,13.536,30.173,30.173,30.173S80.173,66.638,80.173,50   C80.173,33.363,66.637,19.827,50,19.827z M50,77.173c-14.983,0-27.173-12.189-27.173-27.173S35.017,22.827,50,22.827   S77.173,35.017,77.173,50S64.983,77.173,50,77.173z\"></path>\r\n      <path\r\n        d=\"M55.5,26.818v5.349h-11v-5.349C33.993,29.301,26.172,38.734,26.172,50c0,13.16,10.668,23.828,23.828,23.828   c13.16,0,23.828-10.668,23.828-23.828C73.827,38.734,66.007,29.301,55.5,26.818z M33.484,51.93l-0.266,0.128l-3.912,1.875   l-1.035-2.16l3.912-1.875l0.266-0.128l0.017-0.295c0.064-1.111,0.716-2.095,1.703-2.567c0.407-0.195,0.84-0.294,1.287-0.294   c0.628,0,1.261,0.204,1.781,0.575l0.24,0.171l0.266-0.128l3.912-1.875l1.035,2.159l-3.912,1.875l-0.266,0.128l-0.017,0.295   c-0.064,1.111-0.716,2.095-1.703,2.567c-0.407,0.195-0.84,0.294-1.287,0.294c-0.628,0-1.261-0.204-1.781-0.575L33.484,51.93z    M42.769,57.906c0.435,1.024,0.286,2.195-0.389,3.056c-0.572,0.729-1.438,1.147-2.377,1.147c-0.166,0-0.334-0.013-0.498-0.04   l-0.291-0.047l-0.182,0.232l-2.677,3.414l-1.885-1.477l2.677-3.414l0.182-0.232l-0.115-0.272c-0.435-1.024-0.286-2.195,0.389-3.056   c0.572-0.729,1.438-1.147,2.377-1.147c0.166,0,0.334,0.013,0.498,0.04l0.291,0.047l0.182-0.232l2.677-3.414l1.885,1.478   l-2.677,3.414l-0.182,0.232L42.769,57.906z M51.456,66.597l-0.258,0.143v0.295v4.338h-2.395v-4.338V66.74l-0.258-0.143   c-0.974-0.538-1.579-1.551-1.579-2.645c0-1.094,0.605-2.107,1.579-2.645l0.258-0.143v-0.295v-4.338h2.395v4.338v0.295l0.258,0.143   c0.974,0.538,1.579,1.551,1.579,2.645C53.035,65.046,52.43,66.059,51.456,66.597z M63.645,65.669l-2.677-3.414l-0.182-0.232   l-0.291,0.047c-0.164,0.027-0.332,0.04-0.498,0.04c-0.939,0-1.805-0.418-2.377-1.147c-0.675-0.861-0.824-2.032-0.389-3.056   l0.115-0.272l-0.182-0.232l-2.677-3.414l1.885-1.478l2.677,3.414l0.182,0.232l0.291-0.047c0.164-0.027,0.332-0.04,0.498-0.04   c0.939,0,1.805,0.418,2.377,1.147c0.675,0.861,0.824,2.032,0.389,3.056l-0.115,0.272l0.182,0.232l2.677,3.414L63.645,65.669z    M66.782,52.057l-0.266-0.128l-0.24,0.171c-0.52,0.371-1.152,0.575-1.781,0.575c-0.447,0-0.88-0.099-1.287-0.294   c-0.986-0.473-1.639-1.456-1.703-2.567l-0.017-0.295l-0.266-0.128l-3.912-1.875l1.035-2.159l3.912,1.875l0.266,0.128l0.24-0.171   c0.52-0.371,1.152-0.575,1.781-0.575c0.447,0,0.88,0.099,1.287,0.294c0.986,0.473,1.639,1.456,1.703,2.567l0.017,0.295l0.266,0.128   l3.912,1.875l-1.035,2.16L66.782,52.057z\"></path></g>\r\n    <g><polygon points=\"-345.613,-58.068 -356.915,-58.068 -356.915,-82.068 -362.191,-82.068 -362.191,-85.068 -353.915,-85.068    -353.915,-61.068 -348.613,-61.068 -348.613,-85.068 -337.481,-85.068 -337.481,-61.568 -331.671,-61.568 -331.671,-85.068    -320.54,-85.068 -320.54,-61.568 -315.941,-61.568 -315.941,-58.568 -323.54,-58.568 -323.54,-82.068 -328.671,-82.068    -328.671,-58.568 -340.481,-58.568 -340.481,-82.068 -345.613,-82.068  \"></polygon></g>\r\n    <g><path d=\"M-833.962-52.234c-5.517,0-9.726-3.466-12.172-10.023c-1.184-3.173-1.672-6.312-1.867-8.073h-20.625   c-3.009,0-5.553-1.053-7.562-3.13c-3.986-4.12-4.713-11.205-4.832-14.381c-19.44,1.561-19.67,33.775-19.67,34.108h-3   c0-0.372,0.276-37.167,24.154-37.167h1.548l-0.049,1.549c-0.003,0.093-0.247,9.417,4.009,13.81   c1.442,1.488,3.209,2.212,5.402,2.212h23.431l0.068,1.43c0.008,0.167,0.915,16.667,11.165,16.667V-52.234z\"></path></g>\r\n    <g><path d=\"M-748.533-54.65l-0.377,1.964c0.697,0.134,1.431,0.202,2.179,0.202v-2C-747.354-54.484-747.96-54.54-748.533-54.65z\"></path>\r\n      <path\r\n        d=\"M-759.411-65.35c0.36,1.435,0.8,2.782,1.306,4.004l1.848-0.766c-0.469-1.131-0.877-2.385-1.214-3.726L-759.411-65.35z\"></path>\r\n      <path\r\n        d=\"M-754.437-58.729l-1.637,1.148c0.899,1.282,1.929,2.339,3.06,3.142l1.157-1.631   C-752.8-56.74-753.668-57.635-754.437-58.729z\"></path>\r\n      <path\r\n        d=\"M-758.395-71.627l-0.045-0.953h-2.954v2h1.076c0.03,0.31,0.072,0.686,0.128,1.117l1.983-0.26   C-758.358-70.879-758.395-71.62-758.395-71.627z\"></path>\r\n      <path\r\n        d=\"M-788.615-76.882l-1.721,1.019c0.741,1.252,1.62,2.299,2.612,3.112l1.268-1.547   C-787.268-74.963-787.994-75.833-788.615-76.882z\"></path>\r\n      <path\r\n        d=\"M-790.868-83.585l-1.972,0.333c0.227,1.344,0.532,2.613,0.908,3.774l1.902-0.616   C-790.375-81.163-790.658-82.337-790.868-83.585z\"></path>\r\n      <path\r\n        d=\"M-783.542-72.833l-0.485,1.94c0.828,0.207,1.713,0.312,2.632,0.312h1.319v-2h-1.319   C-782.15-72.581-782.873-72.666-783.542-72.833z\"></path>\r\n      <rect x=\"-776.339\" y=\"-72.581\" width=\"3.736\" height=\"2\"></rect>\r\n      <rect x=\"-768.867\" y=\"-72.581\" width=\"3.736\" height=\"2\"></rect>\r\n      <path\r\n        d=\"M-791.267-87.625c-0.062-1.158,0-3.018,0-3.026l-1.039,0.012v-0.012c-0.106,0-0.203,0.014-0.308,0.015l-0.697,0.008   c0,0.001,0,0.02-0.001,0.026c-22.863,1.035-23.149,36.751-23.149,37.118h3c0-0.339,0.249-33.586,20.647-34.141H-791.267z\"></path></g>\r\n    <g><path d=\"M-721.096-82.177l1.613,1.182c0.758-1.036,1.579-1.977,2.438-2.796l-1.38-1.447   C-719.369-84.338-720.268-83.308-721.096-82.177z\"></path>\r\n      <path\r\n        d=\"M-715.179-87.743l1.04,1.708c1.044-0.636,2.16-1.15,3.315-1.528l-0.621-1.901   C-712.746-89.038-714.003-88.459-715.179-87.743z\"></path>\r\n      <path\r\n        d=\"M-727.277-67.536l1.949,0.447c0.293-1.275,0.625-2.52,0.985-3.698l-1.912-0.586   C-726.629-70.148-726.974-68.857-727.277-67.536z\"></path>\r\n      <path\r\n        d=\"M-728.584-59.73l1.988,0.22c0.142-1.284,0.318-2.566,0.525-3.811l-1.973-0.328   C-728.256-62.369-728.438-61.05-728.584-59.73z\"></path>\r\n      <path\r\n        d=\"M-724.929-75.13l1.854,0.749c0.492-1.216,1.03-2.372,1.601-3.434l-1.762-0.946   C-723.841-77.635-724.411-76.413-724.929-75.13z\"></path>\r\n      <path\r\n        d=\"M-728.978-53.734h2c0-0.015,0.001-0.728,0.066-1.941l-1.997-0.106C-728.979-54.488-728.978-53.734-728.978-53.734z\"></path>\r\n      <path\r\n        d=\"M-661.552-54.899l-0.377,1.964c0.698,0.134,1.432,0.202,2.18,0.202v-2C-660.371-54.734-660.979-54.789-661.552-54.899z\"></path>\r\n      <path\r\n        d=\"M-667.455-58.978l-1.637,1.149c0.9,1.282,1.931,2.339,3.06,3.141l1.158-1.631   C-665.818-56.989-666.686-57.884-667.455-58.978z\"></path>\r\n      <path\r\n        d=\"M-672.43-65.599c0.361,1.438,0.801,2.784,1.306,4.003l1.848-0.765c-0.468-1.129-0.876-2.383-1.214-3.727L-672.43-65.599z\"></path>\r\n      <path\r\n        d=\"M-671.413-71.876l-0.045-0.954h-2.954v2h1.075c0.03,0.31,0.072,0.687,0.129,1.118l1.982-0.261   C-671.377-71.128-671.413-71.869-671.413-71.876z\"></path>\r\n      <rect x=\"-688.814\" y=\"-72.83\" width=\"3.601\" height=\"2\"></rect>\r\n      <rect x=\"-681.614\" y=\"-72.83\" width=\"3.601\" height=\"2\"></rect>\r\n      <path\r\n        d=\"M-699.816-75.542c-4.256-4.393-4.183-14.765-4.18-14.858l-1.329,0.025V-90.4c-0.709,0-0.824-0.014-1.506,0.053   c-0.015,0.434-0.286,11.574,4.854,16.887c2.01,2.077,5.668,3.13,9.562,3.13v-0.5v-2v-0.31   C-695.558-72.83-698.374-74.054-699.816-75.542z\"></path></g>\r\n    <g><path d=\"M-614.292-76.95l-1.703,1.05c0.783,1.27,1.712,2.318,2.76,3.116l1.211-1.592C-612.876-75.023-613.638-75.89-614.292-76.95z   \"></path>\r\n      <path\r\n        d=\"M-616.647-83.773l-1.971,0.339c0.236,1.378,0.555,2.675,0.946,3.854l1.898-0.63   C-616.133-81.294-616.427-82.493-616.647-83.773z\"></path>\r\n      <path\r\n        d=\"M-617.094-89.369l0.033-1.032h-1.032c-0.709,0-1.414,0.034-2.096,0.101l0.195,1.99c0.297-0.029,0.598-0.051,0.902-0.066   c0.007,0.292,0.019,0.637,0.039,1.026l1.998-0.106C-617.117-88.615-617.094-89.361-617.094-89.369z\"></path>\r\n      <path\r\n        d=\"M-627.948-87.743l1.041,1.708c1.043-0.636,2.158-1.15,3.314-1.528l-0.621-1.901   C-625.517-89.038-626.773-88.459-627.948-87.743z\"></path>\r\n      <path\r\n        d=\"M-633.865-82.177l1.613,1.182c0.758-1.035,1.578-1.976,2.439-2.796l-1.381-1.447   C-632.138-84.337-633.038-83.307-633.865-82.177z\"></path>\r\n      <path\r\n        d=\"M-637.699-75.13l1.855,0.748c0.488-1.21,1.026-2.366,1.6-3.434l-1.762-0.946C-636.613-77.63-637.183-76.408-637.699-75.13z   \"></path>\r\n      <path\r\n        d=\"M-641.354-59.732l1.988,0.222c0.144-1.292,0.32-2.574,0.526-3.811l-1.973-0.328   C-641.024-62.377-641.206-61.059-641.354-59.732z\"></path>\r\n      <path\r\n        d=\"M-640.045-67.536l1.949,0.447c0.291-1.271,0.623-2.516,0.984-3.699l-1.912-0.585   C-639.399-70.144-639.743-68.853-640.045-67.536z\"></path>\r\n      <path\r\n        d=\"M-641.747-53.734h2c0-0.014,0.001-0.728,0.065-1.942l-1.998-0.105C-641.747-54.489-641.747-53.734-641.747-53.734z\"></path>\r\n      <path\r\n        d=\"M-574.321-54.9l-0.377,1.964c0.698,0.134,1.432,0.202,2.18,0.202v-2C-573.14-54.734-573.748-54.79-574.321-54.9z\"></path>\r\n      <path\r\n        d=\"M-580.224-58.979l-1.637,1.149c0.9,1.282,1.931,2.339,3.06,3.141l1.158-1.631   C-578.587-56.989-579.455-57.884-580.224-58.979z\"></path>\r\n      <path\r\n        d=\"M-585.199-65.6c0.361,1.438,0.801,2.784,1.306,4.003l1.848-0.765c-0.468-1.129-0.876-2.383-1.214-3.727L-585.199-65.6z\"></path>\r\n      <path\r\n        d=\"M-584.04-70.331c-0.151-1.155-0.225-2.993-0.225-3h-0.917h-1.002h-22.769l-0.562,3h23.462h0.871H-584.04z\"></path></g>\r\n    <g><path d=\"M-527.172-77.383l-1.721,1.021c0.743,1.253,1.622,2.3,2.613,3.111l1.268-1.547   C-525.821-75.462-526.549-76.332-527.172-77.383z\"></path>\r\n      <path\r\n        d=\"M-522.096-73.333l-0.486,1.94c0.828,0.207,1.713,0.312,2.631,0.312h1.32v-2h-1.32   C-520.707-73.081-521.428-73.166-522.096-73.333z\"></path>\r\n      <path\r\n        d=\"M-529.425-84.085l-1.973,0.335c0.229,1.349,0.535,2.618,0.909,3.773l1.902-0.616   C-528.929-81.657-529.212-82.832-529.425-84.085z\"></path>\r\n      <rect x=\"-507.423\" y=\"-73.081\" width=\"3.736\" height=\"2\"></rect>\r\n      <rect x=\"-514.895\" y=\"-73.081\" width=\"3.736\" height=\"2\"></rect>\r\n      <path\r\n        d=\"M-529.863-89.619l0.033-1.032h-1.032c-0.709,0-1.414,0.034-2.096,0.101l0.195,1.99c0.297-0.029,0.598-0.051,0.902-0.066   c0.007,0.292,0.019,0.637,0.039,1.026l1.998-0.106C-529.885-88.865-529.863-89.611-529.863-89.619z\"></path>\r\n      <path\r\n        d=\"M-552.813-67.786l1.949,0.447c0.291-1.271,0.623-2.516,0.984-3.699l-1.912-0.585   C-552.168-70.394-552.511-69.103-552.813-67.786z\"></path>\r\n      <path\r\n        d=\"M-554.123-59.982l1.988,0.222c0.144-1.292,0.32-2.574,0.526-3.811l-1.973-0.328   C-553.793-62.627-553.974-61.309-554.123-59.982z\"></path>\r\n      <path\r\n        d=\"M-550.468-75.38l1.855,0.748c0.488-1.21,1.026-2.366,1.6-3.434l-1.762-0.946C-549.382-77.88-549.952-76.658-550.468-75.38z   \"></path>\r\n      <path\r\n        d=\"M-546.634-82.427l1.613,1.182c0.758-1.035,1.578-1.976,2.439-2.796l-1.381-1.447   C-544.907-84.587-545.806-83.557-546.634-82.427z\"></path>\r\n      <path\r\n        d=\"M-540.717-87.993l1.041,1.708c1.043-0.636,2.158-1.15,3.314-1.528l-0.621-1.901   C-538.286-89.288-539.542-88.709-540.717-87.993z\"></path>\r\n      <path\r\n        d=\"M-554.515-53.984h2c0-0.014,0.001-0.728,0.065-1.942l-1.998-0.105C-554.515-54.739-554.515-53.984-554.515-53.984z\"></path>\r\n      <path\r\n        d=\"M-496.512-73.081h-1.438h-1h-0.498c0.009,0.194,0.24,5.882,1.989,10.572c2.446,6.558,6.655,10.024,12.172,10.024v-3   C-495.845-55.432-496.504-72.914-496.512-73.081z\"></path></g>\r\n    <g><path d=\"M-941.887-94.26l2.223,3.85c7.844,3.119,13.411,10.771,13.411,19.712c0,11.701-9.52,21.221-21.22,21.221   s-21.22-9.52-21.22-21.221c0-8.942,5.567-16.593,13.411-19.712l2.223-3.85c-10.67,2.53-18.634,12.131-18.634,23.563   c0,13.355,10.865,24.221,24.22,24.221s24.22-10.865,24.22-24.221C-923.253-82.13-931.218-91.731-941.887-94.26z\"></path>\r\n      <path\r\n        d=\"M-965.002-70.698c0,9.681,7.848,17.529,17.529,17.529s17.529-7.848,17.529-17.529c0-7.462-4.67-13.817-11.24-16.347   l-6.288-10.892l-6.288,10.892C-960.332-84.515-965.002-78.159-965.002-70.698z M-934.914-70.698c0,6.937-5.623,12.56-12.56,12.56   s-12.56-5.623-12.56-12.56c0-6.937,5.623-12.56,12.56-12.56S-934.914-77.634-934.914-70.698z\"></path></g>\r\n    <g><path d=\"M-1097.062-64.348c-0.013,0-0.025-0.004-0.038-0.004v18.079h2v-18.078c-0.013,0-0.025,0.003-0.038,0.003H-1097.062z\"></path>\r\n      <path\r\n        d=\"M-1095.138-84.861c0.013,0,0.025,0.004,0.038,0.004v-7.331h-2v7.331c0.013,0,0.025-0.004,0.038-0.004H-1095.138z\"></path>\r\n      <path\r\n        d=\"M-1083.638-73.861c0.013,0,0.025,0.003,0.038,0.003v-18.33h-2v18.33c0.013,0,0.025-0.003,0.038-0.003H-1083.638z\"></path>\r\n      <path\r\n        d=\"M-1085.562-53.348c-0.013,0-0.025-0.004-0.038-0.004v7.079h2v-7.079c-0.013,0-0.025,0.004-0.038,0.004H-1085.562z\"></path>\r\n      <path\r\n        d=\"M-1074.062-60.348c-0.013,0-0.025-0.003-0.038-0.003v14.078h2v-14.078c-0.013,0-0.025,0.003-0.038,0.003H-1074.062z\"></path>\r\n      <path\r\n        d=\"M-1072.138-80.861c0.013,0,0.025,0.004,0.038,0.004v-11.331h-2v11.331c0.013,0,0.025-0.004,0.038-0.004H-1072.138z\"></path>\r\n      <path\r\n        d=\"M-1062.562-56.348c-0.013,0-0.025-0.004-0.038-0.004v10.079h2v-10.079c-0.013,0-0.025,0.004-0.038,0.004H-1062.562z\"></path>\r\n      <path\r\n        d=\"M-1060.638-76.861c0.013,0,0.025,0.003,0.038,0.003v-15.33h-2v15.33c0.013,0,0.025-0.003,0.038-0.003H-1060.638z\"></path>\r\n      <path\r\n        d=\"M-1049.138-79.487c0.013,0,0.025,0.004,0.038,0.004v-12.705h-2v12.705c0.013,0,0.025-0.004,0.038-0.004H-1049.138z\"></path>\r\n      <path\r\n        d=\"M-1051.062-58.974c-0.013,0-0.025-0.003-0.038-0.003v12.704h2v-12.705c-0.013,0-0.025,0.004-0.038,0.004H-1051.062z\"></path>\r\n      <path\r\n        d=\"M-1095.1-81.857L-1095.1-81.857c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1093.174-80.967-1094.035-81.836-1095.1-81.857   z\"></path>\r\n      <path\r\n        d=\"M-1083.6-70.857L-1083.6-70.857c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1081.674-69.967-1082.535-70.836-1083.6-70.857   z\"></path>\r\n      <path\r\n        d=\"M-1072.1-77.857L-1072.1-77.857c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1070.174-76.967-1071.035-77.836-1072.1-77.857   z\"></path>\r\n      <path\r\n        d=\"M-1060.6-73.857L-1060.6-73.857c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1058.674-72.967-1059.535-73.836-1060.6-73.857   z\"></path>\r\n      <path\r\n        d=\"M-1049.1-76.483L-1049.1-76.483c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1047.174-75.593-1048.035-76.462-1049.1-76.483   z\"></path></g>\r\n  </svg>\r\n)\r\n\r\nexport default MidiIcon;\r\n","import _ from 'lodash';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport React, {useEffect} from 'react';\r\nimport MidiIcon from './icons/midiIcon';\r\nimport useMidi from './useMidi';\r\nimport {WebMidi} from 'webmidi';\r\nimport {IconButton, Toolbar} from \"@material-ui/core\";\r\nimport {WatchLater as MidiClockIcon} from '@material-ui/icons';\r\n\r\nconst Midi = () => {\r\n\r\n  const [state, actions] = useMidi( // https://github.com/andregardi/use-global-hook#avoid-unnecessary-renders\r\n    ({\r\n      inputDevices,\r\n      isMidiClockInSelectorOpen,\r\n      isMidiInSelectorOpen,\r\n      midiInDevice,\r\n      outputDevices,\r\n    }) => ({\r\n      inputDevices,\r\n      isMidiClockInSelectorOpen,\r\n      isMidiInSelectorOpen,\r\n      midiInDevice,\r\n      outputDevices,\r\n    }),\r\n    actions => actions,\r\n  );\r\n\r\n  const {\r\n    inputDevices,\r\n    isMidiClockInSelectorOpen,\r\n    isMidiInSelectorOpen,\r\n    midiInDevice,\r\n    outputDevices,\r\n  } = state;\r\n\r\n  useEffect(() => {\r\n    WebMidi.enable((err) => {\r\n      if (err) console.error(err);\r\n      else {\r\n        console.log('WebMidi enabled.');\r\n        actions.setInputDevices(WebMidi.inputs);\r\n        actions.setOutputDevices(WebMidi.outputs);\r\n      }\r\n    }, true);\r\n  }, []);\r\n\r\n\r\n  const handleMidi = (evt) => {\r\n    const {note: {number: n}, rawVelocity: vel, type} = evt;\r\n    // console.log(evt)\r\n    // actions.setMidiEvent({\r\n    //   [n]: type === 'noteon' ? vel : 0\r\n    // });\r\n  }\r\n\r\n  const handleMidiClock = (evt) => {\r\n\r\n    // console.log(evt)\r\n    // actions.setMidiEvent({\r\n    //   [n]: type === 'noteon' ? vel : 0\r\n    // });\r\n  }\r\n\r\n\r\n  const [midiMenuAnchorEl, setMidiMenuAnchorEl] = React.useState(null);\r\n\r\n  const handleMidiMenuButtonClick = (isBeatClock = false) => ({ currentTarget }) => {\r\n    setMidiMenuAnchorEl(currentTarget);\r\n    actions[isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector']();\r\n  }\r\n\r\n  const handleMidiMenuClose = (isBeatClock = false) => () => {\r\n    console.log('close', isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector')\r\n    actions[isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector']();\r\n    setMidiMenuAnchorEl(null);\r\n  }\r\n\r\n  const handleMidiInputSelect = (deviceIdx, isBeatClock = false) => ({ currentTarget }) => { // todo: remove prev listener\r\n    setMidiMenuAnchorEl(currentTarget);\r\n\r\n    const midiInDevice = inputDevices[deviceIdx];\r\n    actions[isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector']();\r\n    if (isBeatClock) {\r\n      midiInDevice.addListener('clock', 'all', handleMidiClock);\r\n      actions.setMidiClockInDevice(midiInDevice);\r\n    } else {\r\n      actions.setMidiInDevice(midiInDevice);\r\n      midiInDevice.addListener('noteon', 'all', handleMidi);\r\n      midiInDevice.addListener('noteoff', 'all', handleMidi);\r\n    }\r\n\r\n  };\r\n\r\n  return ( // TODO: only show if MIDI devices present; use looser permission to query\r\n    <>\r\n      <IconButton\r\n        edge=\"start\"\r\n        color=\"inherit\"\r\n        aria-label=\"open drawer\"\r\n        onClick={handleMidiMenuButtonClick(false)}\r\n      >\r\n        <MidiIcon/>\r\n      </IconButton>\r\n\r\n      <IconButton\r\n        edge=\"start\"\r\n        color=\"inherit\"\r\n        aria-label=\"open drawer\"\r\n        onClick={handleMidiMenuButtonClick(true)}\r\n      >\r\n        <MidiClockIcon/>\r\n      </IconButton>\r\n\r\n      <Menu\r\n        id=\"simple-menu\"\r\n        anchorEl={midiMenuAnchorEl}\r\n        open={isMidiInSelectorOpen || isMidiClockInSelectorOpen}\r\n        onClose={handleMidiMenuClose(isMidiClockInSelectorOpen)}\r\n      >\r\n        {inputDevices.map(({name}, idx) => (\r\n          <MenuItem\r\n            key={name}\r\n            onClick={handleMidiInputSelect(idx, isMidiClockInSelectorOpen)}\r\n            selected={isMidiInSelectorOpen && name === _.get(midiInDevice, 'name')}\r\n          >\r\n            {name}\r\n          </MenuItem>\r\n        ))}\r\n      </Menu>\r\n    </>\r\n\r\n  );\r\n};\r\n\r\nexport default Midi;\r\n","import _ from 'lodash';\r\n\r\n\r\n\r\nexport const initialState = {\r\n  decayDuration: 5000,\r\n  exciteEnergy: 0.05,\r\n  exciteDuration: 1000,\r\n  fundamentalFreq: 200,\r\n  hilbertN: 64, // hilbertN must be power of 2 in order to be square\r\n  hilbMand: [/*{ x, y, m }*/], // coordinates and associated mandelbrot val in hilbert traversal order\r\n  isControlPanelOpen: true,\r\n  isPlaying: false,\r\n  isRegenNeeded: true,\r\n  maxIters: 4096, // max number of steps to recurse the mandelbrot fn\r\n  midiClock: 0,\r\n  midiClocksPerTick: 24,\r\n  panX: -0.05,\r\n  panY: 0,\r\n  partials: {/* partial: { amp, oscIdx } */}, // the collection is updated in setState but values within are changed in drawLoop directly\r\n  partialsCountMax: 16,\r\n  isSmooth: false, // smooth technique https://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n  tick: 0, // updated in draw() bypasses setState\r\n  tickDuration: 100,\r\n  tickLastMillis: 0, // updated in draw() bypasses setState\r\n  zoom: 1.2,\r\n\r\n  // zoom: 3603.7157567397, panX: 0.18580280974577668, panY: 0.00036930706052212803,\r\n\r\n  // floating point errors here\r\n  // zoom: 279919582741326.66, panX: -0.014853203736137617, panY: 0.13451319076043783,\r\n\r\n  // panX: 0.0011548427778035686,\r\n  // panY: 0.025033026937542575,\r\n  // zoom: 319852972190.0951,\r\n  //\r\n  // panX: -0.18498767183730766,\r\n  // panY: 0.4722205531430409,\r\n  // zoom: 419013953.31772846,\r\n  //\r\n  //\r\n  // decay: 0.000075,\r\n  // exciteEnergy: 0.006,\r\n  // fundamentalFreq: 10,\r\n  // hilbertN: 256,\r\n  // maxIters: 4096,\r\n  // panX: 0.0011503007796323155,\r\n  // panY: 0.025033026938902938,\r\n  // tickDuration: 10,\r\n  // zoom: 836635.9887997985,\r\n  //\r\n  //\r\n  //\r\n  // panX: 0.08871194014553094,\r\n  // panY: -0.12829271146701177,\r\n  // zoom: 19736096.460687958,\r\n\r\n  // ...{zoom: 39422433.84662852, panX: 0.04670942760989286, panY: 0.13656218122372943},\r\n\r\n  // demo for 10 partials\r\n  // ...{zoom: 12371177.464729108, panX: 0.04671008941233588, panY: 0.13656133340058238},\r\n};\r\n\r\nlet audioCtx = new AudioContext();\r\nlet oscs = [];\r\n\r\nconst masterGain = audioCtx.createGain();\r\nwindow.masterGain = masterGain;\r\nmasterGain.gain.value = 1;\r\nmasterGain.connect(audioCtx.destination);\r\n\r\n\r\nexport const sketch = (p5) => {\r\n  p5.state = initialState;\r\n\r\n  const setupOscillators = () => {\r\n    oscs.forEach(({osc, gain}) =>\r\n    {\r\n      osc.stop();\r\n    }); // TODO: gain.disconnect?\r\n\r\n    oscs = _.range(p5.state.partialsCountMax).map(() => {\r\n      const osc = audioCtx.createOscillator();\r\n      const gain = audioCtx.createGain();\r\n      gain.gain.value = 0;\r\n      osc.connect(gain);\r\n      gain.connect(masterGain);\r\n      osc.start();\r\n      return {osc, gain};\r\n    });\r\n\r\n    window.oscs = oscs;\r\n  }\r\n\r\n  let font;\r\n  p5.preload = () => {\r\n    font = p5.loadFont('JetBrainsMono-Regular.ttf');\r\n  }\r\n\r\n\r\n  const TWO_PI = Math.PI * 2;\r\n\r\n  let h, w;\r\n\r\n  let d, n, n2 = 0;\r\n\r\n  [n, d] = [2, 1];\r\n\r\n  p5.setup = () => {\r\n    p5.createCanvas(p5._width, p5._height);\r\n    p5.blendMode(p5.ADD);\r\n    p5.colorMode(p5.HSB, 255);\r\n    p5.textFont(font);\r\n  }\r\n\r\n  let input = [];\r\n  p5.keyTyped = () => {\r\n    console.log(p5.key)\r\n    // if (key === ':') {\r\n    //   value = 255;\r\n    // } else if (key === 'b') {\r\n    //   value = 0;\r\n    // }\r\n    // uncomment to prevent any default behavior\r\n    if (p5.key === 'Enter') {\r\n\r\n      const obj = input.join('').split(':').map(s => parseInt(s, 10));\r\n\r\n      n2 = 0;\r\n      [d, n, n2] = obj;\r\n      if (!n2) {\r\n        [n, d] = obj;\r\n        n2 = 0;\r\n      }\r\n      console.log(d, n, n2)\r\n      console.log(w, h)\r\n\r\n      input = [];\r\n    } else {\r\n      input.push(p5.key);\r\n    }\r\n\r\n\r\n\r\n    return false;\r\n  }\r\n\r\n  let phase = 0;\r\n  let x1 = 0;\r\n  let y1 = 0;\r\n  let r;\r\n  const rayCount = 500;\r\n\r\n  const drawWave = ({ freq, phase = 0, hue }) => {\r\n    const dt = TWO_PI / rayCount;\r\n    p5.push();\r\n    p5.translate(w/2, h/2);\r\n    for(let t = 0; t < TWO_PI - dt; t += dt) {\r\n      p5.stroke(\r\n        hue,\r\n        255,\r\n        freq && (50 + 50 * Math.sin(t * freq)),\r\n        100,\r\n      );\r\n\r\n      r = w + h;\r\n      x1 = r * Math.sin(t + phase);\r\n      y1 = r * Math.cos(t + phase);\r\n\r\n      p5.line(0, 0, x1, y1);\r\n    }\r\n    p5.pop();\r\n  };\r\n\r\n\r\n  p5.draw = () => {\r\n    p5.clear();\r\n    p5.background(0, 0, 0);\r\n    h = p5.height;\r\n    w = p5.width;\r\n\r\n\r\n    phase = p5.millis() * (0.001/d);\r\n\r\n    drawWave({\r\n      freq: d,\r\n      hue: 0,\r\n      phase,\r\n    });\r\n\r\n    drawWave({\r\n      freq: d * n / d,\r\n      hue: 90,\r\n      phase: phase * 2,\r\n    });\r\n\r\n    drawWave({\r\n      freq: d * n2 / n,\r\n      hue: 180,\r\n      phase: phase * 3,\r\n    });\r\n\r\n\r\n\r\n\r\n\r\n    p5.blendMode(p5.BLEND);\r\n    p5.fill(255);\r\n    p5.stroke(0);\r\n    p5.strokeWeight(4);\r\n    p5.textAlign(p5.CENTER, p5.CENTER);\r\n    p5.textSize(h/15)\r\n    p5.text(n2 ? `${d}:${n}:${n2}` : `${n}:${d}`, w/2, h/2)\r\n    p5.blendMode(p5.ADD);\r\n  }\r\n\r\n  /**\r\n   * This needs to be called by a user event handler.\r\n   * @param isPlaying\r\n   */\r\n  p5.toggleAudio = () => {\r\n    p5.setState(prevState => {\r\n      const { isPlaying } = prevState;\r\n      if (!isPlaying && audioCtx.state !== 'running') {\r\n        audioCtx.resume();\r\n      }\r\n\r\n      if (isPlaying && audioCtx.state === 'running') {\r\n        audioCtx.suspend();\r\n      }\r\n\r\n      return { ...prevState, isPlaying: !prevState.isPlaying };\r\n    });\r\n\r\n  }\r\n}\r\n","import React, {useEffect} from 'react';\r\nimport useP5 from './useP5';\r\nimport {initialState, sketch} from \"./ratioLightshipP5\";\r\n\r\nconst RatioLightship = () => {\r\n  const {\r\n    ref,\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n  } = useP5(sketch, initialState);\r\n\r\n  window.sketchInstance = sketchInstance;\r\n\r\n  useEffect(() => {\r\n    document.title = 'Ratio Lightship';\r\n  }, [sketchInstance]);\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      style={{\r\n        alignSelf: 'start',\r\n        background: 'radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)',\r\n        height: '100vh',\r\n        width: '100vw',\r\n      }}\r\n    />);\r\n};\r\n\r\n\r\nexport default RatioLightship;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport {Entity} from 'aframe-react';\r\nimport {getNoteColorHex, HSVtoHex} from './color';\r\nimport {toSymbol} from \"./util\";\r\n\r\nconst handleOsc = n => (el) => {\r\n  if (el) {\r\n    const { components: { osc } } = el;\r\n    osc.onOsc = ({ instrument, note, vel }) => {\r\n      if (note === n) {\r\n        osc.vel = vel;\r\n      }\r\n    }\r\n\r\n    osc.onTick = (time, timeDelta) => {\r\n      if (osc.vel === 0) {\r\n\r\n      }\r\n\r\n      if (_.has(osc, 'vel')) {\r\n        el.setAttribute('material', 'opacity', 0.05 + 0.75 * osc.vel / 128);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport default ({\r\n  darkened = true,\r\n  n,\r\n  position = {x: 0, y: 0, z: 0},\r\n  scale = {x: 1, y: 1, z: 1}\r\n}) =>\r\n  <Entity\r\n    _ref={handleOsc(n)}\r\n    // animation={{\r\n    //   dur: 500,\r\n    //   property: 'position',\r\n    //   to: position,\r\n    // }}\r\n    material={{\r\n      blending: darkened ? 'normal' : 'additive',\r\n      color: darkened ? \"#000\" : getNoteColorHex(n),\r\n      opacity: darkened ? 0.5 : 0.1,\r\n    }}\r\n    osc={{\r\n\r\n    }}\r\n    position={position}\r\n    primitive='a-torus'\r\n    radius={0.1}\r\n    radius-tubular={0.003}\r\n    scale={scale}\r\n  >\r\n    <Entity\r\n      look-at=\"#camera\"\r\n      position={{x: 0, y: 0, z: 0}}\r\n      scale={{x: 2, y: 2, z: 2}}\r\n      text={{\r\n        align: 'center',\r\n        color: getNoteColorHex(n),\r\n        font: `../JetBrainsMono-Regular-msdf.json`,\r\n        negate: false,\r\n        transparent: true,\r\n        value: toSymbol(n),\r\n      }}\r\n    />\r\n  </Entity>\r\n","import _ from 'lodash';\r\nimport PitchClass from './pitchClass';\r\nimport React, {useEffect, useState} from 'react';\r\nimport useMidi from \"./useMidi\";\r\nimport {Entity} from 'aframe-react';\r\n\r\nconst ColtraneCircle = () => {\r\n  const [is180, setIs180] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const toggle = ({key}) => {\r\n      if (key === 'r') setIs180(is180 => !is180);\r\n    };\r\n\r\n    window.addEventListener('keyup', toggle);\r\n    return () => window.removeEventListener('keyup', toggle);\r\n  }, []);\r\n\r\n  const [{midiIn}] = useMidi();\r\n\r\n  const midiInPitchClasses = _(12)\r\n    .range()\r\n    .map(n => _(midiIn)\r\n      .pickBy((v, i) => i % 12 === n)\r\n      .values()\r\n      .sum())\r\n    .value();\r\n\r\n  return (// https://www.npmjs.com/package/aframe-animation-component\r\n    <Entity\r\n      animation={`property: rotation; to: 0 ${is180 ? 180 : 0} 0; dur: 500;`}\r\n      position={`0 0 -3`}\r\n    >\r\n      {_(12)\r\n        .range()\r\n        .filter(n => n % 2 == 0)\r\n        .map(n => ({\r\n          n,\r\n          r: 1.5,\r\n          x: -Math.sin(n * Math.PI / 6),\r\n          y: Math.cos(n * Math.PI / 6),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n          />))\r\n        .value()\r\n      }\r\n\r\n      {_(48)\r\n        .range()\r\n        .filter(n => !_.includes([6, 7, 0, 1], n % 8))\r\n        .map((n, i) => ({\r\n          i,\r\n          n: ((i + 1) * 2 + Math.floor(i / 4) * 2) % 12,\r\n          // n: (n * 2) % 12,\r\n          r: 1.5,\r\n          x: Math.sin((n + 0.5) * Math.PI / 24),\r\n          y: Math.cos((n + 0.5) * Math.PI / 24),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n            scale=\"0.5 0.5 0.5\"\r\n          />))\r\n        .value()\r\n      }\r\n\r\n      {_(12)\r\n        .range()\r\n        .filter(n => n % 2 != 0)\r\n        .map(n => ({\r\n          n: (n + 6) % 12,\r\n          r: 1.2,\r\n          x: -Math.sin(n * Math.PI / 6),\r\n          y: Math.cos(n * Math.PI / 6),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n          />))\r\n        .value()\r\n      }\r\n\r\n      {_(48)\r\n        .range()\r\n        .filter(n => !_.includes([4, 5, 6, 7], n % 8))\r\n        .map((n, i) => ({\r\n          i,\r\n          // n: i,\r\n          n: (i * 2 + 9 + Math.floor(i / 4) * 2) % 12,\r\n          // n: i,\r\n          r: 1.2,\r\n          x: Math.sin((n - 1.5) * Math.PI / 24),\r\n          y: Math.cos((n - 1.5) * Math.PI / 24),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n            scale=\"0.5 0.5 0.5\"\r\n          />))\r\n        .value()\r\n      }\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default ColtraneCircle;\r\n","import {Entity} from 'aframe-react';\r\nimport React from 'react';\r\nimport {HSVtoHex} from './color';\r\n\r\n// http://dmccooey.com/polyhedra/PentakisDodecahedron.txt\r\nconst c1 = 1.33058699733550141141687582919;\r\nconst c2 = 2.15293498667750705708437914596;\r\n\r\n// in ordered, opposite pairs\r\nconst verts = [\r\n  [0.0,  -c2,   c1],\r\n  [0.0,   c2,  -c1],\r\n  [ c2,  -c1,  0.0],\r\n  [-c2,   c1,  0.0],\r\n  [0.0,  -c2,  -c1],\r\n  [0.0,   c2,   c1],\r\n  [-c2,  -c1,  0.0],\r\n  [ c2,   c1,  0.0],\r\n  [-c1,  0.0,   c2],\r\n  [ c1,  0.0,  -c2],\r\n  [ c1,  0.0,   c2],\r\n  [-c1,  0.0,  -c2],\r\n];\r\n\r\nconst Dod = ({ rep = 1, sat, stack = [], n = 0 }) =>\r\n  <Entity position=\"0 0 0\">\r\n    {verts.map((v, i) =>\r\n      <Entity\r\n        key={i}\r\n        color={HSVtoHex(i * (1 / 12), sat || 1, 1)}\r\n        events={{ click: () => console.log(i) }}\r\n        primitive=\"a-sphere\"\r\n        position={v.join(' ')}\r\n        scale={[1, 1, 1].map(n => 0.3 * n/ (rep * rep)).join(' ')}\r\n      />)}\r\n\r\n    {rep < 3 && verts.map((v, i) =>\r\n      <Entity\r\n        key={i}\r\n        position={v.map(n => n * 2).join(' ')}\r\n        text={`color: ${HSVtoHex((stack.length ? stack[stack.length - 1] : i) * (1 / 12), 1, 1)}; align: center; value: ${[...stack, i].join(',')} - ${(n + i) % 12}; width: 5; zOffset: 0`}\r\n      >\r\n        <Dod rep={rep+1} sat={0.3} stack={[...stack, i]} n={(n + i) % 12} />\r\n      </Entity>)\r\n      // .filter((n, i) => i % 2)\r\n    }\r\n  </Entity>;\r\n\r\nexport default Dod;","// import * as Tone from 'tone'\r\nimport _ from 'lodash';\r\nimport PitchClass from './pitchClass';\r\nimport PitchDetector from 'pitchdetect';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport useMidiClock from \"./useMidiClock\";\r\nimport {Entity} from 'aframe-react';\r\nimport {HSVtoHex} from \"./color\";\r\n\r\nconst PitchClassCollections = ({}) => {\r\n\r\n  const spacing = 0.75;\r\n\r\n  const [collEl, setCollEl] = useState();\r\n  const collRef = useCallback(setCollEl, []);\r\n\r\n\r\n  const { reset } = useMidiClock(({ tick }) => {\r\n    if (tick % 24 === 0) console.log(tick);\r\n\r\n    if (collEl) {\r\n      collEl.object3D.position.set(0, 0, (tick / 96) * spacing);\r\n    }\r\n  });\r\n\r\n  window.reset = reset;\r\n\r\n  useEffect(() => {\r\n    const handleKeyup = ({code, key}) => {\r\n      // if (key === 'r') setIs180(is180 => !is180);\r\n      // if (code === 'Space') audioContext.resume();\r\n    };\r\n\r\n    window.addEventListener('keyup', handleKeyup);\r\n    return () => window.removeEventListener('keyup', handleKeyup);\r\n  }, []);\r\n\r\n  const colls = [[2, 5, 9], [7, 11, 2], [0, 4, 7]];\r\n\r\n  return (// https://www.npmjs.com/package/aframe-animation-component\r\n    <Entity\r\n      _ref={collRef}\r\n      position={{x: 0, y: 0, z: -2}}\r\n      scale={{x: 4, y: 4, z: 4}}\r\n    >\r\n      {\r\n        _.range(50)\r\n          .map(i => 50 - i)// draw order\r\n          .map(i => ({ coll: colls[i % colls.length], z: i * -spacing}))\r\n          .map(({coll, z}) => (\r\n            <React.Fragment key={z}>\r\n              <Entity\r\n                material={{\r\n                  // blending: 'subtractive',\r\n                  color: '#040404',\r\n                  opacity: 0.45,\r\n                }}\r\n                position={{ x: 0, y: 0, z: z - 0.01}}\r\n                rotation={{x: 90, y: 0, z: 0}}\r\n                primitive='a-cylinder'\r\n                scale={{ x: 1, y: 0.001, z: 1}}\r\n              />\r\n              {_.range(12)\r\n                .map(n => {\r\n                  const r = 0.25;\r\n                  const theta = n * (Math.PI * 2) / 12;\r\n\r\n                  return {\r\n                    n,\r\n                    x: r * Math.sin(theta),\r\n                    y: r * Math.cos(theta),\r\n                  };\r\n                })\r\n                .map(({n, s = 0.5, x, y}) => (\r\n                  <PitchClass\r\n                    darkened={!_.includes(coll, n)}\r\n                    key={n}\r\n                    n={n}\r\n                    position={{x, y, z}}\r\n                    scale={{x: s, y: s, z: s}}\r\n                  />))}\r\n            </React.Fragment>\r\n          ))\r\n      }\r\n\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default PitchClassCollections;\r\n","import _ from 'lodash';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport useMidi from './useMidi';\r\nimport usePrevious from './usePrevious';\r\nimport {Entity} from 'aframe-react';\r\nimport {getNoteColorHex, HSVtoHex} from './color';\r\n\r\nconst PcSpiralWindController = ({isNoteOffIgnored, noteToDimensions, notePoolSize = 10}) => {\r\n  const [noteEls, setNoteEls] = useState(Array(notePoolSize));\r\n\r\n  const [midiInEl, setMidiInEl] = useState();\r\n  const [{midiInDevice}] = useMidi();\r\n  const prevMidiInDevice = usePrevious(midiInDevice);\r\n\r\n\r\n  useEffect(() => {\r\n    const notePool = _.range(notePoolSize).map(() => null);\r\n    const getPoolKey = (n) => {\r\n      const ix = _.indexOf(notePool, n);\r\n      if (ix >= 0) return ix;\r\n\r\n      const ixEmpty = _.indexOf(notePool, null);\r\n      if (ixEmpty >= 0) {\r\n        notePool[ixEmpty] = n;\r\n        return ixEmpty;\r\n      }\r\n\r\n      return -1;\r\n    };\r\n\r\n    const getNoteElAndKey = (n) => {\r\n      const key = getPoolKey(n);\r\n      return key < 0 ? [null] : [noteEls[key], key];\r\n    };\r\n\r\n    let pitchBendAmount = 0;\r\n\r\n    const handleMidi = (evt) => {\r\n      // console.log(evt)\r\n      const {note: {number: n}, velocity: vel, type} = evt;\r\n      const [noteEl, poolKey] = getNoteElAndKey(n);\r\n      if (!noteEl) return;\r\n\r\n\r\n      if (type === 'noteon') {\r\n        const opacity = vel / (0.1 + vel);\r\n        const {s, x, y, z} = noteToDimensions(n + pitchBendAmount);\r\n        noteEl.setAttribute('material', 'opacity', opacity);\r\n\r\n        noteEl.note = n; // FIXME Hack\r\n        noteEl.object3D.position.set(x, y, z + 0.01);\r\n        noteEl.object3D.scale.set(s * 1.1, s * 1.1, s * 1.1);\r\n        noteEl.setAttribute('material', 'color', getNoteColorHex(n));\r\n      }\r\n\r\n      if (type === 'noteoff' && !isNoteOffIgnored) {\r\n        console.log('off', n, noteEl);\r\n        noteEl.setAttribute('material', 'opacity', 0);\r\n        notePool[poolKey] = null;\r\n      }\r\n    };\r\n\r\n    // const handleCC = ({ controller: { number }, value }) => {\r\n    //   if (number === 2) { // breath control\r\n    //\r\n    //     const vel = value / 128;\r\n    //     const opacity = vel / (0.1 + vel);\r\n    //     noteEl.setAttribute('material', 'opacity', opacity);\r\n    //   }\r\n    // };\r\n\r\n    const handlePitchbend = ({value}) => {\r\n      // console.log(value)\r\n\r\n      notePool.forEach((n, k) => {\r\n        if (n === null) return;\r\n        const noteEl = noteEls[k];\r\n        pitchBendAmount = value * 2;\r\n        const {s, x, y, z} = noteToDimensions(n + pitchBendAmount);\r\n        noteEl.object3D.position.set(x, y, z + 0.01);\r\n        noteEl.object3D.scale.set(s * 1.1, s * 1.1, s * 1.1);\r\n      });\r\n    };\r\n\r\n    if (/*midiInEl*/ true) {\r\n      if (midiInDevice) {\r\n        console.log('new midiInDevice: ', _.get(midiInDevice, 'name'), 'prev: ', _.get(prevMidiInDevice, 'name'));\r\n        midiInDevice.addListener('noteon', 'all', handleMidi);\r\n        midiInDevice.addListener('noteoff', 'all', handleMidi);\r\n        // midiInDevice.addListener('controlchange', 'all', handleCC);\r\n        midiInDevice.addListener('pitchbend', 'all', handlePitchbend);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (midiInDevice) {\r\n        console.log('removing listeners for', _.get(midiInDevice, 'name'));\r\n        midiInDevice.removeListener('noteon');\r\n        midiInDevice.removeListener('noteoff');\r\n        midiInDevice.removeListener('controlchange');\r\n        midiInDevice.removeListener('pitchbend');\r\n      }\r\n    };\r\n  }, [noteEls, midiInDevice, noteToDimensions, prevMidiInDevice]);\r\n\r\n  const midiInRef = useCallback((key, el) => {\r\n    noteEls[key] = el;\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      {_.range(notePoolSize).map((ix) => (\r\n        <Entity\r\n          key={ix}\r\n          _ref={el => midiInRef(ix, el)}\r\n          primitive=\"a-sphere\"\r\n          material={{\r\n            blending: 'additive',\r\n            color: HSVtoHex(1, 0, 1),\r\n            opacity: 0,\r\n            transparent: true,\r\n          }}\r\n          radius={0.07}\r\n        />\r\n      ))}\r\n    </>\r\n\r\n  );\r\n};\r\n\r\nexport default PcSpiralWindController;\r\n","import {useEffect, useRef} from \"react\";\r\n\r\nexport default (value) => {\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  });\r\n  return ref.current;\r\n}\r\n","import _ from 'lodash';\r\nimport PcSpiralWindController from './pcSpiralWindController';\r\nimport PitchClass from './pitchClass';\r\nimport PitchDetector from 'pitchdetect';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport useMidi from \"./useMidi\";\r\nimport {Entity} from 'aframe-react';\r\nimport {ftomf} from \"./util\";\r\nimport {getNoteColorHex, getNoteColorHsl, HSVtoHex} from './color';\r\n\r\nconst audioContext = new AudioContext();\r\n\r\n// FIXME HACK\r\nwindow.audioContext = audioContext;\r\n\r\n\r\nconst PitchClassSpiral = ({\r\n  depthMax = 1,\r\n  isAlwaysCounterClockwise = false,\r\n  rMax = 0.75,\r\n  rMin = 0,\r\n  noteRange = [34, 99],\r\n  // notesHighlighted = [0, 2, 4, 5, 7, 9, 11],\r\n  pcsHighlighted= [0, 2, 4, 5, 7, 9, 11],\r\n}) => {\r\n  const [is180, setIs180] = useState(true);\r\n  const [detector, setDetector] = useState();\r\n  const [pitchDetectEl, setPitchDetectEl] = useState();\r\n\r\n\r\n\r\n  const noteToDimensions = n => {\r\n    const step = n / 128;\r\n    const r = (is180 ? 1 : 1.5) * rMax - ((is180 ? 1 : 1.5) * rMax - rMin) * step;\r\n\r\n    return {\r\n      n,\r\n      s:  0.75 - n / 192,\r\n      x: r * (is180 && isAlwaysCounterClockwise ? -1 : 1) * Math.sin(n * Math.PI / 6 + 0.01), // +0.01 to fix floating point error in animation library\r\n      y: r * Math.cos(n * Math.PI / 6 + 0.01),\r\n      z: is180\r\n        ? depthMax - depthMax * step\r\n        : depthMax * step,\r\n    };\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleKeyup = ({code, key}) => {\r\n      if (key === 'r') setIs180(is180 => !is180);\r\n      if (code === 'Space') audioContext.resume();\r\n    };\r\n\r\n    window.addEventListener('keyup', handleKeyup);\r\n    return () => window.removeEventListener('keyup', handleKeyup);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('el', pitchDetectEl, 'detector', detector);\r\n\r\n    const handlePitch = (stats, pitchDetector) => {\r\n      const {frequency, detected, rms} = stats;\r\n\r\n      // https://math.stackexchange.com/q/57429/398343\r\n      // const opacity = 1 - Math.exp(-2 * rms);\r\n      const opacity = rms / (0.1 + rms);\r\n      const n = ftomf(frequency);\r\n      const {s, x, y, z} = noteToDimensions(n);\r\n      pitchDetectEl.setAttribute('material', 'opacity', detected ? opacity : 0);\r\n      pitchDetectEl.object3D.position.set(x, y, z + 0.01);\r\n      pitchDetectEl.object3D.scale.set(s, s, s);\r\n\r\n      if (_.isFinite(n)) {\r\n        pitchDetectEl.setAttribute('material', 'color', getNoteColorHex(n));\r\n      }\r\n    };\r\n\r\n    if (audioContext && !detector && pitchDetectEl) {\r\n      setDetector(new PitchDetector({\r\n        context: audioContext,\r\n\r\n        // input: audioBufferNode, // default: Microphone input\r\n\r\n        interpolateFrequency: true, // default: true\r\n\r\n        onDebug: handlePitch,\r\n\r\n        // Minimal signal strength (RMS, Optional)\r\n        // minRms: 0.1,\r\n\r\n        // Detect pitch only with minimal correlation of: (Optional)\r\n        // minCorrelation: 0.9,\r\n\r\n        // Detect pitch only if correlation increases with at least: (Optional)\r\n        minCorrelationIncrease: 0.5,\r\n\r\n        // Note: you cannot use minCorrelation and minCorreationIncrease\r\n        // at the same time!\r\n\r\n        // Signal Normalization (Optional)\r\n        normalize: \"rms\", // or \"peak\". default: undefined\r\n\r\n        // Only detect pitch once: (Optional)\r\n        stopAfterDetection: false,\r\n\r\n        // Buffer length (Optional)\r\n        length: 1024, // default 1024\r\n\r\n        // Limit range (Optional):\r\n        minNote: 32, // by MIDI note number\r\n        maxNote: 128,\r\n\r\n        // minFrequency: 440,    // by Frequency in Hz\r\n        // maxFrequency: 20000,\r\n\r\n        minPeriod: 2,  // by period (i.e. actual distance of calculation in audio buffer)\r\n        maxPeriod: 512, // --> convert to frequency: frequency = sampleRate / period\r\n\r\n        // Start right away\r\n        start: true, // default: false\r\n      }));\r\n      // window.detector = detector;\r\n    } else if (detector && !pitchDetectEl) {\r\n      detector.stop();\r\n      detector.destroy();\r\n    }\r\n  }, [audioContext, detector, is180, pitchDetectEl]);\r\n\r\n\r\n\r\n  const pitchDetectRef = useCallback(setPitchDetectEl, []);\r\n\r\n\r\n  // const midiInPitchClasses = _(12)\r\n  //   .range()\r\n  //   .map(n => _(midiIn)\r\n  //     .pickBy((v, i) => i % 12 === n)\r\n  //     .values()\r\n  //     .sum())\r\n  //   .value();\r\n\r\n  // TODO: position by freq, not 12TET pitch\r\n\r\n  return (// https://www.npmjs.com/package/aframe-animation-component\r\n    <Entity\r\n      events={{\r\n        click: () => {\r\n          audioContext.resume()\r\n        },\r\n      }}\r\n      position={{x: 0, y: 0, z: -6}}\r\n      scale={{x: 4, y: 4, z: 4}}\r\n    >\r\n      {_.range(noteRange[0], noteRange[1] + 1)\r\n        .map(noteToDimensions)\r\n        .map(({n, s, x, y, z}) => (\r\n          <React.Fragment key={n}>\r\n            <Entity\r\n              line={{\r\n                color: 'black',\r\n                opacity: 0.3,\r\n                start: _.pick(noteToDimensions(n + 0.25), ['x', 'y', 'z']),\r\n                end: _.pick(noteToDimensions(n + 0.75), ['x', 'y', 'z']),\r\n                visible: n < noteRange[1],\r\n              }}\r\n            />\r\n\r\n            <PitchClass\r\n              darkened={!_.includes(pcsHighlighted, n%12)}\r\n              n={n}\r\n              position={{x, y, z}}\r\n              scale={{x: s, y: s, z: s}}\r\n            />\r\n          </React.Fragment>\r\n          ))\r\n      }\r\n\r\n      <PcSpiralWindController\r\n        noteToDimensions={noteToDimensions}\r\n      />\r\n\r\n      {/* TODO intervals   */}\r\n      {/*<Entity*/}\r\n      {/*  line={{*/}\r\n      {/*    color: 'white',*/}\r\n      {/*    opacity: 0.3,*/}\r\n      {/*    start: _.pick(noteToDimensions(60), ['x', 'y', 'z']),*/}\r\n      {/*    end: _.pick(noteToDimensions(65), ['x', 'y', 'z']),*/}\r\n      {/*  }}*/}\r\n      {/*/>*/}\r\n\r\n\r\n      <Entity\r\n        _ref={pitchDetectRef}\r\n        primitive='a-sphere'\r\n        material={{\r\n          blending: 'additive',\r\n          color: HSVtoHex(1, 0, 1),\r\n          opacity: 0,\r\n          transparent: true,\r\n        }}\r\n        radius={0.1}\r\n      />\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default PitchClassSpiral;\r\n","import _ from 'lodash';\r\n\r\n\r\n\r\nexport const initialState = {\r\n\r\n};\r\n\r\n\r\n// https://editor.p5js.org/jayadiandri/sketches/LSNfUToa-\r\n// Real-time Monstercat visualizer using IIR filter banks\r\n\r\n\r\nconst audioCtx = new AudioContext();\r\nconst analyser = audioCtx.createAnalyser();\r\nwindow.addEventListener('click', () => {\r\n  if (audioCtx.state === 'suspended')\r\n    audioCtx.resume();\r\n});\r\n\r\nconst bands = [];\r\nconst filterBank = [];\r\nconst filterBank2 = [];\r\nconst filterBank3 = [];\r\nconst filterBank4 = [];\r\nconst filterBank5 = [];\r\nconst analysers = [];\r\n\r\nvar n = 48 * 2;\r\n\r\nanalyser.fftSize = 64; // [32, 64, 128, 256, 512, 1024, 2048]\r\n\r\nconst dataArrays = new Float32Array(analyser.fftSize);\r\n\r\nconst dataArray = new Uint8Array(analyser.frequencyBinCount);\r\n\r\n\r\n\r\n\r\nvar freq = 0;\r\n\r\nvar root24 = 2 ** ( 1 / n );\r\n\r\nvar c0 = 22.5 * root24 ** -n;\r\n\r\nconsole.log('c0', c0)\r\n\r\nlet i = 0;\r\n\r\nwhile ((freq = c0 * root24 ** i) <= 20000) {\r\n  if (freq >= 20 && i % 4 === 0) bands.push(freq);\r\n  console.log(`f${i}: ${freq}`)\r\n  i++;\r\n}\r\n\r\n\r\n\r\nfor ( i = 0; i < bands.length; i++ ) {\r\n  const gamma = 1 / 0.00437;\r\n  const q = bands[i] / (bands[i] + gamma) * 6;\r\n\r\n  filterBank.push(audioCtx.createBiquadFilter());\r\n  filterBank[i].frequency.value = bands[i];\r\n  filterBank[i].type = 'bandpass';\r\n  filterBank[i].Q.value = q;\r\n\r\n\r\n  filterBank2.push(audioCtx.createBiquadFilter());\r\n  filterBank2[i].frequency.value = bands[i];\r\n  filterBank2[i].type = 'bandpass';\r\n  filterBank2[i].Q.value = q;\r\n\r\n\r\n  filterBank3.push(audioCtx.createBiquadFilter());\r\n  filterBank3[i].frequency.value = bands[i];\r\n  filterBank3[i].type = 'bandpass';\r\n  filterBank3[i].Q.value = q;\r\n\r\n\r\n  filterBank4.push(audioCtx.createBiquadFilter());\r\n  filterBank4[i].frequency.value = bands[i];\r\n  filterBank4[i].type = 'bandpass';\r\n  filterBank4[i].Q.value = q;\r\n\r\n\r\n  filterBank5.push(audioCtx.createBiquadFilter());\r\n  filterBank5[i].frequency.value = bands[i];\r\n  filterBank5[i].type = 'bandpass';\r\n  filterBank5[i].Q.value = 0;\r\n\r\n\r\n  analysers.push(audioCtx.createAnalyser());\r\n  analysers[i].fftSize = analyser.fftSize;\r\n  analysers[i].smoothingTimeConstant = 0;\r\n}\r\n\r\nconst normalize = (val, min, max) => (val - min) / ( max - min );\r\n\r\n\r\n\r\nlet isReady = false;\r\n\r\n\r\n/*https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia*/\r\n\r\nnavigator.mediaDevices.getUserMedia({\r\n  audio: {\r\n    noiseCancellation: false,\r\n    echoCancellation: false,\r\n    autoGainControl: false\r\n  },\r\n  video: false\r\n})\r\n  .then((stream) => {\r\n    const audioSource = audioCtx.createMediaStreamSource(stream);\r\n    audioSource.connect(analyser);\r\n\r\n    bands.forEach((f, i) => {\r\n      audioSource.connect(filterBank[i]);\r\n      filterBank[i].connect(filterBank2[i]);\r\n      filterBank2[i].connect(filterBank3[i]);\r\n      filterBank3[i].connect(filterBank4[i]);\r\n      filterBank4[i].connect(filterBank5[i]);\r\n      filterBank5[i].connect(analysers[i]);\r\n    });\r\n\r\n    // ready\r\n    isReady = true;\r\n\r\n  })\r\n  .catch(function (err) {\r\n    console.error(err);\r\n  });\r\n\r\n\r\n\r\n\r\n\r\nexport const sketch = (p5) => {\r\n  p5.state = initialState;\r\n\r\n  let font;\r\n  p5.preload = () => {\r\n    font = p5.loadFont('JetBrainsMono-Regular.ttf');\r\n  }\r\n\r\n  const TWO_PI = Math.PI * 2;\r\n\r\n  let h, w;\r\n\r\n\r\n\r\n  p5.setup = () => {\r\n    p5.createCanvas(p5._width, p5._height);\r\n    p5.blendMode(p5.ADD);\r\n    p5.colorMode(p5.HSB);\r\n    p5.textFont(font);\r\n\r\n\r\n    p5.background(0, 0, 0);\r\n\r\n\r\n\r\n\r\n\r\n  }\r\n\r\n  p5.keyTyped = () => {\r\n    console.log(p5.key)\r\n    if (p5.key === 'Enter') {\r\n    } else {\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n\r\n  // const drawWave = ({ freq, phase = 0, hue }) => {\r\n  //   const dt = TWO_PI / rayCount;\r\n  //   p5.push();\r\n  //   p5.translate(w/2, h/2);\r\n  //   for(let t = 0; t < TWO_PI - dt; t += dt) {\r\n  //     p5.stroke(\r\n  //       hue,\r\n  //       255,\r\n  //       freq && (50 + 50 * Math.sin(t * freq)),\r\n  //       100,\r\n  //     );\r\n  //\r\n  //     r = w + h;\r\n  //     x1 = r * Math.sin(t + phase);\r\n  //     y1 = r * Math.cos(t + phase);\r\n  //\r\n  //     p5.line(0, 0, x1, y1);\r\n  //   }\r\n  //   p5.pop();\r\n  // };\r\n\r\n\r\n  // const isDarkMode = false;\r\n  const isDarkMode = true;\r\n\r\n  const starSpawn  = () => ({\r\n    x: Math.random() - .5,\r\n    y: Math.random() - .5,\r\n    brightness: Math.random(),\r\n  });\r\n\r\n  const stars = analysers.map(starSpawn);\r\n\r\n\r\n  p5.draw = () => {\r\n    // p5.clear();\r\n\r\n    p5.blendMode(p5.MULTIPLY);\r\n    p5.background(255, 30, isDarkMode ? 50 : 80, .1);\r\n    p5.noStroke()\r\n\r\n    if (!isReady) return;\r\n\r\n    analyser.getByteFrequencyData(dataArray);\r\n\r\n\r\n    // eslint-disable-next-line no-lone-blocks\r\n    {\r\n      p5.push();\r\n      p5.translate(p5.width / 2, p5.height / 2);\r\n\r\n      p5.scale(100)\r\n      p5.blendMode(isDarkMode ? p5.ADD : p5.MULTIPLY);\r\n\r\n\r\n      const hueOffset =  720 + Math.cos(.003 * p5.millis() * Math.PI) * 250;\r\n\r\n      analysers.forEach((analyzer, i) => {\r\n        analyzer.getFloatTimeDomainData(dataArrays);\r\n        let barHeight = 0;\r\n        for (let j = 0; j < analysers[i].fftSize; j++) barHeight += Math.abs(dataArrays[j]);\r\n        barHeight = barHeight / analysers[i].fftSize;\r\n        barHeight = normalize(barHeight, 0, 0.01);\r\n\r\n\r\n        const star = stars[i];\r\n\r\n        p5.fill(hueOffset % 360, 40, star.brightness * 90, .6)\r\n        p5.circle(star.x * 30, star.y * 30, .03 * star.brightness + barHeight * .02);\r\n        star.x *= .99;\r\n        star.y *= .99;\r\n        if (Math.abs(star.x) < .1 && Math.abs(star.y) < .01){\r\n          stars[i] = starSpawn();\r\n        }\r\n\r\n\r\n\r\n        const f = bands[i];\r\n        const angle = 360 * (Math.log2(f)) + 180;\r\n        const octave = angle / 360\r\n\r\n        // eslint-disable-next-line no-lone-blocks\r\n        {\r\n          p5.push();\r\n          p5.rotate(angle * Math.PI / 180);\r\n\r\n          const h = 1;\r\n          // var bot = h * (angle / 360) - 400;\r\n          // var w = 40 - angle / 360;\r\n\r\n          p5.translate(0, h * (octave - 5));\r\n          p5.fill((hueOffset + angle) % 360, 100, isDarkMode ? 100 : 50, Math.log2(barHeight) * .05)\r\n          p5.circle(0, 0, h * (octave ** 2) * barHeight /*Math.pow(barHeight, 2) **/ * .005);\r\n\r\n\r\n\r\n          p5.pop();\r\n        }\r\n\r\n      });\r\n\r\n\r\n      // p5.blendMode(p5.BLEND);\r\n      // p5.fill(255);\r\n      // p5.stroke(0);\r\n      // p5.strokeWeight(4);\r\n      // p5.textAlign(p5.CENTER, p5.CENTER);\r\n      // p5.textSize(h/15)\r\n      // p5.text(n2 ? `${d}:${n}:${n2}` : `${n}:${d}`, w/2, h/2)\r\n\r\n\r\n    }\r\n\r\n\r\n    p5.pop();\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  /**\r\n   * This needs to be called by a user event handler.\r\n   * @param isPlaying\r\n   */\r\n  p5.toggleAudio = () => {\r\n    p5.setState(prevState => {\r\n      const { isPlaying } = prevState;\r\n      if (!isPlaying && audioCtx.state !== 'running') {\r\n        audioCtx.resume();\r\n      }\r\n\r\n      if (isPlaying && audioCtx.state === 'running') {\r\n        audioCtx.suspend();\r\n      }\r\n\r\n      return { ...prevState, isPlaying: !prevState.isPlaying };\r\n    });\r\n\r\n  }\r\n}\r\n","import React, {useEffect} from 'react';\r\nimport useP5 from './useP5';\r\nimport {initialState, sketch} from \"./spiralFFTP5\";\r\n\r\nconst SpiralFFT = () => {\r\n  const {\r\n    ref,\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n  } = useP5(sketch, initialState);\r\n\r\n  window.sketchInstance = sketchInstance;\r\n\r\n  useEffect(() => {\r\n    document.title = 'Spiral FFT';\r\n  }, [sketchInstance]);\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      style={{\r\n        alignSelf: 'start',\r\n        background: 'radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)',\r\n        height: '100vh',\r\n        width: '100vw',\r\n      }}\r\n    />);\r\n};\r\n\r\n\r\nexport default SpiralFFT;\r\n","import _ from 'lodash';\r\nimport Vex from 'vexflow';\r\nimport React, {useCallback, useState} from 'react';\r\n\r\nconst VF = Vex.Flow;\r\n\r\nconst useVexFlow = () => {\r\n  const [context, setContext] = useState(null);\r\n  const [resizeObserver, setResizeObserver] = useState(null);\r\n\r\n  const ref = useCallback((el) => {\r\n    if (el) {\r\n      const renderer = new VF.Renderer(el, VF.Renderer.Backends.SVG);\r\n      renderer.resize(el.clientWidth, el.clientHeight);\r\n      setContext(renderer.getContext());\r\n\r\n      const resizeObserver = new ResizeObserver(([{ contentRect: { height, width } }]) => {\r\n        renderer.resize(width, height);\r\n      });\r\n      setResizeObserver(resizeObserver);\r\n      resizeObserver.observe(el);\r\n    } else {\r\n      resizeObserver.disconnect();\r\n    }\r\n  }, []);\r\n\r\n  return {\r\n    context,\r\n    ref,\r\n  };\r\n}\r\n\r\nconst Staff = () => {\r\n  const {\r\n    context,\r\n    ref,\r\n  } = useVexFlow();\r\n\r\n  if (context) {\r\n    context.setStrokeStyle('white');\r\n    context.setFillStyle('white');\r\n\r\n    const treble = new VF.Stave(50, 0, 10000)\r\n      .addClef('treble')\r\n      .addKeySignature('Db')\r\n      .addTimeSignature('4/4')\r\n      .setContext(context)\r\n      .draw();\r\n\r\n    window.VF= VF;\r\n    window.context = context\r\n    window.treble = treble\r\n\r\n    const bass = new VF.Stave(50, 60, 10000)\r\n      .addClef('bass')\r\n      .addTimeSignature('4/4')\r\n      .addKeySignature('Db')\r\n      .setContext(context)\r\n      .draw();\r\n\r\n    const brace = new VF.StaveConnector(treble, bass)\r\n      .setType(VF.StaveConnector.type.BRACE)\r\n      .setContext(context)\r\n      .draw();\r\n\r\n\r\n    const leftLine = new VF.StaveConnector(treble, bass)\r\n      .setType(VF.StaveConnector.type.SINGLE_LEFT)\r\n      .setContext(context)\r\n      .draw();\r\n\r\n  }\r\n\r\n\r\n  return (\r\n    <div style={{\r\n      display: 'block',\r\n      width: '100%',\r\n    }}>\r\n      <div\r\n        ref={ref}\r\n        style={{\r\n          // background: 'darkcyan',\r\n          fill: 'white',\r\n          height: 500,\r\n          stroke: 'white',\r\n        }}/>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default Staff;\r\n","import _ from 'lodash';\r\nimport {useEffect, useState} from 'react';\r\n// import {Hsluv} from 'hsluv'; // FIXME ts loader\r\n\r\nlet _hsluv;\r\n\r\nconst hslToRgb = (h, s, l) => {\r\n  _hsluv = _hsluv || new window.Hsluv();\r\n  _hsluv.hsluv_h = (h * 360 + 12.2) % 360;\r\n  _hsluv.hsluv_s = s * 100;\r\n  _hsluv.hsluv_l = l * 100;\r\n  _hsluv.hsluvToRgb();\r\n  return [_hsluv.rgb_r * 255, _hsluv.rgb_g * 255, _hsluv.rgb_b * 255];\r\n};\r\n\r\n\r\nconst lumatoneRowLengths = [\r\n  2,\r\n  5,\r\n  8,\r\n  11,\r\n  14,\r\n  17,\r\n  20,\r\n  23,\r\n  26,\r\n  28,\r\n  26,\r\n  23,\r\n  20,\r\n  17,\r\n  14,\r\n  11,\r\n  8,\r\n  5,\r\n  2,\r\n];\r\n\r\nconst lumatoneRowStarts = [\r\n  0, 0, 0, 0, 0, 0, 0, 0, 0,\r\n  1,\r\n  4,\r\n  7,\r\n  10,\r\n  13,\r\n  16,\r\n  19,\r\n  22,\r\n  25,\r\n  28,\r\n];\r\n\r\nconst boardRowLengths = [\r\n  2,\r\n  5,\r\n  6, 6, 6, 6, 6, 6, 6,\r\n  5,\r\n  2,\r\n];\r\n\r\nconst boardsOnGrid = lumatoneRowLengths.map(() => ([]));\r\n\r\n_.range(5).forEach(boardIndex => {\r\n  const boardNum = boardIndex + 1;\r\n\r\n  const boardStartX = boardIndex * 6;\r\n  const boardStartY = boardIndex * 2;\r\n\r\n  let note = 0;\r\n  _.forEach(boardRowLengths, (boardRowLen, boardRow) => {\r\n    _.range(boardRowLen).forEach(boardX => {\r\n      const y = boardStartY + boardRow;\r\n      boardsOnGrid[y][boardStartX + lumatoneRowStarts[boardRow] + boardX] = {\r\n        boardNum,\r\n        note,\r\n      };\r\n\r\n      note++;\r\n    });\r\n  });\r\n\r\n});\r\n\r\nconst setColor = (lumatoneIn, lumatoneOut, board, key, rNorm, gNorm, bNorm) => new Promise((res) => {\r\n  const mfid = [0x00, 0x21, 0x50]; // Embodme according to https://www.midi.org/specifications-old/item/manufacturer-id-numbers\r\n  const setKeyColor = 0x01;\r\n  const normTo255 = norm => Math.max(0, Math.min(255, Math.floor(norm * 255)));\r\n  const r = normTo255(rNorm);\r\n  const g = normTo255(gNorm);\r\n  const b = normTo255(bNorm);\r\n\r\n  lumatoneIn.addOneTimeListener('sysex', () => {\r\n    // console.log('ack');\r\n    res();\r\n  });\r\n  lumatoneOut.sendSysex(mfid, [board, setKeyColor, key, r >> 4, r & 0xf, g >> 4, g & 0xf, b >> 4, b & 0xf]);\r\n  // console.log(`new ColorMapping(){ Board = ${board}, Key = ${key}, R = ${r}f, G = ${g}f, B = ${b}f },`)\r\n});\r\n\r\n/**\r\n *\r\n *\r\n *\r\n * @param lumatoneIn\r\n * @param lumatoneOut\r\n * @param board\r\n * @param key\r\n * @param note\r\n * @param midiChannel\r\n * @param typeByte  disabledDefault = 0, noteOnNoteOff = 1,  continuousController = 2, lumaTouch = 3, disabled = 4\r\n * @returns {Promise<unknown>}\r\n */\r\nconst setNote = (lumatoneIn, lumatoneOut, board, key, note, midiChannel = 1, typeByte = 1) => new Promise((res) => {\r\n  const mfid = [0x00, 0x21, 0x50]; // Embodme according to https://www.midi.org/specifications-old/item/manufacturer-id-numbers\r\n  const setKeyNote = 0x00;\r\n  // console.log('setnote', lumatoneIn, lumatoneOut);\r\n\r\n  lumatoneIn.addOneTimeListener('sysex', () => {\r\n    // console.log('ack');\r\n    res();\r\n  });\r\n  lumatoneOut.sendSysex(mfid, [board, setKeyNote, key, Math.min(127, Math.max(0, note)), midiChannel, typeByte]);\r\n\r\n  // console.log(`new NoteMapping(){ Board = ${board}, Key = ${key}, Note = ${Math.min(127, Math.max(0, note))} }, `)\r\n\r\n});\r\n\r\nconst changeBuffer = [];\r\nlet isPopping = false;\r\n\r\nconst changePush = async (ch) => {\r\n  changeBuffer.push(ch);\r\n\r\n  if (isPopping) return;\r\n\r\n  let chPop;\r\n  isPopping = true;\r\n  while (chPop = changeBuffer.shift()) {\r\n    await chPop();\r\n  }\r\n  isPopping = false;\r\n};\r\n\r\n\r\n/**\r\n *\r\n * TODO: don't update note if only color changes\r\n *\r\n * @param h\r\n * @param l\r\n * @param lumaIn\r\n * @param lumaOut\r\n * @param n\r\n * @param s\r\n * @param x\r\n * @param y\r\n * @returns {null}\r\n * @constructor\r\n */\r\nconst LumatoneKeySync = ({\r\n  color,\r\n  lumaIn,\r\n  lumaOut,\r\n  n,\r\n  x,\r\n  y,\r\n}) => {\r\n  useEffect(() => {\r\n    if (!lumaIn || !lumaOut) return;\r\n\r\n    const lumaKey = boardsOnGrid[y][x];\r\n    if (lumaKey) {\r\n      const {boardNum, note /*note = key index of board*/} = lumaKey;\r\n// console.log(n, 1 - Math.floor(n/12) / 5 )\r\n\r\n      const {r,g,b} = window.culori ? window.culori.converter('rgb')(color) : {r: 0, g: 0, b: 0};\r\n\r\n      changePush(() => setColor(lumaIn, lumaOut, boardNum, note, r, g, b));\r\n      // await setColor(lumaIn, lumaOut, boardNum, note, r, g, b);\r\n      // await setNote(lumaIn, lumaOut, boardNum, note, n);\r\n\r\n\r\n      // const typeByteCC =  (true << 4) | 2;   // (faderUpIsNull << 4) | keyType\r\n      // await setNote(lumaIn, lumaOut, boardNum, note, n, 1, typeByteCC); // cc\r\n\r\n      changePush(() => setNote(lumaIn, lumaOut, boardNum, note, n));\r\n      // console.log('board', boardNum, 'lumaKey', note, n, color)\r\n\r\n      let timeoutId;\r\n      const maxL = 1;\r\n\r\n      const handleNoteOff = (e) => {\r\n        const {dataBytes: [nPlayed, vPlayed]} = e;\r\n\r\n        const repeatCount = 1;\r\n        if (nPlayed === n) {\r\n          let repeat = repeatCount - 1;\r\n          const pushChanges = () => {\r\n\r\n\r\n            const {r,g,b} = window.culori ? window.culori.converter('rgb')({\r\n              ...color,\r\n              l: color.l + (maxL-color.l)*(repeat / repeatCount),\r\n            }) : {r: 0, g: 0, b: 0};\r\n\r\n\r\n            // const [r, g, b] = hslToRgb(h, s + (1-s)*(repeat / repeatCount), l + (maxL-l)*(repeat / repeatCount));\r\n\r\n            changePush(() => setColor(lumaIn, lumaOut, boardNum, note, r, g, b));\r\n\r\n            if (repeat > 0) {\r\n              repeat--;\r\n\r\n              clearTimeout(timeoutId);\r\n              timeoutId = setTimeout(pushChanges, 200 * repeat);\r\n            }\r\n          };\r\n\r\n          pushChanges();\r\n        }\r\n      };\r\n\r\n      const handleNoteOn = (e) => {\r\n        const {dataBytes: [nPlayed, vPlayed]} = e;\r\n\r\n        if (nPlayed === n) {\r\n          clearTimeout(timeoutId);\r\n          const {r,g,b} = window.culori ? window.culori.converter('rgb')({\r\n            ...color,\r\n            l: color.l + .35,\r\n          }) : {r: 0, g: 0, b: 0};\r\n\r\n          changePush(() => setColor(lumaIn, lumaOut, boardNum, note, r, g, b));\r\n        }\r\n      };\r\n\r\n      lumaIn.addListener('noteon', handleNoteOn);\r\n      lumaIn.addListener('noteoff', handleNoteOff);\r\n\r\n      return () => {\r\n        clearTimeout(timeoutId);\r\n        lumaIn.removeListener('noteon', handleNoteOn);\r\n        lumaIn.removeListener('noteoff', handleNoteOff);\r\n      }\r\n\r\n    }\r\n  }, [color.h, color.l, lumaIn, lumaOut, n, color.s, x, y,]);\r\n\r\n  return null;\r\n}\r\n\r\nexport default LumatoneKeySync;\r\n","// import {formatHex} from 'culori';\r\nimport _ from 'lodash';\r\nimport {log2} from 'mathjs';\r\nimport Cell from './cell';\r\nimport LumatoneKeySync from './lumatoneKeySync';\r\nimport PC from './pc';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport {getNoteColorHsl, hslToHex, HSVtoHex} from './color';\r\nimport useMidi from './useMidi';\r\n// import {Hsluv} from 'hsluv'; // FIXME ts loader\r\nimport {toSolfege, toSymbol} from './util';\r\n\r\n\r\nconst {formatHex} = window.culori || {formatHex: () => \"#000\"};\r\nconsole.log('formatHex', formatHex)\r\n\r\n\r\nconst pcSetOpts = [\r\n  {\r\n    label: 'Nothing',\r\n    val: [],\r\n  },\r\n  {\r\n    label: 'Diatonic Scale',\r\n    val: [0, 2, 4, 5, 7, 9, 11],\r\n  },\r\n  {\r\n    label: 'Major Triad',\r\n    val: [0, 4, 7],\r\n  },\r\n  {\r\n    label: 'Major 7',\r\n    val: [0, 4, 7, 11],\r\n  },\r\n  {\r\n    label: 'Minor Triad',\r\n    val: [0, 3, 7],\r\n  },\r\n  {\r\n    label: 'Minor 7',\r\n    val: [0, 3, 7, 10],\r\n  },\r\n  {\r\n    label: 'Diminished Triad',\r\n    val: [0, 3, 6],\r\n  },\r\n  {\r\n    label: 'Diminished 7',\r\n    val: [0, 4, 7],\r\n  },\r\n  {\r\n    label: 'Augmented Triad',\r\n    val: [0, 4, 8],\r\n  },\r\n  {\r\n    label: `'S Wonderful`,\r\n    val: [53, 55, 57],\r\n    // val: [5, 7, 9],\r\n    // val: [0, 4, 5, 6, 7, 9, 10],\r\n  },\r\n];\r\n\r\nconst fallingGrace = [\r\n  {\r\n    label: 'Ab Maj7 -- 8+47', // implied 0 -- but how would we notate omission of 0?\r\n    val: [8, 0, 3, 7],\r\n  },\r\n  {\r\n    label: `D7/F# -- 2+47/4 ${''/*(redundant 4)*/} -- 2+7/4 ${''/*(familiar slash chord notation, no redundancy)*/}  -- 2+470 ${''/*(explicit 0 allows for omitting 0)*/}`,\r\n    val: [2, 6, 9, 0],\r\n  },\r\n  {\r\n    label: 'G min7 -- 7+37',\r\n    val: [7, 10, 2, 5],\r\n  },\r\n  {\r\n    label: 'F min7',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n];\r\n\r\n\r\nconst lumatoneRowLengths = [\r\n  2,\r\n  5,\r\n  8,\r\n  11,\r\n  14,\r\n  17,\r\n  20,\r\n  23,\r\n  26,\r\n  28,\r\n  26,\r\n  23,\r\n  20,\r\n  17,\r\n  14,\r\n  11,\r\n  8,\r\n  5,\r\n  2,\r\n];\r\n\r\nconst lumatoneRowStarts = [\r\n  0, 0, 0, 0, 0, 0, 0, 0, 0,\r\n  1,\r\n  4,\r\n  7,\r\n  10,\r\n  13,\r\n  16,\r\n  19,\r\n  22,\r\n  25,\r\n  28,\r\n];\r\n\r\nconst boardRowLengths = [\r\n  2,\r\n  5,\r\n  6, 6, 6, 6, 6, 6, 6,\r\n  5,\r\n  2,\r\n];\r\n\r\nconst boardsOnGrid = lumatoneRowLengths.map(() => ([]));\r\n\r\n_.range(5).forEach(boardIndex => {\r\n  const boardNum = boardIndex + 1;\r\n\r\n  const boardStartX = boardIndex * 6;\r\n  const boardStartY = boardIndex * 2;\r\n\r\n  let note = 0;\r\n  _.forEach(boardRowLengths, (boardRowLen, boardRow) => {\r\n    _.range(boardRowLen).forEach(boardX => {\r\n      const y = boardStartY + boardRow;\r\n      boardsOnGrid[y][boardStartX + lumatoneRowStarts[boardRow] + boardX] = {\r\n        boardNum,\r\n        note,\r\n      };\r\n\r\n      note++;\r\n    });\r\n  });\r\n\r\n});\r\n\r\n\r\nconst lumatone = () => {\r\n\r\n\r\n};\r\n\r\nconst setColor = (lumatoneIn, lumatoneOut, board, key, r, g, b) => new Promise((res) => {\r\n  const mfid = [0x00, 0x21, 0x50]; // Embodme according to https://www.midi.org/specifications-old/item/manufacturer-id-numbers\r\n  const setKeyColor = 0x01;\r\n  console.log('setcolor', r, g, b);\r\n\r\n  lumatoneIn.addOneTimeListener('sysex', () => {\r\n    // console.log('ack');\r\n    res();\r\n  });\r\n  lumatoneOut.sendSysex(mfid, [board, setKeyColor, key, r >> 4, r & 0xf, g >> 4, g & 0xf, b >> 4, b & 0xf]);\r\n});\r\n\r\n/**\r\n *\r\n *\r\n *\r\n * @param lumatoneIn\r\n * @param lumatoneOut\r\n * @param board\r\n * @param key\r\n * @param note\r\n * @param midiChannel\r\n * @param typeByte  disabledDefault = 0, noteOnNoteOff = 1,  continuousController = 2, lumaTouch = 3, disabled = 4\r\n * @returns {Promise<unknown>}\r\n */\r\nconst setNote = (lumatoneIn, lumatoneOut, board, key, note, midiChannel = 1, typeByte = 1) => new Promise((res) => {\r\n  const mfid = [0x00, 0x21, 0x50]; // Embodme according to https://www.midi.org/specifications-old/item/manufacturer-id-numbers\r\n  const setKeyNote = 0x00;\r\n  console.log('setnote', lumatoneIn, lumatoneOut);\r\n\r\n  lumatoneIn.addOneTimeListener('sysex', () => {\r\n    // console.log('ack');\r\n    res();\r\n  });\r\n  lumatoneOut.sendSysex(mfid, [board, setKeyNote, key, Math.min(127, Math.max(0, note)), midiChannel, typeByte]);\r\n});\r\n\r\n\r\n// http://www.altkeyboards.com/instruments/isomorphic-keyboards\r\nconst layoutOpts = [\r\n  {\r\n    label: 'Wicki-Hayden',\r\n    val: (x, y) => y % 2 === 0\r\n      ? ((12 - y) * 6 + x * 2) + (x > 12 ? 24 : 0)\r\n      : (12 - y) * 6 + x * 2 + 1 + (x > 12 ? 24 : 0)\r\n  },\r\n\r\n  {\r\n    label: 'Harmonic table',\r\n    val: (x, y) => (\r\n      (y % 2 === 0\r\n          ? (8 - y) * 6 + x * 4// + (x > 12 ? 24 : 0)\r\n          : (8 - y) * 6 + x * 4 - 1 //+ (x > 12 ? 24 : 0)\r\n      ))\r\n  },\r\n\r\n];\r\n\r\nconst Tonnetz = ({rows = lumatoneRowLengths}) => {\r\n\r\n  const [{inputDevices, outputDevices}] = useMidi();\r\n  const xTouchIn = inputDevices.find(({name}) => name === 'LM-X-Touch-CS-in');\r\n  const lumaIn = inputDevices.find(({name}) => name === 'LM-Lumatone-in');\r\n  const lumaOut = outputDevices.find(({name}) => name === 'LM-Lumatone-out');\r\n\r\n\r\n  const [layoutKey, setLayoutKey] = useState(0);\r\n  const {val: layout} = layoutOpts[layoutKey];\r\n\r\n  const [pcSetKey, setPcSetKey] = useState(0);\r\n  const [pitchSet, setPitchSet] = useState({});\r\n  // const {val: pitchSet} = pcSetOpts[pcSetKey];\r\n  // const pcSet = pitchSet.map(p => p % 12);\r\n\r\n  useEffect(() => {\r\n    if (!xTouchIn || !lumaIn) return;\r\n\r\n    const notesCurr = {};\r\n\r\n    const handleNoteOn = (e) => {\r\n      const {dataBytes: [nPlayed, vPlayed]} = e;\r\n      notesCurr[nPlayed] = true;\r\n    };\r\n\r\n    const handleNoteOff = (e) => {\r\n      const {dataBytes: [nPlayed, vPlayed]} = e;\r\n      notesCurr[nPlayed] = false;\r\n    };\r\n\r\n    const handlePedalDown = (e) => {\r\n      const {dataBytes: [nPlayed, vPlayed]} = e;\r\n      if (nPlayed === 103) {\r\n        setPitchSet({...notesCurr});\r\n        console.log(notesCurr);\r\n      }\r\n    };\r\n\r\n    xTouchIn.addListener('noteoff', handlePedalDown);\r\n    lumaIn.addListener('noteon', handleNoteOn);\r\n    lumaIn.addListener('noteoff', handleNoteOff);\r\n\r\n    return () => {\r\n      xTouchIn.removeListener('noteoff', handlePedalDown);\r\n      lumaIn.removeListener('noteon', handleNoteOn);\r\n      lumaIn.removeListener('noteoff', handleNoteOff);\r\n    }\r\n  }, [lumaIn, xTouchIn])\r\n\r\n\r\n//   useEffect(() => {\r\n//     if (!lumaIn || !lumaOut) return;\r\n//\r\n//     const changeColors = async () => {\r\n//       for (const y of _.range(rows.length)) {\r\n//         const rowStartX = lumatoneRowStarts[y];\r\n//\r\n//         for (const x of _.range(rowStartX, rows[y] + rowStartX)) {\r\n//           const lumaKey = boardsOnGrid[y][x];\r\n//           if (lumaKey) {\r\n//             const {boardNum, note} = lumaKey;\r\n//             const n = layout(x, y);\r\n// // console.log(n, 1 - Math.floor(n/12) / 5 )\r\n//\r\n//\r\n//\r\n//             const [r, g, b] = hslToRgb(...colorHsl);\r\n//             await setColor(lumaIn, lumaOut, boardNum, note, r, g, b);\r\n//             // await setNote(lumaIn, lumaOut, boardNum, note, n);\r\n//\r\n//\r\n//             // const typeByteCC =  (true << 4) | 2;   // (faderUpIsNull << 4) | keyType\r\n//             // await setNote(lumaIn, lumaOut, boardNum, note, n, 1, typeByteCC); // cc\r\n//\r\n//             await setNote(lumaIn, lumaOut, boardNum, note, n);\r\n//             // console.log('board', boardNum, 'lumaKey', note, n, color)\r\n//           }\r\n//         }\r\n//       }\r\n//     };\r\n//\r\n//     changeColors().catch(e => console.log(e));\r\n//\r\n//   }, [layoutKey, pcSetKey, lumaIn, lumaOut]);\r\n\r\n\r\n  return (\r\n    <div style={{\r\n      display: 'block',\r\n      flexShrink: 0,\r\n    }}>\r\n      <select value={layoutKey} onChange={evt => setLayoutKey(parseInt(evt.target.value, 10))}>\r\n        {layoutOpts.map(({label}, val) => <option key={val} value={val}>{label}</option>)}\r\n      </select>\r\n\r\n      <select value={pcSetKey} onChange={evt => setPcSetKey(parseInt(evt.target.value, 10))}>\r\n        {pcSetOpts.map(({label}, val) => <option key={val} value={val}>{label}</option>)}\r\n      </select>\r\n\r\n      <br/>\r\n      <br/>\r\n      <br/>\r\n\r\n      <div style={{\r\n        transform: 'rotate(341.5deg)'\r\n      }}>\r\n        {_.range(rows.length)\r\n          .map(y => {\r\n            const isOdd = y % 2 === 1;\r\n            const rowStartX = lumatoneRowStarts[y];\r\n\r\n            return (\r\n              <>\r\n                {[\r\n                  ..._.range(rowStartX).map(x => {\r\n                    return (\r\n                      <\r\n                        Cell\r\n                        key={x}\r\n                        isOdd={isOdd}\r\n                      >\r\n                        &nbsp;\r\n                      </Cell>);\r\n                  }),\r\n                  ..._.range(rowStartX, rows[y] + rowStartX).map(x => {\r\n                    const n = layout(x, y);\r\n\r\n                    const pcSet = pcSetKey >= 0 && pcSetOpts[pcSetKey].val;\r\n                    const isInPcSet = _.includes(pcSet, n % 12);\r\n                    const isInPitchSet = pitchSet[n];\r\n                    const colorHsl = getNoteColorHsl(n, isInPitchSet, false/* !isInPcSet*/);\r\n\r\n                    // return (\r\n                    //   <\r\n                    //     Cell\r\n                    //     key={x}\r\n                    //     isOdd={isOdd}\r\n                    //   >\r\n                    //     {(boardsOnGrid[y][x] || {}).boardNum}\r\n                    //   </Cell>);\r\n\r\n                    const color = {\r\n                      mode: 'okhsl',\r\n                      h: 30 + colorHsl[0],\r\n                      s: colorHsl[1],\r\n                      l: colorHsl[2],\r\n                      alpha: 1\r\n                    };\r\n\r\n                    return (\r\n                      <>\r\n                        <PC\r\n                          key={x}\r\n                          n={n}\r\n                          isOdd={isOdd}\r\n                          showOctave\r\n                          style={{\r\n                            // border: `solid ${1}px`,\r\n                            border: `solid 2px`,\r\n                            borderRadius: '50%',\r\n                            color: isInPcSet ? 'white' : 'black', //TODO: printer settings as well as mediaquery stylesheet\r\n                            backgroundColor: formatHex(color),\r\n                            transform: 'rotate(18.5deg)'\r\n                          }}\r\n                        />\r\n                        <LumatoneKeySync\r\n                          color={{\r\n                            ...color,\r\n                            l: Math.log2(1 + color.l * 0.5),\r\n                          }}\r\n                          key={`keysync-${x}`}\r\n                          lumaIn={lumaIn}\r\n                          lumaOut={lumaOut}\r\n                          n={n}\r\n                          x={x}\r\n                          y={y}\r\n                        />\r\n                      </>\r\n                    );\r\n                  })\r\n                ]}\r\n                <br/>\r\n              </>\r\n            );\r\n          })}\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Tonnetz;\r\n","import FrettedInstrument from './frettedInstrument';\r\nimport React from 'react';\r\n\r\nconst Ukulele = () => (\r\n  <FrettedInstrument\r\n    fretCount={18}\r\n    fretMarkers={[0,5,7,10,12]}\r\n    tuning={[7, 4, 0, 9]}\r\n  />\r\n);\r\n\r\nexport default Ukulele;\r\n","import OSC from 'osc-js';\r\nimport Banjo from './banjo';\r\nimport ColtraneCircle from './coltraneCircle';\r\nimport Dod from './dod';\r\nimport Guitar from './guitar';\r\nimport Mandelbrot from './mandelbrot';\r\nimport Mandolin from './mandolin';\r\nimport MultTableMod12 from './multTableMod12';\r\nimport NumpadMod12 from './numpadMod12';\r\nimport PitchClassCollections from './pitchClassCollections';\r\nimport PitchClassSpiral from './pitchClassSpiral';\r\nimport RatioLightship from './ratioLightship';\r\nimport SpiralFFT from './spiralFFT';\r\nimport Staff from './staff';\r\nimport Tonnetz from './tonnetz';\r\nimport Ukulele from './ukulele';\r\n\r\nexport const routes2d = [\r\n  ['Mandelbrot Muse', '/mandelbrot', Mandelbrot],\r\n  ['Mod12 Multiplication Tables', '/multTableMod12', MultTableMod12],\r\n  ['OSC Dataviz', '/osc', OSC, true],\r\n  ['PC Number Notepad', '/numpadMod12', NumpadMod12],\r\n  ['PC Tonnetz', '/tonnetz', Tonnetz],\r\n  ['Ratio Lightship', '/ratioLightship', RatioLightship],\r\n  ['Spiral FFT', '/spiralFFT', SpiralFFT],\r\n  ['Staff', '/staff', Staff],\r\n  ['Strings PCs - Banjo', '/banjo', Banjo],\r\n  ['Strings PCs - Guitar', '/guitar', Guitar],\r\n  ['Strings PCs - Mandolin', '/mandolin', Mandolin],\r\n  ['Strings PCs - Ukulele', '/ukulele', Ukulele],\r\n];\r\n\r\nexport const routesVr = [\r\n  ['Coltrane Circle', '/vr/coltrane', ColtraneCircle],\r\n  ['Dod', '/vr/dod', Dod],\r\n  ['PitchClassCollections', '/vr/pitchClassCollections', PitchClassCollections],\r\n  ['PitchClassSpiral', '/vr/pitchClassSpiral', PitchClassSpiral],\r\n]\r\n","import {Entity} from \"aframe-react\";\r\nimport React from \"react\";\r\n\r\nconst Camera = () => (\r\n  <Entity\r\n    primitive=\"a-camera\"\r\n    id=\"camera\"\r\n    position={{ x: 0, y: 0, z: 0 }}\r\n    look-controls\r\n    // touch-look-controls={{\r\n    //   enabled: true,\r\n    // }}\r\n    wasd-controls={{\r\n      acceleration: 25,\r\n    }}\r\n  >\r\n    {/*<Entity*/}\r\n    {/*  primitive=\"a-cursor\"*/}\r\n    {/*  animation__click={{*/}\r\n    {/*    property: 'scale',*/}\r\n    {/*    startEvents: 'click',*/}\r\n    {/*    from: '0.1 0.1 0.1',*/}\r\n    {/*    to: '1 1 1',*/}\r\n    {/*    dur: 150,*/}\r\n    {/*  }}/>*/}\r\n  </Entity>\r\n);\r\n\r\nexport default Camera;\r\n","// import 'aframe-touch-look-controls'; FIXME\r\nimport Camera from './camera';\r\nimport ColtraneCircle from \"./coltraneCircle\";\r\nimport Dod from './dod';\r\nimport PitchClassCollections from \"./pitchClassCollections\";\r\nimport PitchClassSpiral from \"./pitchClassSpiral\";\r\nimport React from 'react';\r\nimport {Entity, Scene} from 'aframe-react';\r\nimport {Route, Switch} from 'react-router-dom';\r\nimport {routesVr} from './routes';\r\n\r\n// Note: needs https to enter VR\r\n\r\nconst VR = ({match: {path}}) => (\r\n  <Scene\r\n    // fog={{type: 'linear', color: '#000', near: 1, far: 10}}\r\n  >\r\n    <a-assets>\r\n      {/*<img id=\"groundTexture\" src=\"https://cdn.aframe.io/a-painter/images/floor.jpg\"/>*/}\r\n      {/*<img id=\"skyTexture\" src=\"https://cdn.aframe.io/a-painter/images/sky.jpg\"/>*/}\r\n    </a-assets>\r\n\r\n    <Switch\r\n      // FIXME: used to be <Route path={`${path}/pitchClassSpiral`} component={PitchClassSpiral}/>\r\n    >\r\n      {routesVr.map(([title, path, component], key) => (\r\n        <Route {...{ component, key, path }} />\r\n      ))}\r\n    </Switch>\r\n\r\n\r\n    {/*<Entity primitive=\"a-plane\" src=\"#groundTexture\" rotation=\"-90 0 0\" height=\"100\" width=\"100\"/>*/}\r\n    {/*<Entity primitive=\"a-light\" type=\"ambient\" color=\"#445451\"/>*/}\r\n    {/*<Entity primitive=\"a-light\" type=\"point\" intensity=\"2\" position=\"2 4 4\"/>*/}\r\n\r\n    {/*<Entity*/}\r\n    {/*  height=\"2048\"*/}\r\n    {/*  primitive=\"a-sky\"*/}\r\n    {/*  radius=\"30\"*/}\r\n    {/*  rotation=\"90 0 0\"*/}\r\n    {/*  src=\"#skyTexture\"*/}\r\n    {/*  theta-length=\"90\"*/}\r\n    {/*  width=\"2048\"*/}\r\n    {/*/>*/}\r\n    {/*<Entity*/}\r\n    {/*  height=\"2048\"*/}\r\n    {/*  primitive=\"a-sky\"*/}\r\n    {/*  radius=\"30\"*/}\r\n    {/*  rotation=\"90 0 180\"*/}\r\n    {/*  src=\"#skyTexture\"*/}\r\n    {/*  theta-length=\"90\"*/}\r\n    {/*  width=\"2048\"*/}\r\n    {/*/>*/}\r\n\r\n    <Camera />\r\n\r\n    <Entity\r\n      // events={{}}\r\n      id=\"leftHand\"\r\n      oculus-touch-controls=\"hand: left\"\r\n    />\r\n    <Entity\r\n      id=\"rightHand\"\r\n      oculus-touch-controls=\"hand: right\"\r\n    />\r\n\r\n  </Scene>\r\n);\r\n\r\nexport default VR;\r\n","import { fraction } from 'mathjs';\r\n\r\nexport const toOctave = (r) => r > 2\r\n  ? toOctave(r / 2)\r\n  : r < 1\r\n    ? toOctave(r * 2)\r\n    : r;\r\n\r\nexport const intToRatio = (i) => fraction(toOctave(i));\r\n\r\n// TODO: n-dimensions\r\nexport const coordToRatio = (x, y) => {\r\n  const raw = Math.pow(3, x) * Math.pow(5, y);\r\n  return fraction(toOctave(raw));\r\n}\r\n\r\n// for(let threes = -5; threes <= 5; threes++) {\r\n//   for(let fives = -5; fives <= 5; fives++) {\r\n//     let f = coordToRatio(threes, fives);\r\n//     console.log(`${f.n}/${f.d}`)\r\n//   }\r\n// }\r\n","// import 'aframe-animation-component';\r\nimport 'aframe';\r\nimport 'aframe-look-at-component';\r\nimport Banjo from './banjo';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Guitar from './guitar';\r\nimport Intro from './intro';\r\nimport MultTableMod12 from './multTableMod12';\r\nimport NumpadMod12 from './numpadMod12';\r\nimport OSC from 'osc-js';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Mandelbrot from './mandelbrot';\r\nimport Mandolin from './mandolin';\r\nimport Mic from './mic';\r\nimport Midi from './midi';\r\nimport RatioLightship from './ratioLightship';\r\nimport {routes2d, routesVr} from './routes';\r\nimport Staff from './staff';\r\nimport Tonnetz from './tonnetz';\r\nimport Ukulele from './ukulele';\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\nimport VR from './vr';\r\nimport {\r\n  AppBar,\r\n  IconButton,\r\n  Link,\r\n  Menu,\r\n  MenuItem,\r\n  Toolbar,\r\n} from '@material-ui/core';\r\nimport {BrowserRouter as Router, Route, Link as RouterLink} from 'react-router-dom';\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport {\r\n  Menu as MenuIcon,\r\n  MenuBookIcon,\r\n  WatchLater as MidiClockIcon,\r\n} from '@material-ui/icons';\r\nimport _ from 'lodash';\r\n\r\nimport { intToRatio } from \"./fns\";\r\n\r\nwindow.intToRation = intToRatio;\r\n\r\nconst doWhenAframeLoaded = () => {\r\n  if (typeof AFRAME === 'undefined') {\r\n    setTimeout(doWhenAframeLoaded, 100);\r\n    return;\r\n  }\r\n\r\n  const oscHost = {\r\n    host: window.location.hostname,\r\n    port: '8080',\r\n    secure: true,\r\n  };\r\n  const osc = new OSC({\r\n    plugin: new OSC.WebsocketClientPlugin(oscHost),\r\n  });\r\n  osc.open();\r\n  window.osc = osc;\r\n\r\n  // window.sendOsc = (address, ...args) => osc.send(new OSC.Message(address, ...args));\r\n\r\n  // osc.on('/midiSeq/clear', () => clearSeq());\r\n\r\n  // osc.on('/midiSeq/beat', ({args: [beat]}) => setBeat(beat));\r\n\r\n  // WIP\r\n  window.AFRAME.registerComponent('midi', {\r\n    init: function() {\r\n      // this.onOsc = (i, e) => {};\r\n\r\n      this._onOscId = osc.on('/midi/*', ({address, args: [note, vel]}) => {\r\n        const instrument = _.last(address.split('/'));\r\n        if (this.onOsc) this.onOsc({ instrument, note, vel });\r\n      });\r\n\r\n    },\r\n\r\n    tick: function (time, timeDelta) {\r\n      if (this.onTick) this.onTick(time, timeDelta);\r\n    },\r\n\r\n    remove: function() {\r\n      osc.off('/midi/*', this._onOscId);\r\n    },\r\n  });\r\n\r\n  window.AFRAME.registerComponent('osc', {\r\n    init: function() {\r\n      // this.onOsc = (i, e) => {};\r\n\r\n      this._onOscId = osc.on('/midi/*', ({address, args: [note, vel]}) => {\r\n        const instrument = _.last(address.split('/'));\r\n        if (this.onOsc) this.onOsc({ instrument, note, vel });\r\n      });\r\n\r\n    },\r\n\r\n    tick: function (time, timeDelta) {\r\n      if (this.onTick) this.onTick(time, timeDelta);\r\n    },\r\n\r\n    remove: function() {\r\n      osc.off('/midi/*', this._onOscId);\r\n    },\r\n  });\r\n}\r\ndoWhenAframeLoaded();\r\n\r\nconst App = () => {\r\n  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');\r\n\r\n  const neutral = {\r\n    palette: { // https://material-ui.com/customization/palette/\r\n      action: {\r\n        active: '#660000',\r\n      },\r\n      primary: {\r\n        main: '#330033'\r\n      },\r\n      type: 'dark',\r\n    },\r\n  };\r\n\r\n  const dark = {\r\n    palette: { // https://material-ui.com/customization/palette/\r\n      action: {\r\n        active: '#600',\r\n      },\r\n      primary: {\r\n        main: '#c0e'\r\n      },\r\n      type: 'dark',\r\n    },\r\n  };\r\n\r\n  const light = {\r\n    palette: { // https://material-ui.com/customization/palette/\r\n      action: {\r\n        active: '#660000',\r\n      },\r\n      primary: {\r\n        main: '#330033'\r\n      },\r\n      type: 'light',\r\n    },\r\n  };\r\n\r\n  const theme = React.useMemo(\r\n    () =>\r\n      createMuiTheme(prefersDarkMode ? dark : light),\r\n    [prefersDarkMode],\r\n  );\r\n\r\n  // Menu open/close\r\n  const [menuAnchorEl, setMenuAnchorEl] = React.useState(null);\r\n  const handleMenuButtonClick = ({ currentTarget }) => setMenuAnchorEl(currentTarget);\r\n  const handleMenuClose = () => setMenuAnchorEl(null);\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CssBaseline/>\r\n      <Router basename={process.env.PUBLIC_URL}>\r\n        <Route path=\"/\" exact component={Intro}/>\r\n\r\n        <Route path=\"/vr\" component={VR} />\r\n\r\n        {routes2d.map(([title, path, component], key) => (\r\n          <Route {...{ component, key, path }} />\r\n        ))}\r\n\r\n        <AppBar\r\n          color=\"transparent\"\r\n          onClick={() => {\r\n            // if (window.audioContext) { // FIXME HACK\r\n            //   window.audioContext.resume();\r\n            //   window.detector.start();\r\n            // }\r\n          }}\r\n          position=\"fixed\"\r\n          style={{\r\n            top: 'auto',\r\n            bottom: 0,\r\n          }}\r\n        >\r\n          <Toolbar>\r\n            <IconButton\r\n              edge=\"start\"\r\n              color=\"inherit\"\r\n              aria-label=\"open drawer\"\r\n              onClick={handleMenuButtonClick}\r\n            >\r\n              <MenuIcon/>\r\n            </IconButton>\r\n\r\n            <Menu\r\n              anchorEl={menuAnchorEl}\r\n              open={!!menuAnchorEl}\r\n              onClose={handleMenuClose}\r\n            >\r\n              <MenuItem>\r\n                <Link component={RouterLink} style={{ color: 'lightgrey'}} onClick={handleMenuClose} to=\"/\">Introduction</Link>\r\n              </MenuItem>\r\n              <MenuItem disabled divider >2D</MenuItem>\r\n              {routes2d.map(([title, url, component, isDevOnly], idx) => !isDevOnly && (\r\n                <MenuItem key={idx}>\r\n                  <Link color=\"primary\" component={RouterLink} onClick={handleMenuClose} to={url}>{title}</Link>\r\n                </MenuItem>\r\n              ))}\r\n              <MenuItem disabled divider>VR</MenuItem>\r\n              {routesVr.map(([title, url], idx) => (\r\n                <MenuItem key={idx}>\r\n                  <Link color=\"secondary\" component={RouterLink} onClick={handleMenuClose} to={url}>{title}</Link>\r\n                </MenuItem>\r\n              ))}\r\n            </Menu>\r\n\r\n            <Midi />\r\n\r\n            <Mic />\r\n          </Toolbar>\r\n        </AppBar>\r\n      </Router>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n\r\nReactDOM.render(<App/>, document.querySelector('#sceneContainer'));\r\n"],"sourceRoot":""}