(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,n){e.exports=n(129)},129:function(e,t,n){"use strict";n.r(t);var a=n(10),r=(n(105),n(109),n(7)),i=n.n(r),o=n(0),c=n.n(o),l=n(13),s=Object(l.a)({root:{fontSize:20,fontFamily:"jetBrainsMono",display:"inline-flex",height:30,width:30,alignItems:"center",justifyContent:"center"},el:{fontFamily:"Segoe UI"},odd:{left:15,position:"relative"}})(function(e){var t=e.children,n=e.classes,a=e.className,r=void 0===a?"":a,i=e.isOdd,o=e.style;return c.a.createElement("div",{className:"".concat(n.root," ").concat(r," ").concat(i?n.odd:""),style:o},t)}),u=Object(l.a)({fretMarker:{color:"purple"}})(function(e){var t=e.classes.fretMarker,n=e.frets;return i.a.range(i.a.last(n)+1).map(function(e){return i.a.includes(n,e)?e:""}).map(function(e,n){return c.a.createElement(s,{className:t,key:n},e)})}),m=function(e){return{10:"\u0aea",11:"\u0190"}[e%12]||e%12},d=Object(l.a)({el:{fontFamily:"Segoe UI"}})(function(e){var t=e.classes,n=e.n,a=e.isOdd,r=e.style;return c.a.createElement(s,{className:n%12===11?t.el:"",isOdd:a,style:r},m(n))}),h=[1,3,5,7,10,12,15,17,19],f=function(){return c.a.createElement("div",{style:{display:"block",flexShrink:0}},c.a.createElement(u,{frets:h}),c.a.createElement("br",null),[0,9,5,0,0].map(function(e,t){return c.a.createElement(c.a.Fragment,null,i.a.range(23).map(function(t){return(t+e)%12}).map(function(e,n){return 4===t&&n<5?c.a.createElement(s,{key:n}):c.a.createElement(d,{key:n,n:e})}),c.a.createElement("br",null))}),c.a.createElement(u,{frets:h}))},p=n(166),v=[0,5,7,12,15,17,19,24],g=[4,9,2,7,11,4].reverse(),y=([0,5,0,5,9,5].reverse(),[0,7,0,4,7,0].reverse(),function(){return c.a.createElement("div",{style:{display:"block",flexShrink:0}},c.a.createElement(u,{frets:v}),c.a.createElement("br",null),g.map(function(e){return c.a.createElement(c.a.Fragment,null,i.a.range(25).map(function(t){return(t+e)%12}).map(function(e,t){return c.a.createElement(d,{key:t,n:e})}),c.a.createElement("br",null))}),c.a.createElement(u,{frets:v}))}),k=function(){return c.a.createElement("div",{style:{height:"100%",overflowY:"auto",padding:"20% 10%"}},c.a.createElement("h1",null,"What is this nonsense all about?"),c.a.createElement("p",null,'When I learned how to play an instrument, we started with "Hot Cross Buns", "Mary Had a Little Lamb", etc. We started with the first 3 notes in the key of "C". Eventually, we\'d build up to the other 4 notes. Then a new key was introduced. This one has a "Bb" -- the key of "F". At some point we\'d be introduced to an "accidental".'),c.a.createElement("p",null,'This left a lasting impression that the notes C, D, E, F, G, A, and B were the main notes. And these other things were in another class. They were harder -- harder to think about, harder to play, harder to keep track of, harder to say. C, D, E, F, G, A, and B are all single syllables. The other 5 notes were thought of as modifications of these main notes. "B flat", "C sharp", "D flat", yada yada. Wait are there 5 or are there 10?'),c.a.createElement("p",null,'"B sharp" is one of the first little musical jokes you get to say when you\'re in the know, until you learn that when you really get in deep, actually "B sharp" ',c.a.createElement("i",null,"is"),' a real note. There\'s even a "B double sharp"! How many notes ',c.a.createElement("i",null,"are"),' there!? Answer: infinite, as there are infinite numbers between 0 and 1, there are infinite pitches. Another answer, and this is the one we\'ll focus on in this website, is 12. There are 12 pitch-classes in the musical system that westerners refer to as "music theory" and more formally 12-tone equal temperament. All the fancy names like "B flat" and "F sharp" are just various spellings of the 12 pitch-classes in 12-TET.'),c.a.createElement("p",null,'This is all kind of interesting for a while and makes a young musician wonder about how deep this labyrinth gets. But it\'s all a smoke screen. And it gets even worse when you start to learn about intervals. Honestly, what\'s the use of a "diminished second" if not to sound pedantic and "technically correct"?'),c.a.createElement("p",null,"While I'll concede that it sort of makes sense when you're talking about notes ",c.a.createElement("i",null,"written on a staff"),", I'll maintain that it's a bullshit system to think in and it's needlessly convoluted, scares off all but the masochistic academics and overachievers. It adds a layer of cognitive as well as verbal overhead to otherwise simple concepts, and all so that we can pretend that music all fits into this diatonic model, with a few outliers that we call \"accidentals\". It makes the white keys approachable and the black keys scary and hard to name. \"Is it a C# or a Db\"? Why do we care, when we really just want to think about the one pitch we're trying to finger?"),c.a.createElement("p",null,"If we're going to commit to this arguably artificial model of 12 notes, which is but one of a panoply of more naturally harmonious tunings, if we're going to compromise with this 12-TET model so that we end up with 12 equally spaced notes around the octave, let's go all in and treat it with the simple terms it asks for. Let's treat these 12 notes equally instead of imagining this additional layer of complexity on top of them."),c.a.createElement("br",null),c.a.createElement("hr",null),c.a.createElement("h2",null,"Please consider:"),c.a.createElement("pre",null,i.a.range(12).map(function(e){return c.a.createElement(d,{key:e,n:e})})),c.a.createElement("p",null,' That\'s "oh" "one" "two" "three" "four" "five" "six" "sev" "eight" "nine" "ten" "el".'))},E=function(){return c.a.createElement(c.a.Fragment,null,i.a.range(6).map(function(e){return c.a.createElement("div",{style:{display:"block",flexShrink:0,margin:"1em"}},i.a.range(13).map(function(t){return c.a.createElement(c.a.Fragment,null,i.a.range(13).map(function(n){return c.a.createElement(d,{key:n,n:e+n*t})}),c.a.createElement("br",null))}))}))},b=n(2),w=n(1),S=n(5),C=n(3),M=n(6),x=function(e){function t(){var e,n;Object(b.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(S.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(r)))).state={text:""},n.handleKeyPress=function(e){var t={Backquote:"0",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"\u0aea",Minus:"\u0190",Equal:"0",Numpad0:"0",Numpad1:"1",Numpad2:"2",Numpad3:"3",Numpad4:"4",Numpad5:"5",Numpad6:"6",Numpad7:"7",Numpad8:"8",Numpad9:"9",NumpadDivide:"\u0aea",NumpadMultiply:"\u0190",NumpadDecimal:" ",NumpadEnter:"\n",Enter:"\n",Space:" "}[e.code];t&&(e.preventDefault(),n.setState({text:n.state.text+t}))},n.handleChange=function(e){var t=e.target.value;return n.setState({text:t})},n}return Object(M.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("keypress",this.handleKeyPress)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keypress",this.handleKeyPress)}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("h3",null,"Use the numpad to enter pitch classes"),c.a.createElement("textarea",{cols:24,rows:20,onChange:this.handleChange,style:{background:"black",color:"darkgray",fontSize:20},value:this.state.text}))}}]),t}(o.Component),O=n(63),I=n.n(O),j=n(14),D=n.n(j),T=n(11),z=n(99),P=n(39),N=n(81),A=n.n(N),R=n(83),L=n.n(R),F=n(82),B={input:void 0,inputDevices:[],isMidiClockInSelectorOpen:!1,isMidiInSelectorOpen:!1,midiClockInDevice:void 0,midiInDevice:void 0,midiIn:i.a.zipObject(i.a.range(128),i.a.fill(new Array(128),0))},W={setInputDevices:function(e,t){return e.setState({inputDevices:t})},setMidiEvent:function(e,t){return e.setState({midiIn:i.a.merge(e.state.midiIn,t)})},setMidiClockInDevice:function(e,t){return e.setState({midiClockInDevice:t})},setMidiInDevice:function(e,t){return e.setState({midiInDevice:t})},toggleMidiInSelector:function(e){return e.setState({isMidiInSelectorOpen:!e.state.isMidiInSelectorOpen})},toggleMidiClockInSelector:function(e){return e.setState({isMidiClockInSelectorOpen:!e.state.isMidiClockInSelectorOpen})}},K=Object(F.a)(c.a,B,W),q={decayDuration:5e3,exciteEnergy:.05,exciteDuration:1e3,fundamentalFreq:200,hilbertN:64,hilbMand:[],isControlPanelOpen:!0,isPlaying:!1,isRegenNeeded:!0,maxIters:4096,midiClock:0,midiClocksPerTick:24,panX:-.05,panY:0,partials:{},partialsCountMax:16,isSmooth:!1,tick:0,tickDuration:100,tickLastMillis:0,zoom:1.2},U=new AudioContext,_=[],G=U.createGain();window.masterGain=G,G.gain.value=1,G.connect(U.destination);var V=function(e){e.state=q;var t,n=function(e,t,n,a){if(0===a){1===n&&(t.x=e-1-t.x,t.y=e-1-t.y);var r=t.x;t.x=t.y,t.y=r}},a=function(e,t){return i.a.reduce(e,function(e,n,a){return e+n*t[a]},0)},r=function(t,n,r,i,o,c){var l=function(e,t){return{x:3.5*e-2.5,y:2*t-1}}(.5-r+(t-.5)/o,.5-i+(n-.5)/o),s=l.x,u=l.y;return e.state.isSmooth?function(e,t,n){for(var r,i,o=[0,0],c=0,l=0;l<n&&(r=o[0],i=o[1],o[0]=r*r-i*i+e,o[1]=2*r*i+t,!(a(o,o)>65536));l++)c++;return c>=n?n:c-Math.log2(Math.log2(a(o,o)))+4}(s,u,c):function(e,t,n){for(var a=0,r=0,i=0;a*a+r*r<4&&i<n;){var o=a*a-r*r+e;r=2*a*r+t,a=o,i++}return i}(s,u,c)},o=i.a.memoize(function(e){return i.a.range(e*e).map(function(t){return function(e,t){for(var a={x:0,y:0},r=1;r<e;r*=2){var i=1&t/2,o=1&(t^i);n(r,a,i,o),a.x+=r*i,a.y+=r*o,t/=4}return a}(e,t)})}),c=function(t){var n=t/e.state.hilbertN;return 1*Math.min(10,n/20)},l=i.a.memoize(function(e){return i()(100).range().map(function(e){return Math.pow(2,e)}).dropWhile(function(t){return e/t>=2}).first()}),s=function(t){var n=t.m,a=t.p,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.state,o=i.maxIters,c=i.partialsCountMax,s=l(c),u=l(a),m=255*Math.log2(a/u),d=r?0:255-225*Math.pow(u/s,2),h=r?255:n===o?0:30+225*Math.pow(u/s,2);return e.color(m,d,h,r?.7:255)},u=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.fill(s(t,n))},m=function(t,n,a,r){var i=t/r,o=n/r;e.rect(a.x*i,a.y*o,i,o)},d=function(t,n,a){var r=a.hilbertN,i=a.hilbMand,o=c(e.width/2);e.strokeWeight(o),e.stroke(0);var l=h(i.length,e.width/4,e.height);i.forEach(function(a,i){u(a),e.push(),e.translate(e.width/4,0),m(t,n,a,r),e.pop(),e.push(),e.translate(e.width/4*3,0),f(e.width/4,l,i),e.pop()})},h=function(e,t,n){for(var a=t*n,r=Math.sqrt(a/e),i=0,o=1;o<t;o++)if(!((i=t/o)>r)){var c=t/i;if(e/c*i+(e%c>0?i:0)<=n)break}return i},f=function(t,n,a){var r=t/n,i=a%r,o=Math.floor(a/r);o%2===1&&(i=r-(i+1)),e.rect(i*n,o*n,n,n)},p=function(){e.background(32),_.forEach(function(e){var t=e.gain;t.gain.cancelScheduledValues(U.currentTime),t.gain.linearRampToValueAtTime(0,U.currentTime+.5)}),_.length!==a&&(_.forEach(function(e){var t=e.osc;e.gain,t.stop()}),_=i.a.range(e.state.partialsCountMax).map(function(){var e=U.createOscillator(),t=U.createGain();return t.gain.value=0,e.connect(t),t.connect(G),e.start(),{osc:e,gain:t}}),window.oscs=_);var t=e.state,n=t.fundamentalFreq,a=t.partialsCountMax,c=function(){var t=e.state,n=t.hilbertN,a=t.maxIters,i=t.panX,c=t.panY,l=t.partialsCountMax,s=t.zoom;return o(n).map(function(e){var t=e.x,o=e.y,u=r(t/n,o/n,i,c,s,a);return{x:t,y:o,m:u,p:u===a?0:Math.floor((u-1)%l+1)}})}(),l=i()(c).map(function(e){return e.p}).filter(i.a.identity).uniq().sort().take(a).map(function(e,t){return[e,{amp:0,oscIdx:t}]}).fromPairs().value();i.a.each(l,function(e,t){var a=e.decayTimerId,r=e.oscIdx,i=e.zeroGainTimerId;clearTimeout(a),clearTimeout(i),_[r].osc.frequency.cancelScheduledValues(U.currentTime),_[r].osc.frequency.linearRampToValueAtTime(t*n,U.currentTime+.5)}),e.setState(function(t){var n=Object(P.a)({},t,{hilbMand:c,isRegenNeeded:!1,partials:l});return d(e.width/2,e.height,n),n})},v=0,g=function(t){var n=e.state.hilbMand,a=e.state.tick%n.length,r=n[a],i=h(n.length,e.width/4,e.height),o=c(e.width/2);e.strokeWeight(o),function(t,n,a){var r=e.state.hilbMand[a%t];u(r),e.stroke(0),e.push(),e.translate(e.width/4,0),m(e.width/2,e.height,r,e.state.hilbertN),e.pop(),e.push(),e.translate(e.width/4*3,0),f(e.width/4,n,a),e.pop()}(n.length,i,v),v=a,e.stroke(20*t%255,0,255),u(r,!0),e.push(),e.translate(e.width/4,0),m(e.width/2,e.height,r,e.state.hilbertN),e.pop(),e.push(),e.translate(e.width/4*3,0),f(e.width/4,i,a),e.pop()},y=function(){var t=e.height,n=e.width/4;e.noStroke();var a=e.state,r=a.partials,o=a.partialsCountMax;i.a.each(r,function(a,r){var i=a.amp,c=a.oscIdx,l=t/o,u=t*((r-1)/o),m=_[c].gain.gain.value*n,d=s({m:1,p:r});e.fill(e.color(e.hue(d),255,8)),e.rect(0,u,n,l),e.fill(d),e.rect(0,u,m,l),e.fill(255),e.rect(i*n,u,1,l)})},k=!0;e.preload=function(){t=e.loadFont("JetBrainsMono-Regular.ttf")},e.setup=function(){e.createCanvas(e._width,e._height),e.colorMode(e.HSB),e.textFont(t)},e.incrementTick=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.millis(),a=e.state,r=a.isPlaying,o=a.isRegenNeeded,c=a.midiClocksPerTick,l=a.tickDuration,s=a.tickLastMillis;t&&e.state.midiClock++,r&&!o&&(t?e.state.midiClock%c===0:n>s+l)&&(e.state.tick++,e.state.tickLastMillis=n,function(t){var n=e.state,a=n.decayDuration,r=n.exciteEnergy,o=n.exciteDuration,c=n.hilbMand,l=n.partials,s=c[n.tick%c.length].p;if(s>0){var u=l[s],m=u.amp,d=u.decayTimerId,h=u.oscIdx,f=u.zeroGainTimerId,p=_[h].gain,v=i.a.isNumber(d)?m:p.gain.value,g=.8*Math.min(1,v+r*(1-v));u.amp=g,clearTimeout(d),clearTimeout(f),p.gain.cancelScheduledValues(0),p.gain.linearRampToValueAtTime(g,U.currentTime+o/1e3),u.decayTimerId=setTimeout(function(){p.gain.exponentialRampToValueAtTime(1e-5,U.currentTime+a/1e3),u.decayTimerId=null,u.zeroGainTimerId=setTimeout(function(){u.amp=0},a)},o)}}())};var E=0;e.draw=function(){var t=e.state,n=t.isPlaying,a=t.isRegenNeeded,r=t.midiClock;a&&p(),0===r&&e.incrementTick(),i.a.every([!a,e.state.tick!==E])&&(g(0),E=e.state.tick),n&&y(),e.state.isPlaying||e.state.isControlPanelOpen?k&&(y(),d(e.width/2,e.height,e.state),k=!1):(k=!0,e.background(0,.1),e.noFill(),e.stroke(192,127,90),e.textSize(10),e.text("arrow keys to move",0,e.height/2-50,e.width,e.height),e.text("shift+arrow for zoom/resolution",0,e.height/2-35,e.width,e.height),e.text("shift+spacebar toggle controls",0,e.height/2-20,e.width,e.height),e.textSize(20),e.textAlign(e.CENTER),e.text("spacebar to start",0,e.height/2,e.width,e.height))},e.toggleAudio=function(){e.setState(function(e){var t=e.isPlaying;return t||"running"===U.state||U.resume(),t&&"running"===U.state&&U.suspend(),Object(P.a)({},e,{isPlaying:!e.isPlaying})})}},H=n(160),Y=n(131),X=n(172),J=n(161),Q=n(86),Z=n.n(Q),$=n(90),ee=n.n($),te=n(87),ne=n.n(te),ae=n(88),re=n.n(ae),ie=n(84),oe=n.n(ie),ce=n(85),le=n.n(ce),se=n(92),ue=n.n(se),me=n(91),de=n.n(me),he=n(89),fe=n.n(he),pe=n(93),ve=n.n(pe),ge=Object(H.a)({paper:{background:"rgba(0,0,0,0.7)",paddingBottom:65}}),ye=function(e){var t=Object(o.useState)(q),n=Object(a.a)(t,2),r=n[0],i=n[1],c=Object(o.useState)(null),l=Object(a.a)(c,2),s=l[0],u=l[1],m=Object(o.useState)(null),d=Object(a.a)(m,2),h=d[0],f=d[1];s&&(s.setState=i,s.state=r);var p=Object(o.useCallback)(function(t){if(t){var n=new A.a(e,t);u(n),n._height=t.clientHeight,n._width=t.clientWidth;var r=new ResizeObserver(function(e){var t=Object(a.a)(e,1)[0].contentRect,r=t.height;!function(e,t){n.resizeCanvas(e,t),i(function(e){return Object(P.a)({},e,{isRegenNeeded:!0})})}(t.width,r)});f(r),r.observe(t)}else h&&h.disconnect()},[]);return{sketchInstance:s,sketchState:r,setSketchState:i,ref:p}},ke=function(e){var t=e.sketchState,n=e.setSketchState,a=e.stateKey,r=Object(z.a)(e,["sketchState","setSketchState","stateKey"]);return c.a.createElement("div",null,a,": ",t[a],c.a.createElement("br",null),c.a.createElement("input",Object.assign({type:"range",style:{width:400},value:t[a],onChange:function(e){var t=Number(e.target.value);n(function(e){return Object(P.a)({},e,Object(T.a)({},a,t))})}},r)))},Ee=function(){var e=ye(V),t=e.ref,n=e.sketchInstance,r=e.sketchState,l=e.setSketchState;window.sketchInstance=n;var s=function(e){return function(t){return function(){"toggleAudio"!==t?e.setState(function(e){var n=e.hilbertN,a=e.isControlPanelOpen,r=e.isRegenNeeded,o=e.panX,c=e.panY,l=e.zoom,s=.1/l,u={moveLeft:{panX:o+s},moveRight:{panX:o-s},moveUp:{panY:c+s},moveDown:{panY:c-s},resDec:{hilbertN:Math.pow(2,Math.log2(n)-1)},resInc:{hilbertN:Math.min(256,Math.pow(2,Math.log2(n)+1))},toggleControlPanel:{isControlPanelOpen:!a,isRegenNeeded:r},zoomIn:{zoom:l*(10/9)},zoomOut:{zoom:.9*l}}[t];return Object(P.a)({},e,{isRegenNeeded:!i.a.isEmpty(u)},u)}):e.toggleAudio()}}}(n);Object(o.useEffect)(function(){if(document.title="Mandelbrot Muse",n){var e=function(e){return function(t){var n=t.code,a=t.shiftKey,r=t.key;if("Space"!==n){var i={ArrowDown:function(){return a?"zoomOut":"moveDown"},ArrowLeft:function(){return a?"resDec":"moveLeft"},ArrowRight:function(){return a?"resInc":"moveRight"},ArrowUp:function(){return a?"zoomIn":"moveUp"}}[r];i&&e(i())()}else e(a?"toggleControlPanel":"toggleAudio")()}}(s);return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}},[n]);var u=K(function(e){return{midiClockInDevice:e.midiClockInDevice}},function(e){return e}),m=Object(a.a)(u,2),d=m[0].midiClockInDevice;m[1];return Object(o.useEffect)(function(){var e=function(e){n&&n.incrementTick(!0)};return d&&d.addListener("clock","all",e),function(){d&&d.removeListener("clock","all",e)}},[d]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{ref:t,style:{alignSelf:"start",background:"radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)",height:"50vw",width:"100vw"}}),c.a.createElement("div",{style:{bottom:0,padding:0,position:"absolute",textAlign:"center",zIndex:1e6}},!r.isControlPanelOpen&&c.a.createElement(Y.a,{onClick:s("toggleControlPanel")},"show",c.a.createElement(L.a,null),"controls"),c.a.createElement(X.a,{anchor:"top",classes:ge(),color:"transparent",open:r.isControlPanelOpen,onClose:s("toggleControlPanel"),variant:"persistent"},c.a.createElement(J.a,{fullWidth:!0,size:"large"},c.a.createElement(Y.a,{onClick:s("toggleAudio")},r.isPlaying?c.a.createElement(le.a,null):c.a.createElement(oe.a,null)),c.a.createElement(Y.a,{onClick:s("toggleControlPanel")},"hide controls")),c.a.createElement(J.a,{fullWidth:!0,size:"large"},c.a.createElement(Y.a,{onClick:s("moveUp")},c.a.createElement(Z.a,null)),c.a.createElement(Y.a,{onClick:s("moveLeft")},c.a.createElement(ne.a,null)),c.a.createElement(Y.a,{onClick:s("moveRight")},c.a.createElement(re.a,null)),c.a.createElement(Y.a,{onClick:s("zoomIn")},c.a.createElement(fe.a,null))),c.a.createElement(J.a,{fullWidth:!0,size:"large"},c.a.createElement(Y.a,{onClick:s("moveDown")},c.a.createElement(ee.a,null)),c.a.createElement(Y.a,{onClick:s("resDec")},c.a.createElement(de.a,null)),c.a.createElement(Y.a,{onClick:s("resInc")},c.a.createElement(ue.a,null)),c.a.createElement(Y.a,{onClick:s("zoomOut")},c.a.createElement(ve.a,null))),d?c.a.createElement(ke,{min:1,max:1024,stateKey:"midiClocksPerTick",sketchState:r,setSketchState:l}):c.a.createElement(ke,{min:16,max:1e3,stateKey:"tickDuration",sketchState:r,setSketchState:l}),c.a.createElement(ke,{min:1,max:4e3,stateKey:"exciteDuration",sketchState:r,setSketchState:l}),c.a.createElement(ke,{min:10,max:8e3,stateKey:"decayDuration",sketchState:r,setSketchState:l}),c.a.createElement(ke,{min:.01,max:1,step:.01,stateKey:"exciteEnergy",sketchState:r,setSketchState:l}),c.a.createElement(ke,{min:.1,max:500,onPointerUp:function(){console.log("onPointerUp"),r.isRegenNeeded=!0},step:.1,stateKey:"fundamentalFreq",sketchState:r,setSketchState:l}),c.a.createElement(ke,{min:1,max:1e3,stateKey:"partialsCountMax",sketchState:r,setSketchState:l,onPointerUp:function(){console.log("onPointerUp"),r.isRegenNeeded=!0}}),c.a.createElement(ke,{min:64,max:8e3,stateKey:"maxIters",sketchState:r,setSketchState:l,onPointerUp:function(){console.log("onPointerUp"),r.isRegenNeeded=!0}}))))},be=n(171),we=n(173),Se=n(66),Ce=n.n(Se),Me=n(162),xe=n(163),Oe=function(){var e=K(function(e){return{inputDevices:e.inputDevices,isMidiClockInSelectorOpen:e.isMidiClockInSelectorOpen,isMidiInSelectorOpen:e.isMidiInSelectorOpen,midiInDevice:e.midiInDevice}},function(e){return e}),t=Object(a.a)(e,2),n=t[0],r=t[1],l=n.inputDevices,s=n.isMidiClockInSelectorOpen,u=n.isMidiInSelectorOpen,m=n.midiInDevice;Object(o.useEffect)(function(){Ce.a.enable(function(e){e?console.error(e):(console.log("WebMidi enabled."),r.setInputDevices(Ce.a.inputs))},!0)},[]);var d=function(e){e.note.number,e.rawVelocity,e.type},h=function(e){},f=c.a.useState(null),p=Object(a.a)(f,2),v=p[0],g=p[1],y=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t){var n=t.currentTarget;g(n),r[e?"toggleMidiClockInSelector":"toggleMidiInSelector"]()}},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){var a=n.currentTarget;g(a);var i=l[e];r[t?"toggleMidiClockInSelector":"toggleMidiInSelector"](),t?(i.addListener("clock","all",h),r.setMidiClockInDevice(i)):(r.setMidiInDevice(i),i.addListener("noteon","all",d),i.addListener("noteoff","all",d))}};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Me.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:y(!1)},c.a.createElement("img",{src:"/noun_MIDI_385872.svg",style:{width:"1.5em",height:"1.5em"}})),c.a.createElement(Me.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:y(!0)},c.a.createElement(xe.a,null)),c.a.createElement(be.a,{id:"simple-menu",anchorEl:v,open:u||s,onClose:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(){console.log("close",e?"toggleMidiClockInSelector":"toggleMidiInSelector"),r[e?"toggleMidiClockInSelector":"toggleMidiInSelector"](),g(null)}}(s)},l.map(function(e,t){var n=e.name;return c.a.createElement(we.a,{key:n,onClick:k(t,s),selected:u&&n===i.a.get(m,"name")},n)})))},Ie=n(97).a.Flow,je=function(){var e=function(){var e=Object(o.useState)(null),t=Object(a.a)(e,2),n=t[0],r=t[1],i=Object(o.useState)(null),c=Object(a.a)(i,2),l=c[0],s=c[1];return{context:n,ref:Object(o.useCallback)(function(e){if(e){var t=new Ie.Renderer(e,Ie.Renderer.Backends.SVG);t.resize(e.clientWidth,e.clientHeight),r(t.getContext());var n=new ResizeObserver(function(e){var n=Object(a.a)(e,1)[0].contentRect,r=n.height,i=n.width;t.resize(i,r)});s(n),n.observe(e)}else l.disconnect()},[])}}(),t=e.context,n=e.ref;if(t){t.setStrokeStyle("white"),t.setFillStyle("white");var r=new Ie.Stave(50,0,1e4).addClef("treble").addKeySignature("Db").addTimeSignature("4/4").setContext(t).draw();window.VF=Ie,window.context=t,window.treble=r;var i=new Ie.Stave(50,60,1e4).addClef("bass").addTimeSignature("4/4").addKeySignature("Db").setContext(t).draw();new Ie.StaveConnector(r,i).setType(Ie.StaveConnector.type.BRACE).setContext(t).draw(),new Ie.StaveConnector(r,i).setType(Ie.StaveConnector.type.SINGLE_LEFT).setContext(t).draw()}return c.a.createElement("div",{style:{display:"block",width:"100%"}},c.a.createElement("div",{ref:n,style:{fill:"white",height:500,stroke:"white"}}))},De=function(){return c.a.createElement("div",{style:{display:"block",flexShrink:0}},i.a.range(30).map(function(e){return c.a.createElement(c.a.Fragment,null,i.a.range(50).map(function(t){var n=((e%2>0?(e-1)/2*11+3:e/2*11)+7*t)%12;return c.a.createElement(d,{key:t,n:n,isOdd:e%2===1})}),c.a.createElement("br",null))}))},Te=[0,5,7,10,12],ze=function(){return c.a.createElement("div",{style:{display:"block",flexShrink:0}},c.a.createElement(u,{frets:Te}),c.a.createElement("br",null),[9,4,0,7].map(function(e){return c.a.createElement(c.a.Fragment,null,i.a.range(19).map(function(t){return(t+e)%12}).map(function(e,t){return c.a.createElement(d,{key:t,n:e})}),c.a.createElement("br",null))}),c.a.createElement(u,{frets:Te}))},Pe=n(164),Ne=(n(123),n(18)),Ae=function(){return c.a.createElement(Ne.Entity,{primitive:"a-camera",id:"camera",position:{x:0,y:0,z:0},"look-controls":!0,"wasd-controls":{acceleration:25}})};function Re(e,t,n){var a,r,i,o,c,l,s,u;switch(1===arguments.length&&(t=e.s,n=e.v,e=e.h),l=n*(1-t),s=n*(1-(c=6*e-(o=Math.floor(6*e)))*t),u=n*(1-(1-c)*t),o%6){case 0:a=n,r=u,i=l;break;case 1:a=s,r=n,i=l;break;case 2:a=l,r=n,i=u;break;case 3:a=l,r=s,i=n;break;case 4:a=u,r=l,i=n;break;case 5:a=n,r=l,i=s}return function(e){var t=e.r,n=e.g,a=e.b;function r(e){var t=e.toString(16);return 1==t.length?"0"+t:t}return"#"+r(t)+r(n)+r(a)}({r:Math.round(255*a),g:Math.round(255*r),b:Math.round(255*i)})}var Le=function(e){return function(t){if(t){var n=t.components.osc;n.onOsc=function(t){t.instrument;var a=t.note,r=t.vel;a===e&&(n.vel=r)},n.onTick=function(e,a){n.vel,i.a.has(n,"vel")&&t.setAttribute("material","opacity",.05+.75*n.vel/128)}}}},Fe=function(e){var t=e.darkened,n=void 0===t||t,a=e.n,r=e.position,i=void 0===r?{x:0,y:0,z:0}:r,o=e.scale,l=void 0===o?{x:1,y:1,z:1}:o;return c.a.createElement(Ne.Entity,{_ref:Le(a),animation:{dur:500,property:"position",to:i},material:{blending:n?"normal":"additive",color:Re(a/12,.7,n?0:1),opacity:n?.5:.1},osc:{},primitive:"a-torus",radius:.1,"radius-tubular":.003,scale:l},c.a.createElement(Ne.Entity,{"look-at":"#camera",position:{x:0,y:0,z:0},scale:{x:2,y:2,z:2},text:{align:"center",color:Re(a/12,.75,.5),font:"../".concat(a%12>9?"segoeui":"JetBrainsMono-Medium","-msdf.json"),negate:!1,transparent:!0,value:m(a)}}))},Be=function(){var e=Object(o.useState)(!0),t=Object(a.a)(e,2),n=t[0],r=t[1];Object(o.useEffect)(function(){var e=function(e){"r"===e.key&&r(function(e){return!e})};return window.addEventListener("keyup",e),function(){return window.removeEventListener("keyup",e)}},[]);var l=K(),s=Object(a.a)(l,1)[0].midiIn,u=i()(12).range().map(function(e){return i()(s).pickBy(function(t,n){return n%12===e}).values().sum()}).value();return c.a.createElement(Ne.Entity,{animation:"property: rotation; to: 0 ".concat(n?180:0," 0; dur: 500;"),position:"0 0 -3"},i()(12).range().filter(function(e){return e%2==0}).map(function(e){return{n:e,r:1.5,x:-Math.sin(e*Math.PI/6),y:Math.cos(e*Math.PI/6)}}).map(function(e){var t=e.n,n=e.r,a=e.x,r=e.y;return c.a.createElement(Fe,{midiIn:u[t],n:t,position:"".concat(n*a," ").concat(n*r," 0")})}).value(),i()(48).range().filter(function(e){return!i.a.includes([6,7,0,1],e%8)}).map(function(e,t){return{i:t,n:(2*(t+1)+2*Math.floor(t/4))%12,r:1.5,x:Math.sin((e+.5)*Math.PI/24),y:Math.cos((e+.5)*Math.PI/24)}}).map(function(e){var t=e.n,n=e.r,a=e.x,r=e.y;return c.a.createElement(Fe,{midiIn:u[t],n:t,position:"".concat(n*a," ").concat(n*r," 0"),scale:"0.5 0.5 0.5"})}).value(),i()(12).range().filter(function(e){return e%2!=0}).map(function(e){return{n:(e+6)%12,r:1.2,x:-Math.sin(e*Math.PI/6),y:Math.cos(e*Math.PI/6)}}).map(function(e){var t=e.n,n=e.r,a=e.x,r=e.y;return c.a.createElement(Fe,{midiIn:u[t],n:t,position:"".concat(n*a," ").concat(n*r," 0")})}).value(),i()(48).range().filter(function(e){return!i.a.includes([4,5,6,7],e%8)}).map(function(e,t){return{i:t,n:(2*t+9+2*Math.floor(t/4))%12,r:1.2,x:Math.sin((e-1.5)*Math.PI/24),y:Math.cos((e-1.5)*Math.PI/24)}}).map(function(e){var t=e.n,n=e.r,a=e.x,r=e.y;return c.a.createElement(Fe,{midiIn:u[t],n:t,position:"".concat(n*a," ").concat(n*r," 0"),scale:"0.5 0.5 0.5"})}).value())},We=n(21),Ke=1.3305869973355013,qe=2.152934986677507,Ue=[[0,-qe,Ke],[0,qe,-Ke],[qe,-Ke,0],[-qe,Ke,0],[0,-qe,-Ke],[0,qe,Ke],[-qe,-Ke,0],[qe,Ke,0],[-Ke,0,qe],[Ke,0,-qe],[Ke,0,qe],[-Ke,0,-qe]],_e=function e(t){var n=t.rep,a=void 0===n?1:n,r=t.sat,i=t.stack,o=void 0===i?[]:i,l=t.n,s=void 0===l?0:l;return c.a.createElement(Ne.Entity,{position:"0 0 0"},Ue.map(function(e,t){return c.a.createElement(Ne.Entity,{key:t,color:Re(t*(1/12),r||1,1),events:{click:function(){return console.log(t)}},primitive:"a-sphere",position:e.join(" "),scale:[1,1,1].map(function(e){return.3*e/(a*a)}).join(" ")})}),a<3&&Ue.map(function(t,n){return c.a.createElement(Ne.Entity,{key:n,position:t.map(function(e){return 2*e}).join(" "),text:"color: ".concat(Re((o.length?o[o.length-1]:n)*(1/12),1,1),"; align: center; value: ").concat([].concat(Object(We.a)(o),[n]).join(",")," - ").concat((s+n)%12,"; width: 5; zOffset: 0")},c.a.createElement(e,{rep:a+1,sat:.3,stack:[].concat(Object(We.a)(o),[n]),n:(s+n)%12}))}))},Ge=function(e){var t=e.noteToDimensions,n=Object(o.useState)(),r=Object(a.a)(n,2),l=r[0],s=r[1],u=K(),m=Object(a.a)(u,1)[0].midiInDevice,d=function(e){var t=Object(o.useRef)();return Object(o.useEffect)(function(){t.current=e}),t.current}(m);Object(o.useEffect)(function(){var e=function(e){var n=e.note.number,a=e.velocity,r=e.type,i=a/(.1+a),o=t(n),c=o.s,s=o.x,u=o.y,m=o.z;l.setAttribute("material","opacity",i),"noteon"===r&&(l.note=n,l.object3D.position.set(s,u,m+.01),l.object3D.scale.set(1.1*c,1.1*c,1.1*c),l.setAttribute("material","color",Re(n/12,.75,.5)))};return l&&m&&(console.log("new midiInDevice: ",i.a.get(m,"name"),"prev: ",i.a.get(d,"name")),m.addListener("noteon","all",e),m.addListener("noteoff","all",e),m.addListener("controlchange","all",function(e){var t=e.controller.number,n=e.value;if(2===t){var a=n/128,r=a/(.1+a);l.setAttribute("material","opacity",r)}}),m.addListener("pitchbend","all",function(e){var n=e.value,a=l.note||0,r=t(a+2*n),i=r.s,o=r.x,c=r.y,s=r.z;l.object3D.position.set(o,c,s+.01),l.object3D.scale.set(1.1*i,1.1*i,1.1*i)})),function(){m&&(console.log("removing listeners for",i.a.get(m,"name")),m.removeListener("noteon"),m.removeListener("noteoff"),m.removeListener("controlchange"),m.removeListener("pitchbend"))}},[l,m,t,d]);var h=Object(o.useCallback)(s,[]);return c.a.createElement(Ne.Entity,{_ref:h,primitive:"a-sphere",material:{blending:"additive",color:Re(1,0,1),opacity:0,transparent:!0},radius:.07})},Ve=n(94),He=n.n(Ve),Ye=new AudioContext;window.audioContext=Ye;var Xe=function(e){var t=e.depthMax,n=void 0===t?1:t,r=e.isAlwaysCounterClockwise,l=void 0!==r&&r,s=e.rMax,u=void 0===s?.75:s,m=e.rMin,d=void 0===m?0:m,h=e.noteRange,f=void 0===h?[34,99]:h,p=e.pcsHighlighted,v=void 0===p?[0,2,4,5,7,9,11]:p,g=Object(o.useState)(!0),y=Object(a.a)(g,2),k=y[0],E=y[1],b=Object(o.useState)(),w=Object(a.a)(b,2),S=w[0],C=w[1],M=Object(o.useState)(),x=Object(a.a)(M,2),O=x[0],I=x[1],j=function(e){var t=e/128,a=(k?1:1.5)*u-((k?1:1.5)*u-d)*t;return{n:e,s:.75-e/192,x:a*(k&&l?-1:1)*Math.sin(e*Math.PI/6+.01),y:a*Math.cos(e*Math.PI/6+.01),z:k?n-n*t:n*t}};Object(o.useEffect)(function(){var e=function(e){var t=e.code;"r"===e.key&&E(function(e){return!e}),"Space"===t&&Ye.resume()};return window.addEventListener("keyup",e),function(){return window.removeEventListener("keyup",e)}},[]),Object(o.useEffect)(function(){console.log("el",O,"detector",S),Ye&&!S&&O?C(new He.a({context:Ye,interpolateFrequency:!0,onDebug:function(e,t){var n=e.frequency,a=e.detected,r=e.rms,o=r/(.1+r),c=function(e){return 69+12*Math.log2(e/440)}(n),l=j(c),s=l.s,u=l.x,m=l.y,d=l.z;O.setAttribute("material","opacity",a?o:0),O.object3D.position.set(u,m,d+.01),O.object3D.scale.set(s,s,s),i.a.isFinite(c)&&O.setAttribute("material","color",Re(c/12,.5,1))},minCorrelationIncrease:.5,normalize:"rms",stopAfterDetection:!1,length:1024,minNote:32,maxNote:128,minPeriod:2,maxPeriod:512,start:!0})):S&&!O&&(S.stop(),S.destroy())},[Ye,S,k,O]);var D=Object(o.useCallback)(I,[]);return c.a.createElement(Ne.Entity,{events:{click:function(){Ye.resume()}},position:{x:0,y:0,z:-6},scale:{x:4,y:4,z:4}},i.a.range(f[0],f[1]+1).map(j).map(function(e){var t=e.n,n=e.s,a=e.x,r=e.y,o=e.z;return c.a.createElement(c.a.Fragment,{key:t},c.a.createElement(Ne.Entity,{line:{color:"black",opacity:.3,start:i.a.pick(j(t+.25),["x","y","z"]),end:i.a.pick(j(t+.75),["x","y","z"]),visible:t<f[1]}}),c.a.createElement(Fe,{darkened:!i.a.includes(v,t%12),n:t,position:{x:a,y:r,z:o},scale:{x:n,y:n,z:n}}))}),c.a.createElement(Ge,{noteToDimensions:j}),c.a.createElement(Ne.Entity,{_ref:D,primitive:"a-sphere",material:{blending:"additive",color:Re(1,0,1),opacity:0,transparent:!0},radius:.1}))},Je=n(36),Qe=function(e){var t=e.match.path;return c.a.createElement(Ne.Scene,null,c.a.createElement("a-assets",null),c.a.createElement(Je.c,null,c.a.createElement(Je.a,{path:"".concat(t,"/coltrane"),component:Be}),c.a.createElement(Je.a,{path:"".concat(t,"/dod"),component:_e}),c.a.createElement(Je.a,{path:"".concat(t,"/pitchClassSpiral"),component:Xe})),c.a.createElement(Ae,null),c.a.createElement(Ne.Entity,{id:"leftHand","oculus-touch-controls":"hand: left"}),c.a.createElement(Ne.Entity,{id:"rightHand","oculus-touch-controls":"hand: right"}))},Ze=n(167),$e=n(168),et=n(46),tt=n(98),nt=n(165),at=n(169);!function e(){if("undefined"!==typeof AFRAME){var t={host:window.location.hostname,port:"8080",secure:!0},n=new I.a({plugin:new I.a.WebsocketClientPlugin(t)});n.open(),window.osc=n,window.AFRAME.registerComponent("midi",{init:function(){var e=this;this._onOscId=n.on("/midi/*",function(t){var n=t.address,r=Object(a.a)(t.args,2),o=r[0],c=r[1],l=i.a.last(n.split("/"));e.onOsc&&e.onOsc({instrument:l,note:o,vel:c})})},tick:function(e,t){this.onTick&&this.onTick(e,t)},remove:function(){n.off("/midi/*",this._onOscId)}}),window.AFRAME.registerComponent("osc",{init:function(){var e=this;this._onOscId=n.on("/midi/*",function(t){var n=t.address,r=Object(a.a)(t.args,2),o=r[0],c=r[1],l=i.a.last(n.split("/"));e.onOsc&&e.onOsc({instrument:l,note:o,vel:c})})},tick:function(e,t){this.onTick&&this.onTick(e,t)},remove:function(){n.off("/midi/*",this._onOscId)}})}else setTimeout(e,100)}();var rt=[["Mod12 Multiplication Tables","/multTableMod12",E],["PC-Number Notepad","/numpadMod12",x],["OSC Dataviz","/osc",I.a,!0],["PC Tonnetz","/tonnetz",De],["Banjo PCs","/banjo",f],["Guitar PCs","/guitar",y],["Ukulele PCs","/ukulele",ze],["Staff","/staff",je],["Mandelbrot","/mandelbrot",Ee]];D.a.render(c.a.createElement(function(){var e=Object(Pe.a)("(prefers-color-scheme: dark)"),t=c.a.useMemo(function(){return Object(tt.a)({palette:{action:{active:"#660000"},primary:{main:"#330033"},type:e?"dark":"light"}})},[e]),n=c.a.useState(null),r=Object(a.a)(n,2),i=r[0],o=r[1],l=function(){return o(null)};return c.a.createElement(nt.a,{theme:t},c.a.createElement(p.a,null),c.a.createElement(et.a,{basename:"/aframe-musicality"},c.a.createElement(Je.a,{path:"/",exact:!0,component:k}),c.a.createElement(Je.a,{path:"/vr",render:function(e){return c.a.createElement(Qe,e)}}),rt.map(function(e,t){var n=Object(a.a)(e,3),r=(n[0],n[1]),i=n[2];return c.a.createElement(Je.a,{component:i,key:t,path:r})}),c.a.createElement(Ze.a,{color:"transparent",onClick:function(){},position:"fixed",style:{top:"auto",bottom:0}},c.a.createElement($e.a,null,c.a.createElement(Me.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:function(e){var t=e.currentTarget;return o(t)}},c.a.createElement(at.a,null)),c.a.createElement(be.a,{anchorEl:i,open:!!i,onClose:l},c.a.createElement(we.a,null,c.a.createElement(et.b,{style:{color:"lightgrey"},onClick:l,to:"/"},"Introduction")),c.a.createElement(we.a,{disabled:!0,divider:!0},"2D"),rt.map(function(e,t){var n=Object(a.a)(e,4),r=n[0],i=n[1];return n[2],!n[3]&&c.a.createElement(we.a,{key:t},c.a.createElement(et.b,{style:{color:"pink"},onClick:l,to:i},r))}),c.a.createElement(we.a,{disabled:!0,divider:!0},"VR"),[["Coltrane Circle","/vr/coltrane"],["Dod","/vr/dod"],["PitchClassSpiral","/vr/pitchClassSpiral"]].map(function(e,t){var n=Object(a.a)(e,2),r=n[0],i=n[1];return c.a.createElement(we.a,{key:t},c.a.createElement(et.b,{style:{color:"cyan"},onClick:l,to:i},r))})),c.a.createElement(Oe,null)))))},null),document.querySelector("#sceneContainer"))}},[[104,1,2]]]);
//# sourceMappingURL=main.d6451c40.chunk.js.map