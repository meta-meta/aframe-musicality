{"version":3,"sources":["cell.js","fretMarkers.js","util.js","pc.js","banjo.js","frettedInstrument.js","guitar.js","intro.js","multTableMod12.js","numpadMod12.js","useMidi.js","useMidiClock.js","useP5.js","color.js","mandelbrotP5.js","mandelbrot.js","mandolin.js","useMic.js","mic.js","icons/midiIcon.js","midi.js","ratioLightshipP5.js","ratioLightship.js","pitchClass.js","coltraneCircle.js","dod.js","pitchClassCollections.js","pcSpiralWindController.js","usePrevious.js","pitchClassSpiral.js","tonnetz.js","staff.js","ukulele.js","routes.js","camera.js","vr.js","fns.js","index.js"],"names":["Cell","withStyles","root","fontSize","fontFamily","display","height","width","alignItems","justifyContent","position","odd","left","cellSize","_ref","children","classes","_ref$className","className","isOdd","style","react_default","a","createElement","concat","FretMarkers","fretMarker","color","frets","_","range","last","map","f","includes","fret","ix","cell","key","toSymbol","note","equalDivisions","arguments","length","undefined","10","11","PC","_ref$isSolfege","isSolfege","_ref$showOctave","showOctave","n","_ref$style","borderStyle","borderWidth","0","1","2","3","4","5","6","7","8","9","toSolfege","bottom","right","Math","floor","Banjo","flexShrink","src_fretMarkers","pc0","pc0ix","Fragment","i","pc","src_pc","FrettedInstrument","fretCount","fretMarkers","tuning","Object","toConsumableArray","reverse","ixPc0","Guitar","frettedInstrument","Intro","overflowY","padding","MultTableMod12","flexWrap","margin","y","x","NumpadMod12","state","text","handleKeyPress","evt","char","Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadDivide","NumpadMultiply","NumpadDecimal","NumpadEnter","Enter","Space","code","preventDefault","_this","setState","handleChange","value","target","window","addEventListener","this","removeEventListener","cols","rows","onChange","background","Component","initialState","input","inputDevices","isMidiClockInSelectorOpen","isMidiInSelectorOpen","midiClockInDevice","midiInDevice","midiIn","zipObject","fill","Array","outputDevices","actions","setInputDevices","store","setOutputDevices","setMidiEvent","midiEvt","merge","setMidiClockInDevice","setMidiInDevice","toggleMidiInSelector","toggleMidiClockInSelector","globalHook","React","useMidiClock","onClock","onStop","onSongPos","_useMidi","useMidi","_useMidi2","slicedToArray","tick","useEffect","handleMidiClock","handleStop","console","log","handleSpp","_ref2","_ref2$data","data","beats","addListener","removeListener","reset","useP5","sketch","_useState","useState","_useState2","sketchState","setSketchState","_useState3","_useState4","sketchInstance","setSketchInstance","_useState5","_useState6","resizeObserver","setResizeObserver","ref","useCallback","el","instance","P5","_height","clientHeight","_width","clientWidth","ro","ResizeObserver","_ref2$0$contentRect","contentRect","resizeCanvas","prevState","objectSpread","isRegenNeeded","observe","disconnect","HSVtoHex","h","s","v","r","g","b","p","q","t","componentToHex","c","hex","toString","rgbToHex","round","timeouts","messageName","event","source","stopPropagation","shift","fn","setZeroTimeout","push","postMessage","audioPan","decayDuration","exciteEnergy","exciteDuration","fundamentalFreq","hilbertN","hilbMand","isControlPanelOpen","isPlaying","maxIters","midiClock","midiClocksPerTick","panX","panY","partials","partialsCountMax","isSmooth","tickDuration","tickLastMillis","zoom","audioCtx","AudioContext","oscs","masterGain","createGain","audioPanner","createStereoPanner","gain","connect","destination","p5","font","hilbGetRotatedVec","rx","ry","temp","dot","v1","v2","reduce","acc","val","idx","mandGetValFromNormalizedCoords","xN","yN","maxIterations","_mandGetDenormalizedC","mandGetDenormalizedCoords","cx","cy","z","log2","mandGetValSmooth","scaledX","scaledY","iter","xTemp","mandGetVal","genHilbertCoords","memoize","d","dist","hilbDistanceToCoords","getStrokeWeight","w","sideLength","min","getPartialOfOctaveStart","pow","dropWhile","first","getColorForMandelbrotVal","_ref3","m","isCursor","_p5$state2","octMax","oct","setFillColorForMandelbrotVal","coordsWithVal","drawHilbertCoord","hilbertCoord","scaleX","scaleY","rect","drawHilbertMandelbrot","strokeWeight","stroke","getSideLengthForLinearizedMap","forEach","coordWithVal","translate","pop","drawLinearizedMandelbrotCoord","dMax","maxA","largestPossibleSide","sqrt","sqPerRow","valsPerRow","genAndDrawHilbertMandelbrot","_ref4","cancelScheduledValues","currentTime","linearRampToValueAtTime","_p5$state3","osc","stop","createOscillator","start","_p5$state","genHilbertMandelbrot","_ref5","filter","identity","uniq","sort","take","partial","amp","oscIdx","fromPairs","each","_ref6","decayTimerId","zeroGainTimerId","clearTimeout","frequency","nextState","prevD","cursorDraw","id","coordAndVal","maxD","prevCoordAndVal","cursorErasePrev","partialsDraw","noStroke","_p5$state5","_ref7","targetAmp","barH","barW","hue","wasPaused","preload","loadFont","setup","createCanvas","colorMode","HSB","textFont","incrementTick","isExternal","now","millis","_p5$state6","_p5$state4","pan","currGain","isNumber","targetGain","setTimeout","exponentialRampToValueAtTime","cursorExcite","prevTick","draw","_p5$state7","every","noFill","textSize","textAlign","CENTER","toggleAudio","resume","suspend","useStyles","makeStyles","paper","paddingBottom","FreqSlider","_ref2$initialVal","initialVal","_ref2$isInt","isInt","_ref2$isRegenRequired","isRegenRequired","_ref2$label","label","_ref2$max","max","Number","MAX_VALUE","_ref2$min","MIN_VALUE","_ref2$precision","precision","_ref2$size","size","stateKey","constrainVal","valToState","freq","logFreq","exp","deg","numberInputVal","defer","flex","marginBottom","paddingTop","onPointerUp","react_circular_slider_default","dataIndex","degPerExp","knobColor","knobSize","renderLabelValue","type","border","marginLeft","marginTop","top","zIndex","toPrecision","ev","onKeyDown","_objectSpread4","defineProperty","nextExp","progressColorFrom","progressColorTo","progressLineCap","trackColor","Mandelbrot","_useP","handleAction","action","panDelta","moveLeft","moveRight","moveUp","moveDown","resDec","resInc","toggleControlPanel","zoomIn","zoomOut","isEmpty","getHandleAction","document","title","handler","shiftKey","getAction","ArrowDown","ArrowLeft","ArrowRight","ArrowUp","handleKeyDown","beat","alignSelf","Button","onClick","Tune_default","Drawer","anchor","open","onClose","variant","ButtonGroup","fullWidth","PauseCircleOutline_default","PlayCircleOutline_default","ViewModuleOutlined_default","KeyboardArrowUpOutlined_default","ViewComfyOutlined_default","ZoomInOutlined_default","KeyboardArrowLeftOutlined_default","KeyboardArrowDownOutlined_default","KeyboardArrowRightOutlined_default","ZoomOutOutlined_default","mandelbrot_FreqSlider","Mandolin","mediaStream","setMediaStream","Mic","_useMic","useMic","_useMic2","isMicOn","IconButton","edge","getTracks","tr","navigator","mediaDevices","getUserMedia","audio","video","then","MicOffOutlined","esm_Mic","MidiIcon","transform","viewBox","points","Midi","WebMidi","enable","err","error","inputs","outputs","handleMidi","number","rawVelocity","_React$useState","_React$useState2","midiMenuAnchorEl","setMidiMenuAnchorEl","handleMidiMenuButtonClick","isBeatClock","currentTarget","handleMidiInputSelect","deviceIdx","aria-label","midiIcon","WatchLater","Menu","anchorEl","handleMidiMenuClose","name","MenuItem","selected","get","TWO_PI","PI","n2","blendMode","ADD","keyTyped","obj","join","split","parseInt","_obj","_obj2","phase","x1","y1","drawWave","_ref2$phase","dt","sin","cos","line","clear","BLEND","RatioLightship","handleOsc","components","onOsc","instrument","vel","onTick","time","timeDelta","has","setAttribute","pitchClass","_ref2$darkened","darkened","_ref2$position","_ref2$scale","scale","material","blending","opacity","primitive","radius","radius-tubular","look-at","align","negate","transparent","ColtraneCircle","is180","setIs180","toggle","midiInPitchClasses","pickBy","values","sum","animation","c1","c2","verts","Dod","_ref$rep","rep","sat","_ref$stack","stack","_ref$n","events","click","PitchClassCollections","objectDestructuringEmpty","collEl","setCollEl","collRef","object3D","set","handleKeyup","colls","coll","rotation","theta","_ref5$s","PcSpiralWindController","noteToDimensions","midiInEl","setMidiInEl","prevMidiInDevice","useRef","current","usePrevious","velocity","_noteToDimensions","controller","_noteToDimensions2","midiInRef","audioContext","_hsluv","PitchClassSpiral","_ref$depthMax","depthMax","_ref$isAlwaysCounterC","isAlwaysCounterClockwise","_ref$rMax","rMax","_ref$rMin","rMin","_ref$noteRange","noteRange","_ref$pcsHighlighted","pcsHighlighted","detector","setDetector","pitchDetectEl","setPitchDetectEl","step","PitchDetector","context","interpolateFrequency","onDebug","stats","pitchDetector","detected","rms","ftomf","isFinite","minCorrelationIncrease","normalize","stopAfterDetection","minNote","maxNote","minPeriod","maxPeriod","destroy","pitchDetectRef","pick","end","visible","pcSpiralWindController","VF","Vex","Flow","Staff","_useVexFlow","setContext","renderer","Renderer","Backends","SVG","resize","getContext","useVexFlow","setStrokeStyle","setFillStyle","treble","Stave","addClef","addKeySignature","addTimeSignature","bass","StaveConnector","setType","BRACE","SINGLE_LEFT","hslToHex","l","Hsluv","hsluv_h","hsluv_s","hsluv_l","hsluvToHex","hslToRgb","hsluvToRgb","rgb_r","rgb_g","rgb_b","pcSetOpts","lumatoneRowLengths","lumatoneRowStarts","boardRowLengths","boardsOnGrid","boardIndex","boardNum","boardStartX","boardStartY","boardRowLen","boardRow","boardX","setColor","lumatoneIn","lumatoneOut","board","Promise","res","addOneTimeListener","sendSysex","setNote","midiChannel","typeByte","layoutOpts","getColorHsl","isHighlighted","Tonnetz","_ref$rows","_useMidi2$","lumaIn","find","lumaOut","layoutKey","setLayoutKey","layout","pcSetKey","setPcSetKey","pcSet","asyncToGenerator","regenerator_default","mark","_callee","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","rowStartX","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","lumaKey","_hslToRgb","_hslToRgb2","wrap","_context","prev","next","Symbol","iterator","done","apply","t0","return","finish","t1","changeColors","catch","e","isInPcSet","borderRadius","backgroundColor","Ukulele","routes2d","OSC","routesVr","Camera","look-controls","wasd-controls","acceleration","VR","match","path","react_router","component","camera","oculus-touch-controls","toOctave","intToRation","fraction","doWhenAframeLoaded","AFRAME","oscHost","host","location","hostname","port","secure","plugin","WebsocketClientPlugin","registerComponent","init","_onOscId","on","address","_ref$args","args","remove","off","_this2","_ref2$args","ReactDOM","render","dark","palette","active","primary","main","theme","useMemo","createMuiTheme","menuAnchorEl","setMenuAnchorEl","handleMenuClose","ThemeProvider","CssBaseline","react_router_dom","basename","process","exact","AppBar","Toolbar","esm_Menu","Link","RouterLink","to","disabled","divider","url","_ref8","_ref9","midi","mic","querySelector"],"mappings":"8NA4BeA,EAvBFC,YAAW,CACtBC,KAAM,CACJC,SAAU,GACVC,WAAY,gBACZC,QAAS,cACTC,OAPa,GAQbC,MARa,GASbC,WAAY,SACZC,eAAgB,SAChBC,SAAU,YAGZC,IAAK,CACHC,KAAMC,KAbGZ,CAeV,SAAAa,GAAA,IAAEC,EAAFD,EAAEC,SAAUC,EAAZF,EAAYE,QAAZC,EAAAH,EAAqBI,iBAArB,IAAAD,EAAiC,GAAjCA,EAAqCE,EAArCL,EAAqCK,MAAOC,EAA5CN,EAA4CM,MAA5C,OACDC,EAAAC,EAAAC,cAAA,OACEL,UAAS,GAAAM,OAAKR,EAAQd,KAAb,KAAAsB,OAAqBN,EAArB,KAAAM,OAAkCL,EAAQH,EAAQL,IAAM,IACjES,MAAOA,GACNL,KCZUU,EAPKxB,YAAW,CAC7ByB,WAAY,CAACC,MAAO,WADF1B,CAGlB,SAAAa,GAAA,IAAYY,EAAZZ,EAAEE,QAAUU,WAAaE,EAAzBd,EAAyBc,MAAzB,OAAoCC,IAAEC,MAAMD,IAAEE,KAAKH,GAAS,GACzDI,IAAI,SAAAC,GAAC,OAAIJ,IAAEK,SAASN,EAAOK,GAAKA,EAAI,KACpCD,IAAI,SAACG,EAAMC,GAAP,OAAcf,EAAAC,EAAAC,cAACc,EAAD,CAAMnB,UAAWQ,EAAYY,IAAKF,GAAKD,OCmBjDI,EAAW,SAACC,GAAD,IAAOC,EAAPC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAwB,GAAxB,MAAgC,CACtDG,GAAI,SACJC,GAAI,UACHN,EAAOC,IAAmBD,EAAOC,GCDrBM,EA3BJ,SAAAjC,KACTE,QADS,IAETG,EAFSL,EAETK,MAFS6B,EAAAlC,EAGTmC,iBAHS,IAAAD,KAAAE,EAAApC,EAITqC,kBAJS,IAAAD,KAKTE,EALStC,EAKTsC,EALSC,EAAAvC,EAMTM,aANS,IAAAiC,EAMDJ,EAAY,CAClBK,YAAa,QACbC,YAAa,EACbhD,MAAO,IACL,KAVK8C,EAAA,OAYThC,EAAAC,EAAAC,cAACc,EAAD,CACElB,MAAOA,EACPC,MAAOA,GAEN6B,EDZoB,SAACT,GAAD,IAAOC,EAAPC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAwB,GAAxB,MAAgC,CACvDc,EAAG,KACHC,EAAG,MACHC,EAAG,MACHC,EAAG,QACHC,EAAG,OACHC,EAAG,OACHC,EAAG,MACHC,EAAG,MACHC,EAAG,QACHC,EAAG,OACHpB,GAAI,MACJC,GAAI,MACHN,EAAOC,IAAmBD,EAAOC,ECDnByB,CAAUd,GAAKb,EAASa,GACpCD,GACC9B,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACV+C,OAAQ,MACRhE,SAAU,QACVO,SAAU,WACV0D,MAAO,QACJC,KAAKC,MAAMlB,EAAI,OCrBpBxB,EAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,IAyBpB2C,EAvBD,kBACZlD,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACVf,QAAS,QACTmE,WAAY,IAEZnD,EAAAC,EAAAC,cAACkD,EAAD,CAAa7C,MAAOA,IACpBP,EAAAC,EAAAC,cAAA,WACC,CAAC,EAAG,EAAG,EAAG,EAAG,GAAGS,IAAI,SAAC0C,EAAKC,GAAN,OACnBtD,EAAAC,EAAAC,cAACF,EAAAC,EAAMsD,SAAP,CAAgBtC,IAAKqC,GAClB9C,IAAEC,MAAM,IACNE,IAAI,SAAA6C,GAAC,OAAKA,EAAIH,GAAO,KACrB1C,IAAI,SAAC8C,EAAI1C,GAAL,OACO,IAAVuC,GAAevC,EAAK,EAChBf,EAAAC,EAAAC,cAACc,EAAD,CAAMC,IAAKF,IACXf,EAAAC,EAAAC,cAACwD,EAAD,CAAIzC,IAAKF,EAAIgB,EAAG0B,MAExBzD,EAAAC,EAAAC,cAAA,cAGJF,EAAAC,EAAAC,cAACkD,EAAD,CAAa7C,MAAOA,uBCEToD,EAvBW,SAAAlE,GAAA,IAAGmE,EAAHnE,EAAGmE,UAAWC,EAAdpE,EAAcoE,YAAaC,EAA3BrE,EAA2BqE,OAA3B,OACxB9D,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACVf,QAAS,QACTmE,WAAY,IAEZnD,EAAAC,EAAAC,cAACkD,EAAD,CAAa7C,MAAOsD,IACpB7D,EAAAC,EAAAC,cAAA,WACC6D,OAAAC,EAAA,EAAAD,CAAID,GACFG,UACAtD,IAAI,SAAC0C,EAAKa,GAAN,OACLlE,EAAAC,EAAAC,cAACF,EAAAC,EAAMsD,SAAP,CAAgBtC,IAAKiD,GAClB1D,IAAEC,MAAMmD,EAAY,GAClBjD,IAAI,SAAA6C,GAAC,OAAKA,EAAIH,GAAO,KACrB1C,IAAI,SAAC8C,EAAI1C,GAAL,OACHf,EAAAC,EAAAC,cAACwD,EAAD,CAAIzC,IAAKF,EAAIgB,EAAG0B,MAEpBzD,EAAAC,EAAAC,cAAA,cAGJF,EAAAC,EAAAC,cAACkD,EAAD,CAAa7C,MAAOsD,MChBlBC,EALM,CAAC,EAAG,EAAG,EAAG,EAAG,GAAI,GAedK,EARA,kBACbnE,EAAAC,EAAAC,cAACkE,EAAD,CACER,UAAW,GACXC,YAAa,CAAC,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,IACvCC,OAAQA,KCCGO,EAZD,kBACZrE,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CAACd,OAAQ,OAAQqF,UAAW,OAAQC,QAAS,YACvDvE,EAAAC,EAAAC,cAAA,iCAEAF,EAAAC,EAAAC,cAAA,uCACAF,EAAAC,EAAAC,cAAA,WAAMM,IAAEC,MAAM,IAAIE,IAAI,SAAA8C,GAAE,OAAIzD,EAAAC,EAAAC,cAACwD,EAAD,CAAIzC,IAAKwC,EAAI1B,EAAG0B,OAE5CzD,EAAAC,EAAAC,cAAA,sDACCM,IAAEC,MAAM,IAAIE,IAAI,SAAA8C,GAAE,OAAIzD,EAAAC,EAAAC,cAACwD,EAAD,CAAIzC,IAAKwC,EAAI7B,WAAS,EAACG,EAAG0B,QCgBtCe,EAvBQ,kBACrBxE,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACVf,QAAS,OACTyF,SAAU,OACVrF,eAAgB,WAEfoB,IAAEC,MAAM,GAAGE,IAAI,SAAAoB,GAAC,OACf/B,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACV2E,OAAQ,QAEPlE,IAAEC,MAAM,IAAIE,IAAI,SAAAgE,GAAC,OAChB3E,EAAAC,EAAAC,cAAAF,EAAAC,EAAAsD,SAAA,KACG/C,IAAEC,MAAM,IAAIE,IAAI,SAAAiE,GAAC,OAChB5E,EAAAC,EAAAC,cAACwD,EAAD,CAAIzC,IAAK2D,EAAG7C,EAAGA,EAAI6C,EAAID,MAEzB3E,EAAAC,EAAAC,cAAA,sDCyDG2E,6MAxEbC,MAAQ,CACNC,KAAM,MAWRC,eAAiB,SAACC,GAEhB,IAAMC,EAAO,CACXC,UAAW,IACXC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,IACRC,OAAQ,SACRC,MAAO,SACPC,MAAO,IACPC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,QAAS,IACTC,aAAc,SACdC,eAAgB,SAChBC,cAAe,IACfC,YAAa,KACbC,MAAO,KACPC,MAAO,KACP9B,EAAI+B,MAEF9B,IACFD,EAAIgC,iBACJC,EAAKC,SAAS,CAAEpC,KAAMmC,EAAKpC,MAAMC,KAAOG,QAI5CkC,aAAe,SAAA3H,GAAA,IAAa4H,EAAb5H,EAAG6H,OAAUD,MAAb,OAA0BH,EAAKC,SAAS,CAAEpC,KAAMsC,wFA/C7DE,OAAOC,iBAAiB,WAAYC,KAAKzC,+DAIzCuC,OAAOG,oBAAoB,WAAYD,KAAKzC,iDA8C5C,OAAOhF,EAAAC,EAAAC,cAAA,WACLF,EAAAC,EAAAC,cAAA,mDACAF,EAAAC,EAAAC,cAAA,YACEyH,KAAM,GACNC,KAAM,GACNC,SAAUJ,KAAKL,aACfrH,MAAO,CACL+H,WAAY,QACZxH,MAAO,WACPxB,SAAU,IAEZuI,MAAOI,KAAK3C,MAAMC,eAnEAgD,6SCIpBC,GAAe,CACnBC,WAAO1G,EACP2G,aAAc,GACdC,2BAA2B,EAC3BC,sBAAsB,EACtBC,uBAAmB9G,EACnB+G,kBAAc/G,EACdgH,OAXa/H,IAAEgI,UACfhI,IAAEC,MAAM,KACRD,IAAEiI,KAAK,IAAIC,MAAM,KAAM,IAUvBC,cAAe,IAGXC,GAAU,CACdC,gBAAiB,SAACC,EAAOZ,GAAR,OACfY,EAAM3B,SAAS,CAACe,kBAElBa,iBAAkB,SAACD,EAAOH,GAAR,OAChBG,EAAM3B,SAAS,CAACwB,mBAElBK,aAAc,SAACF,EAAOG,GAAR,OACZH,EAAM3B,SAAS,CAACoB,OAAQ/H,IAAE0I,MAAMJ,EAAMhE,MAAMyD,OAAQU,MAEtDE,qBAAsB,SAACL,EAAOT,GAAR,OAA8BS,EAAM3B,SAAS,CAACkB,uBAEpEe,gBAAiB,SAACN,EAAOR,GAAR,OAAyBQ,EAAM3B,SAAS,CAACmB,kBAE1De,qBAAsB,SAACP,GAAD,OACpBA,EAAM3B,SAAS,CAACiB,sBAAuBU,EAAMhE,MAAMsD,wBAGrDkB,0BAA2B,SAACR,GAAD,OACzBA,EAAM3B,SAAS,CAACgB,2BAA4BW,EAAMhE,MAAMqD,8BAK7CoB,gBAAWC,IAAOxB,GAAcY,ICUhCa,GAlDM,SAACC,EAASC,EAAQC,GAAc,IAAAC,EACZC,GACrC,SAAArK,GAAA,MAA0B,CAAC4I,kBAA3B5I,EAAE4I,oBACF,SAAAO,GAAO,OAAIA,IAHsCmB,EAAAhG,OAAAiG,EAAA,EAAAjG,CAAA8F,EAAA,GAC3CxB,EAD2C0B,EAAA,GAC3C1B,kBAKJ4B,GAN+CF,EAAA,GAMxC,GAoCX,OAlCAG,oBAAU,WAER,IAAMC,EAAkB,SAAClF,GACvBgF,IACIP,GAASA,EAAQ,CAAEO,UAGnBG,EAAa,SAACnF,GACd0E,GAAQA,IACZU,QAAQC,IAAI,SAGRC,EAAY,SAAAC,GAA0B,IAAAC,EAAA1G,OAAAiG,EAAA,EAAAjG,CAAAyG,EAAvBE,KAAuB,GACpCC,EAA4B,GADQF,EAAA,GACf,IADeA,EAAA,IAE1CJ,QAAQC,IAAI,MAAOK,GACff,GAAWA,EAAUe,IAU3B,OAPItC,IACFA,EAAkBuC,YAAY,QAAS,MAAOT,GAE9C9B,EAAkBuC,YAAY,OAAQ,MAAOR,GAC7C/B,EAAkBuC,YAAY,eAAgB,MAAOL,IAGhD,WACDlC,IACFA,EAAkBwC,eAAe,QAAS,MAAOV,GACjD9B,EAAkBwC,eAAe,OAAQ,MAAOT,GAChD/B,EAAkBwC,eAAe,eAAgB,MAAON,MAG3D,CAAClC,IAEG,CACLA,oBACAyC,MAAO,WACLb,EAAO,0BC7CEc,GAAA,SAACC,EAAQhD,GAAiB,IAAAiD,EACDC,mBAASlD,GADRmD,EAAApH,OAAAiG,EAAA,EAAAjG,CAAAkH,EAAA,GAChCG,EADgCD,EAAA,GACnBE,EADmBF,EAAA,GAAAG,EAEKJ,mBAAS,MAFdK,EAAAxH,OAAAiG,EAAA,EAAAjG,CAAAuH,EAAA,GAEhCE,EAFgCD,EAAA,GAEhBE,EAFgBF,EAAA,GAAAG,EAGKR,mBAAS,MAHdS,EAAA5H,OAAAiG,EAAA,EAAAjG,CAAA2H,EAAA,GAGhCE,EAHgCD,EAAA,GAGhBE,EAHgBF,EAAA,GAKnCH,IACFA,EAAerE,SAAWkE,EAC1BG,EAAe1G,MAAQsG,GAGzB,IAAMU,EAAMC,sBAAY,SAACC,GACvB,GAAIA,EAAI,CACN,IAAMC,EAAW,IAAIC,KAAGlB,EAAQgB,GAChCP,EAAkBQ,GAElBA,EAASE,QAAUH,EAAGI,aACtBH,EAASI,OAASL,EAAGM,YAErB,IAAMC,EAAK,IAAIC,eAAe,SAAA/M,GAAsC,IAAAgN,EAAA1I,OAAAiG,EAAA,EAAAjG,CAAAtE,EAAA,MAAnCiN,YAAczN,EAAqBwN,EAArBxN,OAAQC,EAAauN,EAAbvN,MACrD+M,EAASU,aAAazN,EAAOD,GACzBC,EAAQD,EAAS,GAAGoM,EAAe,SAACuB,GAAD,OAAA7I,OAAA8I,EAAA,EAAA9I,CAAA,GAAoB6I,EAApB,CAA+BE,eAAe,QAGvFjB,EAAkBU,GAClBA,EAAGQ,QAAQf,QAEPJ,GAAgBA,EAAeoB,cAEpC,IAEH,MAAO,CACLxB,iBACAJ,cACAC,iBACAS,QCrCG,SAASmB,GAASC,EAAGC,EAAGC,GAU7B,IAAIC,EAAGC,EAAGC,EAAG/J,EAAG5C,EAAG4M,EAAGC,EAAGC,EAWzB,OAVyB,IAArBrM,UAAUC,SACZ6L,EAAID,EAAEC,EACNC,EAAIF,EAAEE,EACNF,EAAIA,EAAEA,GAIRM,EAAIJ,GAAK,EAAID,GACbM,EAAIL,GAAK,GAFTxM,EAAQ,EAAJsM,GADJ1J,EAAIR,KAAKC,MAAU,EAAJiK,KAGEC,GACjBO,EAAIN,GAAK,GAAK,EAAIxM,GAAKuM,GACf3J,EAAI,GACV,KAAK,EACH6J,EAAID,EACJE,EAAII,EACJH,EAAIC,EACJ,MAEF,KAAK,EACHH,EAAII,EACJH,EAAIF,EACJG,EAAIC,EACJ,MAEF,KAAK,EACHH,EAAIG,EACJF,EAAIF,EACJG,EAAIG,EACJ,MAEF,KAAK,EACHL,EAAIG,EACJF,EAAIG,EACJF,EAAIH,EACJ,MAEF,KAAK,EACHC,EAAIK,EACJJ,EAAIE,EACJD,EAAIH,EACJ,MAEF,KAAK,EACHC,EAAID,EACJE,EAAIE,EACJD,EAAIE,EAIR,OA1DA,SAAAhO,GAA+B,IAAX4N,EAAW5N,EAAX4N,EAAGC,EAAQ7N,EAAR6N,EAAGC,EAAK9N,EAAL8N,EACxB,SAASI,EAAeC,GACtB,IAAIC,EAAMD,EAAEE,SAAS,IACrB,OAAqB,GAAdD,EAAIvM,OAAc,IAAMuM,EAAMA,EAGvC,MAAO,IAAMF,EAAeN,GAAKM,EAAeL,GAAKK,EAAeJ,GAoD/DQ,CAAS,CACdV,EAAGrK,KAAKgL,MAAU,IAAJX,GACdC,EAAGtK,KAAKgL,MAAU,IAAJV,GACdC,EAAGvK,KAAKgL,MAAU,IAAJT,MCnClB,WACE,IAAIU,EAAW,GACXC,EAAc,uBAoBlB3G,OAAOC,iBAAiB,UAVxB,SAAuB2G,GACjBA,EAAMC,QAAU7G,QAAU4G,EAAMzD,MAAQwD,IAC1CC,EAAME,kBACFJ,EAAS3M,OAAS,GACX2M,EAASK,OAClBC,MAK4C,GAGlDhH,OAAOiH,eAlBP,SAAwBD,GACtBN,EAASQ,KAAKF,GACdhH,OAAOmH,YAAYR,EAAa,MATpC,GA6BO,IAAMlG,GAAe,CAC1B2G,SAAU,EACVC,cAAe,IACfC,aAAc,IACdC,eAAgB,GAChBC,gBAAiB,IACjBC,SAAU,GACVC,SAAU,GACVC,oBAAoB,EACpBC,WAAW,EACXrC,eAAe,EACfsC,SAAU,KACVC,UAAW,EACXC,kBAAmB,GACnBC,MAAO,IACPC,KAAM,EACNC,SAAU,GACVC,iBAAkB,GAClBC,UAAU,EACV1F,KAAM,EACN2F,aAAc,IACdC,eAAgB,EAChBC,KAAM,KAsCJC,GAAW,IAAIC,aACfC,GAAO,GAELC,GAAaH,GAASI,aACtBC,GAAcL,GAASM,qBAC7B9I,OAAO2I,WAAaA,GACpBA,GAAWI,KAAKjJ,MAAQ,EACxB6I,GAAWK,QAAQH,IACnBA,GAAYG,QAAQR,GAASS,aAGtB,IAAMxF,GAAS,SAACyF,GACrBA,EAAG3L,MAAQkD,GAGX,IAseI0I,EA7cEC,EAAoB,SAAC5O,EAAGqL,EAAGwD,EAAIC,GACnC,GAAW,IAAPA,EAAU,CACD,IAAPD,IACFxD,EAAExI,EAAI7C,EAAI,EAAIqL,EAAExI,EAChBwI,EAAEzI,EAAI5C,EAAI,EAAIqL,EAAEzI,GAIlB,IAAImM,EAAO1D,EAAExI,EACbwI,EAAExI,EAAIwI,EAAEzI,EACRyI,EAAEzI,EAAImM,IA6DJC,EAAM,SAACC,EAAIC,GAAL,OAAYzQ,IAAE0Q,OAAOF,EAAI,SAACG,EAAKC,EAAKC,GAAX,OAAmBF,EAAMC,EAAMH,EAAGI,IAAM,IAuCvEC,EAAiC,SAACC,EAAIC,EAAIjC,EAAMC,EAAMM,EAAM2B,GAChE,IADkFC,EAlElD,SAAC9M,EAAGD,GAAJ,MAAW,CAC3CC,EAAc,IAAJA,EAAN,IACJD,EAAY,EAAJA,EAAJ,GAmEWgN,CAFN,GAAMpC,GAAQgC,EAAK,IAAOzB,EAC1B,GAAMN,GAAQgC,EAAK,IAAO1B,GAC5BlL,EAH2E8M,EAG3E9M,EAAGD,EAHwE+M,EAGxE/M,EACV,OAAO8L,EAAG3L,MAAM6K,SAlCO,SAACiC,EAAIC,EAAIJ,GAMhC,IALA,IAGI7M,EAAGD,EAFDmN,EAAI,CAAC,EAAE,GACT/P,EAAI,EAGCyB,EAAI,EAAGA,EAAIiO,IACjB7M,EAAQkN,EAD6B,GAClCnN,EAAKmN,EAD6B,GAEtCA,EAAE,GAAKlN,EAAIA,EAAID,EAAIA,EAAIiN,EACvBE,EAAE,GAAK,EAAIlN,EAAID,EAAIkN,IACfd,EAAIe,EAAGA,GATD,QAKuBtO,IAKjCzB,IAIF,OAAOA,GAAK0P,EACRA,EACA1P,EAAIiB,KAAK+O,KAAK/O,KAAK+O,KAAKhB,EAAIe,EAAEA,KAAO,EAkBrCE,CAAiBpN,EAAGD,EAAG8M,GA1DV,SAACQ,EAASC,EAAST,GAIpC,IAHA,IAAI7M,EAAI,EAAGD,EAAI,EACXwN,EAAO,EAEJvN,EAAIA,EAAID,EAAIA,EAAI,GAAKwN,EAAOV,GAAe,CAChD,IAAIW,EAAQxN,EAAIA,EAAID,EAAIA,EAAIsN,EAC5BtN,EAAI,EAAIC,EAAID,EAAIuN,EAChBtN,EAAIwN,EACJD,IAEF,OAAOA,EAiDHE,CAAWzN,EAAGD,EAAG8M,IAGjBa,EAAmB9R,IAAE+R,QAAQ,SAACvD,GAAD,OACjCxO,IAAEC,MAAMuO,EAAWA,GAChBrO,IAAI,SAAA6R,GAAC,OA3GmB,SAACxD,EAAUyD,GAWtC,IAPA,IAAMrF,EAAI,CAACxI,EAAG,EAAGD,EAAG,GAOXwI,EAAI,EAAGA,EAAI6B,EAAU7B,GAAK,EAAG,CACpC,IAAIyD,EAAK,EAAK6B,EAAO,EACjB5B,EAAK,GAAK4B,EAAO7B,GACrBD,EAAkBxD,EAAGC,EAAGwD,EAAIC,GAC5BzD,EAAExI,GAAKuI,EAAIyD,EACXxD,EAAEzI,GAAKwI,EAAI0D,EACX4B,GAAQ,EAEV,OAAOrF,EAwFKsF,CAAqB1D,EAAUwD,OA2BvCG,EAAkB,SAACC,GACvB,IAAMC,EAAaD,EAAInC,EAAG3L,MAAMkK,SAChC,OA7KyB,EA6KGhM,KAAK8P,IAAI,GAAID,EAAa,KAGlDE,EAA0BvS,IAAE+R,QAAQ,SAAC3R,GAAD,OACxCJ,IAAE,KACCC,QACAE,IAAI,SAAAoB,GAAC,OAAIiB,KAAKgQ,IAAI,EAAGjR,KACrBkR,UAAU,SAAAlR,GAAC,OAAInB,EAAImB,GAAK,IACxBmR,UAECC,EAA2B,SAAAC,GAA8B,IAA5BC,EAA4BD,EAA5BC,EAAG7F,EAAyB4F,EAAzB5F,EAAI8F,EAAqBjS,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAAAkS,EAIzD9C,EAAG3L,MAFLsK,EAF2DmE,EAE3DnE,SACAM,EAH2D6D,EAG3D7D,iBAGI8D,EAAST,EAAwBrD,GACjC+D,EAAMV,EAAwBvF,GAM9BN,EAAI,IAAMlK,KAAK+O,KAAKvE,EAAIiG,GACxBtG,EAAImG,EAAW,EAAI,IAAkC,IAA5BtQ,KAAKgQ,IAAIS,EAAMD,EAAQ,GAChDjG,EAAI+F,EACN,IACAD,IAAMjE,EAAW,EACf,GAAiC,IAA5BpM,KAAKgQ,IAAIS,EAAMD,EAAQ,GAElC,OAAO/C,EAAGnQ,MAAM4M,EAAGC,EAAGI,EAAG+F,EA5MN,GA4MgC,MAG/CI,EAA+B,SAACC,GAAoC,IAArBL,EAAqBjS,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACxEoP,EAAGhI,KAAK0K,EAAyBQ,EAAeL,KAG5CM,EAAmB,SAAChB,EAAG1F,EAAG2G,EAAc7E,GAC5C,IAAM8E,EAASlB,EAAI5D,EACb+E,EAAS7G,EAAI8B,EACnByB,EAAGuD,KAAKH,EAAajP,EAAIkP,EAAQD,EAAalP,EAAIoP,EAAQD,EAAQC,IAI9DE,EAAwB,SAACrB,EAAG1F,EAAGpI,GAAU,IAE3CkK,EAEElK,EAFFkK,SACAC,EACEnK,EADFmK,SAGIiF,EAAevB,EAAgBlC,EAAGvR,MAAQ,GAChDuR,EAAGyD,aAAaA,GAChBzD,EAAG0D,OAhOgB,GAkOnB,IAAMhH,EAAIiH,EAA8BnF,EAAS3N,OAAQmP,EAAGvR,MAAQ,EAAGuR,EAAGxR,QAE1EgQ,EAASoF,QAAQ,SAACC,EAAc9B,GAC9BkB,EAA6BY,GAE7B7D,EAAGhC,OAEDgC,EAAG8D,UAAU9D,EAAGvR,MAAQ,EAAG,GAC3B0U,EAAiBhB,EAAG1F,EAAGoH,EAActF,GAEvCyB,EAAG+D,MAEH/D,EAAGhC,OAEDgC,EAAG8D,UAAW9D,EAAGvR,MAAQ,EAAK,EAAG,GACjCuV,EAA8BhE,EAAGvR,MAAQ,EAAGiO,EAAGqF,GAEjD/B,EAAG+D,SAIDJ,EAAgC,SAACM,EAAM9B,EAAG1F,GAK9C,IAJA,IAAMyH,EAAO/B,EAAI1F,EACX0H,EAAsB5R,KAAK6R,KAAKF,EAAOD,GAEzCvH,EAAI,EACC3J,EAAI,EAAGA,EAAIoP,EAAGpP,IAErB,MADA2J,EAAIyF,EAAIpP,GACAoR,GAAR,CAIA,IAAME,EAAWlC,EAAIzF,EAIrB,GAHauH,EAAOI,EAGT3H,GAFMuH,EAAOI,EAEG,EAAI3H,EAAI,IAAMD,EACvC,MAGJ,OAAOC,GAGHsH,EAAgC,SAAC7B,EAAGzF,EAAGqF,GAC3C,IAAMuC,EAAanC,EAAIzF,EAEnBvI,EAAI4N,EAAIuC,EACNpQ,EAAI3B,KAAKC,MAAMuP,EAAIuC,GAGrBpQ,EAAI,IAAM,IACZC,EAAImQ,GAAcnQ,EAAI,IAGxB6L,EAAGuD,KAAKpP,EAAIuI,EAAGxI,EAAIwI,EAAGA,EAAGA,IAGrB6H,EAA8B,WAClCvE,EAAG3I,WAAW,IAGdmI,GAAKoE,QAAQ,SAAAY,GAAY,IAAV3E,EAAU2E,EAAV3E,KACbA,EAAKA,KAAK4E,sBAAsBnF,GAASoF,aACzC7E,EAAKA,KAAK8E,wBAAwB,EAAGrF,GAASoF,YAAc,MANtB,IAAAE,EAYpC5E,EAAG3L,MAFLiK,EAVsCsG,EAUtCtG,gBACAW,EAXsC2F,EAWtC3F,iBAGEO,GAAK3O,SAAWoO,IAtSpBO,GAAKoE,QAAQ,SAAA5U,GACb,IADe6V,EACf7V,EADe6V,IACf7V,EADoB6Q,KAElBgF,EAAIC,SAGNtF,GAAOzP,IAAEC,MAAMgQ,EAAG3L,MAAM4K,kBAAkB/O,IAAI,WAC5C,IAAM2U,EAAMvF,GAASyF,mBACflF,EAAOP,GAASI,aAKtB,OAJAG,EAAKA,KAAKjJ,MAAQ,EAClBiO,EAAI/E,QAAQD,GACZA,EAAKC,QAAQL,IACboF,EAAIG,QACG,CAACH,MAAKhF,UAGf/I,OAAO0I,KAAOA,IA2Rd,IAAMhB,EA3JqB,WAAM,IAAAyG,EAQ7BjF,EAAG3L,MANLkK,EAF+B0G,EAE/B1G,SACAI,EAH+BsG,EAG/BtG,SACAG,EAJ+BmG,EAI/BnG,KACAC,EAL+BkG,EAK/BlG,KACAE,EAN+BgG,EAM/BhG,iBACAI,EAP+B4F,EAO/B5F,KAIF,OAAOwC,EAAiBtD,GAAUrO,IAAI,SAAA6J,GAAc,IAAX5F,EAAW4F,EAAX5F,EAAGD,EAAQ6F,EAAR7F,EACpC0O,EAAI/B,EAA+B1M,EAAIoK,EAAUrK,EAAIqK,EAAUO,EAAMC,EAAMM,EAAMV,GACvF,MAAO,CACLxK,IACAD,IACA0O,IACA7F,EAAG6F,IAAMjE,EACL,EACApM,KAAKC,OAAQoQ,EAAI,GAAK3D,EAAoB,MAwIjCiG,GAEXlG,EAAWjP,IAAEyO,GAChBtO,IAAI,SAAAiV,GAAA,OAAAA,EAAEpI,IACNqI,OAAOrV,IAAEsV,UACTC,OACAC,OACAC,KAAKvG,GACL/O,IAAI,SAACuV,EAAS1S,GAAV,MAAgB,CAAC0S,EAAS,CAACC,IAAK,EAAGC,OAAQ5S,MAC/C6S,YACAhP,QAGH7G,IAAE8V,KAAK7G,EAAU,SAAA8G,EAA0CL,GAAY,IAApDM,EAAoDD,EAApDC,aAAcJ,EAAsCG,EAAtCH,OAAQK,EAA8BF,EAA9BE,gBACvCC,aAAaF,GACbE,aAAaD,GACbxG,GAAKmG,GAAQd,IAAIqB,UAAUzB,sBAAsBnF,GAASoF,aAC1DlF,GAAKmG,GAAQd,IAAIqB,UAAUvB,wBAAwBc,EAAUnH,EAAiBgB,GAASoF,YAAc,KAGvG1E,EAAGtJ,SAAS,SAAAyF,GACV,IAAMgK,EAAS7S,OAAA8I,EAAA,EAAA9I,CAAA,GACV6I,EADU,CAEbqC,WACAnC,eAAe,EACf2C,aAGF,OADAwE,EAAuBxD,EAAGvR,MAAQ,EAAGuR,EAAGxR,OAAQ2X,GACzCA,KA2BPC,EAAQ,EACNC,EAAa,SAACC,GAAO,IAClB9H,EAAYwB,EAAG3L,MAAfmK,SACDuD,EAAI/B,EAAG3L,MAAMmF,KAAOgF,EAAS3N,OAC7B0V,EAAc/H,EAASuD,GACvBK,EAAauB,EAA8BnF,EAAS3N,OAAQmP,EAAGvR,MAAQ,EAAGuR,EAAGxR,QAC7EiV,EAAevB,EAAgBlC,EAAGvR,MAAQ,GAEhDuR,EAAGyD,aAAaA,GA9BM,SAAC+C,EAAM9J,EAAG0J,GAAU,IAEpCK,EADazG,EAAG3L,MAAfmK,SAC0B4H,EAAQI,GAEzCvD,EAA6BwD,GAC7BzG,EAAG0D,OAnVgB,GAqVnB1D,EAAGhC,OAEDgC,EAAG8D,UAAU9D,EAAGvR,MAAQ,EAAG,GAC3B0U,EAAiBnD,EAAGvR,MAAQ,EAAGuR,EAAGxR,OAAQiY,EAAiBzG,EAAG3L,MAAMkK,UAEtEyB,EAAG+D,MAEH/D,EAAGhC,OAEDgC,EAAG8D,UAAW9D,EAAGvR,MAAQ,EAAK,EAAG,GACjCuV,EAA8BhE,EAAGvR,MAAQ,EAAGiO,EAAG0J,GAEjDpG,EAAG+D,MAYH2C,CAAgBlI,EAAS3N,OAAQuR,EAAYgE,GAC7CA,EAAQrE,EACR/B,EAAG0D,OAlXkC,GAkXO4C,EAAM,IAAK,EAAG,KAC1DrD,EAA6BsD,GAAa,GAE1CvG,EAAGhC,OAEDgC,EAAG8D,UAAU9D,EAAGvR,MAAQ,EAAG,GAC3B0U,EAAiBnD,EAAGvR,MAAQ,EAAGuR,EAAGxR,OAAQ+X,EAAavG,EAAG3L,MAAMkK,UAElEyB,EAAG+D,MAEH/D,EAAGhC,OAEDgC,EAAG8D,UAAW9D,EAAGvR,MAAQ,EAAK,EAAG,GACjCuV,EAA8BhE,EAAGvR,MAAQ,EAAG2T,EAAYL,GAE1D/B,EAAG+D,OAqDC4C,EAAe,WACnB,IAAMlK,EAAIuD,EAAGxR,OACP2T,EAAInC,EAAGvR,MAAQ,EAErBuR,EAAG4G,WAJsB,IAAAC,EAMc7G,EAAG3L,MAAlC2K,EANiB6H,EAMjB7H,SAAUC,EANO4H,EAMP5H,iBAElBlP,IAAE8V,KAAK7G,EAAU,SAAA8H,EAA6B/J,GAAM,IAA3BgK,EAA2BD,EAAhCpB,IAAgBC,EAAgBmB,EAAhBnB,OAC5BqB,EAAOvK,EAAIwC,EACX/K,EAAIuI,IAAMM,EAAI,GAAKkC,GACnBgI,EAAOzH,GAAKmG,GAAQ9F,KAAKA,KAAKjJ,MAAQuL,EAEtChF,EAAIuF,EAAyB,CAAEE,EAAG,EAAG7F,MAC3CiD,EAAGhI,KAAKgI,EAAGnQ,MAAMmQ,EAAGkH,IAAI/J,GAAI,IAAK,IACjC6C,EAAGuD,KAAK,EAAGrP,EAAGiO,EAAG6E,GAEjBhH,EAAGhI,KAAKmF,GACR6C,EAAGuD,KAAK,EAAGrP,EAAG+S,EAAMD,GACpBhH,EAAGhI,KAAK,KACRgI,EAAGuD,KAAKwD,EAAY5E,EAAGjO,EAAG,EAAG8S,MAK7BG,GAAY,EAwBhBnH,EAAGoH,QAAU,WACXnH,EAAOD,EAAGqH,SAAS,8BAGrBrH,EAAGsH,MAAQ,WACTtH,EAAGuH,aAAavH,EAAGpE,OAAQoE,EAAGtE,SAC9BsE,EAAGwH,UAAUxH,EAAGyH,KAChBzH,EAAG0H,SAASzH,GACZD,EAAG2H,iBAGL3H,EAAG2H,cAAgB,WAAwB,IAAvBC,EAAuBhX,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACnCiX,EAAM7H,EAAG8H,SAD0BC,EAQrC/H,EAAG3L,MALLqK,EAHuCqJ,EAGvCrJ,UACArC,EAJuC0L,EAIvC1L,cACAwC,EALuCkJ,EAKvClJ,kBACAM,EANuC4I,EAMvC5I,aACAC,EAPuC2I,EAOvC3I,eAGEwI,GACF5H,EAAG3L,MAAMuK,aAGMvC,IAAkBuL,EAC/B5H,EAAG3L,MAAMuK,UAAYC,IAAsB,EAC3CH,GAAamJ,EAAMzI,EAAiBD,KAGtCa,EAAG3L,MAAMmF,OACTwG,EAAG3L,MAAM+K,eAAiByI,EAlIT,SAACvB,GAAO,IAAA0B,EASvBhI,EAAG3L,MAPL6J,EAFyB8J,EAEzB9J,SACAC,EAHyB6J,EAGzB7J,cACAC,EAJyB4J,EAIzB5J,aACAC,EALyB2J,EAKzB3J,eACAG,EANyBwJ,EAMzBxJ,SACAQ,EAPyBgJ,EAOzBhJ,SACAxF,EARyBwO,EAQzBxO,KAGFmG,GAAYsI,IAAIrR,MAAQsH,EAExB,IACOnB,EAAKyB,EADFhF,EAAOgF,EAAS3N,QACnBkM,EAEP,GAAIA,EAAI,EAAG,CACT,IAAM0I,EAAUzG,EAASjC,GAEvB2I,EAIED,EAJFC,IACAK,EAGEN,EAHFM,aACAJ,EAEEF,EAFFE,OACAK,EACEP,EADFO,gBAEKnG,EAAQL,GAAKmG,GAAb9F,KAGDqI,EADYnY,IAAEoY,SAASpC,GACAL,EAAM7F,EAAKA,KAAKjJ,MAIvCwR,EAAa,GAAM7V,KAAK8P,IAAI,EAAG6F,EAAW9J,GAAgB,EAAI8J,IACpEzC,EAAQC,IAAM0C,EAEdnC,aAAaF,GACbE,aAAaD,GACbnG,EAAKA,KAAK4E,sBAAsB,GAChC5E,EAAKA,KAAK8E,wBAAwByD,EAAY9I,GAASoF,YAAcrG,EAAiB,KAEtFoH,EAAQM,aAAesC,WAAW,WAChCxI,EAAKA,KAAKyI,6BAA6B,KAAShJ,GAASoF,YAAcvG,EAAgB,KACvFsH,EAAQM,aAAe,KAEvBN,EAAQO,gBAAkBqC,WAAW,WACnC5C,EAAQC,IAAM,GACbvH,IACFE,IAqFHkK,IAGGX,GAAqC,IAAvB5H,EAAG3L,MAAMuK,WAAiB9H,OAAOiH,eAAeiC,EAAG2H,gBAGxE,IAAIa,EAAW,EACfxI,EAAGyI,KAAO,WAAM,IAAAC,EAKV1I,EAAG3L,MAHLqK,EAFYgK,EAEZhK,UACArC,EAHYqM,EAGZrM,cAHYqM,EAIZ9J,UAGEvC,GACFkI,IAKExU,IAAE4Y,MAAM,EACTtM,EACD2D,EAAG3L,MAAMmF,OAASgP,MAElBnC,EAAW,GACXmC,EAAWxI,EAAG3L,MAAMmF,MAGlBkF,GAAWiI,IAlFV3G,EAAG3L,MAAMqK,WAAcsB,EAAG3L,MAAMoK,mBAa/B0I,IACFR,IACAnD,EAAsBxD,EAAGvR,MAAQ,EAAGuR,EAAGxR,OAAQwR,EAAG3L,OAClD8S,GAAY,IAfdA,GAAY,EACZnH,EAAG3I,WAAW,EAAG,IACjB2I,EAAG4I,SACH5I,EAAG0D,OAAO,IAAK,IAAK,IACpB1D,EAAG6I,SAAS,IACZ7I,EAAG1L,KAAK,qBAAsB,EAAG0L,EAAGxR,OAAS,EAAI,GAAIwR,EAAGvR,MAAOuR,EAAGxR,QAClEwR,EAAG1L,KAAK,kCAAmC,EAAG0L,EAAGxR,OAAS,EAAI,GAAIwR,EAAGvR,MAAOuR,EAAGxR,QAC/EwR,EAAG1L,KAAK,iCAAkC,EAAG0L,EAAGxR,OAAS,EAAI,GAAIwR,EAAGvR,MAAOuR,EAAGxR,QAC9EwR,EAAG6I,SAAS,IACZ7I,EAAG8I,UAAU9I,EAAG+I,QAChB/I,EAAG1L,KAAK,oBAAqB,EAAG0L,EAAGxR,OAAS,EAAGwR,EAAGvR,MAAOuR,EAAGxR,UAgFhEwR,EAAGgJ,YAAc,WACfhJ,EAAGtJ,SAAS,SAAAyF,GAAa,IACfuC,EAAcvC,EAAduC,UASR,OARKA,GAAgC,YAAnBY,GAASjL,OACzBiL,GAAS2J,SAGPvK,GAAgC,YAAnBY,GAASjL,OACxBiL,GAAS4J,UAGJ5V,OAAA8I,EAAA,EAAA9I,CAAA,GAAK6I,EAAZ,CAAuBuC,WAAYvC,EAAUuC,wDCrqB7CyK,GAAYC,aAAW,CAC3BC,MAAO,CACLhS,WAAY,kBACZiS,cAAe,MAyUbC,GAAa,SAAAxP,GAYb,IAAAyP,EAAAzP,EAXJ0P,kBAWI,IAAAD,EAXS,EAWTA,EAAAE,EAAA3P,EAVJ4P,aAUI,IAAAD,KAAAE,EAAA7P,EATJ8P,uBASI,IAAAD,KAAAE,EAAA/P,EARJgQ,aAQI,IAAAD,EARI,GAQJA,EAAAE,EAAAjQ,EAPJkQ,WAOI,IAAAD,EAPEE,OAAOC,UAOTH,EAAAI,EAAArQ,EANJsI,WAMI,IAAA+H,EANEF,OAAOG,UAMTD,EAAAE,EAAAvQ,EALJwQ,iBAKI,IAAAD,EALQ,EAKRA,EAJJ1P,EAIIb,EAJJa,eAII4P,EAAAzQ,EAHJ0Q,YAGI,IAAAD,EAHG,IAGHA,EAFJ7P,EAEIZ,EAFJY,YACA+P,EACI3Q,EADJ2Q,SAKMC,EAAe,SAAAhK,GAAG,OAAIpO,KAAK8P,IAAI9P,KAAK0X,IAAIN,EAAQpX,KAAKgL,MAAMoD,GAAOA,EAAK0B,GAAM4H,IAE7EW,EAAa,SAAAjK,GACjB,IAAMkK,EAAOF,EAAahK,GACpBmK,EAAUvY,KAAK+O,KAAKuJ,GACpBE,EAAMxY,KAAKC,MAAMsY,GAEvB,MAAO,CACLE,IAAKzY,KAAKC,MAXI,MAWesY,EAAUC,IACvCA,MACAE,eAAgBJ,IAdhBrQ,EAkBsBC,mBAAS,kBAAMmQ,EAAWnB,KAlBhD/O,EAAApH,OAAAiG,EAAA,EAAAjG,CAAAkH,EAAA,GAkBGnG,EAlBHqG,EAAA,GAkBUhE,EAlBVgE,EAAA,GAoBJjB,oBAAU,WACR1J,IAAEmb,MAAM,kBAAMxU,EAASkU,EAAWnB,OACjC,IAyBH,OACEla,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACV6b,KAAI,KAAAzb,OAAO+a,EAAO,GAAd,MACJjc,OAAQic,EAAO,GACfW,aAAc,KAEd7b,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACVd,OAAQ,QAETub,GAAK,GAAAra,OAAOgb,EAAP,MAAAhb,OAAoBiL,EAAY+P,KAGtCnb,EAAAC,EAAAC,cAAA,OACEH,MAAO,CACL+b,WAAY,GACZzc,SAAU,YAEZ0c,YAAa,WACX3Q,EAAY0B,cAAgBwN,IAG9Bta,EAAAC,EAAAC,cAAC8b,EAAA/b,EAAD,CACEgc,UAAWnX,EAAM2W,IACjB3I,IAAK,EACL4H,IAAKwB,KACLC,UAAU,OACVC,SAAU,GACV5B,MAAM,wBACN6B,iBACErc,EAAAC,EAAAC,cAAA,SACEoc,KAAK,SACLvc,MAAO,CACL+H,WAAY,OACZyU,OAAQ,OACRjc,MAAO,QACPxB,SAAQ,GAAAqB,OAAK+a,EAAO,IAAZ,MACR3b,KAAM,MACNid,WAAY,OACZC,UAAW,SACXpd,SAAU,WACVka,UAAW,SACXmD,IAAK,MACLxd,MAAO,MACPyd,OAAQ,GAEVtV,MAAO+S,EAAQtV,EAAM4W,eAAiB5W,EAAM4W,eAAekB,YAAY5B,GACvEnT,SAAU,SAAAgV,GACR1V,EAASpD,OAAA8I,EAAA,EAAA9I,CAAA,GACJe,EADG,CAEN4W,eAAgBf,OAAOkC,EAAGvV,OAAOD,WAGrCyV,UAAW,SAAA1J,GACT,GAAY,UADUA,EAAVnS,IACS,CACnB,IAAM2V,EAAYyE,EAAWvW,EAAM4W,gBACnCvU,EAASyP,GACTpW,IAAEmb,MAAM,WACNxU,EAASyP,GAETvL,EAAe,SAAAvG,GAAK,IAAAiY,EAAA,OAAAhZ,OAAA8I,EAAA,EAAA9I,CAAA,GACfe,GADeiY,EAAA,GAAAhZ,OAAAiZ,EAAA,EAAAjZ,CAAAgZ,EAEjB5B,EAAWvE,EAAU8E,gBAFJ3X,OAAAiZ,EAAA,EAAAjZ,CAAAgZ,EAAA,gBAGHzC,GAHGyC,YAW9BlV,SA7Fa,SAAAuF,GAAK,IACjBqO,EAAY3W,EAAZ2W,IAAKD,EAAO1W,EAAP0W,IAGNyB,EAFa7P,GAAK,GAAKA,EAzBb,KACY,GAwBkBqO,EAzB9B,UACY,EA2BxBD,EAAM,EAFSC,GAAO,GAAKA,EA1Bf,KACY,GAyBsBrO,EA1BlC,UACY,EA6BtBoO,EAAM,EACNA,EAEAF,EAAOF,EAAapY,KAAKgQ,IAAI,EAAGiK,EAAU7P,EAjChC,OAuChBjG,EALkB,CAChBsU,IAAKrO,EACLoO,IAAKyB,EACLvB,eAAgBJ,IAGlBjQ,EAAe,SAAAvG,GAAK,OAAAf,OAAA8I,EAAA,EAAA9I,CAAA,GACfe,EADef,OAAAiZ,EAAA,EAAAjZ,CAAA,GAEjBoX,EAAWG,OA2ER4B,kBAAmBjQ,GAASnI,EAAM0W,IAAM,GAAI,EAAG,GAC/C2B,gBAAiBlQ,IAAUnI,EAAM0W,IAAM,GAAK,GAAI,EAAG,GACnD4B,gBAAgB,OAChBC,WAAW,OACXpe,OAAQic,EACRhc,MAAOgc,OASFoC,GA7ZI,WAAM,IAAAC,EAMnBxS,GAAMC,GAAQhD,IAJhB8D,EAFqByR,EAErBzR,IACAN,EAHqB+R,EAGrB/R,eACAJ,EAJqBmS,EAIrBnS,YACAC,EALqBkS,EAKrBlS,eAGF9D,OAAOiE,eAAiBA,EAExB,IAAMgS,EAlEgB,SAAChS,GAAD,OAAoB,SAACiS,GAAD,OAAY,WACvC,gBAAXA,EAKJjS,EAAerE,SAAS,SAAAyF,GAAa,IAEjCoC,EAMEpC,EANFoC,SACAE,EAKEtC,EALFsC,mBACApC,EAIEF,EAJFE,cACAyC,EAGE3C,EAHF2C,KACAC,EAEE5C,EAFF4C,KACAM,EACElD,EADFkD,KAEI4N,EAAW,GAAM5N,EAEjB8G,EAAY,CAChB+G,SAAU,CAACpO,KAAMA,EAAOmO,GACxBE,UAAW,CAACrO,KAAMA,EAAOmO,GACzBG,OAAQ,CAACrO,KAAMA,EAAOkO,GACtBI,SAAU,CAACtO,KAAMA,EAAOkO,GACxBK,OAAQ,CAAC/O,SAAUhM,KAAKgQ,IAAI,EAAGhQ,KAAK+O,KAAK/C,GAAY,IACrDgP,OAAQ,CAAChP,SAAUhM,KAAK8P,IAAI,IAAK9P,KAAKgQ,IAAI,EAAGhQ,KAAK+O,KAAK/C,GAAY,KACnEiP,mBAAoB,CAAC/O,oBAAqBA,EAAoBpC,iBAC9DoR,OAAQ,CAACpO,KAAMA,GAAQ,GAAK,IAC5BqO,QAAS,CAACrO,KAAU,GAAJA,IAChB2N,GAEF,OAAO1Z,OAAA8I,EAAA,EAAA9I,CAAA,GACF6I,EADL,CAEEE,eAAgBtM,IAAE4d,QAAQxH,IACvBA,KA9BLpL,EAAeiO,gBAgEI4E,CAAgB7S,GAErCtB,oBAAU,WAER,GADAoU,SAASC,MAAQ,kBACb/S,EAAgB,CAClB,IAAMgT,EAlCU,SAAChB,GAAD,OAAkB,SAACvY,GAAQ,IAExC+B,EAAuB/B,EAAvB+B,KAAMyX,EAAiBxZ,EAAjBwZ,SAAUxd,EAAOgE,EAAPhE,IAEvB,GAAa,UAAT+F,EAAJ,CAKA,IAAM0X,EAAY,CAChBC,UAAa,kBAAMF,EAAW,UAAY,YAC1CG,UAAa,kBAAMH,EAAW,SAAW,YACzCI,WAAc,kBAAMJ,EAAW,SAAW,aAC1CK,QAAW,kBAAML,EAAW,SAAW,WACvCxd,GAEEyd,GAAWlB,EAAakB,IAAblB,QAXbA,EAAaiB,EAAW,qBAAuB,cAA/CjB,IA6BkBuB,CAAcvB,GAE9B,OADAjW,OAAOC,iBAAiB,UAAWgX,GAC5B,WACLjX,OAAOG,oBAAoB,UAAW8W,MAGzC,CAAChT,IArBmB,IAuBhBnD,EAAqBoB,GAAa,WACnC+B,IACGA,EAAe1G,MAAMqK,WACxB9D,EAAe,SAAAvG,GAAK,OAAAf,OAAA8I,EAAA,EAAA9I,CAAA,GACfe,EADe,CAElBqK,WAAW,MAGf3D,EAAe4M,eAAc,KAE9B,WACD/M,EAAe,SAAAvG,GAAK,OAAAf,OAAA8I,EAAA,EAAA9I,CAAA,GACfe,EADe,CAElBqK,WAAW,OAEZ,SAAC6P,GACF,GAAIxT,EAAgB,KACV8D,EAAsB9D,EAAe1G,MAArCwK,kBACR9D,EAAe1G,MAAMuK,UAAY2P,EACjCxT,EAAe1G,MAAMmF,KAAOjH,KAAKC,MAAM+b,EAAO1P,MAnB3CjH,kBAuBP,OAAQrI,EAAAC,EAAAC,cAAAF,EAAAC,EAAAsD,SAAA,KACNvD,EAAAC,EAAAC,cAAA,OACE4L,IAAKA,EACL/L,MAAO,CACLkf,UAAW,QACXnX,WAAY,4FACZ7I,OAAQ,OACRC,MAAO,WAIXc,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACV+C,OAAQ,GACRC,MAAO,GACPwB,QAAS,EACTlF,SAAU,WACVka,UAAW,SACXoD,OAAQ,OAENvR,EAAY8D,oBACZlP,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,uBAA9B,OAEExd,EAAAC,EAAAC,cAACkf,EAAAnf,EAAD,MAFF,YAOFD,EAAAC,EAAAC,cAACmf,GAAA,EAAD,CACEC,OAAO,SACP3f,QAASia,KACTtZ,MAAM,cACNif,KAAMnU,EAAY8D,mBAClBsQ,QAAShC,EAAa,sBACtBiC,QAAQ,cAKRzf,EAAAC,EAAAC,cAACwf,GAAA,EAAD,CAAaC,WAAS,EAACzE,KAAK,SAC1Blb,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,gBAC1BpS,EAAY+D,UAAwCnP,EAAAC,EAAAC,cAAC0f,EAAA3f,EAAD,MAA5BD,EAAAC,EAAAC,cAAC2f,EAAA5f,EAAD,OAG5BD,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,uBAA9B,kBAKFxd,EAAAC,EAAAC,cAACwf,GAAA,EAAD,CAAaC,WAAS,EAACzE,KAAK,SAE1Blb,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,WAC5Bxd,EAAAC,EAAAC,cAAC4f,EAAA7f,EAAD,OAGFD,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,WAC5Bxd,EAAAC,EAAAC,cAAC6f,EAAA9f,EAAD,OAGFD,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,WAC5Bxd,EAAAC,EAAAC,cAAC8f,EAAA/f,EAAD,OAGFD,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,WAC5Bxd,EAAAC,EAAAC,cAAC+f,GAAAhgB,EAAD,QAKJD,EAAAC,EAAAC,cAACwf,GAAA,EAAD,CAAaC,WAAS,EAACzE,KAAK,SAE1Blb,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,aAC5Bxd,EAAAC,EAAAC,cAACggB,EAAAjgB,EAAD,OAGFD,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,aAC5Bxd,EAAAC,EAAAC,cAACigB,EAAAlgB,EAAD,OAGFD,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,cAC5Bxd,EAAAC,EAAAC,cAACkgB,EAAAngB,EAAD,OAGFD,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,YAC5Bxd,EAAAC,EAAAC,cAACmgB,GAAApgB,EAAD,QAKJD,EAAAC,EAAAC,cAAA,WAEAF,EAAAC,EAAAC,cAACogB,GAAD,CACEpG,WAAY,GACZI,iBAAe,EACfE,MAAM,6BACNW,SAAU,kBACV/P,YAAaA,EACbC,eAAgBA,IAIlBrL,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACVf,QAAS,OACTyF,SAAU,OACVrF,eAAgB,iBAGhBY,EAAAC,EAAAC,cAACogB,GAAD,CACEpG,WAAY,GACZE,OAAK,EACLE,iBAAe,EACfE,MAAM,qBACNE,IAAK,KACL5H,IAAK,EACLkI,UAAW,EACX3P,eAAgBA,EAChB6P,KAAM,IACN9P,YAAaA,EACb+P,SAAU,qBAGZnb,EAAAC,EAAAC,cAACogB,GAAD,CACEpG,WAAY,KACZE,OAAK,EACLE,iBAAe,EACfE,MAAM,wBACNE,IAAK,KACL5H,IAAK,GACLzH,eAAgBA,EAChB6P,KAAM,IACN9P,YAAaA,EACb+P,SAAU,aAGX9S,EACCrI,EAAAC,EAAAC,cAACogB,GAAD,CACErf,IAAKoH,EACL+R,OAAK,EACLtH,IAAK,EACL4H,IAAK,KACLR,WAAY,GACZM,MAAM,uBACNU,KAAM,IACNC,SAAU,oBACV/P,YAAaA,EACbC,eAAgBA,IAGlBrL,EAAAC,EAAAC,cAACogB,GAAD,CACErf,IAAKoH,EACL6R,WAAY,IACZM,MAAM,qBACNU,KAAM,IACNC,SAAU,eACV/P,YAAaA,EACbC,eAAgBA,IAIpBrL,EAAAC,EAAAC,cAACogB,GAAD,CACEpG,WAAY,GACZM,MAAM,uBACNU,KAAM,IACNC,SAAU,iBACV/P,YAAaA,EACbC,eAAgBA,IAElBrL,EAAAC,EAAAC,cAACogB,GAAD,CACEpG,WAAY,IACZM,MAAM,sBACNU,KAAM,IACNC,SAAU,gBACV/P,YAAaA,EACbC,eAAgBA,IAGlBrL,EAAAC,EAAAC,cAACogB,GAAD,CACEpG,WAAY,IACZM,MAAM,gBACNQ,UAAW,EACXE,KAAM,IACNC,SAAU,eACV/P,YAAaA,EACbC,eAAgBA,KAIpBrL,EAAAC,EAAAC,cAACwf,GAAA,EAAD,CAAaC,WAAS,EAACzE,KAAK,SAC1Blb,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,gBAC1BpS,EAAY+D,UAAwCnP,EAAAC,EAAAC,cAAC0f,EAAA3f,EAAD,MAA5BD,EAAAC,EAAAC,cAAC2f,EAAA5f,EAAD,OAG5BD,EAAAC,EAAAC,cAACgf,GAAA,EAAD,CAAQC,QAAS3B,EAAa,uBAA9B,sBCtTK+C,GARE,kBACfvgB,EAAAC,EAAAC,cAACkE,EAAD,CACER,UAAW,GACXC,YAAa,CAAC,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,IAClCC,OAAQ,CAAC,EAAG,EAAG,EAAG,MCJhBkE,GAAe,CACnBwY,iBAAajf,GAQAgI,gBAAWC,IAAOxB,GALjB,CACdyY,eAAgB,SAAC3X,EAAO0X,GAAR,OACd1X,EAAM3B,SAAS,CAACqZ,iDCiCLE,GArCH,WAAM,IAAAC,EAESC,GACvB,SAAAnhB,GAAA,MAAoB,CAAC+gB,YAArB/gB,EAAE+gB,cACF,SAAA5X,GAAO,OAAIA,IAJGiY,EAAA9c,OAAAiG,EAAA,EAAAjG,CAAA4c,EAAA,GAET7b,EAFS+b,EAAA,GAEFjY,EAFEiY,EAAA,GAqBVC,IAAYhc,EAAM0b,YAExB,OACExgB,EAAAC,EAAAC,cAAAF,EAAAC,EAAAsD,SAAA,KACEvD,EAAAC,EAAAC,cAAC6gB,GAAA,EAAD,CACEC,KAAK,QACL1gB,MAAM,UAEN6e,QAAS2B,EAbW,WACxBhc,EAAM0b,YAAYS,YAAY5M,QAAQ,SAAA6M,GAAE,OAAIA,EAAG3L,SAC/C3M,EAAQ6X,oBAAelf,IAXA,WACvB4f,UAAUC,aAAaC,aAAa,CAClCC,OAAO,EACPC,OAAO,IACNC,KAAK,SAAAhB,GACN5X,EAAQ6X,eAAeD,OAmBpBM,EAAU9gB,EAAAC,EAAAC,cAACuhB,GAAA,EAAD,MAAoBzhB,EAAAC,EAAAC,cAACwhB,GAAA,EAAD,6BCoMxBC,GApOE,kBACf3hB,EAAAC,EAAAC,cAAA,OAAKL,UAAU,kBAAkBE,MAAO,CAAC6hB,UAAW,cAAeC,QAAQ,eACzE7hB,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,ggBACRxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,6LACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,4MACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,+MACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,gQACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,uSACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,6LACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,4MACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,gQACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,sTACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,yLACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,qPACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,kSACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,wQACJxS,EAAAC,EAAAC,cAAA,WACE4hB,OAAO,2PACT9hB,EAAAC,EAAAC,cAAA,QACEsS,EAAE,6LACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,8GACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,8PACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,4fACJxS,EAAAC,EAAAC,cAAA,WACE4hB,OAAO,qNACT9hB,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mgCACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,kQACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,6NACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,utIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oLACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,ySACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0KACJxS,EAAAC,EAAAC,cAAA,WACE4hB,OAAO,wLACT9hB,EAAAC,EAAAC,cAAA,QACEsS,EAAE,2OACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0WACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,ibACJxS,EAAAC,EAAAC,cAAA,UAAQ0R,GAAG,QAAQC,GAAG,UAAUxE,EAAE,UAClCrN,EAAAC,EAAAC,cAAA,QACEsS,EAAE,ugCACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,ggBACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,qhBACJxS,EAAAC,EAAAC,cAAA,WACE4hB,OAAO,sYACT9hB,EAAAC,EAAAC,cAAA,QACEsS,EAAE,scACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,wOACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,gVACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0HACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0KACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,2fACJxS,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,WAAS4hB,OAAO,saACnB9hB,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,WAAS4hB,OAAO,+MACnB9hB,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,WAAS4hB,OAAO,qNACnB9hB,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,ixBACXxS,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,WACpDe,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,UACpDe,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,OACpDe,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,WACpDe,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,UAAUD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,UACnDe,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,SAASzF,MAAM,QAAQD,OAAO,WACnDe,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,WACpDe,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,gQACTxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,uRACNxS,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,yRACTxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,2jEACNxS,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,WAAS4hB,OAAO,oaACnB9hB,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,gaACXxS,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,oHACTxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,sHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,gIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,+IACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,sIACJxS,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,MACpDe,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,MACpDe,EAAAC,EAAAC,cAAA,QACEsS,EAAE,4OACNxS,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,mIACTxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,iIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,gIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,iIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,uHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,iIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,yHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,iJACJxS,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,SAASzF,MAAM,QAAQD,OAAO,MACnDe,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,SAASzF,MAAM,QAAQD,OAAO,MACnDe,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0PACNxS,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,8HACTxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0NACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,8HACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,iHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,iIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,uHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,2GACNxS,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,kIACTxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,qIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oIACJxS,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,MACpDe,EAAAC,EAAAC,cAAA,QAAM0E,EAAE,WAAWD,EAAE,UAAUzF,MAAM,QAAQD,OAAO,MACpDe,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0NACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,8HACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mIACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,uKACNxS,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,yUACTxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,gVACNxS,EAAAC,EAAAC,cAAA,SAAGF,EAAAC,EAAAC,cAAA,QAAMsS,EAAE,oHACTxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,iHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,iHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,kHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,iHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,mHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,oHACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0WACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0WACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0WACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,0WACJxS,EAAAC,EAAAC,cAAA,QACEsS,EAAE,gYC5FKuP,GA9HF,WAAM,IAAAlY,EAEQC,GACvB,SAAArK,GAAA,MAMO,CACLyI,aAPFzI,EACEyI,aAOAC,0BARF1I,EAEE0I,0BAOAC,qBATF3I,EAGE2I,qBAOAE,aAVF7I,EAIE6I,aAOAK,cAXFlJ,EAKEkJ,gBAQF,SAAAC,GAAO,OAAIA,IAhBImB,EAAAhG,OAAAiG,EAAA,EAAAjG,CAAA8F,EAAA,GAEV/E,EAFUiF,EAAA,GAEHnB,EAFGmB,EAAA,GAoBf7B,EAKEpD,EALFoD,aACAC,EAIErD,EAJFqD,0BACAC,EAGEtD,EAHFsD,qBACAE,EAEExD,EAFFwD,aAEExD,EADF6D,cAGFuB,oBAAU,WACR8X,WAAQC,OAAO,SAACC,GACVA,EAAK7X,QAAQ8X,MAAMD,IAErB7X,QAAQC,IAAI,oBACZ1B,EAAQC,gBAAgBmZ,WAAQI,QAChCxZ,EAAQG,iBAAiBiZ,WAAQK,YAElC,IACF,IAGH,IAAMC,EAAa,SAACrd,GACkCA,EAA7C9D,KAAOohB,OAAsCtd,EAA1Bud,YAA0Bvd,EAARqX,MAOxCnS,EAAkB,SAAClF,KA/CRwd,EAwD+BjZ,IAAM0B,SAAS,MAxD9CwX,EAAA3e,OAAAiG,EAAA,EAAAjG,CAAA0e,EAAA,GAwDVE,EAxDUD,EAAA,GAwDQE,EAxDRF,EAAA,GA0DXG,EAA4B,eAACC,EAADzhB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,UAAyB,SAAAmJ,GAAuB,IAApBuY,EAAoBvY,EAApBuY,cAC5DH,EAAoBG,GACpBna,EAAQka,EAAc,4BAA8B,4BAShDE,EAAwB,SAACC,GAAD,IAAYH,EAAZzhB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,UAAoC,SAAA+R,GAAuB,IAApB2P,EAAoB3P,EAApB2P,cACnEH,EAAoBG,GAEpB,IAAMza,EAAeJ,EAAa+a,GAClCra,EAAQka,EAAc,4BAA8B,0BAChDA,GACFxa,EAAasC,YAAY,QAAS,MAAOT,GACzCvB,EAAQO,qBAAqBb,KAE7BM,EAAQQ,gBAAgBd,GACxBA,EAAasC,YAAY,SAAU,MAAO0X,GAC1Cha,EAAasC,YAAY,UAAW,MAAO0X,MAK/C,OACEtiB,EAAAC,EAAAC,cAAAF,EAAAC,EAAAsD,SAAA,KACEvD,EAAAC,EAAAC,cAAC6gB,GAAA,EAAD,CACEC,KAAK,QACL1gB,MAAM,UACN4iB,aAAW,cACX/D,QAAS0D,GAA0B,IAEnC7iB,EAAAC,EAAAC,cAACijB,GAAD,OAGFnjB,EAAAC,EAAAC,cAAC6gB,GAAA,EAAD,CACEC,KAAK,QACL1gB,MAAM,UACN4iB,aAAW,cACX/D,QAAS0D,GAA0B,IAEnC7iB,EAAAC,EAAAC,cAACkjB,GAAA,EAAD,OAGFpjB,EAAAC,EAAAC,cAACmjB,GAAA,EAAD,CACEtM,GAAG,cACHuM,SAAUX,EACVpD,KAAMnX,GAAwBD,EAC9BqX,QA9CsB,eAACsD,EAADzhB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,UAAyB,WACnDgJ,QAAQC,IAAI,QAASwY,EAAc,4BAA8B,wBACjEla,EAAQka,EAAc,4BAA8B,0BACpDF,EAAoB,OA2CPW,CAAoBpb,IAE5BD,EAAavH,IAAI,SAAAsU,EAAS5D,GAAT,IAAEmS,EAAFvO,EAAEuO,KAAF,OAChBxjB,EAAAC,EAAAC,cAACujB,GAAA,EAAD,CACExiB,IAAKuiB,EACLrE,QAAS6D,EAAsB3R,EAAKlJ,GACpCub,SAAUtb,GAAwBob,IAAShjB,IAAEmjB,IAAIrb,EAAc,SAE9Dkb,QC3HAxb,GAAe,CAC1B4G,cAAe,IACfC,aAAc,IACdC,eAAgB,IAChBC,gBAAiB,IACjBC,SAAU,GACVC,SAAU,GACVC,oBAAoB,EACpBC,WAAW,EACXrC,eAAe,EACfsC,SAAU,KACVC,UAAW,EACXC,kBAAmB,GACnBC,MAAO,IACPC,KAAM,EACNC,SAAU,GACVC,iBAAkB,GAClBC,UAAU,EACV1F,KAAM,EACN2F,aAAc,IACdC,eAAgB,EAChBC,KAAM,KAsCJC,GAAW,IAAIC,aAGbE,GAAaH,GAASI,aAC5B5I,OAAO2I,WAAaA,GACpBA,GAAWI,KAAKjJ,MAAQ,EACxB6I,GAAWK,QAAQR,GAASS,aAGrB,IAAMxF,GAAS,SAACyF,GACrBA,EAAG3L,MAAQkD,GAEX,IAmBI0I,EACJD,EAAGoH,QAAU,WACXnH,EAAOD,EAAGqH,SAAS,8BAIrB,IAEI5K,EAAG0F,EAEHJ,EAAGzQ,EAJD6hB,EAAmB,EAAV5gB,KAAK6gB,GAIVC,EAAK,EAEd/hB,EAAS,EAANyQ,EAAS,EAEb/B,EAAGsH,MAAQ,WACTtH,EAAGuH,aAAavH,EAAGpE,OAAQoE,EAAGtE,SAC9BsE,EAAGsT,UAAUtT,EAAGuT,KAChBvT,EAAGwH,UAAUxH,EAAGyH,IAAK,KACrBzH,EAAG0H,SAASzH,IAGd,IAAIzI,EAAQ,GACZwI,EAAGwT,SAAW,WAQZ,GAPA5Z,QAAQC,IAAImG,EAAGxP,KAOA,UAAXwP,EAAGxP,IAAiB,CAEtB,IAAMijB,EAAMjc,EAAMkc,KAAK,IAAIC,MAAM,KAAKzjB,IAAI,SAAAwM,GAAC,OAAIkX,SAASlX,EAAG,MAE3D2W,EAAK,EAJiB,IAAAQ,EAAAvgB,OAAAiG,EAAA,EAAAjG,CAKTmgB,EALS,GAMtB,GADC1R,EALqB8R,EAAA,GAKlBviB,EALkBuiB,EAAA,KAKfR,EALeQ,EAAA,IAMb,KAAAC,EAAAxgB,OAAAiG,EAAA,EAAAjG,CACEmgB,EADF,GACNniB,EADMwiB,EAAA,GACH/R,EADG+R,EAAA,GAEPT,EAAK,EAEPzZ,QAAQC,IAAIkI,EAAGzQ,EAAG+hB,GAClBzZ,QAAQC,IAAIsI,EAAG1F,GAEfjF,EAAQ,QAERA,EAAMwG,KAAKgC,EAAGxP,KAKhB,OAAO,GAGT,IAGIoM,EAHAmX,EAAQ,EACRC,EAAK,EACLC,EAAK,EAIHC,EAAW,SAAAna,GAA8B,IAA3B8Q,EAA2B9Q,EAA3B8Q,KAA2BsJ,EAAApa,EAArBga,aAAqB,IAAAI,EAAb,EAAaA,EAAVjN,EAAUnN,EAAVmN,IAC7BkN,EAAKjB,EAHI,IAIfnT,EAAGhC,OACHgC,EAAG8D,UAAU3B,EAAE,EAAG1F,EAAE,GACpB,IAAI,IAAIQ,EAAI,EAAGA,EAAIkW,EAASiB,EAAInX,GAAKmX,EACnCpU,EAAG0D,OACDwD,EACA,IACA2D,GAAS,GAAK,GAAKtY,KAAK8hB,IAAIpX,EAAI4N,GAChC,KAIFmJ,GADApX,EAAIuF,EAAI1F,GACClK,KAAK8hB,IAAIpX,EAAI8W,GACtBE,EAAKrX,EAAIrK,KAAK+hB,IAAIrX,EAAI8W,GAEtB/T,EAAGuU,KAAK,EAAG,EAAGP,EAAIC,GAEpBjU,EAAG+D,OAIL/D,EAAGyI,KAAO,WACRzI,EAAGwU,QACHxU,EAAG3I,WAAW,EAAG,EAAG,GACpBoF,EAAIuD,EAAGxR,OACP2T,EAAInC,EAAGvR,MAGPslB,EAAQ/T,EAAG8H,UAAY,KAAM/F,GAE7BmS,EAAS,CACPrJ,KAAM9I,EACNmF,IAAK,EACL6M,UAGFG,EAAS,CACPrJ,KAAM9I,EAAIzQ,EAAIyQ,EACdmF,IAAK,GACL6M,MAAe,EAARA,IAGTG,EAAS,CACPrJ,KAAM9I,EAAIsR,EAAK/hB,EACf4V,IAAK,IACL6M,MAAe,EAARA,IAOT/T,EAAGsT,UAAUtT,EAAGyU,OAChBzU,EAAGhI,KAAK,KACRgI,EAAG0D,OAAO,GACV1D,EAAGyD,aAAa,GAChBzD,EAAG8I,UAAU9I,EAAG+I,OAAQ/I,EAAG+I,QAC3B/I,EAAG6I,SAASpM,EAAE,IACduD,EAAG1L,KAAK+e,EAAE,GAAA3jB,OAAMqS,EAAN,KAAArS,OAAW4B,EAAX,KAAA5B,OAAgB2jB,GAAhB,GAAA3jB,OAA0B4B,EAA1B,KAAA5B,OAA+BqS,GAAKI,EAAE,EAAG1F,EAAE,GACrDuD,EAAGsT,UAAUtT,EAAGuT,MAOlBvT,EAAGgJ,YAAc,WACfhJ,EAAGtJ,SAAS,SAAAyF,GAAa,IACfuC,EAAcvC,EAAduC,UASR,OARKA,GAAgC,YAAnBY,GAASjL,OACzBiL,GAAS2J,SAGPvK,GAAgC,YAAnBY,GAASjL,OACxBiL,GAAS4J,UAGJ5V,OAAA8I,EAAA,EAAA9I,CAAA,GAAK6I,EAAZ,CAAuBuC,WAAYvC,EAAUuC,gBCxMpCgW,GA3BQ,WAAM,IAAA5H,EAMvBxS,GAAMC,GAAQhD,IAJhB8D,EAFyByR,EAEzBzR,IACAN,EAHyB+R,EAGzB/R,eAHyB+R,EAIzBnS,YAJyBmS,EAKzBlS,eASF,OANA9D,OAAOiE,eAAiBA,EAExBtB,oBAAU,WACRoU,SAASC,MAAQ,mBAChB,CAAC/S,IAGFxL,EAAAC,EAAAC,cAAA,OACE4L,IAAKA,EACL/L,MAAO,CACLkf,UAAW,QACXnX,WAAY,4FACZ7I,OAAQ,QACRC,MAAO,qBCnBTkmB,GAAY,SAAArjB,GAAC,OAAI,SAACiK,GACtB,GAAIA,EAAI,KACgBsJ,EAAUtJ,EAAxBqZ,WAAc/P,IACtBA,EAAIgQ,MAAQ,SAAA7lB,GAA+BA,EAA5B8lB,WAA4B,IAAhBpkB,EAAgB1B,EAAhB0B,KAAMqkB,EAAU/lB,EAAV+lB,IAC3BrkB,IAASY,IACXuT,EAAIkQ,IAAMA,IAIdlQ,EAAImQ,OAAS,SAACC,EAAMC,GACdrQ,EAAIkQ,IAIJhlB,IAAEolB,IAAItQ,EAAK,QACbtJ,EAAG6Z,aAAa,WAAY,UAAW,IAAO,IAAOvQ,EAAIkQ,IAAM,SAMxDM,GAAA,SAAAtb,GAAA,IAAAub,EAAAvb,EACbwb,gBADa,IAAAD,KAEbhkB,EAFayI,EAEbzI,EAFakkB,EAAAzb,EAGbnL,gBAHa,IAAA4mB,EAGF,CAACrhB,EAAG,EAAGD,EAAG,EAAGmN,EAAG,GAHdmU,EAAAC,EAAA1b,EAIb2b,aAJa,IAAAD,EAIL,CAACthB,EAAG,EAAGD,EAAG,EAAGmN,EAAG,GAJXoU,EAAA,OAMblmB,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACEhT,KAAM2lB,GAAUrjB,GAMhBqkB,SAAU,CACRC,SAAUL,EAAW,SAAW,WAChC1lB,MAAO2M,GAASlL,EAAI,GAAI,GAAKikB,EAAW,EAAI,GAC5CM,QAASN,EAAW,GAAM,IAE5B1Q,IAAK,GAGLjW,SAAUA,EACVknB,UAAU,UACVC,OAAQ,GACRC,iBAAgB,KAChBN,MAAOA,GAEPnmB,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACEiU,UAAQ,UACRrnB,SAAU,CAACuF,EAAG,EAAGD,EAAG,EAAGmN,EAAG,GAC1BqU,MAAO,CAACvhB,EAAG,EAAGD,EAAG,EAAGmN,EAAG,GACvB/M,KAAM,CACJ4hB,MAAO,SACPrmB,MAAO2M,GAASlL,EAAI,GAAI,IAAM,IAC9B2O,KAAI,qCACJkW,QAAQ,EACRC,aAAa,EACbxf,MAAOnG,EAASa,QCmDT+kB,GA7GQ,WAAM,IAAA7b,EACDC,oBAAS,GADRC,EAAApH,OAAAiG,EAAA,EAAAjG,CAAAkH,EAAA,GACpB8b,EADoB5b,EAAA,GACb6b,EADa7b,EAAA,GAG3BjB,oBAAU,WACR,IAAM+c,EAAS,SAAAxnB,GACD,MADYA,EAATwB,KACE+lB,EAAS,SAAAD,GAAK,OAAKA,KAItC,OADAxf,OAAOC,iBAAiB,QAASyf,GAC1B,kBAAM1f,OAAOG,oBAAoB,QAASuf,KAChD,IAVwB,IAAApd,EAYRC,KAAXvB,EAZmBxE,OAAAiG,EAAA,EAAAjG,CAAA8F,EAAA,MAYnBtB,OAEF2e,EAAqB1mB,IAAE,IAC1BC,QACAE,IAAI,SAAAoB,GAAC,OAAIvB,IAAE+H,GACT4e,OAAO,SAAC/Z,EAAG5J,GAAJ,OAAUA,EAAI,KAAOzB,IAC5BqlB,SACAC,QACFhgB,QAEH,OACErH,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACE6U,UAAS,6BAAAnnB,OAA+B4mB,EAAQ,IAAM,EAA7C,iBACT1nB,SAAQ,UAEPmB,IAAE,IACAC,QACAoV,OAAO,SAAA9T,GAAC,OAAIA,EAAI,GAAK,IACrBpB,IAAI,SAAAoB,GAAC,MAAK,CACTA,IACAsL,EAAG,IACHzI,GAAI5B,KAAK8hB,IAAI/iB,EAAIiB,KAAK6gB,GAAK,GAC3Blf,EAAG3B,KAAK+hB,IAAIhjB,EAAIiB,KAAK6gB,GAAK,MAE3BljB,IAAI,SAAA6J,GAAA,IAAEzI,EAAFyI,EAAEzI,EAAGsL,EAAL7C,EAAK6C,EAAGzI,EAAR4F,EAAQ5F,EAAGD,EAAX6F,EAAW7F,EAAX,OACH3E,EAAAC,EAAAC,cAAC4lB,GAAD,CACEvd,OAAQ2e,EAAmBnlB,GAC3BA,EAAGA,EACH1C,SAAQ,GAAAc,OAAKkN,EAAIzI,EAAT,KAAAzE,OAAckN,EAAI1I,EAAlB,UAEX0C,QAGF7G,IAAE,IACAC,QACAoV,OAAO,SAAA9T,GAAC,OAAKvB,IAAEK,SAAS,CAAC,EAAG,EAAG,EAAG,GAAIkB,EAAI,KAC1CpB,IAAI,SAACoB,EAAGyB,GAAJ,MAAW,CACdA,IACAzB,GAAc,GAATyB,EAAI,GAA6B,EAApBR,KAAKC,MAAMO,EAAI,IAAU,GAE3C6J,EAAG,IACHzI,EAAG5B,KAAK8hB,KAAK/iB,EAAI,IAAOiB,KAAK6gB,GAAK,IAClClf,EAAG3B,KAAK+hB,KAAKhjB,EAAI,IAAOiB,KAAK6gB,GAAK,OAEnCljB,IAAI,SAAAyS,GAAA,IAAErR,EAAFqR,EAAErR,EAAGsL,EAAL+F,EAAK/F,EAAGzI,EAARwO,EAAQxO,EAAGD,EAAXyO,EAAWzO,EAAX,OACH3E,EAAAC,EAAAC,cAAC4lB,GAAD,CACEvd,OAAQ2e,EAAmBnlB,GAC3BA,EAAGA,EACH1C,SAAQ,GAAAc,OAAKkN,EAAIzI,EAAT,KAAAzE,OAAckN,EAAI1I,EAAlB,MACRwhB,MAAM,kBAET9e,QAGF7G,IAAE,IACAC,QACAoV,OAAO,SAAA9T,GAAC,OAAIA,EAAI,GAAK,IACrBpB,IAAI,SAAAoB,GAAC,MAAK,CACTA,GAAIA,EAAI,GAAK,GACbsL,EAAG,IACHzI,GAAI5B,KAAK8hB,IAAI/iB,EAAIiB,KAAK6gB,GAAK,GAC3Blf,EAAG3B,KAAK+hB,IAAIhjB,EAAIiB,KAAK6gB,GAAK,MAE3BljB,IAAI,SAAAsU,GAAA,IAAElT,EAAFkT,EAAElT,EAAGsL,EAAL4H,EAAK5H,EAAGzI,EAARqQ,EAAQrQ,EAAGD,EAAXsQ,EAAWtQ,EAAX,OACH3E,EAAAC,EAAAC,cAAC4lB,GAAD,CACEvd,OAAQ2e,EAAmBnlB,GAC3BA,EAAGA,EACH1C,SAAQ,GAAAc,OAAKkN,EAAIzI,EAAT,KAAAzE,OAAckN,EAAI1I,EAAlB,UAEX0C,QAGF7G,IAAE,IACAC,QACAoV,OAAO,SAAA9T,GAAC,OAAKvB,IAAEK,SAAS,CAAC,EAAG,EAAG,EAAG,GAAIkB,EAAI,KAC1CpB,IAAI,SAACoB,EAAGyB,GAAJ,MAAW,CACdA,IAEAzB,GAAQ,EAAJyB,EAAQ,EAAwB,EAApBR,KAAKC,MAAMO,EAAI,IAAU,GAEzC6J,EAAG,IACHzI,EAAG5B,KAAK8hB,KAAK/iB,EAAI,KAAOiB,KAAK6gB,GAAK,IAClClf,EAAG3B,KAAK+hB,KAAKhjB,EAAI,KAAOiB,KAAK6gB,GAAK,OAEnCljB,IAAI,SAAAiV,GAAA,IAAE7T,EAAF6T,EAAE7T,EAAGsL,EAALuI,EAAKvI,EAAGzI,EAARgR,EAAQhR,EAAGD,EAAXiR,EAAWjR,EAAX,OACH3E,EAAAC,EAAAC,cAAC4lB,GAAD,CACEvd,OAAQ2e,EAAmBnlB,GAC3BA,EAAGA,EACH1C,SAAQ,GAAAc,OAAKkN,EAAIzI,EAAT,KAAAzE,OAAckN,EAAI1I,EAAlB,MACRwhB,MAAM,kBAET9e,UCxGHkgB,GAAK,mBACLC,GAAK,kBAGLC,GAAQ,CACZ,CAAC,GAAOD,GAAMD,IACd,CAAC,EAAOC,IAAMD,IACd,CAAEC,IAAMD,GAAK,GACb,EAAEC,GAAMD,GAAK,GACb,CAAC,GAAOC,IAAMD,IACd,CAAC,EAAOC,GAAMD,IACd,EAAEC,IAAMD,GAAK,GACb,CAAEC,GAAMD,GAAK,GACb,EAAEA,GAAK,EAAOC,IACd,CAAED,GAAK,GAAOC,IACd,CAAED,GAAK,EAAOC,IACd,EAAED,GAAK,GAAOC,KA2BDE,GAxBH,SAANA,EAAMjoB,GAAA,IAAAkoB,EAAAloB,EAAGmoB,WAAH,IAAAD,EAAS,EAATA,EAAYE,EAAZpoB,EAAYooB,IAAZC,EAAAroB,EAAiBsoB,aAAjB,IAAAD,EAAyB,GAAzBA,EAAAE,EAAAvoB,EAA6BsC,SAA7B,IAAAimB,EAAiC,EAAjCA,EAAA,OACVhoB,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CAAQpT,SAAS,SACdooB,GAAM9mB,IAAI,SAACyM,EAAG5J,GAAJ,OACTxD,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACExR,IAAKuC,EACLlD,MAAO2M,GAASzJ,GAAK,EAAI,IAAKqkB,GAAO,EAAG,GACxCI,OAAQ,CAAEC,MAAO,kBAAM7d,QAAQC,IAAI9G,KACnC+iB,UAAU,WACVlnB,SAAU+N,EAAE+W,KAAK,KACjBgC,MAAO,CAAC,EAAG,EAAG,GAAGxlB,IAAI,SAAAoB,GAAC,MAAI,GAAMA,GAAI6lB,EAAMA,KAAMzD,KAAK,SAGxDyD,EAAM,GAAKH,GAAM9mB,IAAI,SAACyM,EAAG5J,GAAJ,OACpBxD,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACExR,IAAKuC,EACLnE,SAAU+N,EAAEzM,IAAI,SAAAoB,GAAC,OAAQ,EAAJA,IAAOoiB,KAAK,KACjCpf,KAAI,UAAA5E,OAAY8M,IAAU8a,EAAMzmB,OAASymB,EAAMA,EAAMzmB,OAAS,GAAKkC,IAAM,EAAI,IAAK,EAAG,GAAjF,4BAAArD,OAA8G,GAAAA,OAAA4D,OAAAC,EAAA,EAAAD,CAAIgkB,GAAJ,CAAWvkB,IAAG2gB,KAAK,KAAjI,OAAAhkB,QAA4I4B,EAAIyB,GAAK,GAArJ,2BAEJxD,EAAAC,EAAAC,cAACwnB,EAAD,CAAKE,IAAKA,EAAI,EAAGC,IAAK,GAAKE,MAAK,GAAA5nB,OAAA4D,OAAAC,EAAA,EAAAD,CAAMgkB,GAAN,CAAavkB,IAAIzB,GAAIA,EAAIyB,GAAK,wCC+CvD2kB,GAhFe,SAAA1oB,GAASsE,OAAAqkB,GAAA,EAAArkB,CAAAtE,GAErC,IAFoCwL,EAIRC,qBAJQC,EAAApH,OAAAiG,EAAA,EAAAjG,CAAAkH,EAAA,GAI7Bod,EAJ6Bld,EAAA,GAIrBmd,EAJqBnd,EAAA,GAK9Bod,EAAUxc,sBAAYuc,EAAW,IAG/Bxd,EAAUrB,GAAa,SAAAe,GAAc,IAAXP,EAAWO,EAAXP,KAC5BA,EAAO,KAAO,GAAGI,QAAQC,IAAIL,GAE7Boe,GACFA,EAAOG,SAASnpB,SAASopB,IAAI,EAAG,EAAIxe,EAAO,GAV/B,OAMRa,MAQRvD,OAAOuD,MAAQA,EAEfZ,oBAAU,WACR,IAAMwe,EAAc,SAAAtV,GAAiBA,EAAfpM,KAAeoM,EAATnS,KAM5B,OADAsG,OAAOC,iBAAiB,QAASkhB,GAC1B,kBAAMnhB,OAAOG,oBAAoB,QAASghB,KAChD,IAEH,IAAMC,EAAQ,CAAC,CAAC,EAAG,EAAG,GAAI,CAAC,EAAG,GAAI,GAAI,CAAC,EAAG,EAAG,IAE7C,OACE3oB,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACEhT,KAAM8oB,EACNlpB,SAAU,CAACuF,EAAG,EAAGD,EAAG,EAAGmN,GAAI,GAC3BqU,MAAO,CAACvhB,EAAG,EAAGD,EAAG,EAAGmN,EAAG,IAGrBtR,IAAEC,MAAM,IACLE,IAAI,SAAA6C,GAAC,OAAI,GAAKA,IACd7C,IAAI,SAAA6C,GAAC,MAAK,CAAEolB,KAAMD,EAAMnlB,EAAImlB,EAAMrnB,QAASwQ,GArCpC,IAqCuCtO,KAC9C7C,IAAI,SAAAsU,GAAA,IAAE2T,EAAF3T,EAAE2T,KAAM9W,EAARmD,EAAQnD,EAAR,OACH9R,EAAAC,EAAAC,cAACF,EAAAC,EAAMsD,SAAP,CAAgBtC,IAAK6Q,GACnB9R,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACE2T,SAAU,CAER9lB,MAAO,UACPgmB,QAAS,KAEXjnB,SAAU,CAAEuF,EAAG,EAAGD,EAAG,EAAGmN,EAAGA,EAAI,KAC/B+W,SAAU,CAACjkB,EAAG,GAAID,EAAG,EAAGmN,EAAG,GAC3ByU,UAAU,aACVJ,MAAO,CAAEvhB,EAAG,EAAGD,EAAG,KAAOmN,EAAG,KAE7BtR,IAAEC,MAAM,IACNE,IAAI,SAAAoB,GACH,IACM+mB,EAAQ/mB,GAAe,EAAViB,KAAK6gB,IAAU,GAElC,MAAO,CACL9hB,IACA6C,EALQ,IAKD5B,KAAK8hB,IAAIgE,GAChBnkB,EANQ,IAMD3B,KAAK+hB,IAAI+D,MAGnBnoB,IAAI,SAAAiV,GAAA,IAAE7T,EAAF6T,EAAE7T,EAAFgnB,EAAAnT,EAAKzI,SAAL,IAAA4b,EAAS,GAATA,EAAcnkB,EAAdgR,EAAchR,EAAGD,EAAjBiR,EAAiBjR,EAAjB,OACH3E,EAAAC,EAAAC,cAAC4lB,GAAD,CACEE,UAAWxlB,IAAEK,SAAS+nB,EAAM7mB,GAC5Bd,IAAKc,EACLA,EAAGA,EACH1C,SAAU,CAACuF,IAAGD,IAAGmN,KACjBqU,MAAO,CAACvhB,EAAGuI,EAAGxI,EAAGwI,EAAG2E,EAAG3E,YCG5B6b,GA3EgB,SAAAvpB,GAAwB,IAAtBwpB,EAAsBxpB,EAAtBwpB,iBAAsBhe,EACrBC,qBADqBC,EAAApH,OAAAiG,EAAA,EAAAjG,CAAAkH,EAAA,GAC9Cie,EAD8C/d,EAAA,GACpCge,EADoChe,EAAA,GAAAtB,EAE5BC,KAAjBxB,EAF6CvE,OAAAiG,EAAA,EAAAjG,CAAA8F,EAAA,MAE7CvB,aACF8gB,ECRO,SAAC/hB,GACd,IAAMyE,EAAMud,mBAIZ,OAHAnf,oBAAU,WACR4B,EAAIwd,QAAUjiB,IAETyE,EAAIwd,QDGcC,CAAYjhB,GAErC4B,oBAAU,WACR,IAAMoY,EAAa,SAACrd,GAAQ,IAEJlD,EAA2BkD,EAA1C9D,KAAOohB,OAAsBiD,EAAavgB,EAAvBukB,SAAelN,EAAQrX,EAARqX,KACnCgK,EAAUd,GAAO,GAAMA,GAHHiE,EAILR,EAAiBlnB,GAA/BoL,EAJmBsc,EAInBtc,EAAGvI,EAJgB6kB,EAIhB7kB,EAAGD,EAJa8kB,EAIb9kB,EAAGmN,EAJU2X,EAIV3X,EAChBoX,EAASrD,aAAa,WAAY,UAAWS,GAChC,WAAThK,IACF4M,EAAS/nB,KAAOY,EAChBmnB,EAASV,SAASnpB,SAASopB,IAAI7jB,EAAGD,EAAGmN,EAAI,KACzCoX,EAASV,SAASrC,MAAMsC,IAAQ,IAAJtb,EAAa,IAAJA,EAAa,IAAJA,GAC9C+b,EAASrD,aAAa,WAAY,QAAS5Y,GAASlL,EAAI,GAAI,IAAM,OA+BtE,OAVImnB,GACE5gB,IACF+B,QAAQC,IAAI,qBAAsB9J,IAAEmjB,IAAIrb,EAAa,QAAS,SAAU9H,IAAEmjB,IAAIyF,EAAkB,SAChG9gB,EAAasC,YAAY,SAAU,MAAO0X,GAC1Cha,EAAasC,YAAY,UAAW,MAAO0X,GAC3Cha,EAAasC,YAAY,gBAAiB,MAtB7B,SAAAJ,GAAuC,IAAtB+X,EAAsB/X,EAApCkf,WAAcnH,OAAUlb,EAAYmD,EAAZnD,MAC1C,GAAe,IAAXkb,EAAc,CAChB,IAAMiD,EAAMne,EAAQ,IACdif,EAAUd,GAAO,GAAMA,GAC7B0D,EAASrD,aAAa,WAAY,UAAWS,MAmB7Che,EAAasC,YAAY,YAAa,MAflB,SAAAwI,GAAe,IAAZ/L,EAAY+L,EAAZ/L,MAEnBtF,EAAImnB,EAAS/nB,MAAQ,EAFUwoB,EAIhBV,EAAiBlnB,EADX,EAARsF,GACZ8F,EAJ8Bwc,EAI9Bxc,EAAGvI,EAJ2B+kB,EAI3B/kB,EAAGD,EAJwBglB,EAIxBhlB,EAAGmN,EAJqB6X,EAIrB7X,EAChBoX,EAASV,SAASnpB,SAASopB,IAAI7jB,EAAGD,EAAGmN,EAAI,KACzCoX,EAASV,SAASrC,MAAMsC,IAAQ,IAAJtb,EAAa,IAAJA,EAAa,IAAJA,MAazC,WACD7E,IACF+B,QAAQC,IAAI,yBAA0B9J,IAAEmjB,IAAIrb,EAAc,SAC1DA,EAAauC,eAAe,UAC5BvC,EAAauC,eAAe,WAC5BvC,EAAauC,eAAe,iBAC5BvC,EAAauC,eAAe,gBAG/B,CAACqe,EAAU5gB,EAAc2gB,EAAkBG,IAE9C,IAAMQ,EAAY7d,sBAAYod,EAAa,IAE3C,OACEnpB,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACEhT,KAAMmqB,EACNrD,UAAU,WACVH,SAAU,CACRC,SAAU,WACV/lB,MAAO2M,GAAS,EAAG,EAAG,GACtBqZ,QAAS,EACTO,aAAa,GAEfL,OAAQ,OEnERqD,GAAe,IAAI7Z,aAGzBzI,OAAOsiB,aAAeA,GAGtB,ICPIC,GDqMWC,GA9LU,SAAAtqB,GAQnB,IAAAuqB,EAAAvqB,EAPJwqB,gBAOI,IAAAD,EAPO,EAOPA,EAAAE,EAAAzqB,EANJ0qB,gCAMI,IAAAD,KAAAE,EAAA3qB,EALJ4qB,YAKI,IAAAD,EALG,IAKHA,EAAAE,EAAA7qB,EAJJ8qB,YAII,IAAAD,EAJG,EAIHA,EAAAE,EAAA/qB,EAHJgrB,iBAGI,IAAAD,EAHQ,CAAC,GAAI,IAGbA,EAAAE,EAAAjrB,EADJkrB,sBACI,IAAAD,EADY,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAC/BA,EAAAzf,EACsBC,oBAAS,GAD/BC,EAAApH,OAAAiG,EAAA,EAAAjG,CAAAkH,EAAA,GACG8b,EADH5b,EAAA,GACU6b,EADV7b,EAAA,GAAAG,EAE4BJ,qBAF5BK,EAAAxH,OAAAiG,EAAA,EAAAjG,CAAAuH,EAAA,GAEGsf,EAFHrf,EAAA,GAEasf,EAFbtf,EAAA,GAAAG,EAGsCR,qBAHtCS,EAAA5H,OAAAiG,EAAA,EAAAjG,CAAA2H,EAAA,GAGGof,EAHHnf,EAAA,GAGkBof,EAHlBpf,EAAA,GAOEsd,EAAmB,SAAAlnB,GACvB,IAAMipB,EAAOjpB,EAAI,IACXsL,GAAK0Z,EAAQ,EAAI,KAAOsD,IAAStD,EAAQ,EAAI,KAAOsD,EAAOE,GAAQS,EAEzE,MAAO,CACLjpB,IACAoL,EAAI,IAAOpL,EAAI,IACf6C,EAAGyI,GAAK0Z,GAASoD,GAA4B,EAAI,GAAKnnB,KAAK8hB,IAAI/iB,EAAIiB,KAAK6gB,GAAK,EAAI,KACjFlf,EAAG0I,EAAIrK,KAAK+hB,IAAIhjB,EAAIiB,KAAK6gB,GAAK,EAAI,KAClC/R,EAAGiV,EACCkD,EAAWA,EAAWe,EACtBf,EAAWe,IAInB9gB,oBAAU,WACR,IAAMwe,EAAc,SAAAle,GAAiB,IAAfxD,EAAewD,EAAfxD,KACR,MADuBwD,EAATvJ,KACT+lB,EAAS,SAAAD,GAAK,OAAKA,IACvB,UAAT/f,GAAkB6iB,GAAanQ,UAIrC,OADAnS,OAAOC,iBAAiB,QAASkhB,GAC1B,kBAAMnhB,OAAOG,oBAAoB,QAASghB,KAChD,IAEHxe,oBAAU,WACRG,QAAQC,IAAI,KAAMwgB,EAAe,WAAYF,GAmBzCf,KAAiBe,GAAYE,EAC/BD,EAAY,IAAII,KAAc,CAC5BC,QAASrB,GAITsB,sBAAsB,EAEtBC,QAzBgB,SAACC,EAAOC,GAAkB,IACrC3U,EAA4B0U,EAA5B1U,UAAW4U,EAAiBF,EAAjBE,SAAUC,EAAOH,EAAPG,IAItBlF,EAAUkF,GAAO,GAAMA,GACvBzpB,E3B9BS,SAAC4U,GACpB,OAAO,GAAK,GAAK3T,KAAK+O,KAAK4E,EAAY,K2B6BzB8U,CAAM9U,GAN4B8S,EAOvBR,EAAiBlnB,GAA/BoL,EAPqCsc,EAOrCtc,EAAGvI,EAPkC6kB,EAOlC7kB,EAAGD,EAP+B8kB,EAO/B9kB,EAAGmN,EAP4B2X,EAO5B3X,EAChBgZ,EAAcjF,aAAa,WAAY,UAAW0F,EAAWjF,EAAU,GACvEwE,EAActC,SAASnpB,SAASopB,IAAI7jB,EAAGD,EAAGmN,EAAI,KAC9CgZ,EAActC,SAASrC,MAAMsC,IAAItb,EAAGA,EAAGA,GAEnC3M,IAAEkrB,SAAS3pB,IACb+oB,EAAcjF,aAAa,WAAY,QAAS5Y,GAASlL,EAAI,GAAI,GAAK,KAqBtE4pB,uBAAwB,GAMxBC,UAAW,MAGXC,oBAAoB,EAGpBvqB,OAAQ,KAGRwqB,QAAS,GACTC,QAAS,IAKTC,UAAW,EACXC,UAAW,IAGXxW,OAAO,KAGAmV,IAAaE,IACtBF,EAASrV,OACTqV,EAASsB,YAEV,CAACrC,GAAce,EAAU7D,EAAO+D,IAInC,IAAMqB,EAAiBpgB,sBAAYgf,EAAkB,IAarD,OACE/qB,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACEwV,OAAQ,CACNC,MAAO,WACL2B,GAAanQ,WAGjBra,SAAU,CAACuF,EAAG,EAAGD,EAAG,EAAGmN,GAAI,GAC3BqU,MAAO,CAACvhB,EAAG,EAAGD,EAAG,EAAGmN,EAAG,IAEtBtR,IAAEC,MAAMgqB,EAAU,GAAIA,EAAU,GAAK,GACnC9pB,IAAIsoB,GACJtoB,IAAI,SAAAyS,GAAA,IAAErR,EAAFqR,EAAErR,EAAGoL,EAALiG,EAAKjG,EAAGvI,EAARwO,EAAQxO,EAAGD,EAAXyO,EAAWzO,EAAGmN,EAAdsB,EAActB,EAAd,OACH9R,EAAAC,EAAAC,cAACF,EAAAC,EAAMsD,SAAP,CAAgBtC,IAAKc,GACnB/B,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACEuS,KAAM,CACJ1kB,MAAO,QACPgmB,QAAS,GACT7Q,MAAOjV,IAAE4rB,KAAKnD,EAAiBlnB,EAAI,KAAO,CAAC,IAAK,IAAK,MACrDsqB,IAAK7rB,IAAE4rB,KAAKnD,EAAiBlnB,EAAI,KAAO,CAAC,IAAK,IAAK,MACnDuqB,QAASvqB,EAAI0oB,EAAU,MAI3BzqB,EAAAC,EAAAC,cAAC4lB,GAAD,CACEE,UAAWxlB,IAAEK,SAAS8pB,EAAgB5oB,EAAE,IACxCA,EAAGA,EACH1C,SAAU,CAACuF,IAAGD,IAAGmN,KACjBqU,MAAO,CAACvhB,EAAGuI,EAAGxI,EAAGwI,EAAG2E,EAAG3E,QAM/BnN,EAAAC,EAAAC,cAACqsB,GAAD,CACEtD,iBAAkBA,IAcpBjpB,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACEhT,KAAM0sB,EACN5F,UAAU,WACVH,SAAU,CACRC,SAAU,WACV/lB,MAAO2M,GAAS,EAAG,EAAG,GACtBqZ,QAAS,EACTO,aAAa,GAEfL,OAAQ,OEpMVgG,UAAKC,EAAIC,KAuFAC,GA3DD,WAAM,IAAAC,EA1BD,WAAM,IAAA3hB,EACOC,mBAAS,MADhBC,EAAApH,OAAAiG,EAAA,EAAAjG,CAAAkH,EAAA,GAChBigB,EADgB/f,EAAA,GACP0hB,EADO1hB,EAAA,GAAAG,EAEqBJ,mBAAS,MAF9BK,EAAAxH,OAAAiG,EAAA,EAAAjG,CAAAuH,EAAA,GAEhBM,EAFgBL,EAAA,GAEAM,EAFAN,EAAA,GAoBvB,MAAO,CACL2f,UACApf,IAlBUC,sBAAY,SAACC,GACvB,GAAIA,EAAI,CACN,IAAM8gB,EAAW,IAAIN,GAAGO,SAAS/gB,EAAIwgB,GAAGO,SAASC,SAASC,KAC1DH,EAASI,OAAOlhB,EAAGM,YAAaN,EAAGI,cACnCygB,EAAWC,EAASK,cAEpB,IAAMvhB,EAAiB,IAAIY,eAAe,SAAA/M,GAA0C,IAAAgN,EAAA1I,OAAAiG,EAAA,EAAAjG,CAAAtE,EAAA,MAAtCiN,YAAezN,EAAuBwN,EAAvBxN,OAAQC,EAAeuN,EAAfvN,MACnE4tB,EAASI,OAAOhuB,EAAOD,KAEzB4M,EAAkBD,GAClBA,EAAemB,QAAQf,QAEvBJ,EAAeoB,cAEhB,KAYCogB,GAFFlC,EAFgB0B,EAEhB1B,QACApf,EAHgB8gB,EAGhB9gB,IAGF,GAAIof,EAAS,CACXA,EAAQmC,eAAe,SACvBnC,EAAQoC,aAAa,SAErB,IAAMC,EAAS,IAAIf,GAAGgB,MAAM,GAAI,EAAG,KAChCC,QAAQ,UACRC,gBAAgB,MAChBC,iBAAiB,OACjBd,WAAW3B,GACXhS,OAEH3R,OAAOilB,GAAIA,GACXjlB,OAAO2jB,QAAUA,EACjB3jB,OAAOgmB,OAASA,EAEhB,IAAMK,EAAO,IAAIpB,GAAGgB,MAAM,GAAI,GAAI,KAC/BC,QAAQ,QACRE,iBAAiB,OACjBD,gBAAgB,MAChBb,WAAW3B,GACXhS,OAEW,IAAIsT,GAAGqB,eAAeN,EAAQK,GACzCE,QAAQtB,GAAGqB,eAAevR,KAAKyR,OAC/BlB,WAAW3B,GACXhS,OAGc,IAAIsT,GAAGqB,eAAeN,EAAQK,GAC5CE,QAAQtB,GAAGqB,eAAevR,KAAK0R,aAC/BnB,WAAW3B,GACXhS,OAKL,OACElZ,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACVf,QAAS,QACTE,MAAO,SAEPc,EAAAC,EAAAC,cAAA,OACE4L,IAAKA,EACL/L,MAAO,CAEL0I,KAAM,QACNxJ,OAAQ,IACRkV,OAAQ,2CD3EZ8Z,GAAW,SAAC/gB,EAAGC,EAAG+gB,GAMtB,OALApE,GAASA,IAAU,IAAIviB,OAAO4mB,OACvBC,SAAe,IAAJlhB,EAAU,MAAQ,IACpC4c,GAAOuE,QAAc,IAAJlhB,EACjB2c,GAAOwE,QAAc,IAAJJ,EACjBpE,GAAOyE,aACAzE,GAAOjc,KAGV2gB,GAAW,SAACthB,EAAGC,EAAG+gB,GAMtB,OALApE,GAASA,IAAU,IAAIviB,OAAO4mB,OACvBC,SAAe,IAAJlhB,EAAU,MAAQ,IACpC4c,GAAOuE,QAAc,IAAJlhB,EACjB2c,GAAOwE,QAAc,IAAJJ,EACjBpE,GAAO2E,aACA,CAAgB,IAAf3E,GAAO4E,MAA4B,IAAf5E,GAAO6E,MAA4B,IAAf7E,GAAO8E,QAGnDC,GAAY,CAChB,CACErU,MAAO,UACPpJ,IAAK,IAEP,CACEoJ,MAAO,iBACPpJ,IAAK,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,KAE1B,CACEoJ,MAAO,cACPpJ,IAAK,CAAC,EAAG,EAAG,IAEd,CACEoJ,MAAO,UACPpJ,IAAK,CAAC,EAAG,EAAG,EAAG,KAEjB,CACEoJ,MAAO,cACPpJ,IAAK,CAAC,EAAG,EAAG,IAEd,CACEoJ,MAAO,UACPpJ,IAAK,CAAC,EAAG,EAAG,EAAG,KAEjB,CACEoJ,MAAO,mBACPpJ,IAAK,CAAC,EAAG,EAAG,IAEd,CACEoJ,MAAO,eACPpJ,IAAK,CAAC,EAAG,EAAG,IAEd,CACEoJ,MAAO,kBACPpJ,IAAK,CAAC,EAAG,EAAG,KA4CV0d,IAlCG,yBAAA3uB,OAAA,wCAkCkB,CACzB,EACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,EACA,IAGI4uB,GAAoB,CACxB,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACxB,EACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,IAGIC,GAAkB,CACtB,EACA,EACA,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAClB,EACA,GAGIC,GAAeH,GAAmBnuB,IAAI,iBAAO,KAEnDH,IAAEC,MAAM,GAAG4T,QAAQ,SAAA6a,GACjB,IAAMC,EAAWD,EAAa,EAExBE,EAA2B,EAAbF,EACdG,EAA2B,EAAbH,EAEhB/tB,EAAO,EACXX,IAAE6T,QAAQ2a,GAAiB,SAACM,EAAaC,GACvC/uB,IAAEC,MAAM6uB,GAAajb,QAAQ,SAAAmb,GAE3BP,GADUI,EAAcE,GACRH,EAAcL,GAAkBQ,GAAYC,GAAU,CACpEL,WACAhuB,QAGFA,UAON,IAKMsuB,GAAW,SAACC,EAAYC,EAAaC,EAAO3uB,EAAKoM,EAAGC,EAAGC,GAA5C,OAAkD,IAAIsiB,QAAQ,SAACC,GAG9EzlB,QAAQC,IAAI,WAAY+C,EAAGC,EAAGC,GAE9BmiB,EAAWK,mBAAmB,QAAS,WAErCD,MAEFH,EAAYK,UARC,CAAC,EAAM,GAAM,IAQE,CAACJ,EAPT,EAO6B3uB,EAAKoM,GAAK,EAAO,GAAJA,EAASC,GAAK,EAAO,GAAJA,EAASC,GAAK,EAAO,GAAJA,OAgB5F0iB,GAAU,SAACP,EAAYC,EAAaC,EAAO3uB,EAAKE,GAAtC,IAA4C+uB,EAA5C7uB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAA0D,EAAG8uB,EAA7D9uB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAwE,EAAxE,OAA8E,IAAIwuB,QAAQ,SAACC,GAGzGzlB,QAAQC,IAAI,UAAWolB,EAAYC,GAEnCD,EAAWK,mBAAmB,QAAS,WAErCD,MAEFH,EAAYK,UARC,CAAC,EAAM,GAAM,IAQE,CAACJ,EAPV,EAO6B3uB,EAAK+B,KAAK8P,IAAI,IAAK9P,KAAK0X,IAAI,EAAGvZ,IAAQ+uB,EAAaC,OAKhGC,GAAa,CACjB,CACE5V,MAAO,iBACPpJ,IAAK,SAACxM,EAAGD,GAAJ,OACFA,EAAI,IAAM,EACK,GAAT,EAAIA,GAAa,EAAJC,EACJ,GAAT,EAAID,GAAa,EAAJC,EAAQ,IAGhC,CACE4V,MAAO,eACPpJ,IAAK,SAACxM,EAAGD,GAAJ,OAAUA,EAAI,IAAM,EACT,GAAV,GAAKA,GAAa,EAAJC,GAAUA,EAAI,GAAK,GAAK,GAC7B,GAAV,GAAKD,GAAa,EAAJC,EAAQ,GAAKA,EAAI,GAAK,GAAK,MAK5CyrB,GAAc,SAACtuB,GAAD,IAAIuuB,EAAJjvB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,SAA8B,CAC1C,EAAJU,EAAS,GAAM,GACjBiB,KAAK0X,IAAI,EAAG,EAAI3Y,EAAI,KACpBuuB,EAAgB,GAAMttB,KAAK0X,IAAI,GAAK3Y,EAAI,OAoH3BwuB,GAjHC,SAAA9wB,GAAiC,IAAA+wB,EAAA/wB,EAA/BmI,YAA+B,IAAA4oB,EAAxB1B,GAAwB0B,EAAA3mB,EAEPC,KAFO2mB,EAAA1sB,OAAAiG,EAAA,EAAAjG,CAAA8F,EAAA,MAEvC3B,EAFuCuoB,EAEvCvoB,aAAcS,EAFyB8nB,EAEzB9nB,cAChB+nB,EAASxoB,EAAayoB,KAAK,SAAAnmB,GAAA,MAAqB,mBAArBA,EAAEgZ,OAC7BoN,EAAUjoB,EAAcgoB,KAAK,SAAAvd,GAAA,MAAqB,oBAArBA,EAAEoQ,OAJUvY,EAObC,mBAAS,GAPIC,EAAApH,OAAAiG,EAAA,EAAAjG,CAAAkH,EAAA,GAOxC4lB,EAPwC1lB,EAAA,GAO7B2lB,EAP6B3lB,EAAA,GAQnC4lB,EAAUX,GAAWS,GAA1Bzf,IARwC9F,EAUfJ,mBAAS,GAVMK,EAAAxH,OAAAiG,EAAA,EAAAjG,CAAAuH,EAAA,GAUxC0lB,EAVwCzlB,EAAA,GAU9B0lB,EAV8B1lB,EAAA,GAWnC2lB,EAASrC,GAAUmC,GAAxB5f,IA6BP,OA1BAlH,oBAAU,WACHwmB,GAAWE,GAEE,eAAA3b,EAAAlR,OAAAotB,GAAA,EAAAptB,CAAAqtB,GAAAnxB,EAAAoxB,KAAG,SAAAC,IAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAhtB,EAAAitB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAArtB,EAAAstB,EAAA/C,EAAAhuB,EAAAY,EAAAowB,EAAAC,EAAA/kB,EAAAC,EAAAC,EAAA,OAAA6jB,GAAAnxB,EAAAoyB,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAAAjB,GAAA,EAAAC,GAAA,EAAAC,OAAAlwB,EAAA+wB,EAAAC,KAAA,EAAAb,EACHlxB,IAAEC,MAAMmH,EAAKtG,QADVmxB,OAAAC,YAAA,UAAAnB,GAAAI,EAAAD,EAAAc,QAAAG,KAAA,CAAAL,EAAAE,KAAA,SACR7tB,EADQgtB,EAAAtqB,MAEXuqB,EAAY7C,GAAkBpqB,GAFnBktB,GAAA,EAAAC,GAAA,EAAAC,OAAAxwB,EAAA+wB,EAAAC,KAAA,GAAAP,EAIDxxB,IAAEC,MAAMmxB,EAAWhqB,EAAKjD,GAAKitB,GAJ5Ba,OAAAC,YAAA,WAAAb,GAAAI,EAAAD,EAAAQ,QAAAG,KAAA,CAAAL,EAAAE,KAAA,YAIN5tB,EAJMqtB,EAAA5qB,QAKT6qB,EAAUjD,GAAatqB,GAAGC,IALjB,CAAA0tB,EAAAE,KAAA,gBAONrD,EAAkB+C,EAAlB/C,SAAUhuB,EAAQ+wB,EAAR/wB,KACXY,EAAIgvB,EAAOnsB,EAAGD,GARPwtB,EAUK3D,GAAQoE,WAAR,EAAA7uB,OAAAC,EAAA,EAAAD,CAAYssB,GAAYtuB,KAV7BqwB,EAAAruB,OAAAiG,EAAA,EAAAjG,CAAAouB,EAAA,GAUN9kB,EAVM+kB,EAAA,GAUH9kB,EAVG8kB,EAAA,GAUA7kB,EAVA6kB,EAAA,GAAAE,EAAAE,KAAA,GAWP/C,GAASiB,EAAQE,EAASzB,EAAUhuB,EAAMkM,EAAGC,EAAGC,GAXzC,eAAA+kB,EAAAE,KAAA,GAYPvC,GAAQS,EAAQE,EAASzB,EAAUhuB,EAAMY,GAZlC,QAAA8vB,GAAA,EAAAS,EAAAE,KAAA,iBAAAF,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAO,GAAAP,EAAA,UAAAR,GAAA,EAAAC,EAAAO,EAAAO,GAAA,QAAAP,EAAAC,KAAA,GAAAD,EAAAC,KAAA,GAAAV,GAAA,MAAAG,EAAAc,QAAAd,EAAAc,SAAA,WAAAR,EAAAC,KAAA,IAAAT,EAAA,CAAAQ,EAAAE,KAAA,eAAAT,EAAA,eAAAO,EAAAS,OAAA,mBAAAT,EAAAS,OAAA,YAAAxB,GAAA,EAAAe,EAAAE,KAAA,gBAAAF,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAU,GAAAV,EAAA,SAAAd,GAAA,EAAAC,EAAAa,EAAAU,GAAA,QAAAV,EAAAC,KAAA,GAAAD,EAAAC,KAAA,GAAAhB,GAAA,MAAAG,EAAAoB,QAAApB,EAAAoB,SAAA,WAAAR,EAAAC,KAAA,IAAAf,EAAA,CAAAc,EAAAE,KAAA,eAAAf,EAAA,eAAAa,EAAAS,OAAA,mBAAAT,EAAAS,OAAA,6BAAAT,EAAA/c,SAAA+b,EAAA,8DAAH,yBAAArc,EAAA2d,MAAAnrB,KAAApG,YAAA,EAmBlB4xB,GAAeC,MAAM,SAAAC,GAAC,OAAI9oB,QAAQC,IAAI6oB,MAErC,CAACtC,EAAWG,EAAUN,EAAQE,IAG/B5wB,EAAAC,EAAAC,cAAA,OAAKH,MAAO,CACVf,QAAS,QACTmE,WAAY,IAEZnD,EAAAC,EAAAC,cAAA,UAAQmH,MAAOwpB,EAAWhpB,SAAU,SAAA5C,GAAG,OAAI6rB,EAAazM,SAASpf,EAAIqC,OAAOD,MAAO,OAChF+oB,GAAWzvB,IAAI,SAAAiV,EAAUxE,GAAV,IAAEoJ,EAAF5E,EAAE4E,MAAF,OAAkBxa,EAAAC,EAAAC,cAAA,UAAQe,IAAKmQ,EAAK/J,MAAO+J,GAAMoJ,MAGnExa,EAAAC,EAAAC,cAAA,UAAQmH,MAAO2pB,EAAUnpB,SAAU,SAAA5C,GAAG,OAAIgsB,EAAY5M,SAASpf,EAAIqC,OAAOD,MAAO,OAC9EwnB,GAAUluB,IAAI,SAAA4V,EAAUnF,GAAV,IAAEoJ,EAAFjE,EAAEiE,MAAF,OAAkBxa,EAAAC,EAAAC,cAAA,UAAQe,IAAKmQ,EAAK/J,MAAO+J,GAAMoJ,MAGlExa,EAAAC,EAAAC,cAAA,WACAF,EAAAC,EAAAC,cAAA,WACAF,EAAAC,EAAAC,cAAA,WAECM,IAAEC,MAAMmH,EAAKtG,QACXX,IAAI,SAAAgE,GACH,IAAM7E,EAAQ6E,EAAI,IAAM,EAClBitB,EAAY7C,GAAkBpqB,GAEpC,OACE3E,EAAAC,EAAAC,cAAAF,EAAAC,EAAAsD,SAAA,QAAApD,OAAA4D,OAAAC,EAAA,EAAAD,CAEOvD,IAAEC,MAAMmxB,GAAWjxB,IAAI,SAAAiE,GACxB,OACE5E,EAAAC,EAAAC,cACEc,EADF,CAEEC,IAAK2D,EACL9E,MAAOA,GAHT,WAJRiE,OAAAC,EAAA,EAAAD,CAYOvD,IAAEC,MAAMmxB,EAAWhqB,EAAKjD,GAAKitB,GAAWjxB,IAAI,SAAAiE,GAC7C,IAAM7C,EAAIgvB,EAAOnsB,EAAGD,GACdyuB,EAAY5yB,IAAEK,SAASqwB,EAAOnvB,EAAI,IAWxC,OACE/B,EAAAC,EAAAC,cAACwD,EAAD,CACEzC,IAAK2D,EACL7C,EAAGA,EACHjC,MAAOA,EACPgC,YAAU,EACV/B,MAAO,CAELwc,OAAM,YACN8W,aAAc,MACd/yB,MAAO8yB,EAAY,QAAU,OAC7BE,gBAAiBrF,GAAQ2E,WAAR,EAAA7uB,OAAAC,EAAA,EAAAD,CAAYssB,GAAYtuB,EAAGqxB,YAMtDpzB,EAAAC,EAAAC,cAAA,gBEjVCqzB,GARC,kBACdvzB,EAAAC,EAAAC,cAACkE,EAAD,CACER,UAAW,GACXC,YAAa,CAAC,EAAE,EAAE,EAAE,GAAG,IACvBC,OAAQ,CAAC,EAAG,EAAG,EAAG,MCST0vB,GAAW,CACtB,CAAC,kBAAmB,cAAelW,IACnC,CAAC,8BAA+B,kBAAmB9Y,GACnD,CAAC,cAAe,OAAQivB,KAAK,GAC7B,CAAC,oBAAqB,eAAgB5uB,GACtC,CAAC,aAAc,WAAY0rB,IAC3B,CAAC,kBAAmB,kBAAmBpL,IACvC,CAAC,QAAS,SAAUwH,IACpB,CAAC,sBAAuB,SAAUzpB,GAClC,CAAC,uBAAwB,UAAWiB,GACpC,CAAC,yBAA0B,YAAaoc,IACxC,CAAC,wBAAyB,WAAYgT,KAG3BG,GAAW,CACtB,CAAC,kBAAmB,eAAgB5M,IACpC,CAAC,MAAO,UAAWY,IACnB,CAAC,wBAAyB,4BAA6BS,IACvD,CAAC,mBAAoB,uBAAwB4B,KCNhC4J,GAzBA,kBACb3zB,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACE8T,UAAU,WACVxP,GAAG,SACH1X,SAAU,CAAEuF,EAAG,EAAGD,EAAG,EAAGmN,EAAG,GAC3B8hB,iBAAA,EAIAC,gBAAe,CACbC,aAAc,gBCwDLC,GAxDJ,SAAAt0B,KAAEu0B,MAAQC,KAAV,OACTj0B,EAAAC,EAAAC,cAACuS,GAAA,MAAD,KAGEzS,EAAAC,EAAAC,cAAA,iBAKAF,EAAAC,EAAAC,cAACg0B,GAAA,EAAD,KAGGR,GAAS/yB,IAAI,SAAA6J,EAA2BvJ,GAA3B,IAAAmS,EAAArP,OAAAiG,EAAA,EAAAjG,CAAAyG,EAAA,GAASypB,GAAT7gB,EAAA,GAAAA,EAAA,IAAe+gB,EAAf/gB,EAAA,UACZpT,EAAAC,EAAAC,cAACg0B,GAAA,EAAU,CAAEC,YAAWlzB,MAAKgzB,YA4BjCj0B,EAAAC,EAAAC,cAACk0B,GAAD,MAEAp0B,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CAEEsE,GAAG,WACHsd,wBAAsB,eAExBr0B,EAAAC,EAAAC,cAACuS,GAAA,OAAD,CACEsE,GAAG,YACHsd,wBAAsB,iGC7DfC,GAAW,SAAXA,EAAYjnB,GAAD,OAAOA,EAAI,EAC/BinB,EAASjnB,EAAI,GACbA,EAAI,EACFinB,EAAa,EAAJjnB,GACTA,GCoCN9F,OAAOgtB,YDlCmB,SAAC/wB,GAAD,OAAOgxB,aAASF,GAAS9wB,MCoCxB,SAArBixB,IACJ,GAAsB,qBAAXC,OAAX,CAKA,IAAMC,EAAU,CACdC,KAAMrtB,OAAOstB,SAASC,SACtBC,KAAM,OACNC,QAAQ,GAEJ1f,EAAM,IAAIme,IAAI,CAClBwB,OAAQ,IAAIxB,IAAIyB,sBAAsBP,KAExCrf,EAAIiK,OACJhY,OAAO+N,IAAMA,EASb/N,OAAOmtB,OAAOS,kBAAkB,OAAQ,CACtCC,KAAM,WAAW,IAAAluB,EAAAO,KAGfA,KAAK4tB,SAAW/f,EAAIggB,GAAG,UAAW,SAAA71B,GAAkC,IAAhC81B,EAAgC91B,EAAhC81B,QAAgCC,EAAAzxB,OAAAiG,EAAA,EAAAjG,CAAAtE,EAAvBg2B,KAAuB,GAAhBt0B,EAAgBq0B,EAAA,GAAVhQ,EAAUgQ,EAAA,GAC5DjQ,EAAa/kB,IAAEE,KAAK60B,EAAQnR,MAAM,MACpCld,EAAKoe,OAAOpe,EAAKoe,MAAM,CAAEC,aAAYpkB,OAAMqkB,WAKnDvb,KAAM,SAAUyb,EAAMC,GAChBle,KAAKge,QAAQhe,KAAKge,OAAOC,EAAMC,IAGrC+P,OAAQ,WACNpgB,EAAIqgB,IAAI,UAAWluB,KAAK4tB,aAI5B9tB,OAAOmtB,OAAOS,kBAAkB,MAAO,CACrCC,KAAM,WAAW,IAAAQ,EAAAnuB,KAGfA,KAAK4tB,SAAW/f,EAAIggB,GAAG,UAAW,SAAA9qB,GAAkC,IAAhC+qB,EAAgC/qB,EAAhC+qB,QAAgCM,EAAA9xB,OAAAiG,EAAA,EAAAjG,CAAAyG,EAAvBirB,KAAuB,GAAhBt0B,EAAgB00B,EAAA,GAAVrQ,EAAUqQ,EAAA,GAC5DtQ,EAAa/kB,IAAEE,KAAK60B,EAAQnR,MAAM,MACpCwR,EAAKtQ,OAAOsQ,EAAKtQ,MAAM,CAAEC,aAAYpkB,OAAMqkB,WAKnDvb,KAAM,SAAUyb,EAAMC,GAChBle,KAAKge,QAAQhe,KAAKge,OAAOC,EAAMC,IAGrC+P,OAAQ,WACNpgB,EAAIqgB,IAAI,UAAWluB,KAAK4tB,kBA1D1Bvc,WAAW2b,EAAoB,KA8DnCA,GAwHAqB,IAASC,OAAO/1B,EAAAC,EAAAC,cAtHJ,WACV,IAcM81B,EAAO,CACXC,QAAS,CACPxY,OAAQ,CACNyY,OAAQ,QAEVC,QAAS,CACPC,KAAM,QAER9Z,KAAM,SAgBJ+Z,EAAQ7sB,IAAM8sB,QAClB,kBACEC,aAAiCP,IACnC,EAzCsB,IADRvT,EA8CwBjZ,IAAM0B,SAAS,MA9CvCwX,EAAA3e,OAAAiG,EAAA,EAAAjG,CAAA0e,EAAA,GA8CT+T,EA9CS9T,EAAA,GA8CK+T,EA9CL/T,EAAA,GAgDVgU,EAAkB,kBAAMD,EAAgB,OAE9C,OACEz2B,EAAAC,EAAAC,cAACy2B,GAAA,EAAD,CAAeN,MAAOA,GACpBr2B,EAAAC,EAAAC,cAAC02B,EAAA,EAAD,MACA52B,EAAAC,EAAAC,cAAC22B,GAAA,EAAD,CAAQC,SAAUC,sBAChB/2B,EAAAC,EAAAC,cAACg0B,GAAA,EAAD,CAAOD,KAAK,IAAI+C,OAAK,EAAC7C,UAAW9vB,IAEjCrE,EAAAC,EAAAC,cAACg0B,GAAA,EAAD,CAAOD,KAAK,MAAME,UAAWJ,KAE5BP,GAAS7yB,IAAI,SAAAsU,EAA2BhU,GAA3B,IAAA2U,EAAA7R,OAAAiG,EAAA,EAAAjG,CAAAkR,EAAA,GAASgf,GAATre,EAAA,GAAAA,EAAA,IAAeue,EAAfve,EAAA,UACZ5V,EAAAC,EAAAC,cAACg0B,GAAA,EAAU,CAAEC,YAAWlzB,MAAKgzB,WAG/Bj0B,EAAAC,EAAAC,cAAC+2B,GAAA,EAAD,CACE32B,MAAM,cACN6e,QAAS,aAMT9f,SAAS,QACTU,MAAO,CACL2c,IAAK,OACL5Z,OAAQ,IAGV9C,EAAAC,EAAAC,cAACg3B,GAAA,EAAD,KACEl3B,EAAAC,EAAAC,cAAC6gB,GAAA,EAAD,CACEC,KAAK,QACL1gB,MAAM,UACN4iB,aAAW,cACX/D,QAlCkB,SAAA/L,GAAA,IAAG2P,EAAH3P,EAAG2P,cAAH,OAAuB0T,EAAgB1T,KAoCzD/iB,EAAAC,EAAAC,cAACi3B,GAAA,EAAD,OAGFn3B,EAAAC,EAAAC,cAACmjB,GAAA,EAAD,CACEC,SAAUkT,EACVjX,OAAQiX,EACRhX,QAASkX,GAET12B,EAAAC,EAAAC,cAACujB,GAAA,EAAD,KACEzjB,EAAAC,EAAAC,cAACk3B,GAAA,EAAD,CAAMjD,UAAWkD,KAAYt3B,MAAO,CAAEO,MAAO,aAAc6e,QAASuX,EAAiBY,GAAG,KAAxF,iBAEFt3B,EAAAC,EAAAC,cAACujB,GAAA,EAAD,CAAU8T,UAAQ,EAACC,SAAO,GAA1B,MACChE,GAAS7yB,IAAI,SAAA4V,EAAqClF,GAArC,IAAAkG,EAAAxT,OAAAiG,EAAA,EAAAjG,CAAAwS,EAAA,GAAEgI,EAAFhH,EAAA,GAASkgB,EAATlgB,EAAA,UAAAA,EAAA,IAAAA,EAAA,IACZvX,EAAAC,EAAAC,cAACujB,GAAA,EAAD,CAAUxiB,IAAKoQ,GACbrR,EAAAC,EAAAC,cAACk3B,GAAA,EAAD,CAAM92B,MAAM,UAAU6zB,UAAWkD,KAAYlY,QAASuX,EAAiBY,GAAIG,GAAMlZ,MAGrFve,EAAAC,EAAAC,cAACujB,GAAA,EAAD,CAAU8T,UAAQ,EAACC,SAAO,GAA1B,MACC9D,GAAS/yB,IAAI,SAAA+2B,EAAermB,GAAf,IAAAsmB,EAAA5zB,OAAAiG,EAAA,EAAAjG,CAAA2zB,EAAA,GAAEnZ,EAAFoZ,EAAA,GAASF,EAATE,EAAA,UACZ33B,EAAAC,EAAAC,cAACujB,GAAA,EAAD,CAAUxiB,IAAKoQ,GACbrR,EAAAC,EAAAC,cAACk3B,GAAA,EAAD,CAAM92B,MAAM,YAAY6zB,UAAWkD,KAAYlY,QAASuX,EAAiBY,GAAIG,GAAMlZ,OAKzFve,EAAAC,EAAAC,cAAC03B,GAAD,MAEA53B,EAAAC,EAAAC,cAAC23B,GAAD,WAQI,MAAQvZ,SAASwZ,cAAc","file":"static/js/main.060916e2.chunk.js","sourcesContent":["import React from \"react\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst cellSize = 30;\r\n\r\nconst Cell = withStyles({\r\n  root: {\r\n    fontSize: 20,\r\n    fontFamily: 'jetBrainsMono',\r\n    display: 'inline-flex',\r\n    height: cellSize,\r\n    width: cellSize,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    position: 'relative',\r\n    // border: '1px solid',\r\n  },\r\n  odd: {\r\n    left: cellSize / 2,\r\n  }\r\n})(({children, classes, className = '', isOdd, style}) => (\r\n  <div\r\n    className={`${classes.root} ${className} ${isOdd ? classes.odd : ''}`}\r\n    style={style}>\r\n    {children}\r\n  </div>\r\n));\r\n\r\nexport default Cell;\r\n","import _ from 'lodash';\r\nimport Cell from \"./cell\";\r\nimport React from \"react\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst FretMarkers = withStyles({\r\n  fretMarker: {color: 'purple'}\r\n})(\r\n  ({classes: {fretMarker}, frets}) => _.range(_.last(frets) + 1)\r\n    .map(f => _.includes(frets, f) ? f : '')\r\n    .map((fret, ix) => <Cell className={fretMarker} key={ix}>{fret}</Cell>));\r\n\r\nexport default FretMarkers;\r\n","/**\r\n *\r\n * Michael L. Friedmann - https://yalebooks.yale.edu/book/9780300045376/ear-training-twentieth-century-music/\r\n * (Friedmann uses \"lev\" for 11)\r\n * @param note {number} integer - MIDI note\r\n * @param equalDivisions {number} integer - note % equalDivisions\r\n * @returns {number}\r\n */\r\nexport const toSolfege = (note, equalDivisions = 12) => ({\r\n  0: 'oh',\r\n  1: 'one',\r\n  2: 'two',\r\n  3: 'three',\r\n  4: 'four',\r\n  5: 'five',\r\n  6: 'six',\r\n  7: 'sev',\r\n  8: 'eight',\r\n  9: 'nine',\r\n  10: 'ten',\r\n  11: 'el',\r\n})[note % equalDivisions] || note % equalDivisions;\r\n\r\n/**\r\n *\r\n * @param note {number} integer - MIDI note\r\n * @param equalDivisions {number} integer - note % equalDivisions\r\n * @returns {number}\r\n */\r\nexport const toSymbol = (note, equalDivisions = 12) => ({\r\n  10: '',\r\n  11: '',\r\n})[note % equalDivisions] || note % equalDivisions;\r\n\r\n// ripped from Tone/core/Conversions\r\nexport const ftomf = (frequency) => {\r\n  return 69 + 12 * Math.log2(frequency / 440);\r\n}\r\n","import Cell from './cell';\r\nimport React from \"react\";\r\nimport {toSolfege, toSymbol} from \"./util\";\r\n\r\nconst PC = ({\r\n  classes,\r\n  isOdd,\r\n  isSolfege = false,\r\n  showOctave = false,\r\n  n,\r\n  style = isSolfege ? {\r\n    borderStyle: 'solid',\r\n    borderWidth: 1,\r\n    width: 70,\r\n  } : null,\r\n}) => (\r\n  <Cell\r\n    isOdd={isOdd}\r\n    style={style}\r\n  >\r\n    {isSolfege ? toSolfege(n) : toSymbol(n)}\r\n    {showOctave && (\r\n      <div style={{\r\n        bottom: '15%',\r\n        fontSize: '0.4em',\r\n        position: 'absolute',\r\n        right: '10%',\r\n      }} >{Math.floor(n / 12)}</div>)}\r\n  </Cell>\r\n)\r\n\r\nexport default PC;\r\n","import _ from 'lodash';\r\nimport Cell from './cell';\r\nimport FretMarkers from \"./fretMarkers\";\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\nconst frets = [1,3,5,7,10,12,15,17,19];\r\n\r\nconst Banjo = () => (\r\n  <div style={{\r\n    display: 'block',\r\n    flexShrink: 0,\r\n  }}>\r\n    <FretMarkers frets={frets} />\r\n    <br/>\r\n    {[0, 9, 5, 0, 0].map((pc0, pc0ix) => (\r\n      <React.Fragment key={pc0ix}>\r\n        {_.range(23)\r\n          .map(i => (i + pc0) % 12)\r\n          .map((pc, ix) =>\r\n            pc0ix === 4 && ix < 5\r\n              ? <Cell key={ix}/>\r\n              : <PC key={ix} n={pc}/>\r\n          )}\r\n        <br/>\r\n      </React.Fragment>\r\n    ))}\r\n    <FretMarkers frets={frets} />\r\n  </div>\r\n);\r\n\r\nexport default Banjo;\r\n","import _ from 'lodash';\r\nimport FretMarkers from \"./fretMarkers\";\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\n\r\nconst FrettedInstrument = ({ fretCount, fretMarkers, tuning }) => (\r\n  <div style={{\r\n    display: 'block',\r\n    flexShrink: 0,\r\n  }}>\r\n    <FretMarkers frets={fretMarkers}/>\r\n    <br/>\r\n    {[...tuning]\r\n      .reverse() //mutates\r\n      .map((pc0, ixPc0) => (\r\n      <React.Fragment key={ixPc0}>\r\n        {_.range(fretCount + 1 /*for zeroth*/)\r\n          .map(i => (i + pc0) % 12)\r\n          .map((pc, ix) => (\r\n            <PC key={ix} n={pc}/>\r\n          ))}\r\n        <br/>\r\n      </React.Fragment>\r\n    ))}\r\n    <FretMarkers frets={fretMarkers}/>\r\n  </div>\r\n);\r\n\r\nexport default FrettedInstrument;\r\n","import React from 'react';\r\nimport FrettedInstrument from './frettedInstrument';\r\n\r\nconst tunings = {\r\n  standard: [4, 9, 2, 7, 11, 4],\r\n  chelseaSessionsTuning: [0, 5, 0, 5, 9, 5],\r\n  octoberSongTuning: [0, 7, 0, 4, 7, 0],\r\n};\r\n\r\nconst tuning = tunings['standard'];\r\n\r\nconst Guitar = () => (\r\n  <FrettedInstrument\r\n    fretCount={24}\r\n    fretMarkers={[0, 5, 7, 12, 15, 17, 19, 24]}\r\n    tuning={tuning}\r\n  />\r\n)\r\n\r\nexport default Guitar;\r\n","import _ from 'lodash';\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\nconst Intro = () => (\r\n  <div style={{height: '100%', overflowY: 'auto', padding: '20% 10%'}}>\r\n    <h1>musicality.computer</h1>\r\n\r\n    <h2>12ET pitch-class symbols:</h2>\r\n    <pre>{_.range(12).map(pc => <PC key={pc} n={pc}/>)}</pre>\r\n\r\n    <h3>12ET pitch-classes as solfege syllables:</h3>\r\n    {_.range(12).map(pc => <PC key={pc} isSolfege n={pc}/>)}\r\n  </div>\r\n);\r\n\r\nexport default Intro;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport { toSymbol } from \"./util\";\r\nimport PC from \"./pc\";\r\n\r\nconst MultTableMod12 = () => (\r\n  <div style={{\r\n    display: 'flex',\r\n    flexWrap: 'wrap',\r\n    justifyContent: 'center',\r\n  }}>\r\n    {_.range(6).map(n => (\r\n      <div style={{\r\n        margin: '1em',\r\n      }}>\r\n        {_.range(13).map(y => (\r\n          <>\r\n            {_.range(13).map(x => (\r\n              <PC key={x} n={n + x * y} />\r\n            ))}\r\n            <br />\r\n          </>\r\n        ))}\r\n\r\n      </div>\r\n    ))}\r\n  </div>);\r\n\r\nexport default MultTableMod12;\r\n","import _ from 'lodash';\r\nimport React, { Component } from 'react';\r\nimport { toSymbol } from \"./util\";\r\n\r\nclass NumpadMod12 extends Component {\r\n  state = {\r\n    text: '',\r\n  };\r\n\r\n  componentDidMount() {\r\n    window.addEventListener('keypress', this.handleKeyPress);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('keypress', this.handleKeyPress);\r\n  }\r\n\r\n  handleKeyPress = (evt) => {\r\n    // console.log(evt.code)\r\n    const char = {\r\n      Backquote: '0',\r\n      Digit1: '1',\r\n      Digit2: '2',\r\n      Digit3: '3',\r\n      Digit4: '4',\r\n      Digit5: '5',\r\n      Digit6: '6',\r\n      Digit7: '7',\r\n      Digit8: '8',\r\n      Digit9: '9',\r\n      Digit0: '',\r\n      Minus: '',\r\n      Equal: '0',\r\n      Numpad0: '0',\r\n      Numpad1: '1',\r\n      Numpad2: '2',\r\n      Numpad3: '3',\r\n      Numpad4: '4',\r\n      Numpad5: '5',\r\n      Numpad6: '6',\r\n      Numpad7: '7',\r\n      Numpad8: '8',\r\n      Numpad9: '9',\r\n      NumpadDivide: '',\r\n      NumpadMultiply: '',\r\n      NumpadDecimal: ' ',\r\n      NumpadEnter: '\\n',\r\n      Enter: '\\n',\r\n      Space: ' ',\r\n    }[evt.code];\r\n\r\n    if (char) {\r\n      evt.preventDefault();\r\n      this.setState({ text: this.state.text + char });\r\n    }\r\n  };\r\n\r\n  handleChange = ({ target: { value }}) => this.setState({ text: value });\r\n\r\n  render() {\r\n    return <div>\r\n      <h3>Use the numpad to enter pitch classes</h3>\r\n      <textarea\r\n        cols={24}\r\n        rows={20}\r\n        onChange={this.handleChange}\r\n        style={{\r\n          background: 'black',\r\n          color: 'darkgray',\r\n          fontSize: 20,\r\n        }}\r\n        value={this.state.text}\r\n      />\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default NumpadMod12;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport globalHook from 'use-global-hook';\r\n\r\nconst midiIn = _.zipObject(\r\n  _.range(128),\r\n  _.fill(new Array(128), 0));\r\n\r\nconst initialState = {\r\n  input: undefined,\r\n  inputDevices: [],\r\n  isMidiClockInSelectorOpen: false,\r\n  isMidiInSelectorOpen: false,\r\n  midiClockInDevice: undefined,\r\n  midiInDevice: undefined,\r\n  midiIn,\r\n  outputDevices: [],\r\n};\r\n\r\nconst actions = {\r\n  setInputDevices: (store, inputDevices) =>\r\n    store.setState({inputDevices}),\r\n\r\n  setOutputDevices: (store, outputDevices) =>\r\n    store.setState({outputDevices}),\r\n\r\n  setMidiEvent: (store, midiEvt) =>\r\n    store.setState({midiIn: _.merge(store.state.midiIn, midiEvt)}),\r\n\r\n  setMidiClockInDevice: (store, midiClockInDevice) => store.setState({midiClockInDevice}),\r\n\r\n  setMidiInDevice: (store, midiInDevice) => store.setState({midiInDevice}),\r\n\r\n  toggleMidiInSelector: (store) =>\r\n    store.setState({isMidiInSelectorOpen: !store.state.isMidiInSelectorOpen}),\r\n\r\n  // todo: only 1 selector\r\n  toggleMidiClockInSelector: (store) =>\r\n    store.setState({isMidiClockInSelectorOpen: !store.state.isMidiClockInSelectorOpen}),\r\n\r\n\r\n};\r\n\r\nexport default globalHook(React, initialState, actions);\r\n","import useMidi from \"./useMidi\";\r\nimport {useEffect} from \"react\";\r\n\r\nconst useMidiClock = (onClock, onStop, onSongPos) => {\r\n  const [{midiClockInDevice}, actions] = useMidi( // https://github.com/andregardi/use-global-hook#avoid-unnecessary-renders\r\n    ({midiClockInDevice}) => ({midiClockInDevice}),\r\n    actions => actions,\r\n  );\r\n\r\n  let tick = 0;\r\n\r\n  useEffect(() => {\r\n\r\n    const handleMidiClock = (evt) => {\r\n      tick++;\r\n      if (onClock) onClock({ tick });\r\n    };\r\n\r\n    const handleStop = (evt) => {\r\n      if (onStop) onStop();\r\n      console.log('stop')\r\n    };\r\n\r\n    const handleSpp = ({ data: [,lsb,msb] }) => {\r\n      const beats = (lsb + msb * 128) * 6;\r\n      console.log('SPP', beats);\r\n      if (onSongPos) onSongPos(beats);\r\n    };\r\n\r\n    if (midiClockInDevice) {\r\n      midiClockInDevice.addListener('clock', 'all', handleMidiClock);\r\n      // midiClockInDevice.addListener('start', 'all', handleStart); // wasn't getting called\r\n      midiClockInDevice.addListener('stop', 'all', handleStop);\r\n      midiClockInDevice.addListener('songposition', 'all', handleSpp);\r\n    }\r\n\r\n    return () => {\r\n      if (midiClockInDevice) {\r\n        midiClockInDevice.removeListener('clock', 'all', handleMidiClock);\r\n        midiClockInDevice.removeListener('stop', 'all', handleStop);\r\n        midiClockInDevice.removeListener('songposition', 'all', handleSpp);\r\n      }\r\n    }\r\n  }, [midiClockInDevice]);\r\n\r\n  return {\r\n    midiClockInDevice,\r\n    reset: () => {\r\n      tick = 0;\r\n    },\r\n  };\r\n};\r\n\r\nexport default useMidiClock;\r\n","import P5 from 'p5';\r\nimport {useCallback, useState} from \"react\";\r\n\r\nexport default (sketch, initialState) => {\r\n  const [sketchState, setSketchState] = useState(initialState);\r\n  const [sketchInstance, setSketchInstance] = useState(null);\r\n  const [resizeObserver, setResizeObserver] = useState(null);\r\n\r\n  if (sketchInstance) {\r\n    sketchInstance.setState = setSketchState;\r\n    sketchInstance.state = sketchState;\r\n  }\r\n\r\n  const ref = useCallback((el) => {\r\n    if (el) {\r\n      const instance = new P5(sketch, el);\r\n      setSketchInstance(instance);\r\n\r\n      instance._height = el.clientHeight;\r\n      instance._width = el.clientWidth;\r\n\r\n      const ro = new ResizeObserver(([{contentRect: {height, width}}]) => {\r\n        instance.resizeCanvas(width, height);\r\n        if (width + height > 0) setSketchState((prevState) => ({...prevState, isRegenNeeded: true}));\r\n      });\r\n\r\n      setResizeObserver(ro);\r\n      ro.observe(el);\r\n    } else {\r\n      if (resizeObserver) resizeObserver.disconnect();\r\n    }\r\n  }, []);\r\n\r\n  return {\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n    ref,\r\n  };\r\n};\r\n","export function HSVtoHex(h, s, v) {\r\n  function rgbToHex({ r, g, b }) {\r\n    function componentToHex(c) {\r\n      var hex = c.toString(16);\r\n      return hex.length == 1 ? \"0\" + hex : hex;\r\n    }\r\n\r\n    return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\r\n  }\r\n\r\n  var r, g, b, i, f, p, q, t;\r\n  if (arguments.length === 1) {\r\n    s = h.s;\r\n    v = h.v;\r\n    h = h.h;\r\n  }\r\n  i = Math.floor(h * 6);\r\n  f = h * 6 - i;\r\n  p = v * (1 - s);\r\n  q = v * (1 - f * s);\r\n  t = v * (1 - (1 - f) * s);\r\n  switch (i % 6) {\r\n    case 0: {\r\n      r = v;\r\n      g = t;\r\n      b = p;\r\n      break;\r\n    }\r\n    case 1: {\r\n      r = q;\r\n      g = v;\r\n      b = p;\r\n      break;\r\n    }\r\n    case 2: {\r\n      r = p;\r\n      g = v;\r\n      b = t;\r\n      break;\r\n    }\r\n    case 3: {\r\n      r = p;\r\n      g = q;\r\n      b = v;\r\n      break;\r\n    }\r\n    case 4: {\r\n      r = t;\r\n      g = p;\r\n      b = v;\r\n      break;\r\n    }\r\n    case 5: {\r\n      r = v;\r\n      g = p;\r\n      b = q;\r\n      break;\r\n    }\r\n  }\r\n  return rgbToHex({\r\n    r: Math.round(r * 255),\r\n    g: Math.round(g * 255),\r\n    b: Math.round(b * 255)\r\n  });\r\n}","import _ from 'lodash';\r\n\r\n\r\n/* TODO\r\n* high prio\r\n  * fine-tune freq\r\n  * don't require redraw on freq change\r\n  * params bound to urlParams\r\n  * option to auto-choose fundamentalFreq\r\n    based on which partials are present\r\n    to center around 500 - 1000hz\r\n  * MIDI beat clock\r\n  * spiral of any length instead of hilbert\r\n\r\n* med prio\r\n  * for hilbertN of 256 or 512, use the vals to fill an audio buffer and play the ~1 or ~5s of audio\r\n  * utonal partials\r\n\r\n* low prio\r\n  * option to add a second cursor for stereo effects\r\n  * alternate space-filling curves\r\n  * keep cursor in same location when switching resolutions\r\n  * manual cursor\r\n* */\r\n\r\n// Only add setZeroTimeout to the window object, and hide everything\r\n// else in a closure.\r\n(function() {\r\n  var timeouts = [];\r\n  var messageName = \"zero-timeout-message\";\r\n\r\n  // Like setTimeout, but only takes a function argument.  There's\r\n  // no time argument (always zero) and no arguments (you have to\r\n  // use a closure).\r\n  function setZeroTimeout(fn) {\r\n    timeouts.push(fn);\r\n    window.postMessage(messageName, \"*\");\r\n  }\r\n\r\n  function handleMessage(event) {\r\n    if (event.source == window && event.data == messageName) {\r\n      event.stopPropagation();\r\n      if (timeouts.length > 0) {\r\n        var fn = timeouts.shift();\r\n        fn();\r\n      }\r\n    }\r\n  }\r\n\r\n  window.addEventListener(\"message\", handleMessage, true);\r\n\r\n  // Add the one thing we want added to the window object.\r\n  window.setZeroTimeout = setZeroTimeout;\r\n})();\r\n\r\n\r\nexport const initialState = {\r\n  audioPan: 0, // -1 - 1\r\n  decayDuration: 1000,\r\n  exciteEnergy: 0.05,\r\n  exciteDuration: 50,\r\n  fundamentalFreq: 200,\r\n  hilbertN: 64, // hilbertN must be power of 2 in order to be square\r\n  hilbMand: [/*{ x, y, m }*/], // coordinates and associated mandelbrot val in hilbert traversal order\r\n  isControlPanelOpen: true,\r\n  isPlaying: false,\r\n  isRegenNeeded: true,\r\n  maxIters: 4096, // max number of steps to recurse the mandelbrot fn\r\n  midiClock: 0,\r\n  midiClocksPerTick: 24,\r\n  panX: -0.05,\r\n  panY: 0,\r\n  partials: {/* partial: { amp, oscIdx } */}, // the collection is updated in setState but values within are changed in drawLoop directly\r\n  partialsCountMax: 16,\r\n  isSmooth: false, // smooth technique https://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n  tick: 0, // updated in draw() bypasses setState\r\n  tickDuration: 100,\r\n  tickLastMillis: 0, // updated in draw() bypasses setState\r\n  zoom: 1.2,\r\n\r\n  // zoom: 3603.7157567397, panX: 0.18580280974577668, panY: 0.00036930706052212803,\r\n\r\n  // floating point errors here\r\n  // zoom: 279919582741326.66, panX: -0.014853203736137617, panY: 0.13451319076043783,\r\n\r\n  // panX: 0.0011548427778035686,\r\n  // panY: 0.025033026937542575,\r\n  // zoom: 319852972190.0951,\r\n  //\r\n  // panX: -0.18498767183730766,\r\n  // panY: 0.4722205531430409,\r\n  // zoom: 419013953.31772846,\r\n  //\r\n  //\r\n  // decay: 0.000075,\r\n  // exciteEnergy: 0.006,\r\n  // fundamentalFreq: 10,\r\n  // hilbertN: 256,\r\n  // maxIters: 4096,\r\n  // panX: 0.0011503007796323155,\r\n  // panY: 0.025033026938902938,\r\n  // tickDuration: 10,\r\n  // zoom: 836635.9887997985,\r\n  //\r\n  //\r\n  //\r\n  // panX: 0.08871194014553094,\r\n  // panY: -0.12829271146701177,\r\n  // zoom: 19736096.460687958,\r\n\r\n  // ...{zoom: 39422433.84662852, panX: 0.04670942760989286, panY: 0.13656218122372943},\r\n\r\n  // demo for 10 partials\r\n  // ...{zoom: 12371177.464729108, panX: 0.04671008941233588, panY: 0.13656133340058238},\r\n};\r\n\r\nlet audioCtx = new AudioContext();\r\nlet oscs = [];\r\n\r\nconst masterGain = audioCtx.createGain();\r\nconst audioPanner = audioCtx.createStereoPanner();\r\nwindow.masterGain = masterGain;\r\nmasterGain.gain.value = 1;\r\nmasterGain.connect(audioPanner);\r\naudioPanner.connect(audioCtx.destination);\r\n\r\n\r\nexport const sketch = (p5) => {\r\n  p5.state = initialState;\r\n\r\n  /* Border size and color */\r\n  const CURSOR_STROKE_COLOR_SEPARATION = 20;\r\n  const CURSOR_ALPHA = 0.7;\r\n  const STROKE_WEIGHT_COEF = 1;\r\n  const STROKE_COLOR = 0;\r\n\r\n  const setupOscillators = () => {\r\n    oscs.forEach(({osc, gain}) =>\r\n    {\r\n      osc.stop();\r\n    }); // TODO: gain.disconnect? delete osc and gain?\r\n\r\n    oscs = _.range(p5.state.partialsCountMax).map(() => {\r\n      const osc = audioCtx.createOscillator();\r\n      const gain = audioCtx.createGain();\r\n      gain.gain.value = 0;\r\n      osc.connect(gain);\r\n      gain.connect(masterGain);\r\n      osc.start();\r\n      return {osc, gain};\r\n    });\r\n\r\n    window.oscs = oscs;\r\n  }\r\n\r\n  //rotate/flip a quadrant appropriately\r\n  const hilbGetRotatedVec = (n, v, rx, ry) => {\r\n    if (ry === 0) {\r\n      if (rx === 1) {\r\n        v.x = n - 1 - v.x;\r\n        v.y = n - 1 - v.y;\r\n      }\r\n\r\n      //Swap x and y\r\n      let temp = v.x;\r\n      v.x = v.y;\r\n      v.y = temp;\r\n    }\r\n  }\r\n\r\n  const hilbDistanceToCoords = (hilbertN, dist) => {\r\n    //    TODO: get distanceToVector based on percentage of maxD so that the Hilbert cursor stays in the same place when changing Hilbert resolutions\r\n    //    TODO: also click the screen to set the cursor so need amp function to convert x,y to hilbert distance\r\n\r\n    const v = {x: 0, y: 0};\r\n    // _(size)\r\n    //   .range()\r\n    //   .map(v => Math.pow(2, v))\r\n    //   .takeWhile(v => v < size)\r\n    //   .value()\r\n\r\n    for (let s = 1; s < hilbertN; s *= 2) {\r\n      let rx = 1 & (dist / 2);\r\n      let ry = 1 & (dist ^ rx);\r\n      hilbGetRotatedVec(s, v, rx, ry);\r\n      v.x += s * rx;\r\n      v.y += s * ry;\r\n      dist /= 4;\r\n    }\r\n    return v;\r\n  }\r\n\r\n  /**\r\n   * Returns amp {@code Vec} representing the Euclidian coordinates of the given normalized \"Mandelbrot coordinates\"\r\n   * <br>Mandelbrot X scale: -2.5 to 1\r\n   * <br>Mandelbrot Y scale: -1 to 1\r\n   * @param x normalized x coordinate 0 to 1.0\r\n   * @param y normalized y coordinate 0 to 1.0\r\n   * @return\r\n   */\r\n  const mandGetDenormalizedCoords = (x, y) => ({\r\n    x: -2.5 + x * 3.5,\r\n    y: -1 + y * 2,\r\n  })\r\n\r\n\r\n  /**\r\n   * Returns the number of iterations to escape the Mandelbrot set at the given coordinates\r\n   * @param scaledX\r\n   * @param scaledY\r\n   * @param maxIterations\r\n   * @return\r\n   */\r\n  const mandGetVal = (scaledX, scaledY, maxIterations) => {\r\n    let x = 0, y = 0;\r\n    let iter = 0;\r\n\r\n    while (x * x + y * y < 4 && iter < maxIterations) {\r\n      let xTemp = x * x - y * y + scaledX;\r\n      y = 2 * x * y + scaledY;\r\n      x = xTemp;\r\n      iter++;\r\n    }\r\n    return iter;\r\n  }\r\n\r\n\r\n  const dot = (v1, v2) => _.reduce(v1, (acc, val, idx) => acc + val * v2[idx], 0);\r\n\r\n  /**\r\n   * https://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n   * @param cx\r\n   * @param cy\r\n   * @param maxIterations\r\n   * @returns {*|number}\r\n   */\r\n  const mandGetValSmooth = (cx, cy, maxIterations) => {\r\n    const Bsq = 256 * 256;\r\n    const z = [0,0];\r\n    let n = 0;\r\n    let x, y;\r\n\r\n    for (let i = 0; i < maxIterations; i++) {\r\n      [x, y] = z;\r\n      z[0] = x * x - y * y + cx;\r\n      z[1] = 2 * x * y + cy;\r\n      if (dot(z, z) > Bsq) break;\r\n      n++;\r\n    }\r\n\r\n    // return n - Math.log(Math.log(Math.sqrt(z[0] * z[0] + z[1] * z[1]) / Math.log(B) / Math.log(2)))\r\n    return n >= maxIterations\r\n      ? maxIterations\r\n      : n - Math.log2(Math.log2(dot(z,z))) + 4;\r\n  }\r\n\r\n  /**\r\n   * Returns the number of iterations required to escape the Mandelbrot set at the given coordinates\r\n   * @param xN normalized x coordinate 0 to 1.0\r\n   * @param yN normalized y coordinate 0 to 1.0\r\n   * @param panX < 0 pans left. > 0 pans right\r\n   * @param panY < 0 pans up. > 0 pans down\r\n   * @param zoom 1.0 is unzoomed\r\n   * @param maxIterations\r\n   * @return\r\n   */\r\n  const mandGetValFromNormalizedCoords = (xN, yN, panX, panY, zoom, maxIterations) => {\r\n    let x1 = 0.5 - panX + (xN - 0.5) / zoom;\r\n    let y1 = 0.5 - panY + (yN - 0.5) / zoom;\r\n    const {x, y} = mandGetDenormalizedCoords(x1, y1);\r\n    return p5.state.isSmooth\r\n      ? mandGetValSmooth(x, y, maxIterations)\r\n      : mandGetVal(x, y, maxIterations);\r\n  }\r\n\r\n  const genHilbertCoords = _.memoize((hilbertN) =>\r\n    _.range(hilbertN * hilbertN)\r\n      .map(d => hilbDistanceToCoords(hilbertN, d)));\r\n\r\n\r\n  const genHilbertMandelbrot = () => {\r\n    const {\r\n      hilbertN,\r\n      maxIters,\r\n      panX,\r\n      panY,\r\n      partialsCountMax,\r\n      zoom,\r\n    } = p5.state;\r\n\r\n\r\n    return genHilbertCoords(hilbertN).map(({ x, y }) => {\r\n      const m = mandGetValFromNormalizedCoords(x / hilbertN, y / hilbertN, panX, panY, zoom, maxIters);\r\n      return {\r\n        x,\r\n        y,\r\n        m,\r\n        p: m === maxIters\r\n          ? 0 // to be filtered out\r\n          : Math.floor(((m - 1) % partialsCountMax) + 1),\r\n      };\r\n    })\r\n  };\r\n\r\n  const getStrokeWeight = (w) => {\r\n    const sideLength = w / p5.state.hilbertN;\r\n    return STROKE_WEIGHT_COEF * Math.min(10, sideLength / 20);\r\n  };\r\n\r\n  const getPartialOfOctaveStart = _.memoize((f) =>\r\n    _(100)\r\n      .range()\r\n      .map(n => Math.pow(2, n))\r\n      .dropWhile(n => f / n >= 2)\r\n      .first());\r\n\r\n  const getColorForMandelbrotVal = ({m, p}, isCursor = false) => {\r\n    const {\r\n      maxIters,\r\n      partialsCountMax,\r\n    } = p5.state;\r\n\r\n    const octMax = getPartialOfOctaveStart(partialsCountMax);\r\n    const oct = getPartialOfOctaveStart(p);\r\n\r\n    // good looks with smooth but not relevant to partials\r\n    // const h = (m * 10) % 255;\r\n    // const s = isCursor ? 0 : 255 - (m / maxIters) * 225  //(p / partialsCountMax) * 225;\r\n\r\n    const h = 255 * Math.log2(p / oct);\r\n    const s = isCursor ? 0 : 255 - Math.pow(oct / octMax, 2) * 225  //(p / partialsCountMax) * 225;\r\n    const b = isCursor\r\n      ? 255\r\n      : m === maxIters ? 0\r\n        : 30 + Math.pow(oct / octMax, 2) * 225;\r\n\r\n    return p5.color(h, s, b, isCursor ? CURSOR_ALPHA : 255);\r\n  };\r\n\r\n  const setFillColorForMandelbrotVal = (coordsWithVal, isCursor = false) => {\r\n    p5.fill(getColorForMandelbrotVal(coordsWithVal, isCursor));\r\n  }\r\n\r\n  const drawHilbertCoord = (w, h, hilbertCoord, hilbertN) => {\r\n    const scaleX = w / hilbertN;\r\n    const scaleY = h / hilbertN;\r\n    p5.rect(hilbertCoord.x * scaleX, hilbertCoord.y * scaleY, scaleX, scaleY);\r\n    // p5.circle(hilbertCoord.x * scaleX + scaleX / 2, hilbertCoord.y * scaleY + scaleY / 2, scaleX);\r\n  }\r\n\r\n  const drawHilbertMandelbrot = (w, h, state) => {\r\n    const {\r\n      hilbertN,\r\n      hilbMand,\r\n    } = state;\r\n\r\n    const strokeWeight = getStrokeWeight(p5.width / 2);\r\n    p5.strokeWeight(strokeWeight);\r\n    p5.stroke(STROKE_COLOR);\r\n\r\n    const s = getSideLengthForLinearizedMap(hilbMand.length, p5.width / 4, p5.height);\r\n\r\n    hilbMand.forEach((coordWithVal, d) => {\r\n      setFillColorForMandelbrotVal(coordWithVal);\r\n\r\n      p5.push();\r\n      {\r\n        p5.translate(p5.width / 4, 0);\r\n        drawHilbertCoord(w, h, coordWithVal, hilbertN);\r\n      }\r\n      p5.pop();\r\n\r\n      p5.push(); // TODO: is it more expensive to push/pop 1000 times or iterate over hilbMand twice?\r\n      {\r\n        p5.translate((p5.width / 4) * 3, 0);\r\n        drawLinearizedMandelbrotCoord(p5.width / 4, s, d);\r\n      }\r\n      p5.pop();\r\n    })\r\n  };\r\n\r\n  const getSideLengthForLinearizedMap = (dMax, w, h) => {\r\n    const maxA = w * h;\r\n    const largestPossibleSide = Math.sqrt(maxA / dMax);\r\n\r\n    let s = 0;\r\n    for (let i = 1; i < w; i++) {\r\n      s = w / i;\r\n      if (s > largestPossibleSide) {\r\n        continue;\r\n      }\r\n\r\n      const sqPerRow = w / s;\r\n      const rows = dMax / sqPerRow;\r\n      const leftover = dMax % sqPerRow;\r\n\r\n      if (rows * s + (leftover > 0 ? s : 0) <= h) {\r\n        break;\r\n      }\r\n    }\r\n    return s;\r\n  }\r\n\r\n  const drawLinearizedMandelbrotCoord = (w, s, d) => {\r\n    const valsPerRow = w / s;\r\n\r\n    let x = d % valsPerRow;\r\n    const y = Math.floor(d / valsPerRow);\r\n\r\n    // snake around instead of starting from the left for each row\r\n    if (y % 2 === 1) {\r\n      x = valsPerRow - (x + 1);\r\n    }\r\n\r\n    p5.rect(x * s, y * s, s, s);\r\n  }\r\n\r\n  const genAndDrawHilbertMandelbrot = () => {\r\n    p5.background(32);\r\n\r\n    // fade out. this can probably move to partials _.each\r\n    oscs.forEach(({gain}) => {\r\n      gain.gain.cancelScheduledValues(audioCtx.currentTime);\r\n      gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);\r\n    })\r\n\r\n    const {\r\n      fundamentalFreq,\r\n      partialsCountMax,\r\n    } = p5.state;\r\n\r\n    if (oscs.length !== partialsCountMax) {\r\n      setupOscillators(); // TODO: fade out first\r\n    }\r\n\r\n    const hilbMand = genHilbertMandelbrot();\r\n\r\n    const partials = _(hilbMand)\r\n      .map(({p}) => p)\r\n      .filter(_.identity) // maxIters (black) are set as p: 0\r\n      .uniq()\r\n      .sort()\r\n      .take(partialsCountMax)\r\n      .map((partial, i) => [partial, {amp: 0, oscIdx: i}])\r\n      .fromPairs()\r\n      .value();\r\n\r\n    // slide to new freqs if partials change\r\n    _.each(partials, ({decayTimerId, oscIdx, zeroGainTimerId}, partial) => {\r\n      clearTimeout(decayTimerId);\r\n      clearTimeout(zeroGainTimerId);\r\n      oscs[oscIdx].osc.frequency.cancelScheduledValues(audioCtx.currentTime);\r\n      oscs[oscIdx].osc.frequency.linearRampToValueAtTime(partial * fundamentalFreq, audioCtx.currentTime + 1);\r\n    });\r\n\r\n    p5.setState(prevState => {\r\n      const nextState = {\r\n        ...prevState,\r\n        hilbMand,\r\n        isRegenNeeded: false,\r\n        partials,\r\n      };\r\n      drawHilbertMandelbrot( p5.width / 2, p5.height, nextState);\r\n      return nextState;\r\n    });\r\n  }\r\n\r\n\r\n  const cursorErasePrev = (maxD, s, prevD) => {\r\n    const {hilbMand} = p5.state;\r\n    const prevCoordAndVal = hilbMand[prevD % maxD];\r\n\r\n    setFillColorForMandelbrotVal(prevCoordAndVal);\r\n    p5.stroke(STROKE_COLOR);\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate(p5.width / 4, 0);\r\n      drawHilbertCoord(p5.width / 2, p5.height, prevCoordAndVal, p5.state.hilbertN);\r\n    }\r\n    p5.pop();\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate((p5.width / 4) * 3, 0);\r\n      drawLinearizedMandelbrotCoord(p5.width / 4, s, prevD);\r\n    }\r\n    p5.pop();\r\n  }\r\n\r\n  let prevD = 0;\r\n  const cursorDraw = (id) => {\r\n    const {hilbMand} = p5.state;\r\n    const d = p5.state.tick % hilbMand.length;\r\n    const coordAndVal = hilbMand[d];\r\n    const sideLength = getSideLengthForLinearizedMap(hilbMand.length, p5.width / 4, p5.height);\r\n    const strokeWeight = getStrokeWeight(p5.width / 2);\r\n\r\n    p5.strokeWeight(strokeWeight);\r\n    cursorErasePrev(hilbMand.length, sideLength, prevD);\r\n    prevD = d; // maybe multiple ticks per frame when external time sync\r\n    p5.stroke((CURSOR_STROKE_COLOR_SEPARATION * id) % 255, 0, 255);\r\n    setFillColorForMandelbrotVal(coordAndVal, true);\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate(p5.width / 4, 0);\r\n      drawHilbertCoord(p5.width / 2, p5.height, coordAndVal, p5.state.hilbertN);\r\n    }\r\n    p5.pop();\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate((p5.width / 4) * 3, 0);\r\n      drawLinearizedMandelbrotCoord(p5.width / 4, sideLength, d);\r\n    }\r\n    p5.pop();\r\n  }\r\n\r\n  const cursorExcite = (id) => {\r\n    const {\r\n      audioPan,\r\n      decayDuration,\r\n      exciteEnergy,\r\n      exciteDuration,\r\n      hilbMand,\r\n      partials,\r\n      tick,\r\n    } = p5.state;\r\n\r\n    audioPanner.pan.value = audioPan;\r\n\r\n    const d = tick % hilbMand.length;\r\n    const {p} = hilbMand[d];\r\n\r\n    if (p > 0) {\r\n      const partial = partials[p];\r\n      const {\r\n        amp,\r\n        decayTimerId,\r\n        oscIdx,\r\n        zeroGainTimerId,\r\n      } = partial;\r\n      const {gain} = oscs[oscIdx];\r\n\r\n      const isExcited = _.isNumber(decayTimerId);\r\n      const currGain = isExcited ? amp : gain.gain.value;\r\n\r\n      // console.log(p, currGain);\r\n\r\n      const targetGain = 0.8 * Math.min(1, currGain + exciteEnergy * (1 - currGain));\r\n      partial.amp = targetGain;\r\n\r\n      clearTimeout(decayTimerId); // further delay the decay\r\n      clearTimeout(zeroGainTimerId); // don't reset amp to zero\r\n      gain.gain.cancelScheduledValues(0);\r\n      gain.gain.linearRampToValueAtTime(targetGain, audioCtx.currentTime + exciteDuration / 1000);\r\n\r\n      partial.decayTimerId = setTimeout(() => {\r\n        gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + decayDuration / 1000);\r\n        partial.decayTimerId = null;\r\n\r\n        partial.zeroGainTimerId = setTimeout(() => {\r\n          partial.amp = 0;\r\n        }, decayDuration)\r\n      }, exciteDuration);\r\n    }\r\n  }\r\n\r\n  const partialsDraw = () => {\r\n    const h = p5.height;\r\n    const w = p5.width / 4;\r\n\r\n    p5.noStroke();\r\n\r\n    const { partials, partialsCountMax } = p5.state;\r\n\r\n    _.each(partials, ({ amp: targetAmp, oscIdx }, p) => {\r\n      const barH = h / partialsCountMax;\r\n      const y = h * ((p - 1) / partialsCountMax);\r\n      const barW = oscs[oscIdx].gain.gain.value * w;\r\n\r\n      const c = getColorForMandelbrotVal({ m: 1, p})\r\n      p5.fill(p5.color(p5.hue(c), 255, 8));\r\n      p5.rect(0, y, w, barH);\r\n\r\n      p5.fill(c);\r\n      p5.rect(0, y, barW, barH);\r\n      p5.fill(255);\r\n      p5.rect(targetAmp * w, y, 1, barH);\r\n    })\r\n\r\n  }\r\n\r\n  let wasPaused = true;\r\n  const pauseScreenDraw = () => {\r\n    if (!p5.state.isPlaying && !p5.state.isControlPanelOpen) {\r\n      wasPaused = true;\r\n      p5.background(0, 0.1);\r\n      p5.noFill();\r\n      p5.stroke(192, 127, 90);\r\n      p5.textSize(10);\r\n      p5.text('arrow keys to move', 0, p5.height / 2 - 50, p5.width, p5.height);\r\n      p5.text('shift+arrow for zoom/resolution', 0, p5.height / 2 - 35, p5.width, p5.height);\r\n      p5.text('shift+spacebar toggle controls', 0, p5.height / 2 - 20, p5.width, p5.height);\r\n      p5.textSize(20);\r\n      p5.textAlign(p5.CENTER);\r\n      p5.text('spacebar to start', 0, p5.height / 2, p5.width, p5.height);\r\n    } else {\r\n      if (wasPaused) {\r\n        partialsDraw();\r\n        drawHilbertMandelbrot(p5.width / 2, p5.height, p5.state);\r\n        wasPaused = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  let font;\r\n  p5.preload = () => {\r\n    font = p5.loadFont('JetBrainsMono-Regular.ttf');\r\n  }\r\n\r\n  p5.setup = () => {\r\n    p5.createCanvas(p5._width, p5._height);\r\n    p5.colorMode(p5.HSB);\r\n    p5.textFont(font);\r\n    p5.incrementTick();\r\n  }\r\n\r\n  p5.incrementTick = (isExternal = false) => {\r\n    const now = p5.millis();\r\n    const {\r\n      isPlaying,\r\n      isRegenNeeded,\r\n      midiClocksPerTick,\r\n      tickDuration,\r\n      tickLastMillis,\r\n    } = p5.state;\r\n\r\n    if (isExternal) {\r\n      p5.state.midiClock++;\r\n    }\r\n\r\n    const isReady = !isRegenNeeded && (isExternal\r\n      ? p5.state.midiClock % midiClocksPerTick === 0\r\n      : isPlaying && now > tickLastMillis + tickDuration);\r\n\r\n    if (isReady) {\r\n      p5.state.tick++;\r\n      p5.state.tickLastMillis = now;\r\n      cursorExcite(0);\r\n    }\r\n\r\n    if (!isExternal && p5.state.midiClock === 0) window.setZeroTimeout(p5.incrementTick)\r\n  }\r\n\r\n  let prevTick = 0;\r\n  p5.draw = () => {\r\n    const {\r\n      isPlaying,\r\n      isRegenNeeded,\r\n      midiClock,\r\n    } = p5.state;\r\n\r\n    if (isRegenNeeded) {\r\n      genAndDrawHilbertMandelbrot();\r\n    }\r\n\r\n    // if (midiClock === 0) p5.incrementTick();\r\n\r\n    if (_.every([\r\n      !isRegenNeeded,\r\n      p5.state.tick !== prevTick,\r\n    ])) {\r\n      cursorDraw(0);\r\n      prevTick = p5.state.tick;\r\n    }\r\n\r\n    if (isPlaying) partialsDraw();\r\n\r\n    pauseScreenDraw();\r\n  }\r\n\r\n  /**\r\n   * This needs to be called by a user event handler.\r\n   * @param isPlaying\r\n   */\r\n  p5.toggleAudio = () => {\r\n    p5.setState(prevState => {\r\n      const { isPlaying } = prevState;\r\n      if (!isPlaying && audioCtx.state !== 'running') {\r\n        audioCtx.resume();\r\n      }\r\n\r\n      if (isPlaying && audioCtx.state === 'running') {\r\n        audioCtx.suspend();\r\n      }\r\n\r\n      return { ...prevState, isPlaying: !prevState.isPlaying };\r\n    });\r\n\r\n  }\r\n}\r\n","import CircularSlider from '@fseehawer/react-circular-slider';\r\nimport KeyboardArrowDownOutlinedIcon from '@material-ui/icons/KeyboardArrowDownOutlined';\r\nimport KeyboardArrowLeftOutlinedIcon from '@material-ui/icons/KeyboardArrowLeftOutlined';\r\nimport KeyboardArrowRightOutlinedIcon from '@material-ui/icons/KeyboardArrowRightOutlined';\r\nimport KeyboardArrowUpOutlinedIcon from '@material-ui/icons/KeyboardArrowUpOutlined';\r\nimport PauseCircleOutlineIcon from '@material-ui/icons/PauseCircleOutline';\r\nimport PlayCircleOutlineIcon from '@material-ui/icons/PlayCircleOutline';\r\nimport React, {useEffect, useState} from 'react';\r\nimport TuneIcon from '@material-ui/icons/Tune';\r\nimport ViewComfyOutlinedIcon from '@material-ui/icons/ViewComfyOutlined';\r\nimport ViewModuleOutlinedIcon from '@material-ui/icons/ViewModuleOutlined';\r\nimport ZoomInOutlinedIcon from '@material-ui/icons/ZoomInOutlined';\r\nimport ZoomOutOutlinedIcon from '@material-ui/icons/ZoomOutOutlined';\r\nimport _ from 'lodash';\r\nimport useMidiClock from \"./useMidiClock\";\r\nimport useP5 from './useP5';\r\nimport { HSVtoHex } from './color';\r\nimport { initialState, sketch } from \"./mandelbrotP5\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport {Button, ButtonGroup, Drawer} from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles({\r\n  paper: {\r\n    background: \"rgba(0,0,0,0.7)\",\r\n    paddingBottom: 65,\r\n  }\r\n});\r\n\r\nconst getHandleAction = (sketchInstance) => (action) => () => {\r\n  if (action === 'toggleAudio') {\r\n    sketchInstance.toggleAudio();\r\n    return;\r\n  }\r\n\r\n  sketchInstance.setState(prevState => {\r\n    const {\r\n      hilbertN,\r\n      isControlPanelOpen,\r\n      isRegenNeeded,\r\n      panX,\r\n      panY,\r\n      zoom,\r\n    } = prevState;\r\n    const panDelta = 0.1 / zoom;\r\n\r\n    const nextState = {\r\n      moveLeft: {panX: panX + panDelta},\r\n      moveRight: {panX: panX - panDelta},\r\n      moveUp: {panY: panY + panDelta},\r\n      moveDown: {panY: panY - panDelta},\r\n      resDec: {hilbertN: Math.pow(2, Math.log2(hilbertN) - 1)},\r\n      resInc: {hilbertN: Math.min(256, Math.pow(2, Math.log2(hilbertN) + 1))},\r\n      toggleControlPanel: {isControlPanelOpen: !isControlPanelOpen, isRegenNeeded},\r\n      zoomIn: {zoom: zoom * (10 / 9)},\r\n      zoomOut: {zoom: zoom * (9 / 10)},\r\n    }[action];\r\n\r\n    return {\r\n      ...prevState,\r\n      isRegenNeeded: !_.isEmpty(nextState),\r\n      ...nextState,\r\n    };\r\n  })\r\n};\r\n\r\nconst handleKeyDown = (handleAction) => (evt) => {\r\n  // console.log(evt);\r\n  const {code, shiftKey, key} = evt;\r\n\r\n  if (code === 'Space') {\r\n    handleAction(shiftKey ? 'toggleControlPanel' : 'toggleAudio')();\r\n    return;\r\n  }\r\n\r\n  const getAction = {\r\n    'ArrowDown': () => shiftKey ? 'zoomOut' : 'moveDown',\r\n    'ArrowLeft': () => shiftKey ? 'resDec' : 'moveLeft',\r\n    'ArrowRight': () => shiftKey ? 'resInc' : 'moveRight',\r\n    'ArrowUp': () => shiftKey ? 'zoomIn' : 'moveUp',\r\n  }[key];\r\n\r\n  if (getAction) handleAction(getAction())();\r\n};\r\n\r\nconst Mandelbrot = () => {\r\n  const {\r\n    ref,\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n  } = useP5(sketch, initialState);\r\n\r\n  window.sketchInstance = sketchInstance;\r\n\r\n  const handleAction = getHandleAction(sketchInstance);\r\n\r\n  useEffect(() => {\r\n    document.title = 'Mandelbrot Muse';\r\n    if (sketchInstance) {\r\n      const handler = handleKeyDown(handleAction);\r\n      window.addEventListener('keydown', handler)\r\n      return () => { // cleanup\r\n        window.removeEventListener('keydown', handler);\r\n      };\r\n    }\r\n  }, [sketchInstance]);\r\n\r\n  const {midiClockInDevice} = useMidiClock(() => {\r\n    if (sketchInstance) {\r\n      if (!sketchInstance.state.isPlaying) {\r\n        setSketchState(state => ({\r\n          ...state,\r\n          isPlaying: true,\r\n        }));\r\n      }\r\n      sketchInstance.incrementTick(true);\r\n    }\r\n  }, () => {\r\n    setSketchState(state => ({\r\n      ...state,\r\n      isPlaying: false,\r\n    }));\r\n  }, (beat) => {\r\n    if (sketchInstance) {\r\n      const { midiClocksPerTick } = sketchInstance.state;\r\n      sketchInstance.state.midiClock = beat;\r\n      sketchInstance.state.tick = Math.floor(beat / midiClocksPerTick);\r\n    }\r\n  });\r\n\r\n  return (<>\r\n    <div\r\n      ref={ref}\r\n      style={{\r\n        alignSelf: 'start',\r\n        background: 'radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)',\r\n        height: '50vw',\r\n        width: '100vw',\r\n      }}\r\n    />\r\n\r\n    <div style={{\r\n      bottom: 10,\r\n      right: 10,\r\n      padding: 0,\r\n      position: 'absolute',\r\n      textAlign: 'center',\r\n      zIndex: 1000000,\r\n    }}>\r\n      {!sketchState.isControlPanelOpen && (\r\n        <Button onClick={handleAction('toggleControlPanel')}>\r\n          show\r\n          <TuneIcon/>\r\n          controls\r\n        </Button>\r\n      )}\r\n\r\n      <Drawer\r\n        anchor=\"bottom\"\r\n        classes={useStyles()}\r\n        color=\"transparent\"\r\n        open={sketchState.isControlPanelOpen}\r\n        onClose={handleAction('toggleControlPanel')}\r\n        variant=\"persistent\"\r\n\r\n        // onMouseEnter={ev => { ev.currentTarget.style.opacity = 1 }}\r\n        // onMouseLeave={ev => { ev.currentTarget.style.opacity = 0.5 }}\r\n      >\r\n        <ButtonGroup fullWidth size=\"large\">\r\n          <Button onClick={handleAction('toggleAudio')}>\r\n            {!sketchState.isPlaying ? <PlayCircleOutlineIcon /> : <PauseCircleOutlineIcon />}\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('toggleControlPanel')}>\r\n            hide controls\r\n          </Button>\r\n        </ButtonGroup>\r\n\r\n        <ButtonGroup fullWidth size=\"large\">\r\n\r\n          <Button onClick={handleAction('resDec')}>\r\n            <ViewModuleOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('moveUp')}>\r\n            <KeyboardArrowUpOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('resInc')}>\r\n            <ViewComfyOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('zoomIn')}>\r\n            <ZoomInOutlinedIcon/>\r\n          </Button>\r\n\r\n        </ButtonGroup>\r\n\r\n        <ButtonGroup fullWidth size=\"large\">\r\n\r\n          <Button onClick={handleAction('moveLeft')}>\r\n            <KeyboardArrowLeftOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('moveDown')}>\r\n            <KeyboardArrowDownOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('moveRight')}>\r\n            <KeyboardArrowRightOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('zoomOut')}>\r\n            <ZoomOutOutlinedIcon/>\r\n          </Button>\r\n\r\n        </ButtonGroup>\r\n\r\n        <br/>\r\n\r\n        <FreqSlider\r\n          initialVal={60}\r\n          isRegenRequired\r\n          label=\"Fundamental frequency (Hz)\"\r\n          stateKey={\"fundamentalFreq\"}\r\n          sketchState={sketchState}\r\n          setSketchState={setSketchState}\r\n        />\r\n\r\n\r\n        <div style={{\r\n          display: 'flex',\r\n          flexWrap: 'wrap',\r\n          justifyContent: 'space-around',\r\n        }}>\r\n\r\n          <FreqSlider\r\n            initialVal={16}\r\n            isInt\r\n            isRegenRequired\r\n            label=\"Number of partials\"\r\n            max={1024}\r\n            min={1}\r\n            precision={1}\r\n            setSketchState={setSketchState}\r\n            size={120}\r\n            sketchState={sketchState}\r\n            stateKey={\"partialsCountMax\"}\r\n          />\r\n\r\n          <FreqSlider\r\n            initialVal={4096}\r\n            isInt\r\n            isRegenRequired\r\n            label=\"Mandelbrot iterations\"\r\n            max={8192}\r\n            min={64}\r\n            setSketchState={setSketchState}\r\n            size={120}\r\n            sketchState={sketchState}\r\n            stateKey={\"maxIters\"}\r\n          />\r\n\r\n          {midiClockInDevice ? (\r\n            <FreqSlider\r\n              key={midiClockInDevice}\r\n              isInt\r\n              min={1}\r\n              max={1024}\r\n              initialVal={24}\r\n              label=\"MIDI clocks per tick\"\r\n              size={120}\r\n              stateKey={\"midiClocksPerTick\"}\r\n              sketchState={sketchState}\r\n              setSketchState={setSketchState}\r\n            />\r\n          ) : (\r\n            <FreqSlider\r\n              key={midiClockInDevice}\r\n              initialVal={100}\r\n              label=\"Tick duration (ms)\"\r\n              size={120}\r\n              stateKey={\"tickDuration\"}\r\n              sketchState={sketchState}\r\n              setSketchState={setSketchState}\r\n            />\r\n          )}\r\n\r\n          <FreqSlider\r\n            initialVal={50}\r\n            label=\"Excite duration (ms)\"\r\n            size={120}\r\n            stateKey={\"exciteDuration\"}\r\n            sketchState={sketchState}\r\n            setSketchState={setSketchState}\r\n          />\r\n          <FreqSlider\r\n            initialVal={1000}\r\n            label=\"Decay duration (ms)\"\r\n            size={120}\r\n            stateKey={\"decayDuration\"}\r\n            sketchState={sketchState}\r\n            setSketchState={setSketchState}\r\n          />\r\n\r\n          <FreqSlider\r\n            initialVal={0.05}\r\n            label=\"Excite energy\"\r\n            precision={4}\r\n            size={120}\r\n            stateKey={\"exciteEnergy\"}\r\n            sketchState={sketchState}\r\n            setSketchState={setSketchState}\r\n          />\r\n        </div>\r\n\r\n        <ButtonGroup fullWidth size=\"large\">\r\n          <Button onClick={handleAction('toggleAudio')}>\r\n            {!sketchState.isPlaying ? <PlayCircleOutlineIcon /> : <PauseCircleOutlineIcon />}\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('toggleControlPanel')}>\r\n            hide controls\r\n          </Button>\r\n        </ButtonGroup>\r\n      </Drawer>\r\n\r\n\r\n    </div>\r\n   </>);\r\n};\r\n\r\nconst Slider = ({ sketchState, setSketchState, stateKey, ...props }) => (\r\n    <div>\r\n      {stateKey}: {sketchState[stateKey]}\r\n      <br />\r\n      <input\r\n        type=\"range\"\r\n        style={{width: 400}}\r\n        value={sketchState[stateKey]}\r\n        onChange={ev => {\r\n          const value = Number(ev.target.value);\r\n          setSketchState(state => ({\r\n            ...state,\r\n            [stateKey]: value\r\n          }))\r\n        }}\r\n        {...props}\r\n      />\r\n    </div>\r\n  );\r\n\r\n\r\nconst FreqSlider = ({\r\n  initialVal = 1,\r\n  isInt = false,\r\n  isRegenRequired = false,\r\n  label = '',\r\n  max = Number.MAX_VALUE,\r\n  min = Number.MIN_VALUE,\r\n  precision = 6,\r\n  setSketchState,\r\n  size = 240,\r\n  sketchState,\r\n  stateKey,\r\n}) => {\r\n  const degPerExp = 2048;\r\n  const errMargin = degPerExp / 3;\r\n\r\n  const constrainVal = val => Math.min(Math.max(isInt ? Math.round(val) : val, min), max);\r\n\r\n  const valToState = val => {\r\n    const freq = constrainVal(val);\r\n    const logFreq = Math.log2(freq);\r\n    const exp = Math.floor(logFreq);\r\n\r\n    return {\r\n      deg: Math.floor(degPerExp * (logFreq - exp)),\r\n      exp,\r\n      numberInputVal: freq,\r\n    };\r\n  }\r\n\r\n  const [state, setState] = useState(() => valToState(initialVal));\r\n\r\n  useEffect(() => {  // hack because react-circle-slider invokes the onChange callback when its knob position changes even via props\r\n    _.defer(() => setState(valToState(initialVal)));\r\n  }, []);\r\n\r\n  const handleChange = v => {\r\n    const {deg, exp} = state;\r\n    const didCrossUp = v >= 0 && v < errMargin && deg > degPerExp - errMargin;\r\n    const didCrossDn = deg >= 0 && deg < errMargin && v > degPerExp - errMargin;\r\n    const nextExp = didCrossUp\r\n      ? exp + 1\r\n      : didCrossDn\r\n        ? exp - 1\r\n        : exp;\r\n\r\n    const freq = constrainVal(Math.pow(2, nextExp + v / degPerExp));\r\n    const nextState = {\r\n      deg: v,\r\n      exp: nextExp,\r\n      numberInputVal: freq\r\n    };\r\n    setState(nextState);\r\n    setSketchState(state => ({\r\n      ...state,\r\n      [stateKey]: freq,\r\n    }));\r\n  }\r\n\r\n  return (\r\n    <div style={{\r\n      flex: `0 ${size + 40}px`,\r\n      height: size + 40,\r\n      marginBottom: 40,\r\n    }}>\r\n      <div style={{\r\n        height: '3em',\r\n      }}>\r\n      {label || `${stateKey}: ${sketchState[stateKey]}`}\r\n      </div>\r\n\r\n      <div\r\n        style={{\r\n          paddingTop: 10,\r\n          position: 'relative',\r\n        }}\r\n        onPointerUp={() => {\r\n          sketchState.isRegenNeeded = isRegenRequired // TODO: isFreqChanged instead of full regen\r\n        }}\r\n      >\r\n        <CircularSlider\r\n          dataIndex={state.deg}\r\n          min={0}\r\n          max={degPerExp - 1}\r\n          knobColor=\"#AAA\"\r\n          knobSize={60}\r\n          label=\"Fundamental Frequency\"\r\n          renderLabelValue={\r\n            <input\r\n              type=\"number\"\r\n              style={{\r\n                background: 'none',\r\n                border: 'none',\r\n                color: 'white',\r\n                fontSize: `${size / 100}em`,\r\n                left: '50%',\r\n                marginLeft: '-40%',\r\n                marginTop: '-0.5em',\r\n                position: 'absolute',\r\n                textAlign: 'center',\r\n                top: '50%',\r\n                width: '80%',\r\n                zIndex: 3,\r\n              }}\r\n              value={isInt ? state.numberInputVal : state.numberInputVal.toPrecision(precision)}\r\n              onChange={ev => {\r\n                setState({\r\n                  ...state,\r\n                  numberInputVal: Number(ev.target.value),\r\n                });\r\n              }}\r\n              onKeyDown={({ key }) => {\r\n                if (key === 'Enter') {\r\n                  const nextState = valToState(state.numberInputVal);\r\n                  setState(nextState);\r\n                  _.defer(() => { // hack because react-circle-slider invokes the onChange callback when its knob position changes even via props\r\n                    setState(nextState);\r\n\r\n                    setSketchState(state => ({\r\n                      ...state,\r\n                      [stateKey]: nextState.numberInputVal,\r\n                      isRegenNeeded: isRegenRequired,\r\n                    }));\r\n                  })\r\n\r\n                }\r\n              }}\r\n            />\r\n          }\r\n          onChange={handleChange}\r\n          progressColorFrom={HSVtoHex(state.exp / 15, 1, 1)}\r\n          progressColorTo={HSVtoHex((state.exp + 1) / 15, 1, 1)}\r\n          progressLineCap=\"flat\"\r\n          trackColor=\"#666\"\r\n          height={size}\r\n          width={size}\r\n        />\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nexport default Mandelbrot;\r\n","import FrettedInstrument from './frettedInstrument';\r\nimport React from 'react';\r\n\r\nconst Mandolin = () => (\r\n  <FrettedInstrument\r\n    fretCount={20}\r\n    fretMarkers={[0, 3, 5, 7, 10, 12, 15]}\r\n    tuning={[7, 2, 9, 4]}\r\n  />\r\n);\r\n\r\nexport default Mandolin;\r\n","import React from 'react';\r\nimport globalHook from 'use-global-hook';\r\n\r\nconst initialState = {\r\n  mediaStream: undefined,\r\n};\r\n\r\nconst actions = {\r\n  setMediaStream: (store, mediaStream) =>\r\n    store.setState({mediaStream}),\r\n};\r\n\r\nexport default globalHook(React, initialState, actions);\r\n","import React from 'react';\r\nimport useMic from './useMic';\r\nimport {IconButton} from \"@material-ui/core\";\r\nimport {MicOffOutlined, Mic as MicIcon} from '@material-ui/icons';\r\n\r\nconst Mic = () => {\r\n\r\n  const [state, actions] = useMic( // https://github.com/andregardi/use-global-hook#avoid-unnecessary-renders\r\n    ({mediaStream}) => ({mediaStream}),\r\n    actions => actions,\r\n  );\r\n\r\n  const handleMicOnClick = () => {\r\n    navigator.mediaDevices.getUserMedia({\r\n      audio: true,\r\n      video: false\r\n    }).then(mediaStream => {\r\n      actions.setMediaStream(mediaStream)\r\n    });\r\n  }\r\n\r\n  const handleMicOffClick = () => {\r\n    state.mediaStream.getTracks().forEach(tr => tr.stop());\r\n    actions.setMediaStream(undefined);\r\n  }\r\n\r\n  const isMicOn = !!state.mediaStream;\r\n\r\n  return (\r\n    <>\r\n      <IconButton\r\n        edge=\"start\"\r\n        color=\"inherit\"\r\n        // aria-label=\"open drawer\"\r\n        onClick={isMicOn ? handleMicOffClick : handleMicOnClick}\r\n      >\r\n        {isMicOn ? <MicOffOutlined/> : <MicIcon/>}\r\n      </IconButton>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Mic;\r\n","import React from 'react';\r\n\r\n// theme-aware svgs https://github.com/mui/material-ui/issues/34487\r\n\r\nconst MidiIcon = () => (\r\n  <svg className=\"MuiSvgIcon-root\" style={{transform: 'scale(1.5)'}} viewBox=\"0 0 100 100\">\r\n    <path d=\"M-35.146,176.527c0.179,0.52,0.775,0.946,1.325,0.946h3.5c0.55,0,0.709,0.343,0.353,0.763l-9.706,11.446  c-0.356,0.419-0.945,0.426-1.31,0.014l-10.173-11.474c-0.365-0.412-0.213-0.748,0.337-0.748h4c0.55,0,0.835-0.419,0.634-0.931  l-10.269-26.138c-0.201-0.512,0.084-0.931,0.634-0.931h9c0.55,0,0.835-0.419,0.634-0.931l-10.269-26.138  c-0.201-0.512,0.084-0.931,0.634-0.931h14.5c0.55,0,1.127,0.432,1.282,0.959l11.186,38.081c0.155,0.528-0.168,0.959-0.718,0.959  h-9.75c-0.55,0-0.854,0.426-0.675,0.946L-35.146,176.527z\"></path>\r\n    <path\r\n      d=\"M-139.085,142.885c1.738,2.029,2.818,5.84,2.818,9.948c0,3.918-0.962,7.524-2.573,9.644l2.434,1.848  c2.001-2.633,3.196-6.93,3.196-11.493c0-4.877-1.328-9.34-3.552-11.936L-139.085,142.885z\"></path>\r\n    <path\r\n      d=\"M-129.131,133.308l-2.32,1.989c3.123,3.645,5.064,10.415,5.064,17.669c0,6.911-1.722,13.304-4.607,17.102l2.434,1.849  c3.275-4.31,5.23-11.395,5.23-18.95C-123.331,144.895-125.499,137.546-129.131,133.308z\"></path>\r\n    <path\r\n      d=\"M-121.011,126.306l-2.32,1.989c4.402,5.138,7.137,14.638,7.137,24.793c0,9.672-2.425,18.638-6.485,23.983l2.434,1.849  c4.45-5.857,7.107-15.514,7.107-25.831C-113.138,142.071-116.081,132.059-121.011,126.306z\"></path>\r\n    <path\r\n      d=\"M-164.222,138.428c-2.091,2.07-6.513,4.545-11.443,4.545v0.004c-2.465,0.081-4.531,4.357-4.531,9.622  s2.066,9.541,4.531,9.622v0.004c4.93,0,9.418,2.503,11.499,4.571c-1.708-3.721-2.737-8.701-2.737-14.246  C-166.903,147.066-165.896,142.136-164.222,138.428z\"></path>\r\n    <path\r\n      d=\"M-152.596,128.72c-5.631,0-10.196,10.473-10.196,23.392s4.565,23.392,10.196,23.392s10.196-10.473,10.196-23.392  S-146.965,128.72-152.596,128.72z M-156.715,159.95c-0.988-1.74-1.683-4.459-1.683-7.796s0.695-6.056,1.683-7.796  c2.938,0.025,5.315,3.505,5.315,7.796S-153.777,159.925-156.715,159.95z\"></path>\r\n    <path\r\n      d=\"M-207.989,143.385c1.738,2.029,2.818,5.84,2.818,9.948c0,3.918-0.962,7.524-2.573,9.644l2.434,1.848  c2.001-2.633,3.196-6.93,3.196-11.493c0-4.877-1.328-9.34-3.552-11.936L-207.989,143.385z\"></path>\r\n    <path\r\n      d=\"M-198.035,133.808l-2.32,1.989c3.123,3.645,5.064,10.415,5.064,17.669c0,6.911-1.722,13.304-4.607,17.102l2.434,1.849  c3.275-4.31,5.23-11.395,5.23-18.95C-192.234,145.395-194.402,138.046-198.035,133.808z\"></path>\r\n    <path\r\n      d=\"M-233.125,138.928c-2.091,2.07-6.513,4.545-11.443,4.545v0.004c-2.465,0.081-4.531,4.357-4.531,9.622  s2.066,9.541,4.531,9.622v0.004c4.93,0,9.418,2.503,11.499,4.571c-1.708-3.721-2.737-8.701-2.737-14.246  C-235.806,147.566-234.799,142.636-233.125,138.928z\"></path>\r\n    <path\r\n      d=\"M-221.499,129.22c-5.631,0-10.196,10.473-10.196,23.392s4.565,23.392,10.196,23.392s10.196-10.473,10.196-23.392  S-215.868,129.22-221.499,129.22z M-225.618,160.45c-0.988-1.74-1.683-4.459-1.683-7.796s0.695-6.056,1.683-7.796  c2.938,0.025,5.315,3.505,5.315,7.796C-220.304,156.945-222.68,160.425-225.618,160.45z\"></path>\r\n    <path\r\n      d=\"M37.144,150.017c1.738,2.029,2.818,5.84,2.818,9.948c0,3.918-0.962,7.524-2.573,9.644l2.434,1.848  c2.001-2.633,3.196-6.93,3.196-11.493c0-4.877-1.328-9.34-3.552-11.936L37.144,150.017z\"></path>\r\n    <path\r\n      d=\"M12.008,145.56c-2.091,2.07-6.513,4.545-11.443,4.545v0.004c-2.465,0.081-4.531,4.357-4.531,9.622s2.066,9.541,4.531,9.622  v0.004c4.93,0,9.418,2.503,11.499,4.571c-1.708-3.721-2.738-8.701-2.738-14.246C9.326,154.198,10.333,149.267,12.008,145.56z\"></path>\r\n    <path\r\n      d=\"M23.634,135.852c-5.631,0-10.196,10.473-10.196,23.392s4.565,23.392,10.196,23.392s10.196-10.473,10.196-23.392  S29.265,135.852,23.634,135.852z M19.515,167.081c-0.988-1.74-1.683-4.459-1.683-7.796s0.695-6.056,1.683-7.796  c2.938,0.025,5.315,3.505,5.315,7.796S22.453,167.056,19.515,167.081z\"></path>\r\n    <path\r\n      d=\"M284.762,158.47c-4.778,0-8.787,7.542-9.893,17.719l14.814-14.814C288.225,159.526,286.548,158.47,284.762,158.47z\"></path>\r\n    <path\r\n      d=\"M285.384,178.403c0.364,1.054,0.574,2.241,0.574,3.501c0,4.291-2.377,7.771-5.315,7.796c-0.7-1.232-1.246-2.962-1.51-5.047  l-4.115,4.115c1.284,9.548,5.161,16.486,9.744,16.486c5.631,0,10.196-10.473,10.196-23.392c0-4.253-0.497-8.236-1.362-11.673  L285.384,178.403z\"></path>\r\n    <polygon\r\n      points=\"283.842,175.702 292.611,166.933 300.121,159.423 298,157.302 291.329,163.973 281.152,174.15 280.14,175.161   274.579,180.723 270.532,184.77 263.24,192.061 252,203.302 254.121,205.423 266.735,192.809 270.93,188.614 274.654,184.89   279.003,180.541 \"></polygon>\r\n    <path\r\n      d=\"M270.495,180.564c0.189-4.785,1.146-9.075,2.642-12.386c-2.091,2.07-6.513,4.545-11.443,4.545v0.004  c-2.465,0.081-4.531,4.357-4.531,9.622c0,3.924,1.148,7.296,2.754,8.794L270.495,180.564z\"></path>\r\n    <path\r\n      d=\"M269.713,194.073c1.454,0.772,2.657,1.656,3.479,2.473c-0.606-1.32-1.122-2.805-1.541-4.411L269.713,194.073z\"></path>\r\n    <path\r\n      d=\"M330.843,167.678c-2.091,2.07-6.513,4.545-11.443,4.545v0.004c-2.465,0.081-4.531,4.357-4.531,9.622  s2.066,9.541,4.531,9.622v0.004c4.93,0,9.418,2.503,11.499,4.571c-1.708-3.721-2.737-8.701-2.737-14.246  C328.162,176.316,329.169,171.386,330.843,167.678z\"></path>\r\n    <path\r\n      d=\"M348.574,193.029l-1.414-1.414l-2.121-2.121l-1.414-1.414l1.414-1.414l5.303-5.303l-5.303-5.303l-1.414-1.414l1.414-1.414  l2.121-2.121l1.414-1.414l1.414,1.414l2.026,2.026c-1.451-8.859-5.177-15.165-9.546-15.165c-5.631,0-10.196,10.473-10.196,23.392  s4.565,23.392,10.196,23.392c4.369,0,8.094-6.306,9.546-15.165l-2.026,2.026L348.574,193.029z M338.35,189.2  c-0.988-1.74-1.683-4.459-1.683-7.796c0-3.336,0.695-6.056,1.683-7.796c2.938,0.025,5.315,3.505,5.315,7.796  C343.665,185.695,341.288,189.175,338.35,189.2z\"></path>\r\n    <polygon\r\n      points=\"364.131,174.645 362.009,172.523 355.292,179.241 348.574,172.523 346.453,174.645 352.659,180.851   353.171,181.362 346.453,188.08 348.574,190.201 355.292,183.484 362.009,190.201 364.131,188.08 357.413,181.362 \"></polygon>\r\n    <path\r\n      d=\"M532.913,169.595v-0.475c5.377-0.736,9.537-5.346,9.537-10.922c0-6.085-4.951-11.037-11.037-11.037  c-6.085,0-11.036,4.951-11.036,11.037c0,5.575,4.159,10.186,9.536,10.922v0.475c-5.108,0.331-9.764,2.334-13.43,5.468l-1.388-1.388  l0.625-0.625c0.391-0.391,0.391-1.024,0-1.414l-4.361-4.36c-0.391-0.391-1.024-0.391-1.414,0l-3.372,3.372  c-0.391,0.391-0.391,1.024,0,1.414l4.36,4.361c0.391,0.391,1.024,0.391,1.414,0l0.626-0.626l1.357,1.357  c-3.682,4.081-5.929,9.482-5.929,15.399c0,12.688,10.323,23.012,23.011,23.012s23.012-10.323,23.012-23.012  C554.425,180.368,544.905,170.371,532.913,169.595z M523.378,158.198c0-4.432,3.605-8.037,8.036-8.037  c4.432,0,8.037,3.605,8.037,8.037c0,3.918-2.821,7.185-6.537,7.891v-2.807h0.885c0.552,0,1-0.448,1-1v-6.167c0-0.552-0.448-1-1-1  h-4.769c-0.552,0-1,0.448-1,1v6.167c0,0.552,0.448,1,1,1h0.884v2.807C526.198,165.383,523.378,162.116,523.378,158.198z   M531.413,212.563c-11.034,0-20.011-8.978-20.011-20.012s8.977-20.011,20.011-20.011s20.012,8.977,20.012,20.011  S542.447,212.563,531.413,212.563z\"></path>\r\n    <path\r\n      d=\"M531.413,175.54c-0.239,0-0.471,0.026-0.707,0.036v10.275c0.233-0.024,0.468-0.038,0.707-0.038  c3.716,0,6.738,3.023,6.738,6.739c0,0.177-0.007,0.353-0.02,0.528l7.944,8.056c1.483-2.523,2.349-5.451,2.349-8.583  C548.425,183.172,540.794,175.54,531.413,175.54z\"></path>\r\n    <path\r\n      d=\"M535.152,192.552c0-2.065-1.674-3.739-3.738-3.739s-3.739,1.674-3.739,3.739s1.674,3.738,3.739,3.738  c0.435,0,0.846-0.089,1.234-0.225l9.58,9.714l2.137-2.107l-9.515-9.648C535.043,193.572,535.152,193.075,535.152,192.552z\"></path>\r\n    <path\r\n      d=\"M612.769,174.993L612.769,174.993c-0.172-0.407-0.356-0.807-0.55-1.202c-0.042-0.087-0.088-0.171-0.132-0.257  c-0.152-0.3-0.309-0.596-0.474-0.888c-0.061-0.109-0.124-0.217-0.187-0.325c-0.163-0.278-0.331-0.552-0.505-0.823  c-0.06-0.094-0.119-0.189-0.181-0.281c-0.231-0.349-0.469-0.692-0.718-1.027c-0.004-0.006-0.008-0.012-0.012-0.017  c-0.262-0.352-0.535-0.695-0.816-1.031c-0.054-0.065-0.111-0.127-0.166-0.191c-0.224-0.262-0.454-0.52-0.69-0.772  c-0.079-0.085-0.16-0.169-0.241-0.252c-0.229-0.237-0.463-0.47-0.702-0.697c-0.075-0.071-0.148-0.143-0.224-0.213  c-0.637-0.591-1.306-1.148-2.007-1.665c-0.053-0.039-0.107-0.076-0.161-0.114c-0.296-0.214-0.596-0.422-0.902-0.623  c-0.088-0.058-0.177-0.114-0.265-0.17c-0.29-0.185-0.585-0.363-0.884-0.535c-0.081-0.047-0.161-0.094-0.243-0.14  c-0.77-0.431-1.567-0.82-2.388-1.161c-0.045-0.019-0.092-0.036-0.137-0.054c-0.358-0.146-0.721-0.283-1.089-0.412  c-0.093-0.033-0.187-0.064-0.28-0.095c-0.339-0.114-0.68-0.219-1.025-0.317c-0.088-0.025-0.175-0.051-0.264-0.075  c-1.923-0.522-3.943-0.805-6.028-0.805s-4.105,0.283-6.028,0.805c-0.088,0.024-0.176,0.05-0.264,0.075  c-0.345,0.098-0.687,0.204-1.025,0.317c-0.094,0.031-0.187,0.062-0.28,0.095c-0.367,0.129-0.73,0.266-1.089,0.412  c-0.046,0.019-0.092,0.035-0.137,0.054c-0.821,0.342-1.618,0.73-2.388,1.161c-0.082,0.046-0.162,0.093-0.243,0.14  c-0.299,0.172-0.594,0.35-0.884,0.535c-0.089,0.056-0.177,0.113-0.265,0.17c-0.306,0.2-0.607,0.408-0.902,0.623  c-0.053,0.039-0.108,0.075-0.161,0.114c-0.7,0.517-1.37,1.074-2.007,1.665c-0.076,0.07-0.149,0.142-0.224,0.213  c-0.239,0.227-0.473,0.46-0.702,0.697c-0.081,0.084-0.161,0.167-0.241,0.252c-0.236,0.252-0.465,0.509-0.69,0.772  c-0.055,0.064-0.111,0.126-0.166,0.191c-0.281,0.336-0.554,0.679-0.816,1.031c-0.004,0.006-0.008,0.012-0.012,0.017  c-0.249,0.335-0.487,0.679-0.718,1.027c-0.062,0.093-0.12,0.188-0.181,0.281c-0.174,0.271-0.342,0.545-0.505,0.823  c-0.063,0.108-0.126,0.216-0.187,0.325c-0.164,0.292-0.322,0.588-0.474,0.888c-0.044,0.086-0.089,0.17-0.132,0.257  c-0.194,0.395-0.379,0.795-0.55,1.201l0,0l0,0c-1.158,2.747-1.8,5.764-1.8,8.926c0,12.725,10.354,23.069,23.069,23.069  s23.069-10.344,23.069-23.069C614.569,180.756,613.927,177.74,612.769,174.993L612.769,174.993z M611.594,183.919  c0,11.078-9.015,20.094-20.094,20.094s-20.094-9.015-20.094-20.094c0-2.582,0.507-5.043,1.398-7.313l0,0  c0.147-0.375,0.307-0.742,0.476-1.106c0.034-0.073,0.07-0.144,0.105-0.217c0.329-0.687,0.693-1.353,1.096-1.995  c0.023-0.037,0.045-0.075,0.068-0.112c0.211-0.331,0.431-0.655,0.66-0.972c0.046-0.063,0.094-0.125,0.14-0.187  c0.001-0.002,0.003-0.004,0.004-0.006c0.424-0.573,0.876-1.121,1.356-1.645c0.01-0.011,0.021-0.023,0.031-0.034  c0.056-0.061,0.109-0.123,0.166-0.183c0.257-0.273,0.521-0.537,0.792-0.795c0.056-0.053,0.115-0.103,0.171-0.155  c0.014-0.013,0.029-0.026,0.043-0.039c0.496-0.457,1.013-0.887,1.552-1.293c0.108-0.081,0.215-0.164,0.325-0.243  c0.295-0.213,0.593-0.419,0.9-0.615c0.083-0.053,0.169-0.102,0.253-0.154c0.567-0.352,1.151-0.675,1.754-0.97  c0.044-0.021,0.088-0.042,0.132-0.064c0.093-0.045,0.186-0.091,0.28-0.135c0.329-0.152,0.661-0.299,0.999-0.434  c0.063-0.025,0.129-0.046,0.192-0.07c0.654-0.252,1.323-0.468,2.007-0.652c0.128-0.034,0.257-0.067,0.386-0.1  c0.033-0.008,0.066-0.018,0.099-0.026c0.354-0.085,0.708-0.167,1.069-0.233l0,0c1.182-0.218,2.396-0.347,3.64-0.347  s2.457,0.13,3.64,0.347l0,0c0.361,0.066,0.715,0.148,1.069,0.233c0.033,0.008,0.066,0.017,0.099,0.026  c0.129,0.032,0.258,0.065,0.386,0.1c0.684,0.184,1.354,0.4,2.007,0.652c0.064,0.025,0.129,0.045,0.192,0.07  c0.339,0.135,0.67,0.281,0.999,0.434c0.094,0.044,0.187,0.09,0.28,0.135c0.044,0.021,0.088,0.042,0.132,0.064  c0.602,0.295,1.187,0.618,1.754,0.97c0.084,0.052,0.17,0.1,0.253,0.154c0.307,0.197,0.605,0.403,0.9,0.615  c0.11,0.079,0.217,0.162,0.325,0.243c0.539,0.405,1.056,0.836,1.552,1.292c0.035,0.032,0.069,0.063,0.104,0.095  c0.036,0.034,0.074,0.066,0.11,0.1c0.272,0.258,0.535,0.523,0.792,0.795c0.056,0.06,0.11,0.122,0.166,0.183  c0.01,0.012,0.021,0.023,0.031,0.034c0.481,0.524,0.933,1.072,1.356,1.645c0.001,0.002,0.003,0.004,0.004,0.006  c0.046,0.063,0.095,0.124,0.14,0.187c0.229,0.318,0.449,0.641,0.66,0.972c0.023,0.037,0.045,0.075,0.068,0.112  c0.402,0.642,0.767,1.307,1.096,1.995c0.035,0.072,0.071,0.144,0.105,0.217c0.169,0.364,0.328,0.731,0.476,1.106l0,0  C611.087,178.876,611.594,181.337,611.594,183.919z\"></path>\r\n    <path\r\n      d=\"M605.757,155.737c-2.922,0-5.573,1.151-7.528,3.024c7.348,1.967,13.424,7.072,16.697,13.787  c1.099-1.701,1.741-3.724,1.741-5.901C616.667,160.621,611.782,155.737,605.757,155.737z\"></path>\r\n    <path\r\n      d=\"M602.513,171.216l-9.651,9.651c-0.417-0.186-0.876-0.295-1.362-0.295c-0.516,0-0.999,0.126-1.436,0.335l-5.955-5.68  l-2.054,2.153l6.164,5.88c-0.043,0.213-0.066,0.434-0.066,0.66c0,1.849,1.499,3.347,3.347,3.347s3.347-1.499,3.347-3.347  c0-0.256-0.034-0.502-0.089-0.741l9.858-9.858L602.513,171.216z\"></path>\r\n    <path\r\n      d=\"M584.771,158.76c-1.956-1.872-4.606-3.024-7.528-3.024c-6.025,0-10.91,4.884-10.91,10.91c0,2.177,0.641,4.2,1.741,5.901  C571.347,165.832,577.424,160.727,584.771,158.76z\"></path>\r\n    <polygon\r\n      points=\"-88.662,165.331 -70.751,147.482 -70.751,147.482 -56.52,133.299 -58.637,131.174 -71.714,144.206 -71.714,144.206   -89.857,162.287 -89.857,162.287 -104.796,177.174 -102.679,179.299 \"></polygon>\r\n    <path\r\n      d=\"M-84.891,149.473h-9c-0.55,0-0.835,0.419-0.634,0.931l3.473,8.84l18.377-18.314l-5.434-18.497  c-0.155-0.528-0.732-0.959-1.282-0.959h-14.5c-0.55,0-0.835,0.419-0.634,0.931l10.269,26.139  C-84.056,149.054-84.341,149.473-84.891,149.473z\"></path>\r\n    <path\r\n      d=\"M-69.789,150.758l-17.677,17.616l3.209,8.168c0.201,0.512-0.084,0.931-0.634,0.931h-4c-0.55,0-0.701,0.337-0.337,0.748  l10.173,11.474c0.365,0.412,0.954,0.405,1.31-0.014l9.706-11.446c0.356-0.419,0.197-0.763-0.353-0.763h-3.5  c-0.55,0-1.146-0.426-1.325-0.946l-4.85-14.109c-0.179-0.52,0.125-0.946,0.675-0.946h9.75c0.55,0,0.873-0.432,0.718-0.959  L-69.789,150.758z\"></path>\r\n    <path\r\n      d=\"M667.283,152.612h-29.565c-1.225,0-2.217,1.127-2.217,2.518v52.464c0,1.391,0.993,2.518,2.217,2.518h29.565  c1.225,0,2.217-1.128,2.217-2.518V155.13C669.5,153.74,668.507,152.612,667.283,152.612z M652.5,199.612c-5.238,0-9.5-4.262-9.5-9.5  s4.262-9.5,9.5-9.5s9.5,4.262,9.5,9.5S657.738,199.612,652.5,199.612z M652.5,161.158c1.905,0,3.455,1.55,3.455,3.455  s-1.55,3.455-3.455,3.455s-3.455-1.55-3.455-3.455S650.595,161.158,652.5,161.158z\"></path>\r\n    <circle cx=\"652.5\" cy=\"190.112\" r=\"4.955\"></circle>\r\n    <path\r\n      d=\"M740.401,182.582c0-15.109-12.292-27.401-27.401-27.401s-27.401,12.292-27.401,27.401c0,1.802,0.177,3.606,0.542,5.436  l2.71,10.726c0.193,2.308,1.797,4.354,4.163,4.988c0.969,0.26,1.946,0.248,2.854,0.016l0.421,1.571  c0.429,1.6,2.074,2.55,3.674,2.121l4.186-1.122c1.6-0.429,2.55-2.074,2.121-3.674l-4.141-15.455c-0.429-1.6-2.074-2.55-3.674-2.121  l-4.186,1.122c-1.6,0.429-2.55,2.074-2.121,3.674l0.798,2.976c-0.81,0.229-1.561,0.632-2.194,1.185l-1.685-6.667  c-0.31-1.563-0.467-3.17-0.467-4.777c0-13.455,10.946-24.401,24.401-24.401s24.401,10.946,24.401,24.401  c0,1.654-0.167,3.31-0.48,4.852l-1.686,6.655c-0.609-0.553-1.348-0.978-2.186-1.227l0.803-2.998c0.429-1.6-0.521-3.245-2.121-3.674  l-4.186-1.122c-1.6-0.429-3.245,0.521-3.674,2.121l-4.141,15.455c-0.429,1.6,0.521,3.245,2.121,3.674l4.186,1.122  c1.6,0.429,3.245-0.521,3.674-2.121l0.417-1.556c2.957,0.709,5.955-1.05,6.763-3.996l0,0l0.001-0.004  c0.003-0.009,0.006-0.018,0.009-0.027c0.004-0.016,0.006-0.032,0.01-0.048l2.933-11.585  C740.214,186.296,740.401,184.438,740.401,182.582z\"></path>\r\n    <path\r\n      d=\"M783.051,181.505c3.89-4.31,3.883-8.716,3.803-9.476c-0.04-1.27-0.61-13.342-13.25-13.342c-10.62,0-13.43,8.78-13.43,13.33  c-0.01,0.25-0.34,6.07,3.46,10.34c1.27,1.43,0.66,2.89-0.94,5.65c-1.16,1.99-2.657,4.591-1.817,6.671  c1.06,2.63,3.127,3.629,5.117,3.679c0.04,0,0.08,0,0.11,0c2.93,0,5.8-3.09,8.77-9.45c1.82-3.89,2.25-6.64,1.35-8.69  c-1.04-2.37-3.52-3.15-5.92-3.9c-3.53-1.12-7.466-2.549-6.64-7.34c0.88-3.08,3.29-7.29,9.94-7.29  c10.26,0,10.556,9.983,10.578,10.409c0,0,0.719,4.875-2.237,8.411L783.051,181.505z\"></path>\r\n    <path\r\n      d=\"M773.604,152.117c-19.77,0-19.188,19.8-19.188,20h1.375c0-0.05,0.62-4.307,2.75-8.567c2.79-5.59,8.002-8.433,15.062-8.433  c16.75,0,17,16.31,17,17c0,9.17-4.24,12.97-9.16,17.38c-1.96,1.76-3.5,4.52-5.13,7.43c-2.94,5.26-5.922,10.977-11.502,10.977  c-3.402,0-4.313-0.397-6.208-2.292c-2.35-2.36-2.794-6.106-2.794-6.146l-1.415-0.019c0,0.2,0,4.914,3.125,8.289  c1.888,2.039,3.913,2.87,7.233,2.87c7.34,0,10.97-6.49,14.17-12.21c1.51-2.69,2.94-5.24,4.53-6.67c4.99-4.48,10.15-9.11,10.15-19.61  C793.604,171.917,793.374,152.117,773.604,152.117z\"></path>\r\n    <polygon\r\n      points=\"804.908,201.531 812.765,193.531 825.461,180.604 825.461,180.604 838.891,166.93 838.891,166.93 840.004,165.796   847.174,158.495 845.034,156.393 839.896,161.624 839.896,161.624 837.722,163.837 837.722,163.837 834.892,166.719   834.892,166.719 832.729,168.921 832.729,168.921 818.57,183.338 809.88,192.187 809.88,192.187 799.034,203.231 801.174,205.332   803.925,202.532 803.925,202.532 \"></polygon>\r\n    <path\r\n      d=\"M839.597,170.492c0.102,0.902,0.111,1.505,0.111,1.625c0,9.17-4.24,12.97-9.16,17.38c-1.96,1.76-3.5,4.52-5.13,7.43  c-2.94,5.26-5.922,10.977-11.502,10.977c-3.402,0-4.313-0.397-6.208-2.292c-0.451-0.453-0.831-0.958-1.152-1.478l-1.447,1.473  c0.399,0.732,0.893,1.458,1.516,2.13c1.888,2.039,3.913,2.87,7.233,2.87c7.34,0,10.97-6.49,14.17-12.21  c1.51-2.69,2.94-5.24,4.53-6.67c4.99-4.48,10.15-9.11,10.15-19.61c0-0.059-0.024-1.804-0.548-4.235L839.597,170.492z\"></path>\r\n    <path\r\n      d=\"M804.896,172.117c0-0.05,0.62-4.307,2.75-8.568c2.79-5.59,8.002-8.432,15.062-8.432c6.891,0,10.985,2.762,13.423,6.059  l2.101-2.14c-2.896-3.785-7.661-6.92-15.524-6.92c-19.77,0-19.188,19.8-19.188,20L804.896,172.117L804.896,172.117z\"></path>\r\n    <path\r\n      d=\"M822.708,161.687c4.632,0,7.229,2.035,8.691,4.307l2.06-2.098c-1.856-2.787-5.091-5.209-10.751-5.209  c-10.62,0-13.43,8.78-13.43,13.33c-0.01,0.25-0.34,6.07,3.46,10.34c0.548,0.618,0.729,1.247,0.648,1.979l7.425-7.56  c-0.464-0.161-0.933-0.312-1.403-0.459c-3.53-1.12-7.466-2.549-6.64-7.34C813.648,165.897,816.058,161.687,822.708,161.687z\"></path>\r\n    <path\r\n      d=\"M832.155,181.505c2.37-2.626,3.29-5.282,3.632-7.133l-3.077,3.133c-0.349,1.018-0.871,2.058-1.661,3.003L832.155,181.505z\"></path>\r\n    <path\r\n      d=\"M815.098,198.357c0.04,0,0.08,0,0.11,0c2.93,0,5.8-3.09,8.77-9.45c0.704-1.505,1.195-2.836,1.486-4.025l-12.691,12.922  C813.517,198.162,814.312,198.338,815.098,198.357z\"></path>\r\n    <path\r\n      d=\"M857.5,157.362v48h68.75v-48H857.5z M871.119,184.737v-25.375h3.286v25.375h2.125v18.625h-7.535v-18.625H871.119z   M878.529,184.737h2.125v-25.375h5.411v44h-7.536V184.737z M888.065,159.362h5.411v25.375h2.125v18.625h-7.536V159.362z   M897.602,184.737h2.125v-25.375h3.286v25.375h2.125v18.625h-7.535v-18.625H897.602z M907.137,184.737h2.125v-25.375h3.286v25.375  h2.125v18.625h-7.536V184.737z M859.5,159.362h5.369v25.375h2.125v18.625H859.5V159.362z M924.25,203.362h-7.577v-18.625h2.125  v-25.375h5.452V203.362z\"></path>\r\n    <g><polygon points=\"-421.569,177.979 -426.233,163.208 -429.591,173.085 -434.319,165.33 -437.268,169.644 -443.712,162.577    -441.496,160.556 -437.606,164.822 -434.174,159.803 -430.367,166.048 -426.127,153.579 -421.84,167.154 -417.795,151.671    -412.486,165.512 -408.769,158.754 -403.676,165.884 -399.929,159.986 -395.431,165.632 -397.777,167.501 -399.654,165.147    -403.532,171.249 -408.439,164.378 -412.972,172.621 -417.252,161.462  \"></polygon></g>\r\n    <g><polygon points=\"-409.561,-58.915 -419.572,-82.993 -416.802,-84.144 -409.35,-66.222 -400.721,-84.005 -391.99,-66.004    -383.147,-84.22 -373.13,-60.145 -375.9,-58.992 -383.358,-76.917 -391.99,-59.132 -400.721,-77.132  \"></polygon></g>\r\n    <g><polygon points=\"-287.095,-57.809 -304.842,-82.61 -302.403,-84.356 -290.095,-67.157 -290.096,-84.793 -275.842,-66.793    -275.839,-85.327 -258.719,-60.331 -261.194,-58.635 -272.841,-75.639 -272.842,-58.173 -287.096,-76.172  \"></polygon></g>\r\n    <g><path d=\"M-430.636-58.068c-3.541,0-4.659-5.833-6.075-13.218c-0.673-3.508-1.914-9.984-3.128-10.757   c-1.214,0.773-2.456,7.249-3.128,10.757c-1.416,7.385-2.534,13.218-6.075,13.218c-3.539,0-4.656-5.833-6.071-13.217   c-0.672-3.507-1.913-9.98-3.125-10.758c-1.214,0.776-2.455,7.25-3.127,10.758c-1.416,7.385-2.533,13.217-6.073,13.217   c-3.539,0-4.657-5.833-6.072-13.218c-0.685-3.572-1.958-10.22-3.192-10.794l0.067-2.988c3.539,0,4.656,5.833,6.071,13.217   c0.672,3.507,1.913,9.98,3.125,10.758c1.213-0.777,2.454-7.25,3.126-10.757c1.416-7.385,2.533-13.218,6.073-13.218   c3.539,0,4.657,5.833,6.072,13.218c0.672,3.507,1.912,9.98,3.125,10.757c1.214-0.774,2.456-7.25,3.128-10.758   c1.416-7.385,2.534-13.217,6.075-13.217s4.659,5.833,6.075,13.218c0.685,3.572,1.96,10.222,3.195,10.794L-430.636-58.068z\"></path></g>\r\n    <rect x=\"-362.191\" y=\"157.027\" width=\"6.333\" height=\"19.085\"></rect>\r\n    <rect x=\"-351.913\" y=\"143.362\" width=\"6.333\" height=\"32.75\"></rect>\r\n    <rect x=\"-341.635\" y=\"130.112\" width=\"6.333\" height=\"46\"></rect>\r\n    <rect x=\"-331.358\" y=\"148.708\" width=\"6.333\" height=\"27.404\"></rect>\r\n    <rect x=\"-321.08\" y=\"137.942\" width=\"6.333\" height=\"38.17\"></rect>\r\n    <rect x=\"-310.802\" y=\"162.41\" width=\"6.333\" height=\"13.702\"></rect>\r\n    <rect x=\"-300.524\" y=\"157.027\" width=\"6.333\" height=\"19.085\"></rect>\r\n    <g><path d=\"M-1020.055-86.386c5.171-3.442,11.794-3.932,17.395-1.429l-2.85,3.21l11.721,2.405l-3.776-11.353l-3.014,3.395   c-6.704-3.368-14.845-2.916-21.14,1.276c-8.138,5.419-11.494,15.964-7.979,25.074l2.799-1.08   C-1029.911-72.698-1027.033-81.739-1020.055-86.386z\"></path>\r\n      <path\r\n        d=\"M-989.966-78.352l-2.799,1.08c3.013,7.809,0.135,16.85-6.844,21.497c-5.17,3.442-11.793,3.932-17.395,1.429l2.85-3.21   l-11.721-2.405l3.776,11.353l3.015-3.396c2.968,1.491,6.217,2.235,9.465,2.235c4.085,0,8.167-1.175,11.673-3.51   C-989.808-58.697-986.452-69.242-989.966-78.352z\"></path></g>\r\n    <g><path d=\"M50,19.827c-16.637,0-30.173,13.536-30.173,30.173c0,16.638,13.536,30.173,30.173,30.173S80.173,66.638,80.173,50   C80.173,33.363,66.637,19.827,50,19.827z M50,77.173c-14.983,0-27.173-12.189-27.173-27.173S35.017,22.827,50,22.827   S77.173,35.017,77.173,50S64.983,77.173,50,77.173z\"></path>\r\n      <path\r\n        d=\"M55.5,26.818v5.349h-11v-5.349C33.993,29.301,26.172,38.734,26.172,50c0,13.16,10.668,23.828,23.828,23.828   c13.16,0,23.828-10.668,23.828-23.828C73.827,38.734,66.007,29.301,55.5,26.818z M33.484,51.93l-0.266,0.128l-3.912,1.875   l-1.035-2.16l3.912-1.875l0.266-0.128l0.017-0.295c0.064-1.111,0.716-2.095,1.703-2.567c0.407-0.195,0.84-0.294,1.287-0.294   c0.628,0,1.261,0.204,1.781,0.575l0.24,0.171l0.266-0.128l3.912-1.875l1.035,2.159l-3.912,1.875l-0.266,0.128l-0.017,0.295   c-0.064,1.111-0.716,2.095-1.703,2.567c-0.407,0.195-0.84,0.294-1.287,0.294c-0.628,0-1.261-0.204-1.781-0.575L33.484,51.93z    M42.769,57.906c0.435,1.024,0.286,2.195-0.389,3.056c-0.572,0.729-1.438,1.147-2.377,1.147c-0.166,0-0.334-0.013-0.498-0.04   l-0.291-0.047l-0.182,0.232l-2.677,3.414l-1.885-1.477l2.677-3.414l0.182-0.232l-0.115-0.272c-0.435-1.024-0.286-2.195,0.389-3.056   c0.572-0.729,1.438-1.147,2.377-1.147c0.166,0,0.334,0.013,0.498,0.04l0.291,0.047l0.182-0.232l2.677-3.414l1.885,1.478   l-2.677,3.414l-0.182,0.232L42.769,57.906z M51.456,66.597l-0.258,0.143v0.295v4.338h-2.395v-4.338V66.74l-0.258-0.143   c-0.974-0.538-1.579-1.551-1.579-2.645c0-1.094,0.605-2.107,1.579-2.645l0.258-0.143v-0.295v-4.338h2.395v4.338v0.295l0.258,0.143   c0.974,0.538,1.579,1.551,1.579,2.645C53.035,65.046,52.43,66.059,51.456,66.597z M63.645,65.669l-2.677-3.414l-0.182-0.232   l-0.291,0.047c-0.164,0.027-0.332,0.04-0.498,0.04c-0.939,0-1.805-0.418-2.377-1.147c-0.675-0.861-0.824-2.032-0.389-3.056   l0.115-0.272l-0.182-0.232l-2.677-3.414l1.885-1.478l2.677,3.414l0.182,0.232l0.291-0.047c0.164-0.027,0.332-0.04,0.498-0.04   c0.939,0,1.805,0.418,2.377,1.147c0.675,0.861,0.824,2.032,0.389,3.056l-0.115,0.272l0.182,0.232l2.677,3.414L63.645,65.669z    M66.782,52.057l-0.266-0.128l-0.24,0.171c-0.52,0.371-1.152,0.575-1.781,0.575c-0.447,0-0.88-0.099-1.287-0.294   c-0.986-0.473-1.639-1.456-1.703-2.567l-0.017-0.295l-0.266-0.128l-3.912-1.875l1.035-2.159l3.912,1.875l0.266,0.128l0.24-0.171   c0.52-0.371,1.152-0.575,1.781-0.575c0.447,0,0.88,0.099,1.287,0.294c0.986,0.473,1.639,1.456,1.703,2.567l0.017,0.295l0.266,0.128   l3.912,1.875l-1.035,2.16L66.782,52.057z\"></path></g>\r\n    <g><polygon points=\"-345.613,-58.068 -356.915,-58.068 -356.915,-82.068 -362.191,-82.068 -362.191,-85.068 -353.915,-85.068    -353.915,-61.068 -348.613,-61.068 -348.613,-85.068 -337.481,-85.068 -337.481,-61.568 -331.671,-61.568 -331.671,-85.068    -320.54,-85.068 -320.54,-61.568 -315.941,-61.568 -315.941,-58.568 -323.54,-58.568 -323.54,-82.068 -328.671,-82.068    -328.671,-58.568 -340.481,-58.568 -340.481,-82.068 -345.613,-82.068  \"></polygon></g>\r\n    <g><path d=\"M-833.962-52.234c-5.517,0-9.726-3.466-12.172-10.023c-1.184-3.173-1.672-6.312-1.867-8.073h-20.625   c-3.009,0-5.553-1.053-7.562-3.13c-3.986-4.12-4.713-11.205-4.832-14.381c-19.44,1.561-19.67,33.775-19.67,34.108h-3   c0-0.372,0.276-37.167,24.154-37.167h1.548l-0.049,1.549c-0.003,0.093-0.247,9.417,4.009,13.81   c1.442,1.488,3.209,2.212,5.402,2.212h23.431l0.068,1.43c0.008,0.167,0.915,16.667,11.165,16.667V-52.234z\"></path></g>\r\n    <g><path d=\"M-748.533-54.65l-0.377,1.964c0.697,0.134,1.431,0.202,2.179,0.202v-2C-747.354-54.484-747.96-54.54-748.533-54.65z\"></path>\r\n      <path\r\n        d=\"M-759.411-65.35c0.36,1.435,0.8,2.782,1.306,4.004l1.848-0.766c-0.469-1.131-0.877-2.385-1.214-3.726L-759.411-65.35z\"></path>\r\n      <path\r\n        d=\"M-754.437-58.729l-1.637,1.148c0.899,1.282,1.929,2.339,3.06,3.142l1.157-1.631   C-752.8-56.74-753.668-57.635-754.437-58.729z\"></path>\r\n      <path\r\n        d=\"M-758.395-71.627l-0.045-0.953h-2.954v2h1.076c0.03,0.31,0.072,0.686,0.128,1.117l1.983-0.26   C-758.358-70.879-758.395-71.62-758.395-71.627z\"></path>\r\n      <path\r\n        d=\"M-788.615-76.882l-1.721,1.019c0.741,1.252,1.62,2.299,2.612,3.112l1.268-1.547   C-787.268-74.963-787.994-75.833-788.615-76.882z\"></path>\r\n      <path\r\n        d=\"M-790.868-83.585l-1.972,0.333c0.227,1.344,0.532,2.613,0.908,3.774l1.902-0.616   C-790.375-81.163-790.658-82.337-790.868-83.585z\"></path>\r\n      <path\r\n        d=\"M-783.542-72.833l-0.485,1.94c0.828,0.207,1.713,0.312,2.632,0.312h1.319v-2h-1.319   C-782.15-72.581-782.873-72.666-783.542-72.833z\"></path>\r\n      <rect x=\"-776.339\" y=\"-72.581\" width=\"3.736\" height=\"2\"></rect>\r\n      <rect x=\"-768.867\" y=\"-72.581\" width=\"3.736\" height=\"2\"></rect>\r\n      <path\r\n        d=\"M-791.267-87.625c-0.062-1.158,0-3.018,0-3.026l-1.039,0.012v-0.012c-0.106,0-0.203,0.014-0.308,0.015l-0.697,0.008   c0,0.001,0,0.02-0.001,0.026c-22.863,1.035-23.149,36.751-23.149,37.118h3c0-0.339,0.249-33.586,20.647-34.141H-791.267z\"></path></g>\r\n    <g><path d=\"M-721.096-82.177l1.613,1.182c0.758-1.036,1.579-1.977,2.438-2.796l-1.38-1.447   C-719.369-84.338-720.268-83.308-721.096-82.177z\"></path>\r\n      <path\r\n        d=\"M-715.179-87.743l1.04,1.708c1.044-0.636,2.16-1.15,3.315-1.528l-0.621-1.901   C-712.746-89.038-714.003-88.459-715.179-87.743z\"></path>\r\n      <path\r\n        d=\"M-727.277-67.536l1.949,0.447c0.293-1.275,0.625-2.52,0.985-3.698l-1.912-0.586   C-726.629-70.148-726.974-68.857-727.277-67.536z\"></path>\r\n      <path\r\n        d=\"M-728.584-59.73l1.988,0.22c0.142-1.284,0.318-2.566,0.525-3.811l-1.973-0.328   C-728.256-62.369-728.438-61.05-728.584-59.73z\"></path>\r\n      <path\r\n        d=\"M-724.929-75.13l1.854,0.749c0.492-1.216,1.03-2.372,1.601-3.434l-1.762-0.946   C-723.841-77.635-724.411-76.413-724.929-75.13z\"></path>\r\n      <path\r\n        d=\"M-728.978-53.734h2c0-0.015,0.001-0.728,0.066-1.941l-1.997-0.106C-728.979-54.488-728.978-53.734-728.978-53.734z\"></path>\r\n      <path\r\n        d=\"M-661.552-54.899l-0.377,1.964c0.698,0.134,1.432,0.202,2.18,0.202v-2C-660.371-54.734-660.979-54.789-661.552-54.899z\"></path>\r\n      <path\r\n        d=\"M-667.455-58.978l-1.637,1.149c0.9,1.282,1.931,2.339,3.06,3.141l1.158-1.631   C-665.818-56.989-666.686-57.884-667.455-58.978z\"></path>\r\n      <path\r\n        d=\"M-672.43-65.599c0.361,1.438,0.801,2.784,1.306,4.003l1.848-0.765c-0.468-1.129-0.876-2.383-1.214-3.727L-672.43-65.599z\"></path>\r\n      <path\r\n        d=\"M-671.413-71.876l-0.045-0.954h-2.954v2h1.075c0.03,0.31,0.072,0.687,0.129,1.118l1.982-0.261   C-671.377-71.128-671.413-71.869-671.413-71.876z\"></path>\r\n      <rect x=\"-688.814\" y=\"-72.83\" width=\"3.601\" height=\"2\"></rect>\r\n      <rect x=\"-681.614\" y=\"-72.83\" width=\"3.601\" height=\"2\"></rect>\r\n      <path\r\n        d=\"M-699.816-75.542c-4.256-4.393-4.183-14.765-4.18-14.858l-1.329,0.025V-90.4c-0.709,0-0.824-0.014-1.506,0.053   c-0.015,0.434-0.286,11.574,4.854,16.887c2.01,2.077,5.668,3.13,9.562,3.13v-0.5v-2v-0.31   C-695.558-72.83-698.374-74.054-699.816-75.542z\"></path></g>\r\n    <g><path d=\"M-614.292-76.95l-1.703,1.05c0.783,1.27,1.712,2.318,2.76,3.116l1.211-1.592C-612.876-75.023-613.638-75.89-614.292-76.95z   \"></path>\r\n      <path\r\n        d=\"M-616.647-83.773l-1.971,0.339c0.236,1.378,0.555,2.675,0.946,3.854l1.898-0.63   C-616.133-81.294-616.427-82.493-616.647-83.773z\"></path>\r\n      <path\r\n        d=\"M-617.094-89.369l0.033-1.032h-1.032c-0.709,0-1.414,0.034-2.096,0.101l0.195,1.99c0.297-0.029,0.598-0.051,0.902-0.066   c0.007,0.292,0.019,0.637,0.039,1.026l1.998-0.106C-617.117-88.615-617.094-89.361-617.094-89.369z\"></path>\r\n      <path\r\n        d=\"M-627.948-87.743l1.041,1.708c1.043-0.636,2.158-1.15,3.314-1.528l-0.621-1.901   C-625.517-89.038-626.773-88.459-627.948-87.743z\"></path>\r\n      <path\r\n        d=\"M-633.865-82.177l1.613,1.182c0.758-1.035,1.578-1.976,2.439-2.796l-1.381-1.447   C-632.138-84.337-633.038-83.307-633.865-82.177z\"></path>\r\n      <path\r\n        d=\"M-637.699-75.13l1.855,0.748c0.488-1.21,1.026-2.366,1.6-3.434l-1.762-0.946C-636.613-77.63-637.183-76.408-637.699-75.13z   \"></path>\r\n      <path\r\n        d=\"M-641.354-59.732l1.988,0.222c0.144-1.292,0.32-2.574,0.526-3.811l-1.973-0.328   C-641.024-62.377-641.206-61.059-641.354-59.732z\"></path>\r\n      <path\r\n        d=\"M-640.045-67.536l1.949,0.447c0.291-1.271,0.623-2.516,0.984-3.699l-1.912-0.585   C-639.399-70.144-639.743-68.853-640.045-67.536z\"></path>\r\n      <path\r\n        d=\"M-641.747-53.734h2c0-0.014,0.001-0.728,0.065-1.942l-1.998-0.105C-641.747-54.489-641.747-53.734-641.747-53.734z\"></path>\r\n      <path\r\n        d=\"M-574.321-54.9l-0.377,1.964c0.698,0.134,1.432,0.202,2.18,0.202v-2C-573.14-54.734-573.748-54.79-574.321-54.9z\"></path>\r\n      <path\r\n        d=\"M-580.224-58.979l-1.637,1.149c0.9,1.282,1.931,2.339,3.06,3.141l1.158-1.631   C-578.587-56.989-579.455-57.884-580.224-58.979z\"></path>\r\n      <path\r\n        d=\"M-585.199-65.6c0.361,1.438,0.801,2.784,1.306,4.003l1.848-0.765c-0.468-1.129-0.876-2.383-1.214-3.727L-585.199-65.6z\"></path>\r\n      <path\r\n        d=\"M-584.04-70.331c-0.151-1.155-0.225-2.993-0.225-3h-0.917h-1.002h-22.769l-0.562,3h23.462h0.871H-584.04z\"></path></g>\r\n    <g><path d=\"M-527.172-77.383l-1.721,1.021c0.743,1.253,1.622,2.3,2.613,3.111l1.268-1.547   C-525.821-75.462-526.549-76.332-527.172-77.383z\"></path>\r\n      <path\r\n        d=\"M-522.096-73.333l-0.486,1.94c0.828,0.207,1.713,0.312,2.631,0.312h1.32v-2h-1.32   C-520.707-73.081-521.428-73.166-522.096-73.333z\"></path>\r\n      <path\r\n        d=\"M-529.425-84.085l-1.973,0.335c0.229,1.349,0.535,2.618,0.909,3.773l1.902-0.616   C-528.929-81.657-529.212-82.832-529.425-84.085z\"></path>\r\n      <rect x=\"-507.423\" y=\"-73.081\" width=\"3.736\" height=\"2\"></rect>\r\n      <rect x=\"-514.895\" y=\"-73.081\" width=\"3.736\" height=\"2\"></rect>\r\n      <path\r\n        d=\"M-529.863-89.619l0.033-1.032h-1.032c-0.709,0-1.414,0.034-2.096,0.101l0.195,1.99c0.297-0.029,0.598-0.051,0.902-0.066   c0.007,0.292,0.019,0.637,0.039,1.026l1.998-0.106C-529.885-88.865-529.863-89.611-529.863-89.619z\"></path>\r\n      <path\r\n        d=\"M-552.813-67.786l1.949,0.447c0.291-1.271,0.623-2.516,0.984-3.699l-1.912-0.585   C-552.168-70.394-552.511-69.103-552.813-67.786z\"></path>\r\n      <path\r\n        d=\"M-554.123-59.982l1.988,0.222c0.144-1.292,0.32-2.574,0.526-3.811l-1.973-0.328   C-553.793-62.627-553.974-61.309-554.123-59.982z\"></path>\r\n      <path\r\n        d=\"M-550.468-75.38l1.855,0.748c0.488-1.21,1.026-2.366,1.6-3.434l-1.762-0.946C-549.382-77.88-549.952-76.658-550.468-75.38z   \"></path>\r\n      <path\r\n        d=\"M-546.634-82.427l1.613,1.182c0.758-1.035,1.578-1.976,2.439-2.796l-1.381-1.447   C-544.907-84.587-545.806-83.557-546.634-82.427z\"></path>\r\n      <path\r\n        d=\"M-540.717-87.993l1.041,1.708c1.043-0.636,2.158-1.15,3.314-1.528l-0.621-1.901   C-538.286-89.288-539.542-88.709-540.717-87.993z\"></path>\r\n      <path\r\n        d=\"M-554.515-53.984h2c0-0.014,0.001-0.728,0.065-1.942l-1.998-0.105C-554.515-54.739-554.515-53.984-554.515-53.984z\"></path>\r\n      <path\r\n        d=\"M-496.512-73.081h-1.438h-1h-0.498c0.009,0.194,0.24,5.882,1.989,10.572c2.446,6.558,6.655,10.024,12.172,10.024v-3   C-495.845-55.432-496.504-72.914-496.512-73.081z\"></path></g>\r\n    <g><path d=\"M-941.887-94.26l2.223,3.85c7.844,3.119,13.411,10.771,13.411,19.712c0,11.701-9.52,21.221-21.22,21.221   s-21.22-9.52-21.22-21.221c0-8.942,5.567-16.593,13.411-19.712l2.223-3.85c-10.67,2.53-18.634,12.131-18.634,23.563   c0,13.355,10.865,24.221,24.22,24.221s24.22-10.865,24.22-24.221C-923.253-82.13-931.218-91.731-941.887-94.26z\"></path>\r\n      <path\r\n        d=\"M-965.002-70.698c0,9.681,7.848,17.529,17.529,17.529s17.529-7.848,17.529-17.529c0-7.462-4.67-13.817-11.24-16.347   l-6.288-10.892l-6.288,10.892C-960.332-84.515-965.002-78.159-965.002-70.698z M-934.914-70.698c0,6.937-5.623,12.56-12.56,12.56   s-12.56-5.623-12.56-12.56c0-6.937,5.623-12.56,12.56-12.56S-934.914-77.634-934.914-70.698z\"></path></g>\r\n    <g><path d=\"M-1097.062-64.348c-0.013,0-0.025-0.004-0.038-0.004v18.079h2v-18.078c-0.013,0-0.025,0.003-0.038,0.003H-1097.062z\"></path>\r\n      <path\r\n        d=\"M-1095.138-84.861c0.013,0,0.025,0.004,0.038,0.004v-7.331h-2v7.331c0.013,0,0.025-0.004,0.038-0.004H-1095.138z\"></path>\r\n      <path\r\n        d=\"M-1083.638-73.861c0.013,0,0.025,0.003,0.038,0.003v-18.33h-2v18.33c0.013,0,0.025-0.003,0.038-0.003H-1083.638z\"></path>\r\n      <path\r\n        d=\"M-1085.562-53.348c-0.013,0-0.025-0.004-0.038-0.004v7.079h2v-7.079c-0.013,0-0.025,0.004-0.038,0.004H-1085.562z\"></path>\r\n      <path\r\n        d=\"M-1074.062-60.348c-0.013,0-0.025-0.003-0.038-0.003v14.078h2v-14.078c-0.013,0-0.025,0.003-0.038,0.003H-1074.062z\"></path>\r\n      <path\r\n        d=\"M-1072.138-80.861c0.013,0,0.025,0.004,0.038,0.004v-11.331h-2v11.331c0.013,0,0.025-0.004,0.038-0.004H-1072.138z\"></path>\r\n      <path\r\n        d=\"M-1062.562-56.348c-0.013,0-0.025-0.004-0.038-0.004v10.079h2v-10.079c-0.013,0-0.025,0.004-0.038,0.004H-1062.562z\"></path>\r\n      <path\r\n        d=\"M-1060.638-76.861c0.013,0,0.025,0.003,0.038,0.003v-15.33h-2v15.33c0.013,0,0.025-0.003,0.038-0.003H-1060.638z\"></path>\r\n      <path\r\n        d=\"M-1049.138-79.487c0.013,0,0.025,0.004,0.038,0.004v-12.705h-2v12.705c0.013,0,0.025-0.004,0.038-0.004H-1049.138z\"></path>\r\n      <path\r\n        d=\"M-1051.062-58.974c-0.013,0-0.025-0.003-0.038-0.003v12.704h2v-12.705c-0.013,0-0.025,0.004-0.038,0.004H-1051.062z\"></path>\r\n      <path\r\n        d=\"M-1095.1-81.857L-1095.1-81.857c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1093.174-80.967-1094.035-81.836-1095.1-81.857   z\"></path>\r\n      <path\r\n        d=\"M-1083.6-70.857L-1083.6-70.857c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1081.674-69.967-1082.535-70.836-1083.6-70.857   z\"></path>\r\n      <path\r\n        d=\"M-1072.1-77.857L-1072.1-77.857c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1070.174-76.967-1071.035-77.836-1072.1-77.857   z\"></path>\r\n      <path\r\n        d=\"M-1060.6-73.857L-1060.6-73.857c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1058.674-72.967-1059.535-73.836-1060.6-73.857   z\"></path>\r\n      <path\r\n        d=\"M-1049.1-76.483L-1049.1-76.483c-0.013,0-0.025-0.004-0.038-0.004h-1.925c-0.013,0-0.025,0.004-0.038,0.004l0,0   c-1.065,0.021-1.926,0.89-1.926,1.96v10.584c0,1.07,0.861,1.94,1.926,1.961l0,0c0.013,0,0.025,0.004,0.038,0.004h1.925   c0.013,0,0.025-0.004,0.038-0.004l0,0c1.065-0.021,1.926-0.89,1.926-1.961v-10.584C-1047.174-75.593-1048.035-76.462-1049.1-76.483   z\"></path></g>\r\n  </svg>\r\n)\r\n\r\nexport default MidiIcon;\r\n","import _ from 'lodash';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport React, {useEffect} from 'react';\r\nimport MidiIcon from './icons/midiIcon';\r\nimport useMidi from './useMidi';\r\nimport {WebMidi} from 'webmidi';\r\nimport {IconButton, Toolbar} from \"@material-ui/core\";\r\nimport {WatchLater as MidiClockIcon} from '@material-ui/icons';\r\n\r\nconst Midi = () => {\r\n\r\n  const [state, actions] = useMidi( // https://github.com/andregardi/use-global-hook#avoid-unnecessary-renders\r\n    ({\r\n      inputDevices,\r\n      isMidiClockInSelectorOpen,\r\n      isMidiInSelectorOpen,\r\n      midiInDevice,\r\n      outputDevices,\r\n    }) => ({\r\n      inputDevices,\r\n      isMidiClockInSelectorOpen,\r\n      isMidiInSelectorOpen,\r\n      midiInDevice,\r\n      outputDevices,\r\n    }),\r\n    actions => actions,\r\n  );\r\n\r\n  const {\r\n    inputDevices,\r\n    isMidiClockInSelectorOpen,\r\n    isMidiInSelectorOpen,\r\n    midiInDevice,\r\n    outputDevices,\r\n  } = state;\r\n\r\n  useEffect(() => {\r\n    WebMidi.enable((err) => {\r\n      if (err) console.error(err);\r\n      else {\r\n        console.log('WebMidi enabled.');\r\n        actions.setInputDevices(WebMidi.inputs);\r\n        actions.setOutputDevices(WebMidi.outputs);\r\n      }\r\n    }, true);\r\n  }, []);\r\n\r\n\r\n  const handleMidi = (evt) => {\r\n    const {note: {number: n}, rawVelocity: vel, type} = evt;\r\n    // console.log(evt)\r\n    // actions.setMidiEvent({\r\n    //   [n]: type === 'noteon' ? vel : 0\r\n    // });\r\n  }\r\n\r\n  const handleMidiClock = (evt) => {\r\n\r\n    // console.log(evt)\r\n    // actions.setMidiEvent({\r\n    //   [n]: type === 'noteon' ? vel : 0\r\n    // });\r\n  }\r\n\r\n\r\n  const [midiMenuAnchorEl, setMidiMenuAnchorEl] = React.useState(null);\r\n\r\n  const handleMidiMenuButtonClick = (isBeatClock = false) => ({ currentTarget }) => {\r\n    setMidiMenuAnchorEl(currentTarget);\r\n    actions[isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector']();\r\n  }\r\n\r\n  const handleMidiMenuClose = (isBeatClock = false) => () => {\r\n    console.log('close', isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector')\r\n    actions[isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector']();\r\n    setMidiMenuAnchorEl(null);\r\n  }\r\n\r\n  const handleMidiInputSelect = (deviceIdx, isBeatClock = false) => ({ currentTarget }) => { // todo: remove prev listener\r\n    setMidiMenuAnchorEl(currentTarget);\r\n\r\n    const midiInDevice = inputDevices[deviceIdx];\r\n    actions[isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector']();\r\n    if (isBeatClock) {\r\n      midiInDevice.addListener('clock', 'all', handleMidiClock);\r\n      actions.setMidiClockInDevice(midiInDevice);\r\n    } else {\r\n      actions.setMidiInDevice(midiInDevice);\r\n      midiInDevice.addListener('noteon', 'all', handleMidi);\r\n      midiInDevice.addListener('noteoff', 'all', handleMidi);\r\n    }\r\n\r\n  };\r\n\r\n  return ( // TODO: only show if MIDI devices present; use looser permission to query\r\n    <>\r\n      <IconButton\r\n        edge=\"start\"\r\n        color=\"inherit\"\r\n        aria-label=\"open drawer\"\r\n        onClick={handleMidiMenuButtonClick(false)}\r\n      >\r\n        <MidiIcon/>\r\n      </IconButton>\r\n\r\n      <IconButton\r\n        edge=\"start\"\r\n        color=\"inherit\"\r\n        aria-label=\"open drawer\"\r\n        onClick={handleMidiMenuButtonClick(true)}\r\n      >\r\n        <MidiClockIcon/>\r\n      </IconButton>\r\n\r\n      <Menu\r\n        id=\"simple-menu\"\r\n        anchorEl={midiMenuAnchorEl}\r\n        open={isMidiInSelectorOpen || isMidiClockInSelectorOpen}\r\n        onClose={handleMidiMenuClose(isMidiClockInSelectorOpen)}\r\n      >\r\n        {inputDevices.map(({name}, idx) => (\r\n          <MenuItem\r\n            key={name}\r\n            onClick={handleMidiInputSelect(idx, isMidiClockInSelectorOpen)}\r\n            selected={isMidiInSelectorOpen && name === _.get(midiInDevice, 'name')}\r\n          >\r\n            {name}\r\n          </MenuItem>\r\n        ))}\r\n      </Menu>\r\n    </>\r\n\r\n  );\r\n};\r\n\r\nexport default Midi;\r\n","import _ from 'lodash';\r\n\r\n\r\n\r\nexport const initialState = {\r\n  decayDuration: 5000,\r\n  exciteEnergy: 0.05,\r\n  exciteDuration: 1000,\r\n  fundamentalFreq: 200,\r\n  hilbertN: 64, // hilbertN must be power of 2 in order to be square\r\n  hilbMand: [/*{ x, y, m }*/], // coordinates and associated mandelbrot val in hilbert traversal order\r\n  isControlPanelOpen: true,\r\n  isPlaying: false,\r\n  isRegenNeeded: true,\r\n  maxIters: 4096, // max number of steps to recurse the mandelbrot fn\r\n  midiClock: 0,\r\n  midiClocksPerTick: 24,\r\n  panX: -0.05,\r\n  panY: 0,\r\n  partials: {/* partial: { amp, oscIdx } */}, // the collection is updated in setState but values within are changed in drawLoop directly\r\n  partialsCountMax: 16,\r\n  isSmooth: false, // smooth technique https://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n  tick: 0, // updated in draw() bypasses setState\r\n  tickDuration: 100,\r\n  tickLastMillis: 0, // updated in draw() bypasses setState\r\n  zoom: 1.2,\r\n\r\n  // zoom: 3603.7157567397, panX: 0.18580280974577668, panY: 0.00036930706052212803,\r\n\r\n  // floating point errors here\r\n  // zoom: 279919582741326.66, panX: -0.014853203736137617, panY: 0.13451319076043783,\r\n\r\n  // panX: 0.0011548427778035686,\r\n  // panY: 0.025033026937542575,\r\n  // zoom: 319852972190.0951,\r\n  //\r\n  // panX: -0.18498767183730766,\r\n  // panY: 0.4722205531430409,\r\n  // zoom: 419013953.31772846,\r\n  //\r\n  //\r\n  // decay: 0.000075,\r\n  // exciteEnergy: 0.006,\r\n  // fundamentalFreq: 10,\r\n  // hilbertN: 256,\r\n  // maxIters: 4096,\r\n  // panX: 0.0011503007796323155,\r\n  // panY: 0.025033026938902938,\r\n  // tickDuration: 10,\r\n  // zoom: 836635.9887997985,\r\n  //\r\n  //\r\n  //\r\n  // panX: 0.08871194014553094,\r\n  // panY: -0.12829271146701177,\r\n  // zoom: 19736096.460687958,\r\n\r\n  // ...{zoom: 39422433.84662852, panX: 0.04670942760989286, panY: 0.13656218122372943},\r\n\r\n  // demo for 10 partials\r\n  // ...{zoom: 12371177.464729108, panX: 0.04671008941233588, panY: 0.13656133340058238},\r\n};\r\n\r\nlet audioCtx = new AudioContext();\r\nlet oscs = [];\r\n\r\nconst masterGain = audioCtx.createGain();\r\nwindow.masterGain = masterGain;\r\nmasterGain.gain.value = 1;\r\nmasterGain.connect(audioCtx.destination);\r\n\r\n\r\nexport const sketch = (p5) => {\r\n  p5.state = initialState;\r\n\r\n  const setupOscillators = () => {\r\n    oscs.forEach(({osc, gain}) =>\r\n    {\r\n      osc.stop();\r\n    }); // TODO: gain.disconnect?\r\n\r\n    oscs = _.range(p5.state.partialsCountMax).map(() => {\r\n      const osc = audioCtx.createOscillator();\r\n      const gain = audioCtx.createGain();\r\n      gain.gain.value = 0;\r\n      osc.connect(gain);\r\n      gain.connect(masterGain);\r\n      osc.start();\r\n      return {osc, gain};\r\n    });\r\n\r\n    window.oscs = oscs;\r\n  }\r\n\r\n  let font;\r\n  p5.preload = () => {\r\n    font = p5.loadFont('JetBrainsMono-Regular.ttf');\r\n  }\r\n\r\n\r\n  const TWO_PI = Math.PI * 2;\r\n\r\n  let h, w;\r\n\r\n  let d, n, n2 = 0;\r\n\r\n  [n, d] = [2, 1];\r\n\r\n  p5.setup = () => {\r\n    p5.createCanvas(p5._width, p5._height);\r\n    p5.blendMode(p5.ADD);\r\n    p5.colorMode(p5.HSB, 255);\r\n    p5.textFont(font);\r\n  }\r\n\r\n  let input = [];\r\n  p5.keyTyped = () => {\r\n    console.log(p5.key)\r\n    // if (key === ':') {\r\n    //   value = 255;\r\n    // } else if (key === 'b') {\r\n    //   value = 0;\r\n    // }\r\n    // uncomment to prevent any default behavior\r\n    if (p5.key === 'Enter') {\r\n\r\n      const obj = input.join('').split(':').map(s => parseInt(s, 10));\r\n\r\n      n2 = 0;\r\n      [d, n, n2] = obj;\r\n      if (!n2) {\r\n        [n, d] = obj;\r\n        n2 = 0;\r\n      }\r\n      console.log(d, n, n2)\r\n      console.log(w, h)\r\n\r\n      input = [];\r\n    } else {\r\n      input.push(p5.key);\r\n    }\r\n\r\n\r\n\r\n    return false;\r\n  }\r\n\r\n  let phase = 0;\r\n  let x1 = 0;\r\n  let y1 = 0;\r\n  let r;\r\n  const rayCount = 500;\r\n\r\n  const drawWave = ({ freq, phase = 0, hue }) => {\r\n    const dt = TWO_PI / rayCount;\r\n    p5.push();\r\n    p5.translate(w/2, h/2);\r\n    for(let t = 0; t < TWO_PI - dt; t += dt) {\r\n      p5.stroke(\r\n        hue,\r\n        255,\r\n        freq && (50 + 50 * Math.sin(t * freq)),\r\n        100,\r\n      );\r\n\r\n      r = w + h;\r\n      x1 = r * Math.sin(t + phase);\r\n      y1 = r * Math.cos(t + phase);\r\n\r\n      p5.line(0, 0, x1, y1);\r\n    }\r\n    p5.pop();\r\n  };\r\n\r\n\r\n  p5.draw = () => {\r\n    p5.clear();\r\n    p5.background(0, 0, 0);\r\n    h = p5.height;\r\n    w = p5.width;\r\n\r\n\r\n    phase = p5.millis() * (0.001/d);\r\n\r\n    drawWave({\r\n      freq: d,\r\n      hue: 0,\r\n      phase,\r\n    });\r\n\r\n    drawWave({\r\n      freq: d * n / d,\r\n      hue: 90,\r\n      phase: phase * 2,\r\n    });\r\n\r\n    drawWave({\r\n      freq: d * n2 / n,\r\n      hue: 180,\r\n      phase: phase * 3,\r\n    });\r\n\r\n\r\n\r\n\r\n\r\n    p5.blendMode(p5.BLEND);\r\n    p5.fill(255);\r\n    p5.stroke(0);\r\n    p5.strokeWeight(4);\r\n    p5.textAlign(p5.CENTER, p5.CENTER);\r\n    p5.textSize(h/15)\r\n    p5.text(n2 ? `${d}:${n}:${n2}` : `${n}:${d}`, w/2, h/2)\r\n    p5.blendMode(p5.ADD);\r\n  }\r\n\r\n  /**\r\n   * This needs to be called by a user event handler.\r\n   * @param isPlaying\r\n   */\r\n  p5.toggleAudio = () => {\r\n    p5.setState(prevState => {\r\n      const { isPlaying } = prevState;\r\n      if (!isPlaying && audioCtx.state !== 'running') {\r\n        audioCtx.resume();\r\n      }\r\n\r\n      if (isPlaying && audioCtx.state === 'running') {\r\n        audioCtx.suspend();\r\n      }\r\n\r\n      return { ...prevState, isPlaying: !prevState.isPlaying };\r\n    });\r\n\r\n  }\r\n}\r\n","import React, {useEffect} from 'react';\r\nimport useP5 from './useP5';\r\nimport {initialState, sketch} from \"./ratioLightshipP5\";\r\n\r\nconst RatioLightship = () => {\r\n  const {\r\n    ref,\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n  } = useP5(sketch, initialState);\r\n\r\n  window.sketchInstance = sketchInstance;\r\n\r\n  useEffect(() => {\r\n    document.title = 'Ratio Lightship';\r\n  }, [sketchInstance]);\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      style={{\r\n        alignSelf: 'start',\r\n        background: 'radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)',\r\n        height: '100vh',\r\n        width: '100vw',\r\n      }}\r\n    />);\r\n};\r\n\r\n\r\nexport default RatioLightship;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport {Entity} from 'aframe-react';\r\nimport {HSVtoHex} from './color';\r\nimport {toSymbol} from \"./util\";\r\n\r\nconst handleOsc = n => (el) => {\r\n  if (el) {\r\n    const { components: { osc } } = el;\r\n    osc.onOsc = ({ instrument, note, vel }) => {\r\n      if (note === n) {\r\n        osc.vel = vel;\r\n      }\r\n    }\r\n\r\n    osc.onTick = (time, timeDelta) => {\r\n      if (osc.vel === 0) {\r\n\r\n      }\r\n\r\n      if (_.has(osc, 'vel')) {\r\n        el.setAttribute('material', 'opacity', 0.05 + 0.75 * osc.vel / 128);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport default ({\r\n  darkened = true,\r\n  n,\r\n  position = {x: 0, y: 0, z: 0},\r\n  scale = {x: 1, y: 1, z: 1}\r\n}) =>\r\n  <Entity\r\n    _ref={handleOsc(n)}\r\n    // animation={{\r\n    //   dur: 500,\r\n    //   property: 'position',\r\n    //   to: position,\r\n    // }}\r\n    material={{\r\n      blending: darkened ? 'normal' : 'additive',\r\n      color: HSVtoHex(n / 12, 0.7, darkened ? 0 : 1),\r\n      opacity: darkened ? 0.5 : 0.1,\r\n    }}\r\n    osc={{\r\n\r\n    }}\r\n    position={position}\r\n    primitive='a-torus'\r\n    radius={0.1}\r\n    radius-tubular={0.003}\r\n    scale={scale}\r\n  >\r\n    <Entity\r\n      look-at=\"#camera\"\r\n      position={{x: 0, y: 0, z: 0}}\r\n      scale={{x: 2, y: 2, z: 2}}\r\n      text={{\r\n        align: 'center',\r\n        color: HSVtoHex(n / 12, 0.75, 0.5),\r\n        font: `../JetBrainsMono-Regular-msdf.json`,\r\n        negate: false,\r\n        transparent: true,\r\n        value: toSymbol(n),\r\n      }}\r\n    />\r\n  </Entity>\r\n","import _ from 'lodash';\r\nimport PitchClass from './pitchClass';\r\nimport React, {useEffect, useState} from 'react';\r\nimport useMidi from \"./useMidi\";\r\nimport {Entity} from 'aframe-react';\r\n\r\nconst ColtraneCircle = () => {\r\n  const [is180, setIs180] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const toggle = ({key}) => {\r\n      if (key === 'r') setIs180(is180 => !is180);\r\n    };\r\n\r\n    window.addEventListener('keyup', toggle);\r\n    return () => window.removeEventListener('keyup', toggle);\r\n  }, []);\r\n\r\n  const [{midiIn}] = useMidi();\r\n\r\n  const midiInPitchClasses = _(12)\r\n    .range()\r\n    .map(n => _(midiIn)\r\n      .pickBy((v, i) => i % 12 === n)\r\n      .values()\r\n      .sum())\r\n    .value();\r\n\r\n  return (// https://www.npmjs.com/package/aframe-animation-component\r\n    <Entity\r\n      animation={`property: rotation; to: 0 ${is180 ? 180 : 0} 0; dur: 500;`}\r\n      position={`0 0 -3`}\r\n    >\r\n      {_(12)\r\n        .range()\r\n        .filter(n => n % 2 == 0)\r\n        .map(n => ({\r\n          n,\r\n          r: 1.5,\r\n          x: -Math.sin(n * Math.PI / 6),\r\n          y: Math.cos(n * Math.PI / 6),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n          />))\r\n        .value()\r\n      }\r\n\r\n      {_(48)\r\n        .range()\r\n        .filter(n => !_.includes([6, 7, 0, 1], n % 8))\r\n        .map((n, i) => ({\r\n          i,\r\n          n: ((i + 1) * 2 + Math.floor(i / 4) * 2) % 12,\r\n          // n: (n * 2) % 12,\r\n          r: 1.5,\r\n          x: Math.sin((n + 0.5) * Math.PI / 24),\r\n          y: Math.cos((n + 0.5) * Math.PI / 24),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n            scale=\"0.5 0.5 0.5\"\r\n          />))\r\n        .value()\r\n      }\r\n\r\n      {_(12)\r\n        .range()\r\n        .filter(n => n % 2 != 0)\r\n        .map(n => ({\r\n          n: (n + 6) % 12,\r\n          r: 1.2,\r\n          x: -Math.sin(n * Math.PI / 6),\r\n          y: Math.cos(n * Math.PI / 6),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n          />))\r\n        .value()\r\n      }\r\n\r\n      {_(48)\r\n        .range()\r\n        .filter(n => !_.includes([4, 5, 6, 7], n % 8))\r\n        .map((n, i) => ({\r\n          i,\r\n          // n: i,\r\n          n: (i * 2 + 9 + Math.floor(i / 4) * 2) % 12,\r\n          // n: i,\r\n          r: 1.2,\r\n          x: Math.sin((n - 1.5) * Math.PI / 24),\r\n          y: Math.cos((n - 1.5) * Math.PI / 24),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n            scale=\"0.5 0.5 0.5\"\r\n          />))\r\n        .value()\r\n      }\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default ColtraneCircle;\r\n","import {Entity} from 'aframe-react';\r\nimport React from 'react';\r\nimport {HSVtoHex} from './color';\r\n\r\n// http://dmccooey.com/polyhedra/PentakisDodecahedron.txt\r\nconst c1 = 1.33058699733550141141687582919;\r\nconst c2 = 2.15293498667750705708437914596;\r\n\r\n// in ordered, opposite pairs\r\nconst verts = [\r\n  [0.0,  -c2,   c1],\r\n  [0.0,   c2,  -c1],\r\n  [ c2,  -c1,  0.0],\r\n  [-c2,   c1,  0.0],\r\n  [0.0,  -c2,  -c1],\r\n  [0.0,   c2,   c1],\r\n  [-c2,  -c1,  0.0],\r\n  [ c2,   c1,  0.0],\r\n  [-c1,  0.0,   c2],\r\n  [ c1,  0.0,  -c2],\r\n  [ c1,  0.0,   c2],\r\n  [-c1,  0.0,  -c2],\r\n];\r\n\r\nconst Dod = ({ rep = 1, sat, stack = [], n = 0 }) =>\r\n  <Entity position=\"0 0 0\">\r\n    {verts.map((v, i) =>\r\n      <Entity\r\n        key={i}\r\n        color={HSVtoHex(i * (1 / 12), sat || 1, 1)}\r\n        events={{ click: () => console.log(i) }}\r\n        primitive=\"a-sphere\"\r\n        position={v.join(' ')}\r\n        scale={[1, 1, 1].map(n => 0.3 * n/ (rep * rep)).join(' ')}\r\n      />)}\r\n\r\n    {rep < 3 && verts.map((v, i) =>\r\n      <Entity\r\n        key={i}\r\n        position={v.map(n => n * 2).join(' ')}\r\n        text={`color: ${HSVtoHex((stack.length ? stack[stack.length - 1] : i) * (1 / 12), 1, 1)}; align: center; value: ${[...stack, i].join(',')} - ${(n + i) % 12}; width: 5; zOffset: 0`}\r\n      >\r\n        <Dod rep={rep+1} sat={0.3} stack={[...stack, i]} n={(n + i) % 12} />\r\n      </Entity>)\r\n      // .filter((n, i) => i % 2)\r\n    }\r\n  </Entity>;\r\n\r\nexport default Dod;","// import * as Tone from 'tone'\r\nimport _ from 'lodash';\r\nimport PitchClass from './pitchClass';\r\nimport PitchDetector from 'pitchdetect';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport useMidiClock from \"./useMidiClock\";\r\nimport {Entity} from 'aframe-react';\r\nimport {HSVtoHex} from \"./color\";\r\n\r\nconst PitchClassCollections = ({}) => {\r\n\r\n  const spacing = 0.75;\r\n\r\n  const [collEl, setCollEl] = useState();\r\n  const collRef = useCallback(setCollEl, []);\r\n\r\n\r\n  const { reset } = useMidiClock(({ tick }) => {\r\n    if (tick % 24 === 0) console.log(tick);\r\n\r\n    if (collEl) {\r\n      collEl.object3D.position.set(0, 0, (tick / 96) * spacing);\r\n    }\r\n  });\r\n\r\n  window.reset = reset;\r\n\r\n  useEffect(() => {\r\n    const handleKeyup = ({code, key}) => {\r\n      // if (key === 'r') setIs180(is180 => !is180);\r\n      // if (code === 'Space') audioContext.resume();\r\n    };\r\n\r\n    window.addEventListener('keyup', handleKeyup);\r\n    return () => window.removeEventListener('keyup', handleKeyup);\r\n  }, []);\r\n\r\n  const colls = [[2, 5, 9], [7, 11, 2], [0, 4, 7]];\r\n\r\n  return (// https://www.npmjs.com/package/aframe-animation-component\r\n    <Entity\r\n      _ref={collRef}\r\n      position={{x: 0, y: 0, z: -2}}\r\n      scale={{x: 4, y: 4, z: 4}}\r\n    >\r\n      {\r\n        _.range(50)\r\n          .map(i => 50 - i)// draw order\r\n          .map(i => ({ coll: colls[i % colls.length], z: i * -spacing}))\r\n          .map(({coll, z}) => (\r\n            <React.Fragment key={z}>\r\n              <Entity\r\n                material={{\r\n                  // blending: 'subtractive',\r\n                  color: '#040404',\r\n                  opacity: 0.45,\r\n                }}\r\n                position={{ x: 0, y: 0, z: z - 0.01}}\r\n                rotation={{x: 90, y: 0, z: 0}}\r\n                primitive='a-cylinder'\r\n                scale={{ x: 1, y: 0.001, z: 1}}\r\n              />\r\n              {_.range(12)\r\n                .map(n => {\r\n                  const r = 0.25;\r\n                  const theta = n * (Math.PI * 2) / 12;\r\n\r\n                  return {\r\n                    n,\r\n                    x: r * Math.sin(theta),\r\n                    y: r * Math.cos(theta),\r\n                  };\r\n                })\r\n                .map(({n, s = 0.5, x, y}) => (\r\n                  <PitchClass\r\n                    darkened={!_.includes(coll, n)}\r\n                    key={n}\r\n                    n={n}\r\n                    position={{x, y, z}}\r\n                    scale={{x: s, y: s, z: s}}\r\n                  />))}\r\n            </React.Fragment>\r\n          ))\r\n      }\r\n\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default PitchClassCollections;\r\n","import _ from \"lodash\";\r\nimport React, {useCallback, useEffect, useState} from \"react\";\r\nimport useMidi from \"./useMidi\";\r\nimport usePrevious from \"./usePrevious\";\r\nimport {Entity} from \"aframe-react\";\r\nimport {HSVtoHex} from \"./color\";\r\n\r\nconst PcSpiralWindController = ({noteToDimensions}) => {\r\n  const [midiInEl, setMidiInEl] = useState();\r\n  const [{midiInDevice}] = useMidi();\r\n  const prevMidiInDevice = usePrevious(midiInDevice);\r\n\r\n  useEffect(() => {\r\n    const handleMidi = (evt) => {\r\n      // console.log(evt)\r\n      const {note: {number: n}, velocity: vel, type} = evt;\r\n      const opacity = vel / (0.1 + vel);\r\n      const {s, x, y, z} = noteToDimensions(n);\r\n      midiInEl.setAttribute('material', 'opacity', opacity);\r\n      if (type === 'noteon') {\r\n        midiInEl.note = n; // FIXME Hack\r\n        midiInEl.object3D.position.set(x, y, z + 0.01);\r\n        midiInEl.object3D.scale.set(s * 1.1, s * 1.1, s * 1.1);\r\n        midiInEl.setAttribute('material', 'color', HSVtoHex(n / 12, 0.75, 0.5));\r\n      }\r\n    };\r\n\r\n    const handleCC = ({ controller: { number }, value }) => {\r\n      if (number === 2) { // breath control\r\n        const vel = value / 128;\r\n        const opacity = vel / (0.1 + vel);\r\n        midiInEl.setAttribute('material', 'opacity', opacity);\r\n      }\r\n    };\r\n\r\n    const handlePitchbend = ({ value }) => {\r\n      // console.log(value)\r\n      const n = midiInEl.note || 0;\r\n      const bendAmount = value * 2;\r\n      const {s, x, y, z} = noteToDimensions(n + bendAmount);\r\n      midiInEl.object3D.position.set(x, y, z + 0.01);\r\n      midiInEl.object3D.scale.set(s * 1.1, s * 1.1, s * 1.1);\r\n    };\r\n\r\n    if (midiInEl) {\r\n      if (midiInDevice) {\r\n        console.log('new midiInDevice: ', _.get(midiInDevice,'name'), 'prev: ', _.get(prevMidiInDevice, 'name'));\r\n        midiInDevice.addListener('noteon', 'all', handleMidi);\r\n        midiInDevice.addListener('noteoff', 'all', handleMidi);\r\n        midiInDevice.addListener('controlchange', 'all', handleCC);\r\n        midiInDevice.addListener('pitchbend', 'all', handlePitchbend);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (midiInDevice) {\r\n        console.log('removing listeners for', _.get(midiInDevice, 'name'));\r\n        midiInDevice.removeListener('noteon');\r\n        midiInDevice.removeListener('noteoff');\r\n        midiInDevice.removeListener('controlchange');\r\n        midiInDevice.removeListener('pitchbend');\r\n      }\r\n    }\r\n  }, [midiInEl, midiInDevice, noteToDimensions, prevMidiInDevice]);\r\n\r\n  const midiInRef = useCallback(setMidiInEl, []);\r\n\r\n  return (\r\n    <Entity\r\n      _ref={midiInRef}\r\n      primitive='a-sphere'\r\n      material={{\r\n        blending: 'additive',\r\n        color: HSVtoHex(1, 0, 1),\r\n        opacity: 0,\r\n        transparent: true,\r\n      }}\r\n      radius={0.07}\r\n    />\r\n  )\r\n}\r\n\r\nexport default PcSpiralWindController;\r\n","import {useEffect, useRef} from \"react\";\r\n\r\nexport default (value) => {\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  });\r\n  return ref.current;\r\n}\r\n","import _ from 'lodash';\r\nimport PcSpiralWindController from './pcSpiralWindController';\r\nimport PitchClass from './pitchClass';\r\nimport PitchDetector from 'pitchdetect';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport useMidi from \"./useMidi\";\r\nimport {Entity} from 'aframe-react';\r\nimport {ftomf} from \"./util\";\r\nimport {HSVtoHex} from \"./color\";\r\n\r\nconst audioContext = new AudioContext();\r\n\r\n// FIXME HACK\r\nwindow.audioContext = audioContext;\r\n\r\n\r\nconst PitchClassSpiral = ({\r\n  depthMax = 1,\r\n  isAlwaysCounterClockwise = false,\r\n  rMax = 0.75,\r\n  rMin = 0,\r\n  noteRange = [34, 99],\r\n  // notesHighlighted = [0, 2, 4, 5, 7, 9, 11],\r\n  pcsHighlighted= [0, 2, 4, 5, 7, 9, 11],\r\n}) => {\r\n  const [is180, setIs180] = useState(true);\r\n  const [detector, setDetector] = useState();\r\n  const [pitchDetectEl, setPitchDetectEl] = useState();\r\n\r\n\r\n\r\n  const noteToDimensions = n => {\r\n    const step = n / 128;\r\n    const r = (is180 ? 1 : 1.5) * rMax - ((is180 ? 1 : 1.5) * rMax - rMin) * step;\r\n\r\n    return {\r\n      n,\r\n      s:  0.75 - n / 192,\r\n      x: r * (is180 && isAlwaysCounterClockwise ? -1 : 1) * Math.sin(n * Math.PI / 6 + 0.01), // +0.01 to fix floating point error in animation library\r\n      y: r * Math.cos(n * Math.PI / 6 + 0.01),\r\n      z: is180\r\n        ? depthMax - depthMax * step\r\n        : depthMax * step,\r\n    };\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleKeyup = ({code, key}) => {\r\n      if (key === 'r') setIs180(is180 => !is180);\r\n      if (code === 'Space') audioContext.resume();\r\n    };\r\n\r\n    window.addEventListener('keyup', handleKeyup);\r\n    return () => window.removeEventListener('keyup', handleKeyup);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('el', pitchDetectEl, 'detector', detector);\r\n\r\n    const handlePitch = (stats, pitchDetector) => {\r\n      const {frequency, detected, rms} = stats;\r\n\r\n      // https://math.stackexchange.com/q/57429/398343\r\n      // const opacity = 1 - Math.exp(-2 * rms);\r\n      const opacity = rms / (0.1 + rms);\r\n      const n = ftomf(frequency);\r\n      const {s, x, y, z} = noteToDimensions(n);\r\n      pitchDetectEl.setAttribute('material', 'opacity', detected ? opacity : 0);\r\n      pitchDetectEl.object3D.position.set(x, y, z + 0.01);\r\n      pitchDetectEl.object3D.scale.set(s, s, s);\r\n\r\n      if (_.isFinite(n)) {\r\n        pitchDetectEl.setAttribute('material', 'color', HSVtoHex(n / 12, 0.5, 1));\r\n      }\r\n    };\r\n\r\n    if (audioContext && !detector && pitchDetectEl) {\r\n      setDetector(new PitchDetector({\r\n        context: audioContext,\r\n\r\n        // input: audioBufferNode, // default: Microphone input\r\n\r\n        interpolateFrequency: true, // default: true\r\n\r\n        onDebug: handlePitch,\r\n\r\n        // Minimal signal strength (RMS, Optional)\r\n        // minRms: 0.1,\r\n\r\n        // Detect pitch only with minimal correlation of: (Optional)\r\n        // minCorrelation: 0.9,\r\n\r\n        // Detect pitch only if correlation increases with at least: (Optional)\r\n        minCorrelationIncrease: 0.5,\r\n\r\n        // Note: you cannot use minCorrelation and minCorreationIncrease\r\n        // at the same time!\r\n\r\n        // Signal Normalization (Optional)\r\n        normalize: \"rms\", // or \"peak\". default: undefined\r\n\r\n        // Only detect pitch once: (Optional)\r\n        stopAfterDetection: false,\r\n\r\n        // Buffer length (Optional)\r\n        length: 1024, // default 1024\r\n\r\n        // Limit range (Optional):\r\n        minNote: 32, // by MIDI note number\r\n        maxNote: 128,\r\n\r\n        // minFrequency: 440,    // by Frequency in Hz\r\n        // maxFrequency: 20000,\r\n\r\n        minPeriod: 2,  // by period (i.e. actual distance of calculation in audio buffer)\r\n        maxPeriod: 512, // --> convert to frequency: frequency = sampleRate / period\r\n\r\n        // Start right away\r\n        start: true, // default: false\r\n      }));\r\n      // window.detector = detector;\r\n    } else if (detector && !pitchDetectEl) {\r\n      detector.stop();\r\n      detector.destroy();\r\n    }\r\n  }, [audioContext, detector, is180, pitchDetectEl]);\r\n\r\n\r\n\r\n  const pitchDetectRef = useCallback(setPitchDetectEl, []);\r\n\r\n\r\n  // const midiInPitchClasses = _(12)\r\n  //   .range()\r\n  //   .map(n => _(midiIn)\r\n  //     .pickBy((v, i) => i % 12 === n)\r\n  //     .values()\r\n  //     .sum())\r\n  //   .value();\r\n\r\n  // TODO: position by freq, not 12TET pitch\r\n\r\n  return (// https://www.npmjs.com/package/aframe-animation-component\r\n    <Entity\r\n      events={{\r\n        click: () => {\r\n          audioContext.resume()\r\n        },\r\n      }}\r\n      position={{x: 0, y: 0, z: -6}}\r\n      scale={{x: 4, y: 4, z: 4}}\r\n    >\r\n      {_.range(noteRange[0], noteRange[1] + 1)\r\n        .map(noteToDimensions)\r\n        .map(({n, s, x, y, z}) => (\r\n          <React.Fragment key={n}>\r\n            <Entity\r\n              line={{\r\n                color: 'black',\r\n                opacity: 0.3,\r\n                start: _.pick(noteToDimensions(n + 0.25), ['x', 'y', 'z']),\r\n                end: _.pick(noteToDimensions(n + 0.75), ['x', 'y', 'z']),\r\n                visible: n < noteRange[1],\r\n              }}\r\n            />\r\n\r\n            <PitchClass\r\n              darkened={!_.includes(pcsHighlighted, n%12)}\r\n              n={n}\r\n              position={{x, y, z}}\r\n              scale={{x: s, y: s, z: s}}\r\n            />\r\n          </React.Fragment>\r\n          ))\r\n      }\r\n\r\n      <PcSpiralWindController\r\n        noteToDimensions={noteToDimensions}\r\n      />\r\n\r\n      {/* TODO intervals   */}\r\n      {/*<Entity*/}\r\n      {/*  line={{*/}\r\n      {/*    color: 'white',*/}\r\n      {/*    opacity: 0.3,*/}\r\n      {/*    start: _.pick(noteToDimensions(60), ['x', 'y', 'z']),*/}\r\n      {/*    end: _.pick(noteToDimensions(65), ['x', 'y', 'z']),*/}\r\n      {/*  }}*/}\r\n      {/*/>*/}\r\n\r\n\r\n      <Entity\r\n        _ref={pitchDetectRef}\r\n        primitive='a-sphere'\r\n        material={{\r\n          blending: 'additive',\r\n          color: HSVtoHex(1, 0, 1),\r\n          opacity: 0,\r\n          transparent: true,\r\n        }}\r\n        radius={0.1}\r\n      />\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default PitchClassSpiral;\r\n","import _ from 'lodash';\r\nimport Cell from './cell';\r\nimport PC from './pc';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport {HSVtoHex} from './color';\r\nimport useMidi from './useMidi';\r\n// import {Hsluv} from 'hsluv'; // FIXME ts loader\r\nimport {toSolfege, toSymbol} from './util';\r\n\r\nlet _hsluv;\r\nconst hslToHex = (h, s, l) => {\r\n  _hsluv = _hsluv || new window.Hsluv();\r\n  _hsluv.hsluv_h = (h * 360 + 12.2) % 360;\r\n  _hsluv.hsluv_s = s * 100;\r\n  _hsluv.hsluv_l = l * 100;\r\n  _hsluv.hsluvToHex();\r\n  return _hsluv.hex;\r\n};\r\n\r\nconst hslToRgb = (h, s, l) => {\r\n  _hsluv = _hsluv || new window.Hsluv();\r\n  _hsluv.hsluv_h = (h * 360 + 12.2) % 360;\r\n  _hsluv.hsluv_s = s * 100;\r\n  _hsluv.hsluv_l = l * 100;\r\n  _hsluv.hsluvToRgb();\r\n  return [_hsluv.rgb_r * 255, _hsluv.rgb_g * 255, _hsluv.rgb_b * 255];\r\n};\r\n\r\nconst pcSetOpts = [\r\n  {\r\n    label: 'Nothing',\r\n    val: [],\r\n  },\r\n  {\r\n    label: 'Diatonic Scale',\r\n    val: [0, 2, 4, 5, 7, 9, 11],\r\n  },\r\n  {\r\n    label: 'Major Triad',\r\n    val: [0, 4, 7],\r\n  },\r\n  {\r\n    label: 'Major 7',\r\n    val: [0, 4, 7, 11],\r\n  },\r\n  {\r\n    label: 'Minor Triad',\r\n    val: [0, 3, 7],\r\n  },\r\n  {\r\n    label: 'Minor 7',\r\n    val: [0, 3, 7, 10],\r\n  },\r\n  {\r\n    label: 'Diminished Triad',\r\n    val: [0, 3, 6],\r\n  },\r\n  {\r\n    label: 'Diminished 7',\r\n    val: [0, 4, 7],\r\n  },\r\n  {\r\n    label: 'Augmented Triad',\r\n    val: [0, 4, 8],\r\n  },\r\n];\r\n\r\nconst fallingGrace = [\r\n  {\r\n    label: 'Ab Maj7 -- 8+47', // implied 0 -- but how would we notate omission of 0?\r\n    val: [8, 0, 3, 7],\r\n  },\r\n  {\r\n    label: `D7/F# -- 2+47/4 ${''/*(redundant 4)*/} -- 2+7/4 ${''/*(familiar slash chord notation, no redundancy)*/}  -- 2+470 ${''/*(explicit 0 allows for omitting 0)*/}`,\r\n    val: [2, 6, 9, 0],\r\n  },\r\n  {\r\n    label: 'G min7 -- 7+37',\r\n    val: [7, 10, 2, 5],\r\n  },\r\n  {\r\n    label: 'F min7',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n  {\r\n    label: '',\r\n    val: [],\r\n  },\r\n];\r\n\r\n\r\nconst lumatoneRowLengths = [\r\n  2,\r\n  5,\r\n  8,\r\n  11,\r\n  14,\r\n  17,\r\n  20,\r\n  23,\r\n  26,\r\n  28,\r\n  26,\r\n  23,\r\n  20,\r\n  17,\r\n  14,\r\n  11,\r\n  8,\r\n  5,\r\n  2,\r\n];\r\n\r\nconst lumatoneRowStarts = [\r\n  0, 0, 0, 0, 0, 0, 0, 0, 0,\r\n  1,\r\n  4,\r\n  7,\r\n  10,\r\n  13,\r\n  16,\r\n  19,\r\n  22,\r\n  25,\r\n  28,\r\n];\r\n\r\nconst boardRowLengths = [\r\n  2,\r\n  5,\r\n  6, 6, 6, 6, 6, 6, 6,\r\n  5,\r\n  2,\r\n];\r\n\r\nconst boardsOnGrid = lumatoneRowLengths.map(() => ([]));\r\n\r\n_.range(5).forEach(boardIndex => {\r\n  const boardNum = boardIndex + 1;\r\n\r\n  const boardStartX = boardIndex * 6;\r\n  const boardStartY = boardIndex * 2;\r\n\r\n  let note = 0;\r\n  _.forEach(boardRowLengths, (boardRowLen, boardRow) => {\r\n    _.range(boardRowLen).forEach(boardX => {\r\n      const y = boardStartY + boardRow;\r\n      boardsOnGrid[y][boardStartX + lumatoneRowStarts[boardRow] + boardX] = {\r\n        boardNum,\r\n        note,\r\n      };\r\n\r\n      note++;\r\n    });\r\n  });\r\n\r\n});\r\n\r\n\r\nconst lumatone = () => {\r\n\r\n\r\n};\r\n\r\nconst setColor = (lumatoneIn, lumatoneOut, board, key, r, g, b) => new Promise((res) => {\r\n  const mfid = [0x00, 0x21, 0x50]; // Embodme according to https://www.midi.org/specifications-old/item/manufacturer-id-numbers\r\n  const setKeyColor = 0x01;\r\n  console.log('setcolor', r, g, b);\r\n\r\n  lumatoneIn.addOneTimeListener('sysex', () => {\r\n    // console.log('ack');\r\n    res();\r\n  });\r\n  lumatoneOut.sendSysex(mfid, [board, setKeyColor, key, r >> 4, r & 0xf, g >> 4, g & 0xf, b >> 4, b & 0xf]);\r\n});\r\n\r\n/**\r\n *\r\n *\r\n *\r\n * @param lumatoneIn\r\n * @param lumatoneOut\r\n * @param board\r\n * @param key\r\n * @param note\r\n * @param midiChannel\r\n * @param typeByte  disabledDefault = 0, noteOnNoteOff = 1,  continuousController = 2, lumaTouch = 3, disabled = 4\r\n * @returns {Promise<unknown>}\r\n */\r\nconst setNote = (lumatoneIn, lumatoneOut, board, key, note, midiChannel = 1, typeByte = 1) => new Promise((res) => {\r\n  const mfid = [0x00, 0x21, 0x50]; // Embodme according to https://www.midi.org/specifications-old/item/manufacturer-id-numbers\r\n  const setKeyNote = 0x00;\r\n  console.log('setnote', lumatoneIn, lumatoneOut);\r\n\r\n  lumatoneIn.addOneTimeListener('sysex', () => {\r\n    // console.log('ack');\r\n    res();\r\n  });\r\n  lumatoneOut.sendSysex(mfid, [board, setKeyNote, key, Math.min(127, Math.max(0, note)), midiChannel, typeByte]);\r\n});\r\n\r\n\r\n// http://www.altkeyboards.com/instruments/isomorphic-keyboards\r\nconst layoutOpts = [\r\n  {\r\n    label: 'Harmonic table',\r\n    val: (x, y) => (\r\n      (y % 2 === 0\r\n          ? (8 - y) * 6 + x * 4// + (x > 12 ? 24 : 0)\r\n          : (8 - y) * 6 + x * 4 - 1 //+ (x > 12 ? 24 : 0)\r\n      ))\r\n  },\r\n  {\r\n    label: 'Wicki-Hayden',\r\n    val: (x, y) => y % 2 === 0\r\n      ? ((12 - y) * 6 + x * 2) + (x > 12 ? 24 : 0)\r\n      : (12 - y) * 6 + x * 2 + 1 + (x > 12 ? 24 : 0)\r\n  },\r\n\r\n];\r\n\r\nconst getColorHsl = (n, isHighlighted = false) => [\r\n  ((n * 5) % 12) / 12,\r\n  Math.max(0, 1 - n / 256),\r\n  isHighlighted ? 0.4 : Math.max(0.1, n / 256),\r\n];\r\n\r\nconst Tonnetz = ({rows = lumatoneRowLengths}) => {\r\n\r\n  const [{inputDevices, outputDevices}] = useMidi();\r\n  const lumaIn = inputDevices.find(({name}) => name === 'LM-Lumatone-in');\r\n  const lumaOut = outputDevices.find(({name}) => name === 'LM-Lumatone-out');\r\n\r\n\r\n  const [layoutKey, setLayoutKey] = useState(0);\r\n  const {val: layout} = layoutOpts[layoutKey];\r\n\r\n  const [pcSetKey, setPcSetKey] = useState(0);\r\n  const {val: pcSet} = pcSetOpts[pcSetKey];\r\n\r\n\r\n  useEffect(() => {\r\n    if (!lumaIn || !lumaOut) return;\r\n\r\n    const changeColors = async () => {\r\n      for (const y of _.range(rows.length)) {\r\n        const rowStartX = lumatoneRowStarts[y];\r\n\r\n        for (const x of _.range(rowStartX, rows[y] + rowStartX)) {\r\n          const lumaKey = boardsOnGrid[y][x];\r\n          if (lumaKey) {\r\n            const {boardNum, note} = lumaKey;\r\n            const n = layout(x, y);\r\n// console.log(n, 1 - Math.floor(n/12) / 5 )\r\n            const [r, g, b] = hslToRgb(...getColorHsl(n));\r\n            await setColor(lumaIn, lumaOut, boardNum, note, r, g, b);\r\n            await setNote(lumaIn, lumaOut, boardNum, note, n);\r\n            // console.log('board', boardNum, 'lumaKey', note, n, color)\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    changeColors().catch(e => console.log(e));\r\n\r\n  }, [layoutKey, pcSetKey, lumaIn, lumaOut]);\r\n\r\n  return (\r\n    <div style={{\r\n      display: 'block',\r\n      flexShrink: 0,\r\n    }}>\r\n      <select value={layoutKey} onChange={evt => setLayoutKey(parseInt(evt.target.value, 10))}>\r\n        {layoutOpts.map(({label}, val) => <option key={val} value={val}>{label}</option>)}\r\n      </select>\r\n\r\n      <select value={pcSetKey} onChange={evt => setPcSetKey(parseInt(evt.target.value, 10))}>\r\n        {pcSetOpts.map(({label}, val) => <option key={val} value={val}>{label}</option>)}\r\n      </select>\r\n\r\n      <br/>\r\n      <br/>\r\n      <br/>\r\n\r\n      {_.range(rows.length)\r\n        .map(y => {\r\n          const isOdd = y % 2 === 1;\r\n          const rowStartX = lumatoneRowStarts[y];\r\n\r\n          return (\r\n            <>\r\n              {[\r\n                ..._.range(rowStartX).map(x => {\r\n                  return (\r\n                    <\r\n                      Cell\r\n                      key={x}\r\n                      isOdd={isOdd}\r\n                    >\r\n                      &nbsp;\r\n                    </Cell>);\r\n                }),\r\n                ..._.range(rowStartX, rows[y] + rowStartX).map(x => {\r\n                  const n = layout(x, y);\r\n                  const isInPcSet = _.includes(pcSet, n % 12);\r\n\r\n                  // return (\r\n                  //   <\r\n                  //     Cell\r\n                  //     key={x}\r\n                  //     isOdd={isOdd}\r\n                  //   >\r\n                  //     {(boardsOnGrid[y][x] || {}).boardNum}\r\n                  //   </Cell>);\r\n\r\n                  return (\r\n                    <PC\r\n                      key={x}\r\n                      n={n}\r\n                      isOdd={isOdd}\r\n                      showOctave\r\n                      style={{\r\n                        // border: `solid ${1}px`,\r\n                        border: `solid 1px`,\r\n                        borderRadius: '50%',\r\n                        color: isInPcSet ? 'white' : 'grey', //TODO: printer settings as well as mediaquery stylesheet\r\n                        backgroundColor: hslToHex(...getColorHsl(n, isInPcSet)),\r\n                        // color: isInPcSet ? 'magenta' : 'white',\r\n                      }}\r\n                    />);\r\n                })\r\n              ]}\r\n              <br/>\r\n            </>\r\n          );\r\n        })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Tonnetz;\r\n","import _ from 'lodash';\r\nimport Vex from 'vexflow';\r\nimport React, {useCallback, useState} from 'react';\r\n\r\nconst VF = Vex.Flow;\r\n\r\nconst useVexFlow = () => {\r\n  const [context, setContext] = useState(null);\r\n  const [resizeObserver, setResizeObserver] = useState(null);\r\n\r\n  const ref = useCallback((el) => {\r\n    if (el) {\r\n      const renderer = new VF.Renderer(el, VF.Renderer.Backends.SVG);\r\n      renderer.resize(el.clientWidth, el.clientHeight);\r\n      setContext(renderer.getContext());\r\n\r\n      const resizeObserver = new ResizeObserver(([{ contentRect: { height, width } }]) => {\r\n        renderer.resize(width, height);\r\n      });\r\n      setResizeObserver(resizeObserver);\r\n      resizeObserver.observe(el);\r\n    } else {\r\n      resizeObserver.disconnect();\r\n    }\r\n  }, []);\r\n\r\n  return {\r\n    context,\r\n    ref,\r\n  };\r\n}\r\n\r\nconst Staff = () => {\r\n  const {\r\n    context,\r\n    ref,\r\n  } = useVexFlow();\r\n\r\n  if (context) {\r\n    context.setStrokeStyle('white');\r\n    context.setFillStyle('white');\r\n\r\n    const treble = new VF.Stave(50, 0, 10000)\r\n      .addClef('treble')\r\n      .addKeySignature('Db')\r\n      .addTimeSignature('4/4')\r\n      .setContext(context)\r\n      .draw();\r\n\r\n    window.VF= VF;\r\n    window.context = context\r\n    window.treble = treble\r\n\r\n    const bass = new VF.Stave(50, 60, 10000)\r\n      .addClef('bass')\r\n      .addTimeSignature('4/4')\r\n      .addKeySignature('Db')\r\n      .setContext(context)\r\n      .draw();\r\n\r\n    const brace = new VF.StaveConnector(treble, bass)\r\n      .setType(VF.StaveConnector.type.BRACE)\r\n      .setContext(context)\r\n      .draw();\r\n\r\n\r\n    const leftLine = new VF.StaveConnector(treble, bass)\r\n      .setType(VF.StaveConnector.type.SINGLE_LEFT)\r\n      .setContext(context)\r\n      .draw();\r\n\r\n  }\r\n\r\n\r\n  return (\r\n    <div style={{\r\n      display: 'block',\r\n      width: '100%',\r\n    }}>\r\n      <div\r\n        ref={ref}\r\n        style={{\r\n          // background: 'darkcyan',\r\n          fill: 'white',\r\n          height: 500,\r\n          stroke: 'white',\r\n        }}/>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default Staff;\r\n","import FrettedInstrument from './frettedInstrument';\r\nimport React from 'react';\r\n\r\nconst Ukulele = () => (\r\n  <FrettedInstrument\r\n    fretCount={18}\r\n    fretMarkers={[0,5,7,10,12]}\r\n    tuning={[7, 4, 0, 9]}\r\n  />\r\n);\r\n\r\nexport default Ukulele;\r\n","import OSC from 'osc-js';\r\nimport Banjo from './banjo';\r\nimport ColtraneCircle from './coltraneCircle';\r\nimport Dod from './dod';\r\nimport Guitar from './guitar';\r\nimport Mandelbrot from './mandelbrot';\r\nimport Mandolin from './mandolin';\r\nimport MultTableMod12 from './multTableMod12';\r\nimport NumpadMod12 from './numpadMod12';\r\nimport PitchClassCollections from './pitchClassCollections';\r\nimport PitchClassSpiral from './pitchClassSpiral';\r\nimport RatioLightship from './ratioLightship';\r\nimport Staff from './staff';\r\nimport Tonnetz from './tonnetz';\r\nimport Ukulele from './ukulele';\r\n\r\nexport const routes2d = [\r\n  ['Mandelbrot Muse', '/mandelbrot', Mandelbrot],\r\n  ['Mod12 Multiplication Tables', '/multTableMod12', MultTableMod12],\r\n  ['OSC Dataviz', '/osc', OSC, true],\r\n  ['PC Number Notepad', '/numpadMod12', NumpadMod12],\r\n  ['PC Tonnetz', '/tonnetz', Tonnetz],\r\n  ['Ratio Lightship', '/ratioLightship', RatioLightship],\r\n  ['Staff', '/staff', Staff],\r\n  ['Strings PCs - Banjo', '/banjo', Banjo],\r\n  ['Strings PCs - Guitar', '/guitar', Guitar],\r\n  ['Strings PCs - Mandolin', '/mandolin', Mandolin],\r\n  ['Strings PCs - Ukulele', '/ukulele', Ukulele],\r\n];\r\n\r\nexport const routesVr = [\r\n  ['Coltrane Circle', '/vr/coltrane', ColtraneCircle],\r\n  ['Dod', '/vr/dod', Dod],\r\n  ['PitchClassCollections', '/vr/pitchClassCollections', PitchClassCollections],\r\n  ['PitchClassSpiral', '/vr/pitchClassSpiral', PitchClassSpiral],\r\n]\r\n","import {Entity} from \"aframe-react\";\r\nimport React from \"react\";\r\n\r\nconst Camera = () => (\r\n  <Entity\r\n    primitive=\"a-camera\"\r\n    id=\"camera\"\r\n    position={{ x: 0, y: 0, z: 0 }}\r\n    look-controls\r\n    // touch-look-controls={{\r\n    //   enabled: true,\r\n    // }}\r\n    wasd-controls={{\r\n      acceleration: 25,\r\n    }}\r\n  >\r\n    {/*<Entity*/}\r\n    {/*  primitive=\"a-cursor\"*/}\r\n    {/*  animation__click={{*/}\r\n    {/*    property: 'scale',*/}\r\n    {/*    startEvents: 'click',*/}\r\n    {/*    from: '0.1 0.1 0.1',*/}\r\n    {/*    to: '1 1 1',*/}\r\n    {/*    dur: 150,*/}\r\n    {/*  }}/>*/}\r\n  </Entity>\r\n);\r\n\r\nexport default Camera;\r\n","// import 'aframe-touch-look-controls'; FIXME\r\nimport Camera from './camera';\r\nimport ColtraneCircle from \"./coltraneCircle\";\r\nimport Dod from './dod';\r\nimport PitchClassCollections from \"./pitchClassCollections\";\r\nimport PitchClassSpiral from \"./pitchClassSpiral\";\r\nimport React from 'react';\r\nimport {Entity, Scene} from 'aframe-react';\r\nimport {Route, Switch} from 'react-router-dom';\r\nimport {routesVr} from './routes';\r\n\r\n// Note: needs https to enter VR\r\n\r\nconst VR = ({match: {path}}) => (\r\n  <Scene\r\n    // fog={{type: 'linear', color: '#000', near: 1, far: 10}}\r\n  >\r\n    <a-assets>\r\n      {/*<img id=\"groundTexture\" src=\"https://cdn.aframe.io/a-painter/images/floor.jpg\"/>*/}\r\n      {/*<img id=\"skyTexture\" src=\"https://cdn.aframe.io/a-painter/images/sky.jpg\"/>*/}\r\n    </a-assets>\r\n\r\n    <Switch\r\n      // FIXME: used to be <Route path={`${path}/pitchClassSpiral`} component={PitchClassSpiral}/>\r\n    >\r\n      {routesVr.map(([title, path, component], key) => (\r\n        <Route {...{ component, key, path }} />\r\n      ))}\r\n    </Switch>\r\n\r\n\r\n    {/*<Entity primitive=\"a-plane\" src=\"#groundTexture\" rotation=\"-90 0 0\" height=\"100\" width=\"100\"/>*/}\r\n    {/*<Entity primitive=\"a-light\" type=\"ambient\" color=\"#445451\"/>*/}\r\n    {/*<Entity primitive=\"a-light\" type=\"point\" intensity=\"2\" position=\"2 4 4\"/>*/}\r\n\r\n    {/*<Entity*/}\r\n    {/*  height=\"2048\"*/}\r\n    {/*  primitive=\"a-sky\"*/}\r\n    {/*  radius=\"30\"*/}\r\n    {/*  rotation=\"90 0 0\"*/}\r\n    {/*  src=\"#skyTexture\"*/}\r\n    {/*  theta-length=\"90\"*/}\r\n    {/*  width=\"2048\"*/}\r\n    {/*/>*/}\r\n    {/*<Entity*/}\r\n    {/*  height=\"2048\"*/}\r\n    {/*  primitive=\"a-sky\"*/}\r\n    {/*  radius=\"30\"*/}\r\n    {/*  rotation=\"90 0 180\"*/}\r\n    {/*  src=\"#skyTexture\"*/}\r\n    {/*  theta-length=\"90\"*/}\r\n    {/*  width=\"2048\"*/}\r\n    {/*/>*/}\r\n\r\n    <Camera />\r\n\r\n    <Entity\r\n      // events={{}}\r\n      id=\"leftHand\"\r\n      oculus-touch-controls=\"hand: left\"\r\n    />\r\n    <Entity\r\n      id=\"rightHand\"\r\n      oculus-touch-controls=\"hand: right\"\r\n    />\r\n\r\n  </Scene>\r\n);\r\n\r\nexport default VR;\r\n","import { fraction } from 'mathjs';\r\n\r\nexport const toOctave = (r) => r > 2\r\n  ? toOctave(r / 2)\r\n  : r < 1\r\n    ? toOctave(r * 2)\r\n    : r;\r\n\r\nexport const intToRatio = (i) => fraction(toOctave(i));\r\n\r\n// TODO: n-dimensions\r\nexport const coordToRatio = (x, y) => {\r\n  const raw = Math.pow(3, x) * Math.pow(5, y);\r\n  return fraction(toOctave(raw));\r\n}\r\n\r\n// for(let threes = -5; threes <= 5; threes++) {\r\n//   for(let fives = -5; fives <= 5; fives++) {\r\n//     let f = coordToRatio(threes, fives);\r\n//     console.log(`${f.n}/${f.d}`)\r\n//   }\r\n// }\r\n","// import 'aframe-animation-component';\r\nimport 'aframe';\r\nimport 'aframe-look-at-component';\r\nimport Banjo from './banjo';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Guitar from './guitar';\r\nimport Intro from './intro';\r\nimport MultTableMod12 from './multTableMod12';\r\nimport NumpadMod12 from './numpadMod12';\r\nimport OSC from 'osc-js';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Mandelbrot from './mandelbrot';\r\nimport Mandolin from './mandolin';\r\nimport Mic from './mic';\r\nimport Midi from './midi';\r\nimport RatioLightship from './ratioLightship';\r\nimport {routes2d, routesVr} from './routes';\r\nimport Staff from './staff';\r\nimport Tonnetz from './tonnetz';\r\nimport Ukulele from './ukulele';\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\nimport VR from './vr';\r\nimport {\r\n  AppBar,\r\n  IconButton,\r\n  Link,\r\n  Menu,\r\n  MenuItem,\r\n  Toolbar,\r\n} from '@material-ui/core';\r\nimport {BrowserRouter as Router, Route, Link as RouterLink} from 'react-router-dom';\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport {\r\n  Menu as MenuIcon,\r\n  MenuBookIcon,\r\n  WatchLater as MidiClockIcon,\r\n} from '@material-ui/icons';\r\nimport _ from 'lodash';\r\n\r\nimport { intToRatio } from \"./fns\";\r\n\r\nwindow.intToRation = intToRatio;\r\n\r\nconst doWhenAframeLoaded = () => {\r\n  if (typeof AFRAME === 'undefined') {\r\n    setTimeout(doWhenAframeLoaded, 100);\r\n    return;\r\n  }\r\n\r\n  const oscHost = {\r\n    host: window.location.hostname,\r\n    port: '8080',\r\n    secure: true,\r\n  };\r\n  const osc = new OSC({\r\n    plugin: new OSC.WebsocketClientPlugin(oscHost),\r\n  });\r\n  osc.open();\r\n  window.osc = osc;\r\n\r\n  // window.sendOsc = (address, ...args) => osc.send(new OSC.Message(address, ...args));\r\n\r\n  // osc.on('/midiSeq/clear', () => clearSeq());\r\n\r\n  // osc.on('/midiSeq/beat', ({args: [beat]}) => setBeat(beat));\r\n\r\n  // WIP\r\n  window.AFRAME.registerComponent('midi', {\r\n    init: function() {\r\n      // this.onOsc = (i, e) => {};\r\n\r\n      this._onOscId = osc.on('/midi/*', ({address, args: [note, vel]}) => {\r\n        const instrument = _.last(address.split('/'));\r\n        if (this.onOsc) this.onOsc({ instrument, note, vel });\r\n      });\r\n\r\n    },\r\n\r\n    tick: function (time, timeDelta) {\r\n      if (this.onTick) this.onTick(time, timeDelta);\r\n    },\r\n\r\n    remove: function() {\r\n      osc.off('/midi/*', this._onOscId);\r\n    },\r\n  });\r\n\r\n  window.AFRAME.registerComponent('osc', {\r\n    init: function() {\r\n      // this.onOsc = (i, e) => {};\r\n\r\n      this._onOscId = osc.on('/midi/*', ({address, args: [note, vel]}) => {\r\n        const instrument = _.last(address.split('/'));\r\n        if (this.onOsc) this.onOsc({ instrument, note, vel });\r\n      });\r\n\r\n    },\r\n\r\n    tick: function (time, timeDelta) {\r\n      if (this.onTick) this.onTick(time, timeDelta);\r\n    },\r\n\r\n    remove: function() {\r\n      osc.off('/midi/*', this._onOscId);\r\n    },\r\n  });\r\n}\r\ndoWhenAframeLoaded();\r\n\r\nconst App = () => {\r\n  const prefersDarkMode = true// useMediaQuery('(prefers-color-scheme: dark)');\r\n\r\n  const neutral = {\r\n    palette: { // https://material-ui.com/customization/palette/\r\n      action: {\r\n        active: '#660000',\r\n      },\r\n      primary: {\r\n        main: '#330033'\r\n      },\r\n      type: 'dark',\r\n    },\r\n  };\r\n\r\n  const dark = {\r\n    palette: { // https://material-ui.com/customization/palette/\r\n      action: {\r\n        active: '#600',\r\n      },\r\n      primary: {\r\n        main: '#c0e'\r\n      },\r\n      type: 'dark',\r\n    },\r\n  };\r\n\r\n  const light = {\r\n    palette: { // https://material-ui.com/customization/palette/\r\n      action: {\r\n        active: '#660000',\r\n      },\r\n      primary: {\r\n        main: '#330033'\r\n      },\r\n      type: 'light',\r\n    },\r\n  };\r\n\r\n  const theme = React.useMemo(\r\n    () =>\r\n      createMuiTheme(prefersDarkMode ? dark : light),\r\n    [prefersDarkMode],\r\n  );\r\n\r\n  // Menu open/close\r\n  const [menuAnchorEl, setMenuAnchorEl] = React.useState(null);\r\n  const handleMenuButtonClick = ({ currentTarget }) => setMenuAnchorEl(currentTarget);\r\n  const handleMenuClose = () => setMenuAnchorEl(null);\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CssBaseline/>\r\n      <Router basename={process.env.PUBLIC_URL}>\r\n        <Route path=\"/\" exact component={Intro}/>\r\n\r\n        <Route path=\"/vr\" component={VR} />\r\n\r\n        {routes2d.map(([title, path, component], key) => (\r\n          <Route {...{ component, key, path }} />\r\n        ))}\r\n\r\n        <AppBar\r\n          color=\"transparent\"\r\n          onClick={() => {\r\n            // if (window.audioContext) { // FIXME HACK\r\n            //   window.audioContext.resume();\r\n            //   window.detector.start();\r\n            // }\r\n          }}\r\n          position=\"fixed\"\r\n          style={{\r\n            top: 'auto',\r\n            bottom: 0,\r\n          }}\r\n        >\r\n          <Toolbar>\r\n            <IconButton\r\n              edge=\"start\"\r\n              color=\"inherit\"\r\n              aria-label=\"open drawer\"\r\n              onClick={handleMenuButtonClick}\r\n            >\r\n              <MenuIcon/>\r\n            </IconButton>\r\n\r\n            <Menu\r\n              anchorEl={menuAnchorEl}\r\n              open={!!menuAnchorEl}\r\n              onClose={handleMenuClose}\r\n            >\r\n              <MenuItem>\r\n                <Link component={RouterLink} style={{ color: 'lightgrey'}} onClick={handleMenuClose} to=\"/\">Introduction</Link>\r\n              </MenuItem>\r\n              <MenuItem disabled divider >2D</MenuItem>\r\n              {routes2d.map(([title, url, component, isDevOnly], idx) => !isDevOnly && (\r\n                <MenuItem key={idx}>\r\n                  <Link color=\"primary\" component={RouterLink} onClick={handleMenuClose} to={url}>{title}</Link>\r\n                </MenuItem>\r\n              ))}\r\n              <MenuItem disabled divider>VR</MenuItem>\r\n              {routesVr.map(([title, url], idx) => (\r\n                <MenuItem key={idx}>\r\n                  <Link color=\"secondary\" component={RouterLink} onClick={handleMenuClose} to={url}>{title}</Link>\r\n                </MenuItem>\r\n              ))}\r\n            </Menu>\r\n\r\n            <Midi />\r\n\r\n            <Mic />\r\n          </Toolbar>\r\n        </AppBar>\r\n      </Router>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n\r\nReactDOM.render(<App/>, document.querySelector('#sceneContainer'));\r\n"],"sourceRoot":""}