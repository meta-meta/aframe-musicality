(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{119:function(e,t,n){e.exports=n(150)},149:function(e,t){},150:function(e,t,n){"use strict";n.r(t);var a=n(9),i=(n(120),n(123),n(7)),r=n.n(i),o=n(0),c=n.n(o),l=n(14),u=Object(l.a)({root:{fontSize:20,fontFamily:"jetBrainsMono",display:"inline-flex",height:30,width:30,alignItems:"center",justifyContent:"center"},odd:{left:15,position:"relative"}})(function(e){var t=e.children,n=e.classes,a=e.className,i=void 0===a?"":a,r=e.isOdd,o=e.style;return c.a.createElement("div",{className:"".concat(n.root," ").concat(i," ").concat(r?n.odd:""),style:o},t)}),s=Object(l.a)({fretMarker:{color:"purple"}})(function(e){var t=e.classes.fretMarker,n=e.frets;return r.a.range(r.a.last(n)+1).map(function(e){return r.a.includes(n,e)?e:""}).map(function(e,n){return c.a.createElement(u,{className:t,key:n},e)})}),d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return{10:"\u0aea",11:"\u0190"}[e%t]||e%t},m=function(e){e.classes;var t=e.isOdd,n=e.isSolfege,a=void 0!==n&&n,i=e.n,r=e.style,o=void 0===r?a?{borderStyle:"solid",borderWidth:1,width:70}:null:r;return c.a.createElement(u,{isOdd:t,style:o},a?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return{0:"oh",1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"sev",8:"eight",9:"nine",10:"ten",11:"el"}[e%t]||e%t}(i):d(i))},f=[1,3,5,7,10,12,15,17,19],p=function(){return c.a.createElement("div",{style:{display:"block",flexShrink:0}},c.a.createElement(s,{frets:f}),c.a.createElement("br",null),[0,9,5,0,0].map(function(e,t){return c.a.createElement(c.a.Fragment,{key:t},r.a.range(23).map(function(t){return(t+e)%12}).map(function(e,n){return 4===t&&n<5?c.a.createElement(u,{key:n}):c.a.createElement(m,{key:n,n:e})}),c.a.createElement("br",null))}),c.a.createElement(s,{frets:f}))},h=n(191),v=n(16),g=function(e){var t=e.fretCount,n=e.fretMarkers,a=e.tuning;return c.a.createElement("div",{style:{display:"block",flexShrink:0}},c.a.createElement(s,{frets:n}),c.a.createElement("br",null),Object(v.a)(a).reverse().map(function(e,n){return c.a.createElement(c.a.Fragment,{key:n},r.a.range(t+1).map(function(t){return(t+e)%12}).map(function(e,t){return c.a.createElement(m,{key:t,n:e})}),c.a.createElement("br",null))}),c.a.createElement(s,{frets:n}))},b=[4,9,2,7,11,4],k=function(){return c.a.createElement(g,{fretCount:24,fretMarkers:[0,5,7,12,15,17,19,24],tuning:b})},y=function(){return c.a.createElement("div",{style:{height:"100%",overflowY:"auto",padding:"20% 10%"}},c.a.createElement("h1",null,"musicality.computer"),c.a.createElement("h2",null,"12ET pitch-class symbols:"),c.a.createElement("pre",null,r.a.range(12).map(function(e){return c.a.createElement(m,{key:e,n:e})})),c.a.createElement("h3",null,"12ET pitch-classes as solfege syllables:"),r.a.range(12).map(function(e){return c.a.createElement(m,{key:e,isSolfege:!0,n:e})}))},E=function(){return c.a.createElement(c.a.Fragment,null,r.a.range(6).map(function(e){return c.a.createElement("div",{style:{display:"block",flexShrink:0,margin:"1em"}},r.a.range(13).map(function(t){return c.a.createElement(c.a.Fragment,null,r.a.range(13).map(function(n){return c.a.createElement(m,{key:n,n:e+n*t})}),c.a.createElement("br",null))}))}))},w=n(2),M=n(1),S=n(5),C=n(3),x=n(6),O=function(e){function t(){var e,n;Object(w.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(S.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(i)))).state={text:""},n.handleKeyPress=function(e){var t={Backquote:"0",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"\u0aea",Minus:"\u0190",Equal:"0",Numpad0:"0",Numpad1:"1",Numpad2:"2",Numpad3:"3",Numpad4:"4",Numpad5:"5",Numpad6:"6",Numpad7:"7",Numpad8:"8",Numpad9:"9",NumpadDivide:"\u0aea",NumpadMultiply:"\u0190",NumpadDecimal:" ",NumpadEnter:"\n",Enter:"\n",Space:" "}[e.code];t&&(e.preventDefault(),n.setState({text:n.state.text+t}))},n.handleChange=function(e){var t=e.target.value;return n.setState({text:t})},n}return Object(x.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("keypress",this.handleKeyPress)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keypress",this.handleKeyPress)}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("h3",null,"Use the numpad to enter pitch classes"),c.a.createElement("textarea",{cols:24,rows:20,onChange:this.handleChange,style:{background:"black",color:"darkgray",fontSize:20},value:this.state.text}))}}]),t}(o.Component),I=n(74),j=n.n(I),D=n(15),z=n.n(D),T=n(12),P=(n(115),n(22)),N=n(99),R=n.n(N),A=n(107),L=n.n(A),F=n(106),V=n.n(F),q=n(108),_=n.n(q),K=n(103),W=n.n(K),B=n(81),G=n.n(B),U=n(80),H=n.n(U),X=n(101),Y=n.n(X),J=n(104),Z=n.n(J),Q=n(102),$=n.n(Q),ee=n(105),te=n.n(ee),ne=n(109),ae=n.n(ne),ie=n(68),re={input:void 0,inputDevices:[],isMidiClockInSelectorOpen:!1,isMidiInSelectorOpen:!1,midiClockInDevice:void 0,midiInDevice:void 0,midiIn:r.a.zipObject(r.a.range(128),r.a.fill(new Array(128),0))},oe={setInputDevices:function(e,t){return e.setState({inputDevices:t})},setMidiEvent:function(e,t){return e.setState({midiIn:r.a.merge(e.state.midiIn,t)})},setMidiClockInDevice:function(e,t){return e.setState({midiClockInDevice:t})},setMidiInDevice:function(e,t){return e.setState({midiInDevice:t})},toggleMidiInSelector:function(e){return e.setState({isMidiInSelectorOpen:!e.state.isMidiInSelectorOpen})},toggleMidiClockInSelector:function(e){return e.setState({isMidiClockInSelectorOpen:!e.state.isMidiClockInSelectorOpen})}},ce=Object(ie.a)(c.a,re,oe),le=function(e,t,n){var i=ce(function(e){return{midiClockInDevice:e.midiClockInDevice}},function(e){return e}),r=Object(a.a)(i,2),c=r[0].midiClockInDevice,l=(r[1],0);return Object(o.useEffect)(function(){var i=function(t){l++,e&&e({tick:l})},r=function(e){t&&t(),console.log("stop")},o=function(e){var t=Object(a.a)(e.data,3),i=6*(t[1]+128*t[2]);console.log("SPP",i),n&&n(i)};return c&&(c.addListener("clock","all",i),c.addListener("stop","all",r),c.addListener("songposition","all",o)),function(){c&&(c.removeListener("clock","all",i),c.removeListener("stop","all",r),c.removeListener("songposition","all",o))}},[c]),{midiClockInDevice:c,reset:function(){l=0}}},ue=n(100),se=n.n(ue),de=function(e,t){var n=Object(o.useState)(t),i=Object(a.a)(n,2),r=i[0],c=i[1],l=Object(o.useState)(null),u=Object(a.a)(l,2),s=u[0],d=u[1],m=Object(o.useState)(null),f=Object(a.a)(m,2),p=f[0],h=f[1];s&&(s.setState=c,s.state=r);var v=Object(o.useCallback)(function(t){if(t){var n=new se.a(e,t);d(n),n._height=t.clientHeight,n._width=t.clientWidth;var i=new ResizeObserver(function(e){var t=Object(a.a)(e,1)[0].contentRect,i=t.height,r=t.width;n.resizeCanvas(r,i),r+i>0&&c(function(e){return Object(P.a)({},e,{isRegenNeeded:!0})})});h(i),i.observe(t)}else p&&p.disconnect()},[]);return{sketchInstance:s,sketchState:r,setSketchState:c,ref:v}};function me(e,t,n){var a,i,r,o,c,l,u,s;switch(1===arguments.length&&(t=e.s,n=e.v,e=e.h),l=n*(1-t),u=n*(1-(c=6*e-(o=Math.floor(6*e)))*t),s=n*(1-(1-c)*t),o%6){case 0:a=n,i=s,r=l;break;case 1:a=u,i=n,r=l;break;case 2:a=l,i=n,r=s;break;case 3:a=l,i=u,r=n;break;case 4:a=s,i=l,r=n;break;case 5:a=n,i=l,r=u}return function(e){var t=e.r,n=e.g,a=e.b;function i(e){var t=e.toString(16);return 1==t.length?"0"+t:t}return"#"+i(t)+i(n)+i(a)}({r:Math.round(255*a),g:Math.round(255*i),b:Math.round(255*r)})}!function(){var e=[],t="zero-timeout-message";window.addEventListener("message",function(n){n.source==window&&n.data==t&&(n.stopPropagation(),e.length>0&&e.shift()())},!0),window.setZeroTimeout=function(n){e.push(n),window.postMessage(t,"*")}}();var fe={audioPan:0,decayDuration:1e3,exciteEnergy:.05,exciteDuration:50,fundamentalFreq:200,hilbertN:64,hilbMand:[],isControlPanelOpen:!0,isPlaying:!1,isRegenNeeded:!0,maxIters:4096,midiClock:0,midiClocksPerTick:24,panX:-.05,panY:0,partials:{},partialsCountMax:16,isSmooth:!1,tick:0,tickDuration:100,tickLastMillis:0,zoom:1.2},pe=new AudioContext,he=[],ve=pe.createGain(),ge=pe.createStereoPanner();window.masterGain=ve,ve.gain.value=1,ve.connect(ge),ge.connect(pe.destination);var be=function(e){e.state=fe;var t,n=function(e,t,n,a){if(0===a){1===n&&(t.x=e-1-t.x,t.y=e-1-t.y);var i=t.x;t.x=t.y,t.y=i}},a=function(e,t){return r.a.reduce(e,function(e,n,a){return e+n*t[a]},0)},i=function(t,n,i,r,o,c){var l=function(e,t){return{x:3.5*e-2.5,y:2*t-1}}(.5-i+(t-.5)/o,.5-r+(n-.5)/o),u=l.x,s=l.y;return e.state.isSmooth?function(e,t,n){for(var i,r,o=[0,0],c=0,l=0;l<n&&(i=o[0],r=o[1],o[0]=i*i-r*r+e,o[1]=2*i*r+t,!(a(o,o)>65536));l++)c++;return c>=n?n:c-Math.log2(Math.log2(a(o,o)))+4}(u,s,c):function(e,t,n){for(var a=0,i=0,r=0;a*a+i*i<4&&r<n;){var o=a*a-i*i+e;i=2*a*i+t,a=o,r++}return r}(u,s,c)},o=r.a.memoize(function(e){return r.a.range(e*e).map(function(t){return function(e,t){for(var a={x:0,y:0},i=1;i<e;i*=2){var r=1&t/2,o=1&(t^r);n(i,a,r,o),a.x+=i*r,a.y+=i*o,t/=4}return a}(e,t)})}),c=function(t){var n=t/e.state.hilbertN;return 1*Math.min(10,n/20)},l=r.a.memoize(function(e){return r()(100).range().map(function(e){return Math.pow(2,e)}).dropWhile(function(t){return e/t>=2}).first()}),u=function(t){var n=t.m,a=t.p,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.state,o=r.maxIters,c=r.partialsCountMax,u=l(c),s=l(a),d=255*Math.log2(a/s),m=i?0:255-225*Math.pow(s/u,2),f=i?255:n===o?0:30+225*Math.pow(s/u,2);return e.color(d,m,f,i?.7:255)},s=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.fill(u(t,n))},d=function(t,n,a,i){var r=t/i,o=n/i;e.rect(a.x*r,a.y*o,r,o)},m=function(t,n,a){var i=a.hilbertN,r=a.hilbMand,o=c(e.width/2);e.strokeWeight(o),e.stroke(0);var l=f(r.length,e.width/4,e.height);r.forEach(function(a,r){s(a),e.push(),e.translate(e.width/4,0),d(t,n,a,i),e.pop(),e.push(),e.translate(e.width/4*3,0),p(e.width/4,l,r),e.pop()})},f=function(e,t,n){for(var a=t*n,i=Math.sqrt(a/e),r=0,o=1;o<t;o++)if(!((r=t/o)>i)){var c=t/r;if(e/c*r+(e%c>0?r:0)<=n)break}return r},p=function(t,n,a){var i=t/n,r=a%i,o=Math.floor(a/i);o%2===1&&(r=i-(r+1)),e.rect(r*n,o*n,n,n)},h=function(){e.background(32),he.forEach(function(e){var t=e.gain;t.gain.cancelScheduledValues(pe.currentTime),t.gain.linearRampToValueAtTime(0,pe.currentTime+.5)});var t=e.state,n=t.fundamentalFreq,a=t.partialsCountMax;he.length!==a&&(he.forEach(function(e){var t=e.osc;e.gain,t.stop()}),he=r.a.range(e.state.partialsCountMax).map(function(){var e=pe.createOscillator(),t=pe.createGain();return t.gain.value=0,e.connect(t),t.connect(ve),e.start(),{osc:e,gain:t}}),window.oscs=he);var c=function(){var t=e.state,n=t.hilbertN,a=t.maxIters,r=t.panX,c=t.panY,l=t.partialsCountMax,u=t.zoom;return o(n).map(function(e){var t=e.x,o=e.y,s=i(t/n,o/n,r,c,u,a);return{x:t,y:o,m:s,p:s===a?0:Math.floor((s-1)%l+1)}})}(),l=r()(c).map(function(e){return e.p}).filter(r.a.identity).uniq().sort().take(a).map(function(e,t){return[e,{amp:0,oscIdx:t}]}).fromPairs().value();r.a.each(l,function(e,t){var a=e.decayTimerId,i=e.oscIdx,r=e.zeroGainTimerId;clearTimeout(a),clearTimeout(r),he[i].osc.frequency.cancelScheduledValues(pe.currentTime),he[i].osc.frequency.linearRampToValueAtTime(t*n,pe.currentTime+1)}),e.setState(function(t){var n=Object(P.a)({},t,{hilbMand:c,isRegenNeeded:!1,partials:l});return m(e.width/2,e.height,n),n})},v=0,g=function(t){var n=e.state.hilbMand,a=e.state.tick%n.length,i=n[a],r=f(n.length,e.width/4,e.height),o=c(e.width/2);e.strokeWeight(o),function(t,n,a){var i=e.state.hilbMand[a%t];s(i),e.stroke(0),e.push(),e.translate(e.width/4,0),d(e.width/2,e.height,i,e.state.hilbertN),e.pop(),e.push(),e.translate(e.width/4*3,0),p(e.width/4,n,a),e.pop()}(n.length,r,v),v=a,e.stroke(20*t%255,0,255),s(i,!0),e.push(),e.translate(e.width/4,0),d(e.width/2,e.height,i,e.state.hilbertN),e.pop(),e.push(),e.translate(e.width/4*3,0),p(e.width/4,r,a),e.pop()},b=function(){var t=e.height,n=e.width/4;e.noStroke();var a=e.state,i=a.partials,o=a.partialsCountMax;r.a.each(i,function(a,i){var r=a.amp,c=a.oscIdx,l=t/o,s=t*((i-1)/o),d=he[c].gain.gain.value*n,m=u({m:1,p:i});e.fill(e.color(e.hue(m),255,8)),e.rect(0,s,n,l),e.fill(m),e.rect(0,s,d,l),e.fill(255),e.rect(r*n,s,1,l)})},k=!0;e.preload=function(){t=e.loadFont("JetBrainsMono-Regular.ttf")},e.setup=function(){e.createCanvas(e._width,e._height),e.colorMode(e.HSB),e.textFont(t),e.incrementTick()},e.incrementTick=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.millis(),a=e.state,i=a.isPlaying,o=a.isRegenNeeded,c=a.midiClocksPerTick,l=a.tickDuration,u=a.tickLastMillis;t&&e.state.midiClock++,!o&&(t?e.state.midiClock%c===0:i&&n>u+l)&&(e.state.tick++,e.state.tickLastMillis=n,function(t){var n=e.state,a=n.audioPan,i=n.decayDuration,o=n.exciteEnergy,c=n.exciteDuration,l=n.hilbMand,u=n.partials,s=n.tick;ge.pan.value=a;var d=l[s%l.length].p;if(d>0){var m=u[d],f=m.amp,p=m.decayTimerId,h=m.oscIdx,v=m.zeroGainTimerId,g=he[h].gain,b=r.a.isNumber(p)?f:g.gain.value,k=.8*Math.min(1,b+o*(1-b));m.amp=k,clearTimeout(p),clearTimeout(v),g.gain.cancelScheduledValues(0),g.gain.linearRampToValueAtTime(k,pe.currentTime+c/1e3),m.decayTimerId=setTimeout(function(){g.gain.exponentialRampToValueAtTime(1e-5,pe.currentTime+i/1e3),m.decayTimerId=null,m.zeroGainTimerId=setTimeout(function(){m.amp=0},i)},c)}}()),t||0!==e.state.midiClock||window.setZeroTimeout(e.incrementTick)};var y=0;e.draw=function(){var t=e.state,n=t.isPlaying,a=t.isRegenNeeded;t.midiClock;a&&h(),r.a.every([!a,e.state.tick!==y])&&(g(0),y=e.state.tick),n&&b(),e.state.isPlaying||e.state.isControlPanelOpen?k&&(b(),m(e.width/2,e.height,e.state),k=!1):(k=!0,e.background(0,.1),e.noFill(),e.stroke(192,127,90),e.textSize(10),e.text("arrow keys to move",0,e.height/2-50,e.width,e.height),e.text("shift+arrow for zoom/resolution",0,e.height/2-35,e.width,e.height),e.text("shift+spacebar toggle controls",0,e.height/2-20,e.width,e.height),e.textSize(20),e.textAlign(e.CENTER),e.text("spacebar to start",0,e.height/2,e.width,e.height))},e.toggleAudio=function(){e.setState(function(e){var t=e.isPlaying;return t||"running"===pe.state||pe.resume(),t&&"running"===pe.state&&pe.suspend(),Object(P.a)({},e,{isPlaying:!e.isPlaying})})}},ke=n(183),ye=n(152),Ee=n(198),we=n(184),Me=Object(ke.a)({paper:{background:"rgba(0,0,0,0.7)",paddingBottom:65}}),Se=function(e){var t=e.initialVal,n=void 0===t?1:t,i=e.isInt,l=void 0!==i&&i,u=e.isRegenRequired,s=void 0!==u&&u,d=e.label,m=void 0===d?"":d,f=e.max,p=void 0===f?Number.MAX_VALUE:f,h=e.min,v=void 0===h?Number.MIN_VALUE:h,g=e.precision,b=void 0===g?6:g,k=e.setSketchState,y=e.size,E=void 0===y?240:y,w=e.sketchState,M=e.stateKey,S=function(e){return Math.min(Math.max(l?Math.round(e):e,v),p)},C=function(e){var t=S(e),n=Math.log2(t),a=Math.floor(n);return{deg:Math.floor(2048*(n-a)),exp:a,numberInputVal:t}},x=Object(o.useState)(function(){return C(n)}),O=Object(a.a)(x,2),I=O[0],j=O[1];Object(o.useEffect)(function(){r.a.defer(function(){return j(C(n))})},[]);return c.a.createElement("div",{style:{flex:"0 ".concat(E+40,"px"),height:E+40,marginBottom:40}},c.a.createElement("div",{style:{height:"3em"}},m||"".concat(M,": ").concat(w[M])),c.a.createElement("div",{style:{paddingTop:10,position:"relative"},onPointerUp:function(){w.isRegenNeeded=s}},c.a.createElement(R.a,{dataIndex:I.deg,min:0,max:2047,knobColor:"#AAA",knobSize:60,label:"Fundamental Frequency",renderLabelValue:c.a.createElement("input",{type:"number",style:{background:"none",border:"none",color:"white",fontSize:"".concat(E/100,"em"),left:"50%",marginLeft:"-40%",marginTop:"-0.5em",position:"absolute",textAlign:"center",top:"50%",width:"80%",zIndex:3},value:l?I.numberInputVal:I.numberInputVal.toPrecision(b),onChange:function(e){j(Object(P.a)({},I,{numberInputVal:Number(e.target.value)}))},onKeyDown:function(e){if("Enter"===e.key){var t=C(I.numberInputVal);j(t),r.a.defer(function(){j(t),k(function(e){var n;return Object(P.a)({},e,(n={},Object(T.a)(n,M,t.numberInputVal),Object(T.a)(n,"isRegenNeeded",s),n))})})}}}),onChange:function(e){var t=I.deg,n=I.exp,a=e>=0&&e<2048/3&&t>2048-2048/3?n+1:t>=0&&t<2048/3&&e>2048-2048/3?n-1:n,i=S(Math.pow(2,a+e/2048));j({deg:e,exp:a,numberInputVal:i}),k(function(e){return Object(P.a)({},e,Object(T.a)({},M,i))})},progressColorFrom:me(I.exp/15,1,1),progressColorTo:me((I.exp+1)/15,1,1),progressLineCap:"flat",trackColor:"#666",height:E,width:E})))},Ce=function(){var e=de(be,fe),t=e.ref,n=e.sketchInstance,a=e.sketchState,i=e.setSketchState;window.sketchInstance=n;var l=function(e){return function(t){return function(){"toggleAudio"!==t?e.setState(function(e){var n=e.hilbertN,a=e.isControlPanelOpen,i=e.isRegenNeeded,o=e.panX,c=e.panY,l=e.zoom,u=.1/l,s={moveLeft:{panX:o+u},moveRight:{panX:o-u},moveUp:{panY:c+u},moveDown:{panY:c-u},resDec:{hilbertN:Math.pow(2,Math.log2(n)-1)},resInc:{hilbertN:Math.min(256,Math.pow(2,Math.log2(n)+1))},toggleControlPanel:{isControlPanelOpen:!a,isRegenNeeded:i},zoomIn:{zoom:l*(10/9)},zoomOut:{zoom:.9*l}}[t];return Object(P.a)({},e,{isRegenNeeded:!r.a.isEmpty(s)},s)}):e.toggleAudio()}}}(n);Object(o.useEffect)(function(){if(document.title="Mandelbrot Muse",n){var e=function(e){return function(t){var n=t.code,a=t.shiftKey,i=t.key;if("Space"!==n){var r={ArrowDown:function(){return a?"zoomOut":"moveDown"},ArrowLeft:function(){return a?"resDec":"moveLeft"},ArrowRight:function(){return a?"resInc":"moveRight"},ArrowUp:function(){return a?"zoomIn":"moveUp"}}[i];r&&e(r())()}else e(a?"toggleControlPanel":"toggleAudio")()}}(l);return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}},[n]);var u=le(function(){n&&(n.state.isPlaying||i(function(e){return Object(P.a)({},e,{isPlaying:!0})}),n.incrementTick(!0))},function(){i(function(e){return Object(P.a)({},e,{isPlaying:!1})})},function(e){if(n){var t=n.state.midiClocksPerTick;n.state.midiClock=e,n.state.tick=Math.floor(e/t)}}).midiClockInDevice;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{ref:t,style:{alignSelf:"start",background:"radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)",height:"50vw",width:"100vw"}}),c.a.createElement("div",{style:{bottom:10,right:10,padding:0,position:"absolute",textAlign:"center",zIndex:1e6}},!a.isControlPanelOpen&&c.a.createElement(ye.a,{onClick:l("toggleControlPanel")},"show",c.a.createElement(Y.a,null),"controls"),c.a.createElement(Ee.a,{anchor:"bottom",classes:Me(),color:"transparent",open:a.isControlPanelOpen,onClose:l("toggleControlPanel"),variant:"persistent"},c.a.createElement(we.a,{fullWidth:!0,size:"large"},c.a.createElement(ye.a,{onClick:l("toggleAudio")},a.isPlaying?c.a.createElement(G.a,null):c.a.createElement(H.a,null)),c.a.createElement(ye.a,{onClick:l("toggleControlPanel")},"hide controls")),c.a.createElement(we.a,{fullWidth:!0,size:"large"},c.a.createElement(ye.a,{onClick:l("resDec")},c.a.createElement($.a,null)),c.a.createElement(ye.a,{onClick:l("moveUp")},c.a.createElement(W.a,null)),c.a.createElement(ye.a,{onClick:l("resInc")},c.a.createElement(Z.a,null)),c.a.createElement(ye.a,{onClick:l("zoomIn")},c.a.createElement(te.a,null))),c.a.createElement(we.a,{fullWidth:!0,size:"large"},c.a.createElement(ye.a,{onClick:l("moveLeft")},c.a.createElement(V.a,null)),c.a.createElement(ye.a,{onClick:l("moveDown")},c.a.createElement(L.a,null)),c.a.createElement(ye.a,{onClick:l("moveRight")},c.a.createElement(_.a,null)),c.a.createElement(ye.a,{onClick:l("zoomOut")},c.a.createElement(ae.a,null))),c.a.createElement("br",null),c.a.createElement(Se,{initialVal:60,isRegenRequired:!0,label:"Fundamental frequency (Hz)",stateKey:"fundamentalFreq",sketchState:a,setSketchState:i}),c.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"}},c.a.createElement(Se,{initialVal:16,isInt:!0,isRegenRequired:!0,label:"Number of partials",max:1024,min:1,precision:1,setSketchState:i,size:120,sketchState:a,stateKey:"partialsCountMax"}),c.a.createElement(Se,{initialVal:4096,isInt:!0,isRegenRequired:!0,label:"Mandelbrot iterations",max:8192,min:64,setSketchState:i,size:120,sketchState:a,stateKey:"maxIters"}),u?c.a.createElement(Se,{key:u,isInt:!0,min:1,max:1024,initialVal:24,label:"MIDI clocks per tick",size:120,stateKey:"midiClocksPerTick",sketchState:a,setSketchState:i}):c.a.createElement(Se,{key:u,initialVal:100,label:"Tick duration (ms)",size:120,stateKey:"tickDuration",sketchState:a,setSketchState:i}),c.a.createElement(Se,{initialVal:50,label:"Excite duration (ms)",size:120,stateKey:"exciteDuration",sketchState:a,setSketchState:i}),c.a.createElement(Se,{initialVal:1e3,label:"Decay duration (ms)",size:120,stateKey:"decayDuration",sketchState:a,setSketchState:i}),c.a.createElement(Se,{initialVal:.05,label:"Excite energy",precision:4,size:120,stateKey:"exciteEnergy",sketchState:a,setSketchState:i})),c.a.createElement(we.a,{fullWidth:!0,size:"large"},c.a.createElement(ye.a,{onClick:l("toggleAudio")},a.isPlaying?c.a.createElement(G.a,null):c.a.createElement(H.a,null)),c.a.createElement(ye.a,{onClick:l("toggleControlPanel")},"hide controls")))))},xe=function(){return c.a.createElement(g,{fretCount:20,fretMarkers:[0,3,5,7,10,12,15],tuning:[7,2,9,4]})},Oe={mediaStream:void 0},Ie=Object(ie.a)(c.a,Oe,{setMediaStream:function(e,t){return e.setState({mediaStream:t})}}),je=n(185),De=n(186),ze=n(187),Te=function(){var e=Ie(function(e){return{mediaStream:e.mediaStream}},function(e){return e}),t=Object(a.a)(e,2),n=t[0],i=t[1],r=!!n.mediaStream;return c.a.createElement(c.a.Fragment,null,c.a.createElement(je.a,{edge:"start",color:"inherit",onClick:r?function(){n.mediaStream.getTracks().forEach(function(e){return e.stop()}),i.setMediaStream(void 0)}:function(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(e){i.setMediaStream(e)})}},r?c.a.createElement(De.a,null):c.a.createElement(ze.a,null)))},Pe=n(197),Ne=n(199),Re=n(82),Ae=n.n(Re),Le=n(188),Fe=function(){var e=ce(function(e){return{inputDevices:e.inputDevices,isMidiClockInSelectorOpen:e.isMidiClockInSelectorOpen,isMidiInSelectorOpen:e.isMidiInSelectorOpen,midiInDevice:e.midiInDevice}},function(e){return e}),t=Object(a.a)(e,2),n=t[0],i=t[1],l=n.inputDevices,u=n.isMidiClockInSelectorOpen,s=n.isMidiInSelectorOpen,d=n.midiInDevice;Object(o.useEffect)(function(){Ae.a.enable(function(e){e?console.error(e):(console.log("WebMidi enabled."),i.setInputDevices(Ae.a.inputs))},!0)},[]);var m=function(e){e.note.number,e.rawVelocity,e.type},f=function(e){},p=c.a.useState(null),h=Object(a.a)(p,2),v=h[0],g=h[1],b=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t){var n=t.currentTarget;g(n),i[e?"toggleMidiClockInSelector":"toggleMidiInSelector"]()}},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){var a=n.currentTarget;g(a);var r=l[e];i[t?"toggleMidiClockInSelector":"toggleMidiInSelector"](),t?(r.addListener("clock","all",f),i.setMidiClockInDevice(r)):(i.setMidiInDevice(r),r.addListener("noteon","all",m),r.addListener("noteoff","all",m))}};return c.a.createElement(c.a.Fragment,null,c.a.createElement(je.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:b(!1)},c.a.createElement("img",{src:"noun_MIDI_385872.svg",style:{width:"1.5em",height:"1.5em"}})),c.a.createElement(je.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:b(!0)},c.a.createElement(Le.a,null)),c.a.createElement(Pe.a,{id:"simple-menu",anchorEl:v,open:s||u,onClose:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(){console.log("close",e?"toggleMidiClockInSelector":"toggleMidiInSelector"),i[e?"toggleMidiClockInSelector":"toggleMidiInSelector"](),g(null)}}(u)},l.map(function(e,t){var n=e.name;return c.a.createElement(Ne.a,{key:n,onClick:k(t,u),selected:s&&n===r.a.get(d,"name")},n)})))},Ve={decayDuration:5e3,exciteEnergy:.05,exciteDuration:1e3,fundamentalFreq:200,hilbertN:64,hilbMand:[],isControlPanelOpen:!0,isPlaying:!1,isRegenNeeded:!0,maxIters:4096,midiClock:0,midiClocksPerTick:24,panX:-.05,panY:0,partials:{},partialsCountMax:16,isSmooth:!1,tick:0,tickDuration:100,tickLastMillis:0,zoom:1.2},qe=new AudioContext,_e=qe.createGain();window.masterGain=_e,_e.gain.value=1,_e.connect(qe.destination);var Ke=function(e){e.state=Ve;var t;e.preload=function(){t=e.loadFont("JetBrainsMono-Regular.ttf")};var n,i,r,o,c=2*Math.PI,l=0;o=2,r=1,e.setup=function(){e.createCanvas(e._width,e._height),e.blendMode(e.ADD),e.colorMode(e.HSB,255),e.textFont(t)};var u=[];e.keyTyped=function(){if(console.log(e.key),"Enter"===e.key){var t=u.join("").split(":").map(function(e){return parseInt(e,10)});l=0;var c=Object(a.a)(t,3);if(r=c[0],o=c[1],!(l=c[2])){var s=Object(a.a)(t,2);o=s[0],r=s[1],l=0}console.log(r,o,l),console.log(i,n),u=[]}else u.push(e.key);return!1};var s,d=0,m=0,f=0,p=function(t){var a=t.freq,r=t.phase,o=void 0===r?0:r,l=t.hue,u=c/500;e.push(),e.translate(i/2,n/2);for(var d=0;d<c-u;d+=u)e.stroke(l,255,a&&50+50*Math.sin(d*a),100),m=(s=i+n)*Math.sin(d+o),f=s*Math.cos(d+o),e.line(0,0,m,f);e.pop()};e.draw=function(){e.clear(),e.background(0,0,0),n=e.height,i=e.width,d=e.millis()*(.001/r),p({freq:r,hue:0,phase:d}),p({freq:r*o/r,hue:90,phase:2*d}),p({freq:r*l/o,hue:180,phase:3*d}),e.blendMode(e.BLEND),e.fill(255),e.stroke(0),e.strokeWeight(4),e.textAlign(e.CENTER,e.CENTER),e.textSize(n/15),e.text(l?"".concat(r,":").concat(o,":").concat(l):"".concat(o,":").concat(r),i/2,n/2),e.blendMode(e.ADD)},e.toggleAudio=function(){e.setState(function(e){var t=e.isPlaying;return t||"running"===qe.state||qe.resume(),t&&"running"===qe.state&&qe.suspend(),Object(P.a)({},e,{isPlaying:!e.isPlaying})})}},We=function(){var e=de(Ke,Ve),t=e.ref,n=e.sketchInstance;e.sketchState,e.setSketchState;return window.sketchInstance=n,Object(o.useEffect)(function(){document.title="Ratio Lightship"},[n]),c.a.createElement("div",{ref:t,style:{alignSelf:"start",background:"radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)",height:"100vh",width:"100vw"}})},Be=n(113).a.Flow,Ge=function(){var e=function(){var e=Object(o.useState)(null),t=Object(a.a)(e,2),n=t[0],i=t[1],r=Object(o.useState)(null),c=Object(a.a)(r,2),l=c[0],u=c[1];return{context:n,ref:Object(o.useCallback)(function(e){if(e){var t=new Be.Renderer(e,Be.Renderer.Backends.SVG);t.resize(e.clientWidth,e.clientHeight),i(t.getContext());var n=new ResizeObserver(function(e){var n=Object(a.a)(e,1)[0].contentRect,i=n.height,r=n.width;t.resize(r,i)});u(n),n.observe(e)}else l.disconnect()},[])}}(),t=e.context,n=e.ref;if(t){t.setStrokeStyle("white"),t.setFillStyle("white");var i=new Be.Stave(50,0,1e4).addClef("treble").addKeySignature("Db").addTimeSignature("4/4").setContext(t).draw();window.VF=Be,window.context=t,window.treble=i;var r=new Be.Stave(50,60,1e4).addClef("bass").addTimeSignature("4/4").addKeySignature("Db").setContext(t).draw();new Be.StaveConnector(i,r).setType(Be.StaveConnector.type.BRACE).setContext(t).draw(),new Be.StaveConnector(i,r).setType(Be.StaveConnector.type.SINGLE_LEFT).setContext(t).draw()}return c.a.createElement("div",{style:{display:"block",width:"100%"}},c.a.createElement("div",{ref:n,style:{fill:"white",height:500,stroke:"white"}}))},Ue=[{label:"Diatonic Scale",val:[0,2,4,5,7,9,11]},{label:"Major Triad",val:[0,4,7]},{label:"Major 7",val:[0,4,7,10]},{label:"Minor Triad",val:[0,3,7]},{label:"Minor 7",val:[0,3,7,10]},{label:"Diminished Triad",val:[0,3,6]},{label:"Diminished 7",val:[0,4,7]},{label:"Augmented Triad",val:[0,4,8]}],He=[2,5,8,11,14,17,20,23,26,28,26,23,20,17,14,11,8,5,2],Xe=[0,0,0,0,0,0,0,0,0,1,4,7,10,13,16,19,22,25,28],Ye=[{label:"Wicki-Hayden",val:function(e,t){return t%2!==1?2*e%12:(2*e+7)%12}},{label:"Harmonic table",val:function(e,t){return((t%2>0?(t-1)/2*11+3:t/2*11)+7*e)%12}}],Je=function(e){var t=e.rows,n=void 0===t?He:t,i=Object(o.useState)(0),l=Object(a.a)(i,2),s=l[0],d=l[1],f=Ye[s].val,p=Object(o.useState)(0),h=Object(a.a)(p,2),v=h[0],g=h[1],b=Ue[v].val;return c.a.createElement("div",{style:{display:"block",flexShrink:0}},c.a.createElement("select",{value:s,onChange:function(e){return d(parseInt(e.target.value,10))}},Ye.map(function(e,t){var n=e.label;return c.a.createElement("option",{key:t,value:t},n)})),c.a.createElement("select",{value:v,onChange:function(e){return g(parseInt(e.target.value,10))}},Ue.map(function(e,t){var n=e.label;return c.a.createElement("option",{key:t,value:t},n)})),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("br",null),r.a.range(n.length).map(function(e){return c.a.createElement(c.a.Fragment,null,r.a.range(n[e]+Xe[e]).map(function(t){var n=e%2===1,a=f(t,e),i=r.a.includes(b,a);return Xe[e]>t?c.a.createElement(u,{key:t,isOdd:n},"\xa0"):c.a.createElement(m,{key:t,n:a,isOdd:n,style:{border:"solid ".concat(i?2:1,"px"),borderRadius:"50%",color:me(5*a%12/12,1,i?1:.4)}})}),c.a.createElement("br",null))}))},Ze=function(){return c.a.createElement(g,{fretCount:18,fretMarkers:[0,5,7,10,12],tuning:[7,4,0,9]})},Qe=n(189),$e=(n(136),n(18)),et=function(){return c.a.createElement($e.Entity,{primitive:"a-camera",id:"camera",position:{x:0,y:0,z:0},"look-controls":!0,"wasd-controls":{acceleration:25}})},tt=function(e){return function(t){if(t){var n=t.components.osc;n.onOsc=function(t){t.instrument;var a=t.note,i=t.vel;a===e&&(n.vel=i)},n.onTick=function(e,a){n.vel,r.a.has(n,"vel")&&t.setAttribute("material","opacity",.05+.75*n.vel/128)}}}},nt=function(e){var t=e.darkened,n=void 0===t||t,a=e.n,i=e.position,r=void 0===i?{x:0,y:0,z:0}:i,o=e.scale,l=void 0===o?{x:1,y:1,z:1}:o;return c.a.createElement($e.Entity,{_ref:tt(a),material:{blending:n?"normal":"additive",color:me(a/12,.7,n?0:1),opacity:n?.5:.1},osc:{},position:r,primitive:"a-torus",radius:.1,"radius-tubular":.003,scale:l},c.a.createElement($e.Entity,{"look-at":"#camera",position:{x:0,y:0,z:0},scale:{x:2,y:2,z:2},text:{align:"center",color:me(a/12,.75,.5),font:"../JetBrainsMono-Regular-msdf.json",negate:!1,transparent:!0,value:d(a)}}))},at=function(){var e=Object(o.useState)(!0),t=Object(a.a)(e,2),n=t[0],i=t[1];Object(o.useEffect)(function(){var e=function(e){"r"===e.key&&i(function(e){return!e})};return window.addEventListener("keyup",e),function(){return window.removeEventListener("keyup",e)}},[]);var l=ce(),u=Object(a.a)(l,1)[0].midiIn,s=r()(12).range().map(function(e){return r()(u).pickBy(function(t,n){return n%12===e}).values().sum()}).value();return c.a.createElement($e.Entity,{animation:"property: rotation; to: 0 ".concat(n?180:0," 0; dur: 500;"),position:"0 0 -3"},r()(12).range().filter(function(e){return e%2==0}).map(function(e){return{n:e,r:1.5,x:-Math.sin(e*Math.PI/6),y:Math.cos(e*Math.PI/6)}}).map(function(e){var t=e.n,n=e.r,a=e.x,i=e.y;return c.a.createElement(nt,{midiIn:s[t],n:t,position:"".concat(n*a," ").concat(n*i," 0")})}).value(),r()(48).range().filter(function(e){return!r.a.includes([6,7,0,1],e%8)}).map(function(e,t){return{i:t,n:(2*(t+1)+2*Math.floor(t/4))%12,r:1.5,x:Math.sin((e+.5)*Math.PI/24),y:Math.cos((e+.5)*Math.PI/24)}}).map(function(e){var t=e.n,n=e.r,a=e.x,i=e.y;return c.a.createElement(nt,{midiIn:s[t],n:t,position:"".concat(n*a," ").concat(n*i," 0"),scale:"0.5 0.5 0.5"})}).value(),r()(12).range().filter(function(e){return e%2!=0}).map(function(e){return{n:(e+6)%12,r:1.2,x:-Math.sin(e*Math.PI/6),y:Math.cos(e*Math.PI/6)}}).map(function(e){var t=e.n,n=e.r,a=e.x,i=e.y;return c.a.createElement(nt,{midiIn:s[t],n:t,position:"".concat(n*a," ").concat(n*i," 0")})}).value(),r()(48).range().filter(function(e){return!r.a.includes([4,5,6,7],e%8)}).map(function(e,t){return{i:t,n:(2*t+9+2*Math.floor(t/4))%12,r:1.2,x:Math.sin((e-1.5)*Math.PI/24),y:Math.cos((e-1.5)*Math.PI/24)}}).map(function(e){var t=e.n,n=e.r,a=e.x,i=e.y;return c.a.createElement(nt,{midiIn:s[t],n:t,position:"".concat(n*a," ").concat(n*i," 0"),scale:"0.5 0.5 0.5"})}).value())},it=1.3305869973355013,rt=2.152934986677507,ot=[[0,-rt,it],[0,rt,-it],[rt,-it,0],[-rt,it,0],[0,-rt,-it],[0,rt,it],[-rt,-it,0],[rt,it,0],[-it,0,rt],[it,0,-rt],[it,0,rt],[-it,0,-rt]],ct=function e(t){var n=t.rep,a=void 0===n?1:n,i=t.sat,r=t.stack,o=void 0===r?[]:r,l=t.n,u=void 0===l?0:l;return c.a.createElement($e.Entity,{position:"0 0 0"},ot.map(function(e,t){return c.a.createElement($e.Entity,{key:t,color:me(t*(1/12),i||1,1),events:{click:function(){return console.log(t)}},primitive:"a-sphere",position:e.join(" "),scale:[1,1,1].map(function(e){return.3*e/(a*a)}).join(" ")})}),a<3&&ot.map(function(t,n){return c.a.createElement($e.Entity,{key:n,position:t.map(function(e){return 2*e}).join(" "),text:"color: ".concat(me((o.length?o[o.length-1]:n)*(1/12),1,1),"; align: center; value: ").concat([].concat(Object(v.a)(o),[n]).join(",")," - ").concat((u+n)%12,"; width: 5; zOffset: 0")},c.a.createElement(e,{rep:a+1,sat:.3,stack:[].concat(Object(v.a)(o),[n]),n:(u+n)%12}))}))},lt=n(110),ut=n(79),st=n.n(ut),dt=function(e){Object(lt.a)(e);var t=Object(o.useState)(),n=Object(a.a)(t,2),i=n[0],l=n[1],u=Object(o.useCallback)(l,[]),s=le(function(e){var t=e.tick;t%24===0&&console.log(t),i&&i.object3D.position.set(0,0,t/96*.75)}).reset;window.reset=s,Object(o.useEffect)(function(){var e=function(e){e.code,e.key};return window.addEventListener("keyup",e),function(){return window.removeEventListener("keyup",e)}},[]);var d=[[2,5,9],[7,11,2],[0,4,7]];return c.a.createElement($e.Entity,{_ref:u,position:{x:0,y:0,z:-2},scale:{x:4,y:4,z:4}},r.a.range(50).map(function(e){return 50-e}).map(function(e){return{coll:d[e%d.length],z:-.75*e}}).map(function(e){var t=e.coll,n=e.z;return c.a.createElement(c.a.Fragment,{key:n},c.a.createElement($e.Entity,{material:{color:"#040404",opacity:.45},position:{x:0,y:0,z:n-.01},rotation:{x:90,y:0,z:0},primitive:"a-cylinder",scale:{x:1,y:.001,z:1}}),r.a.range(12).map(function(e){var t=e*(2*Math.PI)/12;return{n:e,x:.25*Math.sin(t),y:.25*Math.cos(t)}}).map(function(e){var a=e.n,i=e.s,o=void 0===i?.5:i,l=e.x,u=e.y;return c.a.createElement(nt,{darkened:!r.a.includes(t,a),key:a,n:a,position:{x:l,y:u,z:n},scale:{x:o,y:o,z:o}})}))}))},mt=function(e){var t=e.noteToDimensions,n=Object(o.useState)(),i=Object(a.a)(n,2),l=i[0],u=i[1],s=ce(),d=Object(a.a)(s,1)[0].midiInDevice,m=function(e){var t=Object(o.useRef)();return Object(o.useEffect)(function(){t.current=e}),t.current}(d);Object(o.useEffect)(function(){var e=function(e){var n=e.note.number,a=e.velocity,i=e.type,r=a/(.1+a),o=t(n),c=o.s,u=o.x,s=o.y,d=o.z;l.setAttribute("material","opacity",r),"noteon"===i&&(l.note=n,l.object3D.position.set(u,s,d+.01),l.object3D.scale.set(1.1*c,1.1*c,1.1*c),l.setAttribute("material","color",me(n/12,.75,.5)))};return l&&d&&(console.log("new midiInDevice: ",r.a.get(d,"name"),"prev: ",r.a.get(m,"name")),d.addListener("noteon","all",e),d.addListener("noteoff","all",e),d.addListener("controlchange","all",function(e){var t=e.controller.number,n=e.value;if(2===t){var a=n/128,i=a/(.1+a);l.setAttribute("material","opacity",i)}}),d.addListener("pitchbend","all",function(e){var n=e.value,a=l.note||0,i=t(a+2*n),r=i.s,o=i.x,c=i.y,u=i.z;l.object3D.position.set(o,c,u+.01),l.object3D.scale.set(1.1*r,1.1*r,1.1*r)})),function(){d&&(console.log("removing listeners for",r.a.get(d,"name")),d.removeListener("noteon"),d.removeListener("noteoff"),d.removeListener("controlchange"),d.removeListener("pitchbend"))}},[l,d,t,m]);var f=Object(o.useCallback)(u,[]);return c.a.createElement($e.Entity,{_ref:f,primitive:"a-sphere",material:{blending:"additive",color:me(1,0,1),opacity:0,transparent:!0},radius:.07})},ft=new AudioContext;window.audioContext=ft;var pt=function(e){var t=e.depthMax,n=void 0===t?1:t,i=e.isAlwaysCounterClockwise,l=void 0!==i&&i,u=e.rMax,s=void 0===u?.75:u,d=e.rMin,m=void 0===d?0:d,f=e.noteRange,p=void 0===f?[34,99]:f,h=e.pcsHighlighted,v=void 0===h?[0,2,4,5,7,9,11]:h,g=Object(o.useState)(!0),b=Object(a.a)(g,2),k=b[0],y=b[1],E=Object(o.useState)(),w=Object(a.a)(E,2),M=w[0],S=w[1],C=Object(o.useState)(),x=Object(a.a)(C,2),O=x[0],I=x[1],j=function(e){var t=e/128,a=(k?1:1.5)*s-((k?1:1.5)*s-m)*t;return{n:e,s:.75-e/192,x:a*(k&&l?-1:1)*Math.sin(e*Math.PI/6+.01),y:a*Math.cos(e*Math.PI/6+.01),z:k?n-n*t:n*t}};Object(o.useEffect)(function(){var e=function(e){var t=e.code;"r"===e.key&&y(function(e){return!e}),"Space"===t&&ft.resume()};return window.addEventListener("keyup",e),function(){return window.removeEventListener("keyup",e)}},[]),Object(o.useEffect)(function(){console.log("el",O,"detector",M),ft&&!M&&O?S(new st.a({context:ft,interpolateFrequency:!0,onDebug:function(e,t){var n=e.frequency,a=e.detected,i=e.rms,o=i/(.1+i),c=function(e){return 69+12*Math.log2(e/440)}(n),l=j(c),u=l.s,s=l.x,d=l.y,m=l.z;O.setAttribute("material","opacity",a?o:0),O.object3D.position.set(s,d,m+.01),O.object3D.scale.set(u,u,u),r.a.isFinite(c)&&O.setAttribute("material","color",me(c/12,.5,1))},minCorrelationIncrease:.5,normalize:"rms",stopAfterDetection:!1,length:1024,minNote:32,maxNote:128,minPeriod:2,maxPeriod:512,start:!0})):M&&!O&&(M.stop(),M.destroy())},[ft,M,k,O]);var D=Object(o.useCallback)(I,[]);return c.a.createElement($e.Entity,{events:{click:function(){ft.resume()}},position:{x:0,y:0,z:-6},scale:{x:4,y:4,z:4}},r.a.range(p[0],p[1]+1).map(j).map(function(e){var t=e.n,n=e.s,a=e.x,i=e.y,o=e.z;return c.a.createElement(c.a.Fragment,{key:t},c.a.createElement($e.Entity,{line:{color:"black",opacity:.3,start:r.a.pick(j(t+.25),["x","y","z"]),end:r.a.pick(j(t+.75),["x","y","z"]),visible:t<p[1]}}),c.a.createElement(nt,{darkened:!r.a.includes(v,t%12),n:t,position:{x:a,y:i,z:o},scale:{x:n,y:n,z:n}}))}),c.a.createElement(mt,{noteToDimensions:j}),c.a.createElement($e.Entity,{_ref:D,primitive:"a-sphere",material:{blending:"additive",color:me(1,0,1),opacity:0,transparent:!0},radius:.1}))},ht=n(43),vt=function(e){var t=e.match.path;return c.a.createElement($e.Scene,null,c.a.createElement("a-assets",null),c.a.createElement(ht.c,null,c.a.createElement(ht.a,{path:"".concat(t,"/coltrane"),component:at}),c.a.createElement(ht.a,{path:"".concat(t,"/dod"),component:ct}),c.a.createElement(ht.a,{path:"".concat(t,"/pitchClassCollections"),component:dt}),c.a.createElement(ht.a,{path:"".concat(t,"/pitchClassSpiral"),component:pt})),c.a.createElement(et,null),c.a.createElement($e.Entity,{id:"leftHand","oculus-touch-controls":"hand: left"}),c.a.createElement($e.Entity,{id:"rightHand","oculus-touch-controls":"hand: right"}))},gt=n(192),bt=n(193),kt=n(57),yt=n(114),Et=n(190),wt=n(194),Mt=n(195),St=function e(t){return t>2?e(t/2):t<1?e(2*t):t};window.intToRation=function(e){return Object(Mt.a)(St(e))};!function e(){if("undefined"!==typeof AFRAME){var t={host:window.location.hostname,port:"8080",secure:!0},n=new j.a({plugin:new j.a.WebsocketClientPlugin(t)});n.open(),window.osc=n,window.AFRAME.registerComponent("midi",{init:function(){var e=this;this._onOscId=n.on("/midi/*",function(t){var n=t.address,i=Object(a.a)(t.args,2),o=i[0],c=i[1],l=r.a.last(n.split("/"));e.onOsc&&e.onOsc({instrument:l,note:o,vel:c})})},tick:function(e,t){this.onTick&&this.onTick(e,t)},remove:function(){n.off("/midi/*",this._onOscId)}}),window.AFRAME.registerComponent("osc",{init:function(){var e=this;this._onOscId=n.on("/midi/*",function(t){var n=t.address,i=Object(a.a)(t.args,2),o=i[0],c=i[1],l=r.a.last(n.split("/"));e.onOsc&&e.onOsc({instrument:l,note:o,vel:c})})},tick:function(e,t){this.onTick&&this.onTick(e,t)},remove:function(){n.off("/midi/*",this._onOscId)}})}else setTimeout(e,100)}();var Ct=[["Mod12 Multiplication Tables","/multTableMod12",E],["PC-Number Notepad","/numpadMod12",O],["OSC Dataviz","/osc",j.a,!0],["PC Tonnetz","/tonnetz",Je],["Banjo PCs","/banjo",p],["Guitar PCs","/guitar",k],["Mandolin PCs","/mandolin",xe],["Ukulele PCs","/ukulele",Ze],["Staff","/staff",Ge],["Mandelbrot","/mandelbrot",Ce],["Ratio Lightship","/ratioLightship",We]];z.a.render(c.a.createElement(function(){var e=Object(Qe.a)("(prefers-color-scheme: dark)"),t={palette:{action:{active:"#660000"},primary:{main:"#330033"},type:"dark"}},n={palette:{action:{active:"#660000"},primary:{main:"#330033"},type:"light"}},i=c.a.useMemo(function(){return Object(yt.a)(e?t:n)},[e]),r=c.a.useState(null),o=Object(a.a)(r,2),l=o[0],u=o[1],s=function(){return u(null)};return c.a.createElement(Et.a,{theme:i},c.a.createElement(h.a,null),c.a.createElement(kt.a,{basename:"/aframe-musicality"},c.a.createElement(ht.a,{path:"/",exact:!0,component:y}),c.a.createElement(ht.a,{path:"/vr",component:vt}),Ct.map(function(e,t){var n=Object(a.a)(e,3),i=(n[0],n[1]),r=n[2];return c.a.createElement(ht.a,{component:r,key:t,path:i})}),c.a.createElement(gt.a,{color:"transparent",onClick:function(){},position:"fixed",style:{top:"auto",bottom:0}},c.a.createElement(bt.a,null,c.a.createElement(je.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:function(e){var t=e.currentTarget;return u(t)}},c.a.createElement(wt.a,null)),c.a.createElement(Pe.a,{anchorEl:l,open:!!l,onClose:s},c.a.createElement(Ne.a,null,c.a.createElement(kt.b,{style:{color:"lightgrey"},onClick:s,to:"/"},"Introduction")),c.a.createElement(Ne.a,{disabled:!0,divider:!0},"2D"),Ct.map(function(e,t){var n=Object(a.a)(e,4),i=n[0],r=n[1];return n[2],!n[3]&&c.a.createElement(Ne.a,{key:t},c.a.createElement(kt.b,{style:{color:"darkmagenta"},onClick:s,to:r},i))}),c.a.createElement(Ne.a,{disabled:!0,divider:!0},"VR"),[["Coltrane Circle","/vr/coltrane"],["Dod","/vr/dod"],["PitchClassCollections","/vr/pitchClassCollections"],["PitchClassSpiral","/vr/pitchClassSpiral"]].map(function(e,t){var n=Object(a.a)(e,2),i=n[0],r=n[1];return c.a.createElement(Ne.a,{key:t},c.a.createElement(kt.b,{style:{color:"cyan"},onClick:s,to:r},i))})),c.a.createElement(Fe,null),c.a.createElement(Te,null)))))},null),document.querySelector("#sceneContainer"))}},[[119,1,2]]]);
//# sourceMappingURL=main.f25fb0dc.chunk.js.map