{"version":3,"sources":["cell.js","fretMarkers.js","util.js","pc.js","banjo.js","frettedInstrument.js","guitar.js","intro.js","multTableMod12.js","numpadMod12.js","useP5.js","useMidi.js","useMidiClock.js","mandelbrotP5.js","mandelbrot.js","mandolin.js","midi.js","ratioLightshipP5.js","ratioLightship.js","staff.js","tonnetz.js","ukulele.js","camera.js","color.js","pitchClass.js","coltraneCircle.js","dod.js","pitchClassCollections.js","pcSpiralWindController.js","usePrevious.js","pitchClassSpiral.js","vr.js","fns.js","index.js"],"names":["Cell","withStyles","root","fontSize","fontFamily","display","height","width","alignItems","justifyContent","odd","left","cellSize","position","_ref","children","classes","_ref$className","className","isOdd","style","react_default","a","createElement","concat","FretMarkers","fretMarker","color","frets","_","range","last","map","f","includes","fret","ix","cell","key","toSymbol","n","10","11","PC","Banjo","flexShrink","src_fretMarkers","pc0","pc0ix","Fragment","i","pc","src_pc","FrettedInstrument","fretCount","fretMarkers","tuning","Object","toConsumableArray","reverse","ixPc0","Guitar","frettedInstrument","overflowY","padding","MultTableMod12","margin","y","x","NumpadMod12","state","text","handleKeyPress","evt","char","Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadDivide","NumpadMultiply","NumpadDecimal","NumpadEnter","Enter","Space","code","preventDefault","_this","setState","handleChange","value","target","window","addEventListener","this","removeEventListener","cols","rows","onChange","background","Component","useP5","sketch","initialState","_useState","useState","_useState2","slicedToArray","sketchState","setSketchState","_useState3","_useState4","sketchInstance","setSketchInstance","_useState5","_useState6","resizeObserver","setResizeObserver","ref","useCallback","el","instance","P5","_height","clientHeight","_width","clientWidth","ro","ResizeObserver","_ref2$0$contentRect","contentRect","resizeCanvas","prevState","objectSpread","isRegenNeeded","observe","disconnect","input","undefined","inputDevices","isMidiClockInSelectorOpen","isMidiInSelectorOpen","midiClockInDevice","midiInDevice","midiIn","zipObject","fill","Array","actions","setInputDevices","store","setMidiEvent","midiEvt","merge","setMidiClockInDevice","setMidiInDevice","toggleMidiInSelector","toggleMidiClockInSelector","globalHook","React","useMidiClock","onClock","_useMidi","useMidi","_useMidi2","tick","useEffect","handleMidiClock","addListener","removeListener","reset","decayDuration","exciteEnergy","exciteDuration","fundamentalFreq","hilbertN","hilbMand","isControlPanelOpen","isPlaying","maxIters","midiClock","midiClocksPerTick","panX","panY","partials","partialsCountMax","isSmooth","tickDuration","tickLastMillis","zoom","audioCtx","AudioContext","oscs","masterGain","createGain","gain","connect","destination","p5","font","hilbGetRotatedVec","v","rx","ry","temp","dot","v1","v2","reduce","acc","val","idx","mandGetValFromNormalizedCoords","xN","yN","maxIterations","_mandGetDenormalizedC","mandGetDenormalizedCoords","cx","cy","z","Math","log2","mandGetValSmooth","scaledX","scaledY","iter","xTemp","mandGetVal","genHilbertCoords","memoize","d","dist","s","hilbDistanceToCoords","getStrokeWeight","w","sideLength","min","getPartialOfOctaveStart","pow","dropWhile","first","getColorForMandelbrotVal","_ref3","m","p","isCursor","arguments","length","_p5$state2","octMax","oct","h","b","setFillColorForMandelbrotVal","coordsWithVal","drawHilbertCoord","hilbertCoord","scaleX","scaleY","rect","drawHilbertMandelbrot","strokeWeight","stroke","getSideLengthForLinearizedMap","forEach","coordWithVal","push","translate","pop","drawLinearizedMandelbrotCoord","dMax","maxA","largestPossibleSide","sqrt","sqPerRow","valsPerRow","floor","genAndDrawHilbertMandelbrot","_ref4","cancelScheduledValues","currentTime","linearRampToValueAtTime","osc","stop","createOscillator","start","_p5$state3","_p5$state","_ref2","genHilbertMandelbrot","_ref5","filter","identity","uniq","sort","take","partial","amp","oscIdx","fromPairs","each","_ref6","decayTimerId","zeroGainTimerId","clearTimeout","frequency","nextState","prevD","cursorDraw","id","coordAndVal","maxD","prevCoordAndVal","cursorErasePrev","partialsDraw","noStroke","_p5$state5","_ref7","targetAmp","barH","barW","c","hue","wasPaused","preload","loadFont","setup","createCanvas","colorMode","HSB","textFont","incrementTick","isExternal","now","millis","_p5$state6","_p5$state4","currGain","isNumber","targetGain","setTimeout","exponentialRampToValueAtTime","cursorExcite","prevTick","draw","_p5$state7","every","noFill","textSize","textAlign","CENTER","toggleAudio","resume","suspend","useStyles","makeStyles","paper","paddingBottom","Slider","stateKey","props","objectWithoutProperties","assign","type","ev","Number","defineProperty","Mandelbrot","_useP","handleAction","action","panDelta","moveLeft","moveRight","moveUp","moveDown","resDec","resInc","toggleControlPanel","zoomIn","zoomOut","isEmpty","getHandleAction","document","title","handler","shiftKey","getAction","ArrowDown","ArrowLeft","ArrowRight","ArrowUp","handleKeyDown","alignSelf","bottom","zIndex","Button","onClick","Tune_default","Drawer","anchor","open","onClose","variant","ButtonGroup","fullWidth","size","PauseCircleOutline_default","PlayCircleOutline_default","KeyboardArrowUpOutlined_default","KeyboardArrowLeftOutlined_default","KeyboardArrowRightOutlined_default","ZoomInOutlined_default","KeyboardArrowDownOutlined_default","ViewModuleOutlined_default","ViewComfyOutlined_default","ZoomOutOutlined_default","mandelbrot_Slider","max","step","onPointerUp","console","log","Mandolin","Midi","WebMidi","enable","err","error","inputs","handleMidi","note","number","rawVelocity","_React$useState","_React$useState2","midiMenuAnchorEl","setMidiMenuAnchorEl","handleMidiMenuButtonClick","isBeatClock","currentTarget","handleMidiInputSelect","deviceIdx","IconButton","edge","aria-label","src","WatchLater","Menu","anchorEl","handleMidiMenuClose","name","MenuItem","selected","get","TWO_PI","PI","n2","blendMode","ADD","keyTyped","obj","join","split","parseInt","_obj","_obj2","r","phase","x1","y1","drawWave","freq","_ref2$phase","dt","t","sin","cos","line","clear","BLEND","RatioLightship","VF","Vex","Flow","Staff","_useVexFlow","context","setContext","renderer","Renderer","Backends","SVG","resize","getContext","useVexFlow","setStrokeStyle","setFillStyle","treble","Stave","addClef","addKeySignature","addTimeSignature","bass","StaveConnector","setType","BRACE","SINGLE_LEFT","Tonnetz","Ukulele","Camera","primitive","look-controls","wasd-controls","acceleration","HSVtoHex","g","q","componentToHex","hex","toString","rgbToHex","round","handleOsc","components","onOsc","instrument","vel","onTick","time","timeDelta","has","setAttribute","pitchClass","_ref2$darkened","darkened","_ref2$position","_ref2$scale","scale","material","blending","opacity","radius","radius-tubular","look-at","align","negate","transparent","ColtraneCircle","is180","setIs180","toggle","midiInPitchClasses","pickBy","values","sum","animation","c1","c2","verts","Dod","_ref$rep","rep","sat","_ref$stack","stack","_ref$n","events","click","PitchClassCollections","objectDestructuringEmpty","collEl","setCollEl","collRef","object3D","set","handleKeyup","colls","coll","rotation","theta","_ref5$s","PcSpiralWindController","noteToDimensions","midiInEl","setMidiInEl","prevMidiInDevice","useRef","current","usePrevious","velocity","_noteToDimensions","controller","_noteToDimensions2","midiInRef","audioContext","PitchClassSpiral","_ref$depthMax","depthMax","_ref$isAlwaysCounterC","isAlwaysCounterClockwise","_ref$rMax","rMax","_ref$rMin","rMin","_ref$noteRange","noteRange","_ref$pcsHighlighted","pcsHighlighted","detector","setDetector","pitchDetectEl","setPitchDetectEl","PitchDetector","interpolateFrequency","onDebug","stats","pitchDetector","detected","rms","ftomf","isFinite","minCorrelationIncrease","normalize","stopAfterDetection","minNote","maxNote","minPeriod","maxPeriod","destroy","pitchDetectRef","pick","end","visible","pcSpiralWindController","VR","path","match","react_router","component","camera","oculus-touch-controls","toOctave","intToRation","fraction","doWhenAframeLoaded","AFRAME","oscHost","host","location","hostname","port","secure","OSC","plugin","WebsocketClientPlugin","registerComponent","init","_onOscId","on","address","_ref$args","args","remove","off","_this2","_ref2$args","routes2d","ReactDOM","render","theme","useMemo","createMuiTheme","palette","active","primary","main","menuAnchorEl","setMenuAnchorEl","handleMenuClose","ThemeProvider","CssBaseline","react_router_dom","basename","process","exact","Intro","AppBar","top","Toolbar","esm_Menu","to","disabled","divider","url","_ref8","_ref9","midi","MicOffOutlined","MicOutlined","querySelector"],"mappings":"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","file":"static/js/main.b8a454b7.chunk.js","sourcesContent":["import React from \"react\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst cellSize = 30;\r\n\r\nconst Cell = withStyles({\r\n  root: {\r\n    fontSize: 20,\r\n    fontFamily: 'jetBrainsMono',\r\n    display: 'inline-flex',\r\n    height: cellSize,\r\n    width: cellSize,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    // border: '1px solid',\r\n  },\r\n  odd: {\r\n    left: cellSize / 2,\r\n    position: 'relative',\r\n  }\r\n})(({children, classes, className = '', isOdd, style}) => (\r\n  <div\r\n    className={`${classes.root} ${className} ${isOdd ? classes.odd : ''}`}\r\n    style={style}>\r\n    {children}\r\n  </div>\r\n));\r\n\r\nexport default Cell;\r\n","import _ from 'lodash';\r\nimport Cell from \"./cell\";\r\nimport React from \"react\";\r\nimport {withStyles} from \"@material-ui/core/styles\";\r\n\r\nconst FretMarkers = withStyles({\r\n  fretMarker: {color: 'purple'}\r\n})(\r\n  ({classes: {fretMarker}, frets}) => _.range(_.last(frets) + 1)\r\n    .map(f => _.includes(frets, f) ? f : '')\r\n    .map((fret, ix) => <Cell className={fretMarker} key={ix}>{fret}</Cell>));\r\n\r\nexport default FretMarkers;\r\n","export const toSymbol = n => ({\r\n  10: '',\r\n  11: '',\r\n})[n % 12] || n % 12;\r\n\r\n// ripped from Tone/core/Conversions\r\nexport const ftomf = (frequency) => {\r\n  return 69 + 12 * Math.log2(frequency / 440);\r\n}\r\n","import Cell from './cell';\r\nimport React from \"react\";\r\nimport {toSymbol} from \"./util\";\r\n\r\nconst PC = ({classes, n, isOdd, style}) => (\r\n  <Cell\r\n    isOdd={isOdd}\r\n    style={style}\r\n  >\r\n    {toSymbol(n)}\r\n  </Cell>\r\n)\r\n\r\nexport default PC;\r\n","import _ from 'lodash';\r\nimport Cell from './cell';\r\nimport FretMarkers from \"./fretMarkers\";\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\nconst frets = [1,3,5,7,10,12,15,17,19];\r\n\r\nconst Banjo = () => (\r\n  <div style={{\r\n    display: 'block',\r\n    flexShrink: 0,\r\n  }}>\r\n    <FretMarkers frets={frets} />\r\n    <br/>\r\n    {[0, 9, 5, 0, 0].map((pc0, pc0ix) => (\r\n      <React.Fragment key={pc0ix}>\r\n        {_.range(23)\r\n          .map(i => (i + pc0) % 12)\r\n          .map((pc, ix) =>\r\n            pc0ix === 4 && ix < 5\r\n              ? <Cell key={ix}/>\r\n              : <PC key={ix} n={pc}/>\r\n          )}\r\n        <br/>\r\n      </React.Fragment>\r\n    ))}\r\n    <FretMarkers frets={frets} />\r\n  </div>\r\n);\r\n\r\nexport default Banjo;\r\n","import _ from 'lodash';\r\nimport FretMarkers from \"./fretMarkers\";\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\n\r\nconst FrettedInstrument = ({ fretCount, fretMarkers, tuning }) => (\r\n  <div style={{\r\n    display: 'block',\r\n    flexShrink: 0,\r\n  }}>\r\n    <FretMarkers frets={fretMarkers}/>\r\n    <br/>\r\n    {[...tuning]\r\n      .reverse() //mutates\r\n      .map((pc0, ixPc0) => (\r\n      <React.Fragment key={ixPc0}>\r\n        {_.range(fretCount + 1 /*for zeroth*/)\r\n          .map(i => (i + pc0) % 12)\r\n          .map((pc, ix) => (\r\n            <PC key={ix} n={pc}/>\r\n          ))}\r\n        <br/>\r\n      </React.Fragment>\r\n    ))}\r\n    <FretMarkers frets={fretMarkers}/>\r\n  </div>\r\n);\r\n\r\nexport default FrettedInstrument;\r\n","import React from 'react';\r\nimport FrettedInstrument from './frettedInstrument';\r\n\r\nconst tunings = {\r\n  standard: [4, 9, 2, 7, 11, 4],\r\n  chelseaSessionsTuning: [0, 5, 0, 5, 9, 5],\r\n  octoberSongTuning: [0, 7, 0, 4, 7, 0],\r\n};\r\n\r\nconst tuning = tunings['standard'];\r\n\r\nconst Guitar = () => (\r\n  <FrettedInstrument\r\n    fretCount={24}\r\n    fretMarkers={[0, 5, 7, 12, 15, 17, 19, 24]}\r\n    tuning={tuning}\r\n  />\r\n)\r\n\r\nexport default Guitar;\r\n","import _ from 'lodash';\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\nconst Banjo = () => (\r\n  <div style={{height: '100%', overflowY: 'auto', padding: '20% 10%'}}>\r\n    <h1>What is this nonsense all about?</h1>\r\n\r\n    <p>\r\n      When I learned how to play an instrument, we started with \"Hot Cross Buns\", \"Mary Had a Little Lamb\", etc.\r\n      We started with the first 3 notes in the key of \"C\". Eventually, we'd build up to the other 4 notes. Then a new\r\n      key was introduced. This one has a \"Bb\" -- the key of \"F\". At some point we'd be introduced to an \"accidental\".\r\n    </p>\r\n\r\n    <p>\r\n      This left a lasting impression that the notes C, D, E, F, G, A, and B were the main notes. And these other things\r\n      were in another class. They were harder -- harder to think about, harder to play, harder to keep track of, harder\r\n      to say. C, D, E, F, G, A, and B are all single syllables. The other 5 notes were thought of as modifications of\r\n      these main notes. \"B flat\", \"C sharp\", \"D flat\", yada yada. Wait are there 5 or are there 10?\r\n    </p>\r\n\r\n    <p>\r\n      \"B sharp\" is one of the first little musical jokes you get to say when you're in the know, until you learn that\r\n      when you really get in deep, actually \"B sharp\" <i>is</i> a real note. There's even a \"B double sharp\"! How many\r\n      notes <i>are</i> there!? Answer: infinite, as there are infinite numbers between 0 and 1, there are infinite\r\n      pitches. Another answer, and this is the one we'll focus on in this website, is 12. There are 12 pitch-classes in\r\n      the musical system that westerners refer to as \"music theory\" and more formally 12-tone equal temperament. All the\r\n      fancy names like \"B flat\" and \"F sharp\" are just various spellings of the 12 pitch-classes in 12-TET.\r\n    </p>\r\n\r\n    <p>\r\n      This is all kind of interesting for a while and makes a young musician wonder about how deep this labyrinth gets.\r\n      But it's all a smoke screen. And it gets even worse when you start to learn about intervals. Honestly, what's the\r\n      use of a \"diminished second\" if not to sound pedantic and \"technically correct\"?\r\n    </p>\r\n\r\n    <p>\r\n      While I'll concede that it sort of makes sense when you're talking about notes <i>written on a staff</i>,\r\n      I'll maintain that it's a bullshit system to think in and it's needlessly convoluted, scares off all but the\r\n      masochistic academics and overachievers. It adds a layer of cognitive as well as verbal overhead to otherwise\r\n      simple concepts, and all so that we can pretend that music all fits into this diatonic model, with a few outliers\r\n      that we call \"accidentals\". It makes the white keys approachable and the black keys scary and hard to name. \"Is\r\n      it a C# or a Db\"? Why do we care, when we really just want to think about the one pitch we're trying to finger?\r\n    </p>\r\n\r\n    <p>\r\n      If we're going to commit to this arguably artificial model of 12 notes, which is but one of a panoply of more\r\n      naturally harmonious tunings, if we're going to compromise with this 12-TET model so that we end up with 12\r\n      equally spaced notes around the octave, let's go all in and treat it with the simple terms it asks for. Let's\r\n      treat these 12 notes equally instead of imagining this additional layer of complexity on top of them.\r\n    </p>\r\n\r\n    <br/>\r\n    <hr/>\r\n\r\n    <h2>Please consider:</h2>\r\n    <pre>{_.range(12).map(pc => <PC key={pc} n={pc}/>)}</pre>\r\n    <p> That's \"oh\" \"one\" \"two\" \"three\" \"four\" \"five\" \"six\" \"sev\" \"eight\" \"nine\" \"ten\" \"el\".</p>\r\n\r\n\r\n\r\n  </div>\r\n);\r\n\r\nexport default Banjo;\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport { toSymbol } from \"./util\";\r\nimport PC from \"./pc\";\r\n\r\nconst MultTableMod12 = () => (\r\n  <>\r\n    {_.range(6).map(n => (\r\n      <div style={{\r\n        display: 'block',\r\n        flexShrink: 0,\r\n        margin: '1em',\r\n      }}>\r\n        {_.range(13).map(y => (\r\n          <>\r\n            {_.range(13).map(x => (\r\n              <PC key={x} n={n + x * y} />\r\n            ))}\r\n            <br />\r\n          </>\r\n        ))}\r\n\r\n      </div>\r\n    ))}\r\n  </>);\r\n\r\nexport default MultTableMod12;\r\n","import _ from 'lodash';\r\nimport React, { Component } from 'react';\r\nimport { toSymbol } from \"./util\";\r\n\r\nclass NumpadMod12 extends Component {\r\n  state = {\r\n    text: '',\r\n  };\r\n\r\n  componentDidMount() {\r\n    window.addEventListener('keypress', this.handleKeyPress);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('keypress', this.handleKeyPress);\r\n  }\r\n\r\n  handleKeyPress = (evt) => {\r\n    // console.log(evt.code)\r\n    const char = {\r\n      Backquote: '0',\r\n      Digit1: '1',\r\n      Digit2: '2',\r\n      Digit3: '3',\r\n      Digit4: '4',\r\n      Digit5: '5',\r\n      Digit6: '6',\r\n      Digit7: '7',\r\n      Digit8: '8',\r\n      Digit9: '9',\r\n      Digit0: '',\r\n      Minus: '',\r\n      Equal: '0',\r\n      Numpad0: '0',\r\n      Numpad1: '1',\r\n      Numpad2: '2',\r\n      Numpad3: '3',\r\n      Numpad4: '4',\r\n      Numpad5: '5',\r\n      Numpad6: '6',\r\n      Numpad7: '7',\r\n      Numpad8: '8',\r\n      Numpad9: '9',\r\n      NumpadDivide: '',\r\n      NumpadMultiply: '',\r\n      NumpadDecimal: ' ',\r\n      NumpadEnter: '\\n',\r\n      Enter: '\\n',\r\n      Space: ' ',\r\n    }[evt.code];\r\n\r\n    if (char) {\r\n      evt.preventDefault();\r\n      this.setState({ text: this.state.text + char });\r\n    }\r\n  };\r\n\r\n  handleChange = ({ target: { value }}) => this.setState({ text: value });\r\n\r\n  render() {\r\n    return <div>\r\n      <h3>Use the numpad to enter pitch classes</h3>\r\n      <textarea\r\n        cols={24}\r\n        rows={20}\r\n        onChange={this.handleChange}\r\n        style={{\r\n          background: 'black',\r\n          color: 'darkgray',\r\n          fontSize: 20,\r\n        }}\r\n        value={this.state.text}\r\n      />\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default NumpadMod12;\r\n","import P5 from 'p5';\r\nimport {useCallback, useState} from \"react\";\r\n\r\nexport default (sketch, initialState) => {\r\n  const [sketchState, setSketchState] = useState(initialState);\r\n  const [sketchInstance, setSketchInstance] = useState(null);\r\n  const [resizeObserver, setResizeObserver] = useState(null);\r\n\r\n  if (sketchInstance) {\r\n    sketchInstance.setState = setSketchState;\r\n    sketchInstance.state = sketchState;\r\n  }\r\n\r\n  const ref = useCallback((el) => {\r\n    if (el) {\r\n      const instance = new P5(sketch, el);\r\n      setSketchInstance(instance);\r\n\r\n      instance._height = el.clientHeight;\r\n      instance._width = el.clientWidth;\r\n\r\n      const ro = new ResizeObserver(([{contentRect: {height, width}}]) => {\r\n        instance.resizeCanvas(width, height);\r\n        if (width + height > 0) setSketchState((prevState) => ({...prevState, isRegenNeeded: true}));\r\n      });\r\n\r\n      setResizeObserver(ro);\r\n      ro.observe(el);\r\n    } else {\r\n      if (resizeObserver) resizeObserver.disconnect();\r\n    }\r\n  }, []);\r\n\r\n  return {\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n    ref,\r\n  };\r\n};\r\n","import _ from 'lodash';\r\nimport React from 'react';\r\nimport globalHook from 'use-global-hook';\r\n\r\nconst initialState = {\r\n  input: undefined,\r\n  inputDevices: [],\r\n  isMidiClockInSelectorOpen: false,\r\n  isMidiInSelectorOpen: false,\r\n  midiClockInDevice: undefined,\r\n  midiInDevice: undefined,\r\n  midiIn: _.zipObject(\r\n    _.range(128),\r\n    _.fill(new Array(128), 0)),\r\n};\r\n\r\nconst actions = {\r\n  setInputDevices: (store, inputDevices) =>\r\n    store.setState({inputDevices}),\r\n\r\n  setMidiEvent: (store, midiEvt) =>\r\n    store.setState({midiIn: _.merge(store.state.midiIn, midiEvt)}),\r\n\r\n  setMidiClockInDevice: (store, midiClockInDevice) => store.setState({midiClockInDevice}),\r\n\r\n  setMidiInDevice: (store, midiInDevice) => store.setState({midiInDevice}),\r\n\r\n  toggleMidiInSelector: (store) =>\r\n    store.setState({isMidiInSelectorOpen: !store.state.isMidiInSelectorOpen}),\r\n\r\n  // todo: only 1 selector\r\n  toggleMidiClockInSelector: (store) =>\r\n    store.setState({isMidiClockInSelectorOpen: !store.state.isMidiClockInSelectorOpen}),\r\n\r\n\r\n};\r\n\r\nexport default globalHook(React, initialState, actions);\r\n","import useMidi from \"./useMidi\";\r\nimport {useEffect} from \"react\";\r\n\r\nconst useMidiClock = (onClock) => {\r\n  const [{midiClockInDevice}, actions] = useMidi( // https://github.com/andregardi/use-global-hook#avoid-unnecessary-renders\r\n    ({midiClockInDevice}) => ({midiClockInDevice}),\r\n    actions => actions,\r\n  );\r\n\r\n  let tick = 0;\r\n\r\n  useEffect(() => {\r\n\r\n    const handleMidiClock = (evt) => {\r\n      tick++;\r\n      if (onClock) onClock({ tick });\r\n    };\r\n\r\n    if (midiClockInDevice) {\r\n      midiClockInDevice.addListener('clock', 'all', handleMidiClock);\r\n    }\r\n\r\n    return () => {\r\n      if (midiClockInDevice) {\r\n        midiClockInDevice.removeListener('clock', 'all', handleMidiClock);\r\n      }\r\n    }\r\n  }, [midiClockInDevice]);\r\n\r\n  return {\r\n    midiClockInDevice,\r\n    reset: () => {\r\n      tick = 0;\r\n    },\r\n  };\r\n};\r\n\r\nexport default useMidiClock;\r\n","import _ from 'lodash';\r\n\r\n\r\n/* TODO\r\n* high prio\r\n  * fine-tune freq\r\n  * don't require redraw on freq change\r\n  * params bound to urlParams\r\n  * option to auto-choose fundamentalFreq\r\n    based on which partials are present\r\n    to center around 500 - 1000hz\r\n  * MIDI beat clock\r\n  * spiral of any length instead of hilbert\r\n\r\n* med prio\r\n  * for hilbertN of 256 or 512, use the vals to fill an audio buffer and play the ~1 or ~5s of audio\r\n  * utonal partials\r\n\r\n* low prio\r\n  * option to add a second cursor for stereo effects\r\n  * alternate space-filling curves\r\n  * keep cursor in same location when switching resolutions\r\n  * manual cursor\r\n* */\r\n\r\n\r\n\r\nexport const initialState = {\r\n  decayDuration: 5000,\r\n  exciteEnergy: 0.05,\r\n  exciteDuration: 1000,\r\n  fundamentalFreq: 200,\r\n  hilbertN: 64, // hilbertN must be power of 2 in order to be square\r\n  hilbMand: [/*{ x, y, m }*/], // coordinates and associated mandelbrot val in hilbert traversal order\r\n  isControlPanelOpen: true,\r\n  isPlaying: false,\r\n  isRegenNeeded: true,\r\n  maxIters: 4096, // max number of steps to recurse the mandelbrot fn\r\n  midiClock: 0,\r\n  midiClocksPerTick: 24,\r\n  panX: -0.05,\r\n  panY: 0,\r\n  partials: {/* partial: { amp, oscIdx } */}, // the collection is updated in setState but values within are changed in drawLoop directly\r\n  partialsCountMax: 16,\r\n  isSmooth: false, // smooth technique https://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n  tick: 0, // updated in draw() bypasses setState\r\n  tickDuration: 100,\r\n  tickLastMillis: 0, // updated in draw() bypasses setState\r\n  zoom: 1.2,\r\n\r\n  // zoom: 3603.7157567397, panX: 0.18580280974577668, panY: 0.00036930706052212803,\r\n\r\n  // floating point errors here\r\n  // zoom: 279919582741326.66, panX: -0.014853203736137617, panY: 0.13451319076043783,\r\n\r\n  // panX: 0.0011548427778035686,\r\n  // panY: 0.025033026937542575,\r\n  // zoom: 319852972190.0951,\r\n  //\r\n  // panX: -0.18498767183730766,\r\n  // panY: 0.4722205531430409,\r\n  // zoom: 419013953.31772846,\r\n  //\r\n  //\r\n  // decay: 0.000075,\r\n  // exciteEnergy: 0.006,\r\n  // fundamentalFreq: 10,\r\n  // hilbertN: 256,\r\n  // maxIters: 4096,\r\n  // panX: 0.0011503007796323155,\r\n  // panY: 0.025033026938902938,\r\n  // tickDuration: 10,\r\n  // zoom: 836635.9887997985,\r\n  //\r\n  //\r\n  //\r\n  // panX: 0.08871194014553094,\r\n  // panY: -0.12829271146701177,\r\n  // zoom: 19736096.460687958,\r\n\r\n  // ...{zoom: 39422433.84662852, panX: 0.04670942760989286, panY: 0.13656218122372943},\r\n\r\n  // demo for 10 partials\r\n  // ...{zoom: 12371177.464729108, panX: 0.04671008941233588, panY: 0.13656133340058238},\r\n};\r\n\r\nlet audioCtx = new AudioContext();\r\nlet oscs = [];\r\n\r\nconst masterGain = audioCtx.createGain();\r\nwindow.masterGain = masterGain;\r\nmasterGain.gain.value = 1;\r\nmasterGain.connect(audioCtx.destination);\r\n\r\n\r\nexport const sketch = (p5) => {\r\n  p5.state = initialState;\r\n\r\n  /* Border size and color */\r\n  const CURSOR_STROKE_COLOR_SEPARATION = 20;\r\n  const CURSOR_ALPHA = 0.7;\r\n  const STROKE_WEIGHT_COEF = 1;\r\n  const STROKE_COLOR = 0;\r\n\r\n  const setupOscillators = () => {\r\n    oscs.forEach(({osc, gain}) =>\r\n    {\r\n      osc.stop();\r\n    }); // TODO: gain.disconnect?\r\n\r\n    oscs = _.range(p5.state.partialsCountMax).map(() => {\r\n      const osc = audioCtx.createOscillator();\r\n      const gain = audioCtx.createGain();\r\n      gain.gain.value = 0;\r\n      osc.connect(gain);\r\n      gain.connect(masterGain);\r\n      osc.start();\r\n      return {osc, gain};\r\n    });\r\n\r\n    window.oscs = oscs;\r\n  }\r\n\r\n  //rotate/flip a quadrant appropriately\r\n  const hilbGetRotatedVec = (n, v, rx, ry) => {\r\n    if (ry === 0) {\r\n      if (rx === 1) {\r\n        v.x = n - 1 - v.x;\r\n        v.y = n - 1 - v.y;\r\n      }\r\n\r\n      //Swap x and y\r\n      let temp = v.x;\r\n      v.x = v.y;\r\n      v.y = temp;\r\n    }\r\n  }\r\n\r\n  const hilbDistanceToCoords = (hilbertN, dist) => {\r\n    //    TODO: get distanceToVector based on percentage of maxD so that the Hilbert cursor stays in the same place when changing Hilbert resolutions\r\n    //    TODO: also click the screen to set the cursor so need amp function to convert x,y to hilbert distance\r\n\r\n    const v = {x: 0, y: 0};\r\n    // _(size)\r\n    //   .range()\r\n    //   .map(v => Math.pow(2, v))\r\n    //   .takeWhile(v => v < size)\r\n    //   .value()\r\n\r\n    for (let s = 1; s < hilbertN; s *= 2) {\r\n      let rx = 1 & (dist / 2);\r\n      let ry = 1 & (dist ^ rx);\r\n      hilbGetRotatedVec(s, v, rx, ry);\r\n      v.x += s * rx;\r\n      v.y += s * ry;\r\n      dist /= 4;\r\n    }\r\n    return v;\r\n  }\r\n\r\n  /**\r\n   * Returns amp {@code Vec} representing the Euclidian coordinates of the given normalized \"Mandelbrot coordinates\"\r\n   * <br>Mandelbrot X scale: -2.5 to 1\r\n   * <br>Mandelbrot Y scale: -1 to 1\r\n   * @param x normalized x coordinate 0 to 1.0\r\n   * @param y normalized y coordinate 0 to 1.0\r\n   * @return\r\n   */\r\n  const mandGetDenormalizedCoords = (x, y) => ({\r\n    x: -2.5 + x * 3.5,\r\n    y: -1 + y * 2,\r\n  })\r\n\r\n\r\n  /**\r\n   * Returns the number of iterations to escape the Mandelbrot set at the given coordinates\r\n   * @param scaledX\r\n   * @param scaledY\r\n   * @param maxIterations\r\n   * @return\r\n   */\r\n  const mandGetVal = (scaledX, scaledY, maxIterations) => {\r\n    let x = 0, y = 0;\r\n    let iter = 0;\r\n\r\n    while (x * x + y * y < 4 && iter < maxIterations) {\r\n      let xTemp = x * x - y * y + scaledX;\r\n      y = 2 * x * y + scaledY;\r\n      x = xTemp;\r\n      iter++;\r\n    }\r\n    return iter;\r\n  }\r\n\r\n\r\n  const dot = (v1, v2) => _.reduce(v1, (acc, val, idx) => acc + val * v2[idx], 0);\r\n\r\n  /**\r\n   * https://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n   * @param cx\r\n   * @param cy\r\n   * @param maxIterations\r\n   * @returns {*|number}\r\n   */\r\n  const mandGetValSmooth = (cx, cy, maxIterations) => {\r\n    const Bsq = 256 * 256;\r\n    const z = [0,0];\r\n    let n = 0;\r\n    let x, y;\r\n\r\n    for (let i = 0; i < maxIterations; i++) {\r\n      [x, y] = z;\r\n      z[0] = x * x - y * y + cx;\r\n      z[1] = 2 * x * y + cy;\r\n      if (dot(z, z) > Bsq) break;\r\n      n++;\r\n    }\r\n\r\n    // return n - Math.log(Math.log(Math.sqrt(z[0] * z[0] + z[1] * z[1]) / Math.log(B) / Math.log(2)))\r\n    return n >= maxIterations\r\n      ? maxIterations\r\n      : n - Math.log2(Math.log2(dot(z,z))) + 4;\r\n  }\r\n\r\n  /**\r\n   * Returns the number of iterations required to escape the Mandelbrot set at the given coordinates\r\n   * @param xN normalized x coordinate 0 to 1.0\r\n   * @param yN normalized y coordinate 0 to 1.0\r\n   * @param panX < 0 pans left. > 0 pans right\r\n   * @param panY < 0 pans up. > 0 pans down\r\n   * @param zoom 1.0 is unzoomed\r\n   * @param maxIterations\r\n   * @return\r\n   */\r\n  const mandGetValFromNormalizedCoords = (xN, yN, panX, panY, zoom, maxIterations) => {\r\n    let x1 = 0.5 - panX + (xN - 0.5) / zoom;\r\n    let y1 = 0.5 - panY + (yN - 0.5) / zoom;\r\n    const {x, y} = mandGetDenormalizedCoords(x1, y1);\r\n    return p5.state.isSmooth\r\n      ? mandGetValSmooth(x, y, maxIterations)\r\n      : mandGetVal(x, y, maxIterations);\r\n  }\r\n\r\n  const genHilbertCoords = _.memoize((hilbertN) =>\r\n    _.range(hilbertN * hilbertN)\r\n      .map(d => hilbDistanceToCoords(hilbertN, d)));\r\n\r\n\r\n  const genHilbertMandelbrot = () => {\r\n    const {\r\n      hilbertN,\r\n      maxIters,\r\n      panX,\r\n      panY,\r\n      partialsCountMax,\r\n      zoom,\r\n    } = p5.state;\r\n\r\n\r\n    return genHilbertCoords(hilbertN).map(({ x, y }) => {\r\n      const m = mandGetValFromNormalizedCoords(x / hilbertN, y / hilbertN, panX, panY, zoom, maxIters);\r\n      return {\r\n        x,\r\n        y,\r\n        m,\r\n        p: m === maxIters\r\n          ? 0 // to be filtered out\r\n          : Math.floor(((m - 1) % partialsCountMax) + 1),\r\n      };\r\n    })\r\n  };\r\n\r\n  const getStrokeWeight = (w) => {\r\n    const sideLength = w / p5.state.hilbertN;\r\n    return STROKE_WEIGHT_COEF * Math.min(10, sideLength / 20);\r\n  };\r\n\r\n  const getPartialOfOctaveStart = _.memoize((f) =>\r\n    _(100)\r\n      .range()\r\n      .map(n => Math.pow(2, n))\r\n      .dropWhile(n => f / n >= 2)\r\n      .first());\r\n\r\n  const getColorForMandelbrotVal = ({m, p}, isCursor = false) => {\r\n    const {\r\n      maxIters,\r\n      partialsCountMax,\r\n    } = p5.state;\r\n\r\n    const octMax = getPartialOfOctaveStart(partialsCountMax);\r\n    const oct = getPartialOfOctaveStart(p);\r\n\r\n    // good looks with smooth but not relevant to partials\r\n    // const h = (m * 10) % 255;\r\n    // const s = isCursor ? 0 : 255 - (m / maxIters) * 225  //(p / partialsCountMax) * 225;\r\n\r\n    const h = 255 * Math.log2(p / oct);\r\n    const s = isCursor ? 0 : 255 - Math.pow(oct / octMax, 2) * 225  //(p / partialsCountMax) * 225;\r\n    const b = isCursor\r\n      ? 255\r\n      : m === maxIters ? 0\r\n        : 30 + Math.pow(oct / octMax, 2) * 225;\r\n\r\n    return p5.color(h, s, b, isCursor ? CURSOR_ALPHA : 255);\r\n  };\r\n\r\n  const setFillColorForMandelbrotVal = (coordsWithVal, isCursor = false) => {\r\n    p5.fill(getColorForMandelbrotVal(coordsWithVal, isCursor));\r\n  }\r\n\r\n  const drawHilbertCoord = (w, h, hilbertCoord, hilbertN) => {\r\n    const scaleX = w / hilbertN;\r\n    const scaleY = h / hilbertN;\r\n    p5.rect(hilbertCoord.x * scaleX, hilbertCoord.y * scaleY, scaleX, scaleY);\r\n    // p5.circle(hilbertCoord.x * scaleX + scaleX / 2, hilbertCoord.y * scaleY + scaleY / 2, scaleX);\r\n  }\r\n\r\n  const drawHilbertMandelbrot = (w, h, state) => {\r\n    const {\r\n      hilbertN,\r\n      hilbMand,\r\n    } = state;\r\n\r\n    const strokeWeight = getStrokeWeight(p5.width / 2);\r\n    p5.strokeWeight(strokeWeight);\r\n    p5.stroke(STROKE_COLOR);\r\n\r\n    const s = getSideLengthForLinearizedMap(hilbMand.length, p5.width / 4, p5.height);\r\n\r\n    hilbMand.forEach((coordWithVal, d) => {\r\n      setFillColorForMandelbrotVal(coordWithVal);\r\n\r\n      p5.push();\r\n      {\r\n        p5.translate(p5.width / 4, 0);\r\n        drawHilbertCoord(w, h, coordWithVal, hilbertN);\r\n      }\r\n      p5.pop();\r\n\r\n      p5.push(); // TODO: is it more expensive to push/pop 1000 times or iterate over hilbMand twice?\r\n      {\r\n        p5.translate((p5.width / 4) * 3, 0);\r\n        drawLinearizedMandelbrotCoord(p5.width / 4, s, d);\r\n      }\r\n      p5.pop();\r\n    })\r\n  };\r\n\r\n  const getSideLengthForLinearizedMap = (dMax, w, h) => {\r\n    const maxA = w * h;\r\n    const largestPossibleSide = Math.sqrt(maxA / dMax);\r\n\r\n    let s = 0;\r\n    for (let i = 1; i < w; i++) {\r\n      s = w / i;\r\n      if (s > largestPossibleSide) {\r\n        continue;\r\n      }\r\n\r\n      const sqPerRow = w / s;\r\n      const rows = dMax / sqPerRow;\r\n      const leftover = dMax % sqPerRow;\r\n\r\n      if (rows * s + (leftover > 0 ? s : 0) <= h) {\r\n        break;\r\n      }\r\n    }\r\n    return s;\r\n  }\r\n\r\n  const drawLinearizedMandelbrotCoord = (w, s, d) => {\r\n    const valsPerRow = w / s;\r\n\r\n    let x = d % valsPerRow;\r\n    const y = Math.floor(d / valsPerRow);\r\n\r\n    // snake around instead of starting from the left for each row\r\n    if (y % 2 === 1) {\r\n      x = valsPerRow - (x + 1);\r\n    }\r\n\r\n    p5.rect(x * s, y * s, s, s);\r\n  }\r\n\r\n  const genAndDrawHilbertMandelbrot = () => {\r\n    p5.background(32);\r\n\r\n    // fade out. this can probably move to partials _.each\r\n    oscs.forEach(({gain}) => {\r\n      gain.gain.cancelScheduledValues(audioCtx.currentTime);\r\n      gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);\r\n    })\r\n\r\n    if (oscs.length !== partialsCountMax) {\r\n      setupOscillators(); // TODO: fade out first\r\n    }\r\n\r\n    const {\r\n      fundamentalFreq,\r\n      partialsCountMax,\r\n    } = p5.state;\r\n\r\n    const hilbMand = genHilbertMandelbrot();\r\n\r\n    const partials = _(hilbMand)\r\n      .map(({p}) => p)\r\n      .filter(_.identity) // maxIters (black) are set as p: 0\r\n      .uniq()\r\n      .sort()\r\n      .take(partialsCountMax)\r\n      .map((partial, i) => [partial, {amp: 0, oscIdx: i}])\r\n      .fromPairs()\r\n      .value();\r\n\r\n    // slide to new freqs if partials change\r\n    _.each(partials, ({decayTimerId, oscIdx, zeroGainTimerId}, partial) => {\r\n      clearTimeout(decayTimerId);\r\n      clearTimeout(zeroGainTimerId);\r\n      oscs[oscIdx].osc.frequency.cancelScheduledValues(audioCtx.currentTime);\r\n      oscs[oscIdx].osc.frequency.linearRampToValueAtTime(partial * fundamentalFreq, audioCtx.currentTime + 0.5);\r\n    });\r\n\r\n    p5.setState(prevState => {\r\n      const nextState = {\r\n        ...prevState,\r\n        hilbMand,\r\n        isRegenNeeded: false,\r\n        partials,\r\n      };\r\n      drawHilbertMandelbrot( p5.width / 2, p5.height, nextState);\r\n      return nextState;\r\n    });\r\n  }\r\n\r\n\r\n  const cursorErasePrev = (maxD, s, prevD) => {\r\n    const {hilbMand} = p5.state;\r\n    const prevCoordAndVal = hilbMand[prevD % maxD];\r\n\r\n    setFillColorForMandelbrotVal(prevCoordAndVal);\r\n    p5.stroke(STROKE_COLOR);\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate(p5.width / 4, 0);\r\n      drawHilbertCoord(p5.width / 2, p5.height, prevCoordAndVal, p5.state.hilbertN);\r\n    }\r\n    p5.pop();\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate((p5.width / 4) * 3, 0);\r\n      drawLinearizedMandelbrotCoord(p5.width / 4, s, prevD);\r\n    }\r\n    p5.pop();\r\n  }\r\n\r\n  let prevD = 0;\r\n  const cursorDraw = (id) => {\r\n    const {hilbMand} = p5.state;\r\n    const d = p5.state.tick % hilbMand.length;\r\n    const coordAndVal = hilbMand[d];\r\n    const sideLength = getSideLengthForLinearizedMap(hilbMand.length, p5.width / 4, p5.height);\r\n    const strokeWeight = getStrokeWeight(p5.width / 2);\r\n\r\n    p5.strokeWeight(strokeWeight);\r\n    cursorErasePrev(hilbMand.length, sideLength, prevD);\r\n    prevD = d; // maybe multiple ticks per frame when external time sync\r\n    p5.stroke((CURSOR_STROKE_COLOR_SEPARATION * id) % 255, 0, 255);\r\n    setFillColorForMandelbrotVal(coordAndVal, true);\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate(p5.width / 4, 0);\r\n      drawHilbertCoord(p5.width / 2, p5.height, coordAndVal, p5.state.hilbertN);\r\n    }\r\n    p5.pop();\r\n\r\n    p5.push();\r\n    {\r\n      p5.translate((p5.width / 4) * 3, 0);\r\n      drawLinearizedMandelbrotCoord(p5.width / 4, sideLength, d);\r\n    }\r\n    p5.pop();\r\n  }\r\n\r\n  const cursorExcite = (id) => {\r\n    const {\r\n      decayDuration,\r\n      exciteEnergy,\r\n      exciteDuration,\r\n      hilbMand,\r\n      partials,\r\n      tick,\r\n    } = p5.state;\r\n\r\n    const d = tick % hilbMand.length;\r\n    const {p} = hilbMand[d];\r\n\r\n    if (p > 0) {\r\n      const partial = partials[p];\r\n      const {\r\n        amp,\r\n        decayTimerId,\r\n        oscIdx,\r\n        zeroGainTimerId,\r\n      } = partial;\r\n      const {gain} = oscs[oscIdx];\r\n\r\n      const isExcited = _.isNumber(decayTimerId);\r\n      const currGain = isExcited ? amp : gain.gain.value;\r\n\r\n      // console.log(p, currGain);\r\n\r\n      const targetGain = 0.8 * Math.min(1, currGain + exciteEnergy * (1 - currGain));\r\n      partial.amp = targetGain;\r\n\r\n      clearTimeout(decayTimerId); // further delay the decay\r\n      clearTimeout(zeroGainTimerId); // don't reset amp to zero\r\n      gain.gain.cancelScheduledValues(0);\r\n      gain.gain.linearRampToValueAtTime(targetGain, audioCtx.currentTime + exciteDuration / 1000);\r\n\r\n      partial.decayTimerId = setTimeout(() => {\r\n        gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + decayDuration / 1000);\r\n        partial.decayTimerId = null;\r\n\r\n        partial.zeroGainTimerId = setTimeout(() => {\r\n          partial.amp = 0;\r\n        }, decayDuration)\r\n      }, exciteDuration);\r\n    }\r\n  }\r\n\r\n  const partialsDraw = () => {\r\n    const h = p5.height;\r\n    const w = p5.width / 4;\r\n\r\n    p5.noStroke();\r\n\r\n    const { partials, partialsCountMax } = p5.state;\r\n\r\n    _.each(partials, ({ amp: targetAmp, oscIdx }, p) => {\r\n      const barH = h / partialsCountMax;\r\n      const y = h * ((p - 1) / partialsCountMax);\r\n      const barW = oscs[oscIdx].gain.gain.value * w;\r\n\r\n      const c = getColorForMandelbrotVal({ m: 1, p})\r\n      p5.fill(p5.color(p5.hue(c), 255, 8));\r\n      p5.rect(0, y, w, barH);\r\n\r\n      p5.fill(c);\r\n      p5.rect(0, y, barW, barH);\r\n      p5.fill(255);\r\n      p5.rect(targetAmp * w, y, 1, barH);\r\n    })\r\n\r\n  }\r\n\r\n  let wasPaused = true;\r\n  const pauseScreenDraw = () => {\r\n    if (!p5.state.isPlaying && !p5.state.isControlPanelOpen) {\r\n      wasPaused = true;\r\n      p5.background(0, 0.1);\r\n      p5.noFill();\r\n      p5.stroke(192, 127, 90);\r\n      p5.textSize(10);\r\n      p5.text('arrow keys to move', 0, p5.height / 2 - 50, p5.width, p5.height);\r\n      p5.text('shift+arrow for zoom/resolution', 0, p5.height / 2 - 35, p5.width, p5.height);\r\n      p5.text('shift+spacebar toggle controls', 0, p5.height / 2 - 20, p5.width, p5.height);\r\n      p5.textSize(20);\r\n      p5.textAlign(p5.CENTER);\r\n      p5.text('spacebar to start', 0, p5.height / 2, p5.width, p5.height);\r\n    } else {\r\n      if (wasPaused) {\r\n        partialsDraw();\r\n        drawHilbertMandelbrot(p5.width / 2, p5.height, p5.state);\r\n        wasPaused = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  let font;\r\n  p5.preload = () => {\r\n    font = p5.loadFont('JetBrainsMono-Regular.ttf');\r\n  }\r\n\r\n  p5.setup = () => {\r\n    p5.createCanvas(p5._width, p5._height);\r\n    p5.colorMode(p5.HSB);\r\n    p5.textFont(font);\r\n  }\r\n\r\n  p5.incrementTick = (isExternal = false) => {\r\n    const now = p5.millis();\r\n    const {\r\n      isPlaying,\r\n      isRegenNeeded,\r\n      midiClocksPerTick,\r\n      tickDuration,\r\n      tickLastMillis,\r\n    } = p5.state;\r\n\r\n    if (isExternal) {\r\n      p5.state.midiClock++;\r\n    }\r\n\r\n    const isReady = isPlaying && !isRegenNeeded && (isExternal\r\n      ? p5.state.midiClock % midiClocksPerTick === 0\r\n      : now > tickLastMillis + tickDuration);\r\n\r\n    if (isReady) {\r\n      p5.state.tick++;\r\n      p5.state.tickLastMillis = now;\r\n      cursorExcite(0);\r\n    }\r\n  }\r\n\r\n  let prevTick = 0;\r\n  p5.draw = () => {\r\n    const {\r\n      isPlaying,\r\n      isRegenNeeded,\r\n      midiClock,\r\n    } = p5.state;\r\n\r\n    if (isRegenNeeded) {\r\n      genAndDrawHilbertMandelbrot();\r\n    }\r\n\r\n    if (midiClock === 0) p5.incrementTick();\r\n\r\n    if (_.every([\r\n      !isRegenNeeded,\r\n      p5.state.tick !== prevTick,\r\n    ])) {\r\n      cursorDraw(0);\r\n      prevTick = p5.state.tick;\r\n    }\r\n\r\n    if (isPlaying) partialsDraw();\r\n\r\n    pauseScreenDraw();\r\n  }\r\n\r\n  /**\r\n   * This needs to be called by a user event handler.\r\n   * @param isPlaying\r\n   */\r\n  p5.toggleAudio = () => {\r\n    p5.setState(prevState => {\r\n      const { isPlaying } = prevState;\r\n      if (!isPlaying && audioCtx.state !== 'running') {\r\n        audioCtx.resume();\r\n      }\r\n\r\n      if (isPlaying && audioCtx.state === 'running') {\r\n        audioCtx.suspend();\r\n      }\r\n\r\n      return { ...prevState, isPlaying: !prevState.isPlaying };\r\n    });\r\n\r\n  }\r\n}\r\n","import _ from 'lodash';\r\nimport useP5 from './useP5';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport TuneIcon from '@material-ui/icons/Tune';\r\nimport useMidiClock from \"./useMidiClock\";\r\nimport { initialState, sketch } from \"./mandelbrotP5\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport {Button, ButtonGroup, Drawer} from '@material-ui/core';\r\n\r\nimport KeyboardArrowUpOutlinedIcon from '@material-ui/icons/KeyboardArrowUpOutlined';\r\nimport KeyboardArrowDownOutlinedIcon from '@material-ui/icons/KeyboardArrowDownOutlined';\r\nimport KeyboardArrowLeftOutlinedIcon from '@material-ui/icons/KeyboardArrowLeftOutlined';\r\nimport KeyboardArrowRightOutlinedIcon from '@material-ui/icons/KeyboardArrowRightOutlined';\r\nimport PlayCircleOutlineIcon from '@material-ui/icons/PlayCircleOutline';\r\nimport PauseCircleOutlineIcon from '@material-ui/icons/PauseCircleOutline';\r\nimport ViewComfyOutlinedIcon from '@material-ui/icons/ViewComfyOutlined';\r\nimport ViewModuleOutlinedIcon from '@material-ui/icons/ViewModuleOutlined';\r\nimport ZoomInOutlinedIcon from '@material-ui/icons/ZoomInOutlined';\r\nimport ZoomOutOutlinedIcon from '@material-ui/icons/ZoomOutOutlined';\r\n\r\nconst useStyles = makeStyles({\r\n  paper: {\r\n    background: \"rgba(0,0,0,0.7)\",\r\n    paddingBottom: 65,\r\n  }\r\n});\r\n\r\nconst getHandleAction = (sketchInstance) => (action) => () => {\r\n  if (action === 'toggleAudio') {\r\n    sketchInstance.toggleAudio();\r\n    return;\r\n  }\r\n\r\n  sketchInstance.setState(prevState => {\r\n    const {\r\n      hilbertN,\r\n      isControlPanelOpen,\r\n      isRegenNeeded,\r\n      panX,\r\n      panY,\r\n      zoom,\r\n    } = prevState;\r\n    const panDelta = 0.1 / zoom;\r\n\r\n    const nextState = {\r\n      moveLeft: {panX: panX + panDelta},\r\n      moveRight: {panX: panX - panDelta},\r\n      moveUp: {panY: panY + panDelta},\r\n      moveDown: {panY: panY - panDelta},\r\n      resDec: {hilbertN: Math.pow(2, Math.log2(hilbertN) - 1)},\r\n      resInc: {hilbertN: Math.min(256, Math.pow(2, Math.log2(hilbertN) + 1))},\r\n      toggleControlPanel: {isControlPanelOpen: !isControlPanelOpen, isRegenNeeded},\r\n      zoomIn: {zoom: zoom * (10 / 9)},\r\n      zoomOut: {zoom: zoom * (9 / 10)},\r\n    }[action];\r\n\r\n    return {\r\n      ...prevState,\r\n      isRegenNeeded: !_.isEmpty(nextState),\r\n      ...nextState,\r\n    };\r\n  })\r\n};\r\n\r\nconst handleKeyDown = (handleAction) => (evt) => {\r\n  // console.log(evt);\r\n  const {code, shiftKey, key} = evt;\r\n\r\n  if (code === 'Space') {\r\n    handleAction(shiftKey ? 'toggleControlPanel' : 'toggleAudio')();\r\n    return;\r\n  }\r\n\r\n  const getAction = {\r\n    'ArrowDown': () => shiftKey ? 'zoomOut' : 'moveDown',\r\n    'ArrowLeft': () => shiftKey ? 'resDec' : 'moveLeft',\r\n    'ArrowRight': () => shiftKey ? 'resInc' : 'moveRight',\r\n    'ArrowUp': () => shiftKey ? 'zoomIn' : 'moveUp',\r\n  }[key];\r\n\r\n  if (getAction) handleAction(getAction())();\r\n};\r\n\r\nconst Mandelbrot = () => {\r\n  const {\r\n    ref,\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n  } = useP5(sketch, initialState);\r\n\r\n  window.sketchInstance = sketchInstance;\r\n\r\n  const handleAction = getHandleAction(sketchInstance);\r\n\r\n  useEffect(() => {\r\n    document.title = 'Mandelbrot Muse';\r\n    if (sketchInstance) {\r\n      const handler = handleKeyDown(handleAction);\r\n      window.addEventListener('keydown', handler)\r\n      return () => { // cleanup\r\n        window.removeEventListener('keydown', handler);\r\n      };\r\n    }\r\n  }, [sketchInstance]);\r\n\r\n  const {midiClockInDevice} = useMidiClock(() => {\r\n    if (sketchInstance) {\r\n      sketchInstance.incrementTick(true);\r\n    }\r\n  });\r\n\r\n  return (<>\r\n    <div\r\n      ref={ref}\r\n      style={{\r\n        alignSelf: 'start',\r\n        background: 'radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)',\r\n        height: '50vw',\r\n        width: '100vw',\r\n      }}\r\n    />\r\n\r\n    <div style={{\r\n      bottom: 0,\r\n      padding: 0,\r\n      position: 'absolute',\r\n      textAlign: 'center',\r\n      zIndex: 1000000,\r\n    }}>\r\n      {!sketchState.isControlPanelOpen && (\r\n        <Button onClick={handleAction('toggleControlPanel')}>\r\n          show\r\n          <TuneIcon/>\r\n          controls\r\n        </Button>\r\n      )}\r\n\r\n      <Drawer\r\n        anchor=\"top\"\r\n        classes={useStyles()}\r\n        color=\"transparent\"\r\n        open={sketchState.isControlPanelOpen}\r\n        onClose={handleAction('toggleControlPanel')}\r\n        variant=\"persistent\"\r\n\r\n        // onMouseEnter={ev => { ev.currentTarget.style.opacity = 1 }}\r\n        // onMouseLeave={ev => { ev.currentTarget.style.opacity = 0.5 }}\r\n      >\r\n\r\n\r\n        <ButtonGroup fullWidth size=\"large\">\r\n          <Button onClick={handleAction('toggleAudio')}>\r\n            {!sketchState.isPlaying ? <PlayCircleOutlineIcon /> : <PauseCircleOutlineIcon />}\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('toggleControlPanel')}>\r\n            hide controls\r\n          </Button>\r\n        </ButtonGroup>\r\n\r\n        <ButtonGroup fullWidth size=\"large\">\r\n          <Button onClick={handleAction('moveUp')}>\r\n            <KeyboardArrowUpOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('moveLeft')}>\r\n            <KeyboardArrowLeftOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('moveRight')}>\r\n            <KeyboardArrowRightOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('zoomIn')}>\r\n            <ZoomInOutlinedIcon/>\r\n          </Button>\r\n\r\n        </ButtonGroup>\r\n\r\n        <ButtonGroup fullWidth size=\"large\">\r\n          <Button onClick={handleAction('moveDown')}>\r\n            <KeyboardArrowDownOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('resDec')}>\r\n            <ViewModuleOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('resInc')}>\r\n            <ViewComfyOutlinedIcon/>\r\n          </Button>\r\n\r\n          <Button onClick={handleAction('zoomOut')}>\r\n            <ZoomOutOutlinedIcon/>\r\n          </Button>\r\n\r\n        </ButtonGroup>\r\n\r\n        {midiClockInDevice ? (\r\n          <Slider\r\n            min={1}\r\n            max={1024}\r\n            stateKey={\"midiClocksPerTick\"}\r\n            sketchState={sketchState}\r\n            setSketchState={setSketchState}\r\n          />\r\n        ) : (\r\n          <Slider\r\n            min={16}\r\n            max={1000}\r\n            stateKey={\"tickDuration\"}\r\n            sketchState={sketchState}\r\n            setSketchState={setSketchState}\r\n          />\r\n        )}\r\n\r\n        <Slider\r\n          min={1}\r\n          max={4000}\r\n          stateKey={\"exciteDuration\"}\r\n          sketchState={sketchState}\r\n          setSketchState={setSketchState}\r\n        />\r\n        <Slider\r\n          min={10}\r\n          max={8000}\r\n          stateKey={\"decayDuration\"}\r\n          sketchState={sketchState}\r\n          setSketchState={setSketchState}\r\n        />\r\n\r\n        <Slider\r\n          min={0.01}\r\n          max={1}\r\n          step={0.01}\r\n          stateKey={\"exciteEnergy\"}\r\n          sketchState={sketchState}\r\n          setSketchState={setSketchState}\r\n        />\r\n        <Slider\r\n          min={0.1}\r\n          max={500}\r\n          onPointerUp={() => {\r\n            console.log('onPointerUp');\r\n            sketchState.isRegenNeeded = true // TODO: isFreqChanged instead of full regen\r\n          }}\r\n          step={0.1}\r\n          stateKey={\"fundamentalFreq\"}\r\n          sketchState={sketchState}\r\n          setSketchState={setSketchState}\r\n        />\r\n        <Slider\r\n          min={1}\r\n          max={1000}\r\n          stateKey={\"partialsCountMax\"}\r\n          sketchState={sketchState}\r\n          setSketchState={setSketchState}\r\n          // onInput={() => {\r\n          //   console.log('onInput');\r\n          //   sketchState.isRegenNeeded = true\r\n          // // console.log('sketchState.isRegenNeeded:', sketchState.isRegenNeeded)\r\n          // }}\r\n          onPointerUp={() => {\r\n            console.log('onPointerUp');\r\n            sketchState.isRegenNeeded = true\r\n            // console.log('sketchState.isRegenNeeded:', sketchState.isRegenNeeded)\r\n          }}\r\n        />\r\n        <Slider\r\n          min={64}\r\n          max={8000}\r\n          stateKey={\"maxIters\"}\r\n          sketchState={sketchState}\r\n          setSketchState={setSketchState}\r\n          onPointerUp={() => {\r\n            console.log('onPointerUp');\r\n            sketchState.isRegenNeeded = true\r\n          }}\r\n        />\r\n      </Drawer>\r\n\r\n\r\n    </div>\r\n   </>);\r\n};\r\n\r\nconst Slider = ({ sketchState, setSketchState, stateKey, ...props }) => (\r\n    <div>\r\n      {stateKey}: {sketchState[stateKey]}\r\n      <br />\r\n      <input\r\n        type=\"range\"\r\n        style={{width: 400}}\r\n        value={sketchState[stateKey]}\r\n        onChange={ev => {\r\n          const value = Number(ev.target.value);\r\n          setSketchState(state => ({\r\n            ...state,\r\n            [stateKey]: value\r\n          }))\r\n        }}\r\n        {...props}\r\n      />\r\n    </div>\r\n  );\r\n\r\nexport default Mandelbrot;\r\n","import FrettedInstrument from './frettedInstrument';\r\nimport React from 'react';\r\n\r\nconst Mandolin = () => (\r\n  <FrettedInstrument\r\n    fretCount={20}\r\n    fretMarkers={[0, 3, 5, 7, 10, 12, 15]}\r\n    tuning={[7, 2, 9, 4]}\r\n  />\r\n);\r\n\r\nexport default Mandolin;\r\n","import _ from 'lodash';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport React, {useEffect} from 'react';\r\nimport useMidi from './useMidi';\r\nimport WebMidi from 'webmidi';\r\nimport {IconButton, Toolbar} from \"@material-ui/core\";\r\nimport {WatchLater as MidiClockIcon} from '@material-ui/icons';\r\n\r\nconst Midi = () => {\r\n\r\n  const [state, actions] = useMidi( // https://github.com/andregardi/use-global-hook#avoid-unnecessary-renders\r\n    ({\r\n      inputDevices,\r\n      isMidiClockInSelectorOpen,\r\n      isMidiInSelectorOpen,\r\n      midiInDevice,\r\n    }) => ({inputDevices, isMidiClockInSelectorOpen, isMidiInSelectorOpen, midiInDevice}),\r\n    actions => actions,\r\n  );\r\n\r\n  const {\r\n    inputDevices,\r\n    isMidiClockInSelectorOpen,\r\n    isMidiInSelectorOpen,\r\n    midiInDevice,\r\n  } = state;\r\n\r\n  useEffect(() => {\r\n    WebMidi.enable((err) => {\r\n      if (err) console.error(err);\r\n      else {\r\n        console.log('WebMidi enabled.');\r\n        actions.setInputDevices(WebMidi.inputs);\r\n      }\r\n    }, true);\r\n  }, []);\r\n\r\n\r\n  const handleMidi = (evt) => {\r\n    const {note: {number: n}, rawVelocity: vel, type} = evt;\r\n    // console.log(evt)\r\n    // actions.setMidiEvent({\r\n    //   [n]: type === 'noteon' ? vel : 0\r\n    // });\r\n  }\r\n\r\n  const handleMidiClock = (evt) => {\r\n\r\n    // console.log(evt)\r\n    // actions.setMidiEvent({\r\n    //   [n]: type === 'noteon' ? vel : 0\r\n    // });\r\n  }\r\n\r\n\r\n  const [midiMenuAnchorEl, setMidiMenuAnchorEl] = React.useState(null);\r\n\r\n  const handleMidiMenuButtonClick = (isBeatClock = false) => ({ currentTarget }) => {\r\n    setMidiMenuAnchorEl(currentTarget);\r\n    actions[isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector']();\r\n  }\r\n\r\n  const handleMidiMenuClose = (isBeatClock = false) => () => {\r\n    console.log('close', isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector')\r\n    actions[isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector']();\r\n    setMidiMenuAnchorEl(null);\r\n  }\r\n\r\n  const handleMidiInputSelect = (deviceIdx, isBeatClock = false) => ({ currentTarget }) => { // todo: remove prev listener\r\n    setMidiMenuAnchorEl(currentTarget);\r\n\r\n    const midiInDevice = inputDevices[deviceIdx];\r\n    actions[isBeatClock ? 'toggleMidiClockInSelector' : 'toggleMidiInSelector']();\r\n    if (isBeatClock) {\r\n      midiInDevice.addListener('clock', 'all', handleMidiClock);\r\n      actions.setMidiClockInDevice(midiInDevice);\r\n    } else {\r\n      actions.setMidiInDevice(midiInDevice);\r\n      midiInDevice.addListener('noteon', 'all', handleMidi);\r\n      midiInDevice.addListener('noteoff', 'all', handleMidi);\r\n    }\r\n\r\n  };\r\n\r\n  return ( // TODO: only show if MIDI devices present; use looser permission to query\r\n    <>\r\n      <IconButton\r\n        edge=\"start\"\r\n        color=\"inherit\"\r\n        aria-label=\"open drawer\"\r\n        onClick={handleMidiMenuButtonClick(false)}\r\n      >\r\n        <img src=\"noun_MIDI_385872.svg\" style={{ width: '1.5em', height: '1.5em'}} />\r\n      </IconButton>\r\n\r\n      <IconButton\r\n        edge=\"start\"\r\n        color=\"inherit\"\r\n        aria-label=\"open drawer\"\r\n        onClick={handleMidiMenuButtonClick(true)}\r\n      >\r\n        <MidiClockIcon/>\r\n      </IconButton>\r\n\r\n      <Menu\r\n        id=\"simple-menu\"\r\n        anchorEl={midiMenuAnchorEl}\r\n        open={isMidiInSelectorOpen || isMidiClockInSelectorOpen}\r\n        onClose={handleMidiMenuClose(isMidiClockInSelectorOpen)}\r\n      >\r\n        {inputDevices.map(({name}, idx) => (\r\n          <MenuItem\r\n            key={name}\r\n            onClick={handleMidiInputSelect(idx, isMidiClockInSelectorOpen)}\r\n            selected={isMidiInSelectorOpen && name === _.get(midiInDevice, 'name')}\r\n          >\r\n            {name}\r\n          </MenuItem>\r\n        ))}\r\n      </Menu>\r\n    </>\r\n\r\n  );\r\n};\r\n\r\nexport default Midi;\r\n","import _ from 'lodash';\r\n\r\n\r\n\r\nexport const initialState = {\r\n  decayDuration: 5000,\r\n  exciteEnergy: 0.05,\r\n  exciteDuration: 1000,\r\n  fundamentalFreq: 200,\r\n  hilbertN: 64, // hilbertN must be power of 2 in order to be square\r\n  hilbMand: [/*{ x, y, m }*/], // coordinates and associated mandelbrot val in hilbert traversal order\r\n  isControlPanelOpen: true,\r\n  isPlaying: false,\r\n  isRegenNeeded: true,\r\n  maxIters: 4096, // max number of steps to recurse the mandelbrot fn\r\n  midiClock: 0,\r\n  midiClocksPerTick: 24,\r\n  panX: -0.05,\r\n  panY: 0,\r\n  partials: {/* partial: { amp, oscIdx } */}, // the collection is updated in setState but values within are changed in drawLoop directly\r\n  partialsCountMax: 16,\r\n  isSmooth: false, // smooth technique https://iquilezles.org/www/articles/mset_smooth/mset_smooth.htm\r\n  tick: 0, // updated in draw() bypasses setState\r\n  tickDuration: 100,\r\n  tickLastMillis: 0, // updated in draw() bypasses setState\r\n  zoom: 1.2,\r\n\r\n  // zoom: 3603.7157567397, panX: 0.18580280974577668, panY: 0.00036930706052212803,\r\n\r\n  // floating point errors here\r\n  // zoom: 279919582741326.66, panX: -0.014853203736137617, panY: 0.13451319076043783,\r\n\r\n  // panX: 0.0011548427778035686,\r\n  // panY: 0.025033026937542575,\r\n  // zoom: 319852972190.0951,\r\n  //\r\n  // panX: -0.18498767183730766,\r\n  // panY: 0.4722205531430409,\r\n  // zoom: 419013953.31772846,\r\n  //\r\n  //\r\n  // decay: 0.000075,\r\n  // exciteEnergy: 0.006,\r\n  // fundamentalFreq: 10,\r\n  // hilbertN: 256,\r\n  // maxIters: 4096,\r\n  // panX: 0.0011503007796323155,\r\n  // panY: 0.025033026938902938,\r\n  // tickDuration: 10,\r\n  // zoom: 836635.9887997985,\r\n  //\r\n  //\r\n  //\r\n  // panX: 0.08871194014553094,\r\n  // panY: -0.12829271146701177,\r\n  // zoom: 19736096.460687958,\r\n\r\n  // ...{zoom: 39422433.84662852, panX: 0.04670942760989286, panY: 0.13656218122372943},\r\n\r\n  // demo for 10 partials\r\n  // ...{zoom: 12371177.464729108, panX: 0.04671008941233588, panY: 0.13656133340058238},\r\n};\r\n\r\nlet audioCtx = new AudioContext();\r\nlet oscs = [];\r\n\r\nconst masterGain = audioCtx.createGain();\r\nwindow.masterGain = masterGain;\r\nmasterGain.gain.value = 1;\r\nmasterGain.connect(audioCtx.destination);\r\n\r\n\r\nexport const sketch = (p5) => {\r\n  p5.state = initialState;\r\n\r\n  const setupOscillators = () => {\r\n    oscs.forEach(({osc, gain}) =>\r\n    {\r\n      osc.stop();\r\n    }); // TODO: gain.disconnect?\r\n\r\n    oscs = _.range(p5.state.partialsCountMax).map(() => {\r\n      const osc = audioCtx.createOscillator();\r\n      const gain = audioCtx.createGain();\r\n      gain.gain.value = 0;\r\n      osc.connect(gain);\r\n      gain.connect(masterGain);\r\n      osc.start();\r\n      return {osc, gain};\r\n    });\r\n\r\n    window.oscs = oscs;\r\n  }\r\n\r\n  let font;\r\n  p5.preload = () => {\r\n    font = p5.loadFont('JetBrainsMono-Regular.ttf');\r\n  }\r\n\r\n\r\n  const TWO_PI = Math.PI * 2;\r\n\r\n  let h, w;\r\n\r\n  let d, n, n2 = 0;\r\n\r\n  [n, d] = [2, 1];\r\n\r\n  p5.setup = () => {\r\n    p5.createCanvas(p5._width, p5._height);\r\n    p5.blendMode(p5.ADD);\r\n    p5.colorMode(p5.HSB, 255);\r\n    p5.textFont(font);\r\n  }\r\n\r\n  let input = [];\r\n  p5.keyTyped = () => {\r\n    console.log(p5.key)\r\n    // if (key === ':') {\r\n    //   value = 255;\r\n    // } else if (key === 'b') {\r\n    //   value = 0;\r\n    // }\r\n    // uncomment to prevent any default behavior\r\n    if (p5.key === 'Enter') {\r\n\r\n      const obj = input.join('').split(':').map(s => parseInt(s, 10));\r\n\r\n      n2 = 0;\r\n      [d, n, n2] = obj;\r\n      if (!n2) {\r\n        [n, d] = obj;\r\n        n2 = 0;\r\n      }\r\n      console.log(d, n, n2)\r\n      console.log(w, h)\r\n\r\n      input = [];\r\n    } else {\r\n      input.push(p5.key);\r\n    }\r\n\r\n\r\n\r\n    return false;\r\n  }\r\n\r\n  let phase = 0;\r\n  let x1 = 0;\r\n  let y1 = 0;\r\n  let r;\r\n  const rayCount = 500;\r\n\r\n  const drawWave = ({ freq, phase = 0, hue }) => {\r\n    const dt = TWO_PI / rayCount;\r\n    p5.push();\r\n    p5.translate(w/2, h/2);\r\n    for(let t = 0; t < TWO_PI - dt; t += dt) {\r\n      p5.stroke(\r\n        hue,\r\n        255,\r\n        freq && (50 + 50 * Math.sin(t * freq)),\r\n        100,\r\n      );\r\n\r\n      r = w + h;\r\n      x1 = r * Math.sin(t + phase);\r\n      y1 = r * Math.cos(t + phase);\r\n\r\n      p5.line(0, 0, x1, y1);\r\n    }\r\n    p5.pop();\r\n  };\r\n\r\n\r\n  p5.draw = () => {\r\n    p5.clear();\r\n    p5.background(0, 0, 0);\r\n    h = p5.height;\r\n    w = p5.width;\r\n\r\n\r\n    phase = p5.millis() * (0.001/d);\r\n\r\n    drawWave({\r\n      freq: d,\r\n      hue: 0,\r\n      phase,\r\n    });\r\n\r\n    drawWave({\r\n      freq: d * n / d,\r\n      hue: 90,\r\n      phase: phase * 2,\r\n    });\r\n\r\n    drawWave({\r\n      freq: d * n2 / n,\r\n      hue: 180,\r\n      phase: phase * 3,\r\n    });\r\n\r\n\r\n\r\n\r\n\r\n    p5.blendMode(p5.BLEND);\r\n    p5.fill(255);\r\n    p5.stroke(0);\r\n    p5.strokeWeight(4);\r\n    p5.textAlign(p5.CENTER, p5.CENTER);\r\n    p5.textSize(h/15)\r\n    p5.text(n2 ? `${d}:${n}:${n2}` : `${n}:${d}`, w/2, h/2)\r\n    p5.blendMode(p5.ADD);\r\n  }\r\n\r\n  /**\r\n   * This needs to be called by a user event handler.\r\n   * @param isPlaying\r\n   */\r\n  p5.toggleAudio = () => {\r\n    p5.setState(prevState => {\r\n      const { isPlaying } = prevState;\r\n      if (!isPlaying && audioCtx.state !== 'running') {\r\n        audioCtx.resume();\r\n      }\r\n\r\n      if (isPlaying && audioCtx.state === 'running') {\r\n        audioCtx.suspend();\r\n      }\r\n\r\n      return { ...prevState, isPlaying: !prevState.isPlaying };\r\n    });\r\n\r\n  }\r\n}\r\n","import React, {useEffect} from 'react';\r\nimport useP5 from './useP5';\r\nimport {initialState, sketch} from \"./ratioLightshipP5\";\r\n\r\nconst RatioLightship = () => {\r\n  const {\r\n    ref,\r\n    sketchInstance,\r\n    sketchState,\r\n    setSketchState,\r\n  } = useP5(sketch, initialState);\r\n\r\n  window.sketchInstance = sketchInstance;\r\n\r\n  useEffect(() => {\r\n    document.title = 'Ratio Lightship';\r\n  }, [sketchInstance]);\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      style={{\r\n        alignSelf: 'start',\r\n        background: 'radial-gradient(circle, rgba(74,153,117,1) 0%, rgba(188,148,233,0.6943726953672094) 100%)',\r\n        height: '100vh',\r\n        width: '100vw',\r\n      }}\r\n    />);\r\n};\r\n\r\n\r\nexport default RatioLightship;\r\n","import _ from 'lodash';\r\nimport Vex from 'vexflow';\r\nimport React, {useCallback, useState} from 'react';\r\n\r\nconst VF = Vex.Flow;\r\n\r\nconst useVexFlow = () => {\r\n  const [context, setContext] = useState(null);\r\n  const [resizeObserver, setResizeObserver] = useState(null);\r\n\r\n  const ref = useCallback((el) => {\r\n    if (el) {\r\n      const renderer = new VF.Renderer(el, VF.Renderer.Backends.SVG);\r\n      renderer.resize(el.clientWidth, el.clientHeight);\r\n      setContext(renderer.getContext());\r\n\r\n      const resizeObserver = new ResizeObserver(([{ contentRect: { height, width } }]) => {\r\n        renderer.resize(width, height);\r\n      });\r\n      setResizeObserver(resizeObserver);\r\n      resizeObserver.observe(el);\r\n    } else {\r\n      resizeObserver.disconnect();\r\n    }\r\n  }, []);\r\n\r\n  return {\r\n    context,\r\n    ref,\r\n  };\r\n}\r\n\r\nconst Staff = () => {\r\n  const {\r\n    context,\r\n    ref,\r\n  } = useVexFlow();\r\n\r\n  if (context) {\r\n    context.setStrokeStyle('white');\r\n    context.setFillStyle('white');\r\n\r\n    const treble = new VF.Stave(50, 0, 10000)\r\n      .addClef('treble')\r\n      .addKeySignature('Db')\r\n      .addTimeSignature('4/4')\r\n      .setContext(context)\r\n      .draw();\r\n\r\n    window.VF= VF;\r\n    window.context = context\r\n    window.treble = treble\r\n\r\n    const bass = new VF.Stave(50, 60, 10000)\r\n      .addClef('bass')\r\n      .addTimeSignature('4/4')\r\n      .addKeySignature('Db')\r\n      .setContext(context)\r\n      .draw();\r\n\r\n    const brace = new VF.StaveConnector(treble, bass)\r\n      .setType(VF.StaveConnector.type.BRACE)\r\n      .setContext(context)\r\n      .draw();\r\n\r\n\r\n    const leftLine = new VF.StaveConnector(treble, bass)\r\n      .setType(VF.StaveConnector.type.SINGLE_LEFT)\r\n      .setContext(context)\r\n      .draw();\r\n\r\n  }\r\n\r\n\r\n  return (\r\n    <div style={{\r\n      display: 'block',\r\n      width: '100%',\r\n    }}>\r\n      <div\r\n        ref={ref}\r\n        style={{\r\n          // background: 'darkcyan',\r\n          fill: 'white',\r\n          height: 500,\r\n          stroke: 'white',\r\n        }}/>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default Staff;\r\n","import _ from 'lodash';\r\nimport PC from './pc';\r\nimport React from 'react';\r\n\r\nconst Tonnetz = () => (\r\n  <div style={{\r\n    display: 'block',\r\n    flexShrink: 0,\r\n  }}>\r\n    {_.range(30)\r\n      .map(y => (\r\n        <>\r\n          {_.range(50).map(x => {\r\n            const n = ((y % 2 > 0\r\n              ? ((y - 1) / 2) * 11 + 3\r\n              : (y / 2) * 11) + x * 7) % 12;\r\n\r\n            return (\r\n              <PC key={x} n={n} isOdd={y % 2 === 1}/>\r\n            )\r\n          })}\r\n          <br/>\r\n        </>\r\n      ))}\r\n  </div>\r\n);\r\n\r\nexport default Tonnetz;\r\n","import FrettedInstrument from './frettedInstrument';\r\nimport React from 'react';\r\n\r\nconst Ukulele = () => (\r\n  <FrettedInstrument\r\n    fretCount={18}\r\n    fretMarkers={[0,5,7,10,12]}\r\n    tuning={[7, 4, 0, 9]}\r\n  />\r\n);\r\n\r\nexport default Ukulele;\r\n","import {Entity} from \"aframe-react\";\r\nimport React from \"react\";\r\n\r\nconst Camera = () => (\r\n  <Entity\r\n    primitive=\"a-camera\"\r\n    id=\"camera\"\r\n    position={{ x: 0, y: 0, z: 0 }}\r\n    look-controls\r\n    // touch-look-controls={{\r\n    //   enabled: true,\r\n    // }}\r\n    wasd-controls={{\r\n      acceleration: 25,\r\n    }}\r\n  >\r\n    {/*<Entity*/}\r\n    {/*  primitive=\"a-cursor\"*/}\r\n    {/*  animation__click={{*/}\r\n    {/*    property: 'scale',*/}\r\n    {/*    startEvents: 'click',*/}\r\n    {/*    from: '0.1 0.1 0.1',*/}\r\n    {/*    to: '1 1 1',*/}\r\n    {/*    dur: 150,*/}\r\n    {/*  }}/>*/}\r\n  </Entity>\r\n);\r\n\r\nexport default Camera;\r\n","export function HSVtoHex(h, s, v) {\r\n  function rgbToHex({ r, g, b }) {\r\n    function componentToHex(c) {\r\n      var hex = c.toString(16);\r\n      return hex.length == 1 ? \"0\" + hex : hex;\r\n    }\r\n\r\n    return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\r\n  }\r\n\r\n  var r, g, b, i, f, p, q, t;\r\n  if (arguments.length === 1) {\r\n    s = h.s;\r\n    v = h.v;\r\n    h = h.h;\r\n  }\r\n  i = Math.floor(h * 6);\r\n  f = h * 6 - i;\r\n  p = v * (1 - s);\r\n  q = v * (1 - f * s);\r\n  t = v * (1 - (1 - f) * s);\r\n  switch (i % 6) {\r\n    case 0: {\r\n      r = v;\r\n      g = t;\r\n      b = p;\r\n      break;\r\n    }\r\n    case 1: {\r\n      r = q;\r\n      g = v;\r\n      b = p;\r\n      break;\r\n    }\r\n    case 2: {\r\n      r = p;\r\n      g = v;\r\n      b = t;\r\n      break;\r\n    }\r\n    case 3: {\r\n      r = p;\r\n      g = q;\r\n      b = v;\r\n      break;\r\n    }\r\n    case 4: {\r\n      r = t;\r\n      g = p;\r\n      b = v;\r\n      break;\r\n    }\r\n    case 5: {\r\n      r = v;\r\n      g = p;\r\n      b = q;\r\n      break;\r\n    }\r\n  }\r\n  return rgbToHex({\r\n    r: Math.round(r * 255),\r\n    g: Math.round(g * 255),\r\n    b: Math.round(b * 255)\r\n  });\r\n}","import _ from 'lodash';\r\nimport React from 'react';\r\nimport {Entity} from 'aframe-react';\r\nimport {HSVtoHex} from './color';\r\nimport {toSymbol} from \"./util\";\r\n\r\nconst handleOsc = n => (el) => {\r\n  if (el) {\r\n    const { components: { osc } } = el;\r\n    osc.onOsc = ({ instrument, note, vel }) => {\r\n      if (note === n) {\r\n        osc.vel = vel;\r\n      }\r\n    }\r\n\r\n    osc.onTick = (time, timeDelta) => {\r\n      if (osc.vel === 0) {\r\n\r\n      }\r\n\r\n      if (_.has(osc, 'vel')) {\r\n        el.setAttribute('material', 'opacity', 0.05 + 0.75 * osc.vel / 128);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport default ({\r\n  darkened = true,\r\n  n,\r\n  position = {x: 0, y: 0, z: 0},\r\n  scale = {x: 1, y: 1, z: 1}\r\n}) =>\r\n  <Entity\r\n    _ref={handleOsc(n)}\r\n    // animation={{\r\n    //   dur: 500,\r\n    //   property: 'position',\r\n    //   to: position,\r\n    // }}\r\n    material={{\r\n      blending: darkened ? 'normal' : 'additive',\r\n      color: HSVtoHex(n / 12, 0.7, darkened ? 0 : 1),\r\n      opacity: darkened ? 0.5 : 0.1,\r\n    }}\r\n    osc={{\r\n\r\n    }}\r\n    position={position}\r\n    primitive='a-torus'\r\n    radius={0.1}\r\n    radius-tubular={0.003}\r\n    scale={scale}\r\n  >\r\n    <Entity\r\n      look-at=\"#camera\"\r\n      position={{x: 0, y: 0, z: 0}}\r\n      scale={{x: 2, y: 2, z: 2}}\r\n      text={{\r\n        align: 'center',\r\n        color: HSVtoHex(n / 12, 0.75, 0.5),\r\n        font: `../JetBrainsMono-Regular-msdf.json`,\r\n        negate: false,\r\n        transparent: true,\r\n        value: toSymbol(n),\r\n      }}\r\n    />\r\n  </Entity>\r\n","import _ from 'lodash';\r\nimport PitchClass from './pitchClass';\r\nimport React, {useEffect, useState} from 'react';\r\nimport useMidi from \"./useMidi\";\r\nimport {Entity} from 'aframe-react';\r\n\r\nconst ColtraneCircle = () => {\r\n  const [is180, setIs180] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const toggle = ({key}) => {\r\n      if (key === 'r') setIs180(is180 => !is180);\r\n    };\r\n\r\n    window.addEventListener('keyup', toggle);\r\n    return () => window.removeEventListener('keyup', toggle);\r\n  }, []);\r\n\r\n  const [{midiIn}] = useMidi();\r\n\r\n  const midiInPitchClasses = _(12)\r\n    .range()\r\n    .map(n => _(midiIn)\r\n      .pickBy((v, i) => i % 12 === n)\r\n      .values()\r\n      .sum())\r\n    .value();\r\n\r\n  return (// https://www.npmjs.com/package/aframe-animation-component\r\n    <Entity\r\n      animation={`property: rotation; to: 0 ${is180 ? 180 : 0} 0; dur: 500;`}\r\n      position={`0 0 -3`}\r\n    >\r\n      {_(12)\r\n        .range()\r\n        .filter(n => n % 2 == 0)\r\n        .map(n => ({\r\n          n,\r\n          r: 1.5,\r\n          x: -Math.sin(n * Math.PI / 6),\r\n          y: Math.cos(n * Math.PI / 6),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n          />))\r\n        .value()\r\n      }\r\n\r\n      {_(48)\r\n        .range()\r\n        .filter(n => !_.includes([6, 7, 0, 1], n % 8))\r\n        .map((n, i) => ({\r\n          i,\r\n          n: ((i + 1) * 2 + Math.floor(i / 4) * 2) % 12,\r\n          // n: (n * 2) % 12,\r\n          r: 1.5,\r\n          x: Math.sin((n + 0.5) * Math.PI / 24),\r\n          y: Math.cos((n + 0.5) * Math.PI / 24),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n            scale=\"0.5 0.5 0.5\"\r\n          />))\r\n        .value()\r\n      }\r\n\r\n      {_(12)\r\n        .range()\r\n        .filter(n => n % 2 != 0)\r\n        .map(n => ({\r\n          n: (n + 6) % 12,\r\n          r: 1.2,\r\n          x: -Math.sin(n * Math.PI / 6),\r\n          y: Math.cos(n * Math.PI / 6),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n          />))\r\n        .value()\r\n      }\r\n\r\n      {_(48)\r\n        .range()\r\n        .filter(n => !_.includes([4, 5, 6, 7], n % 8))\r\n        .map((n, i) => ({\r\n          i,\r\n          // n: i,\r\n          n: (i * 2 + 9 + Math.floor(i / 4) * 2) % 12,\r\n          // n: i,\r\n          r: 1.2,\r\n          x: Math.sin((n - 1.5) * Math.PI / 24),\r\n          y: Math.cos((n - 1.5) * Math.PI / 24),\r\n        }))\r\n        .map(({n, r, x, y}) => (\r\n          <PitchClass\r\n            midiIn={midiInPitchClasses[n]}\r\n            n={n}\r\n            position={`${r * x} ${r * y} 0`}\r\n            scale=\"0.5 0.5 0.5\"\r\n          />))\r\n        .value()\r\n      }\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default ColtraneCircle;\r\n","import {Entity} from 'aframe-react';\r\nimport React from 'react';\r\nimport {HSVtoHex} from './color';\r\n\r\n// http://dmccooey.com/polyhedra/PentakisDodecahedron.txt\r\nconst c1 = 1.33058699733550141141687582919;\r\nconst c2 = 2.15293498667750705708437914596;\r\n\r\n// in ordered, opposite pairs\r\nconst verts = [\r\n  [0.0,  -c2,   c1],\r\n  [0.0,   c2,  -c1],\r\n  [ c2,  -c1,  0.0],\r\n  [-c2,   c1,  0.0],\r\n  [0.0,  -c2,  -c1],\r\n  [0.0,   c2,   c1],\r\n  [-c2,  -c1,  0.0],\r\n  [ c2,   c1,  0.0],\r\n  [-c1,  0.0,   c2],\r\n  [ c1,  0.0,  -c2],\r\n  [ c1,  0.0,   c2],\r\n  [-c1,  0.0,  -c2],\r\n];\r\n\r\nconst Dod = ({ rep = 1, sat, stack = [], n = 0 }) =>\r\n  <Entity position=\"0 0 0\">\r\n    {verts.map((v, i) =>\r\n      <Entity\r\n        key={i}\r\n        color={HSVtoHex(i * (1 / 12), sat || 1, 1)}\r\n        events={{ click: () => console.log(i) }}\r\n        primitive=\"a-sphere\"\r\n        position={v.join(' ')}\r\n        scale={[1, 1, 1].map(n => 0.3 * n/ (rep * rep)).join(' ')}\r\n      />)}\r\n\r\n    {rep < 3 && verts.map((v, i) =>\r\n      <Entity\r\n        key={i}\r\n        position={v.map(n => n * 2).join(' ')}\r\n        text={`color: ${HSVtoHex((stack.length ? stack[stack.length - 1] : i) * (1 / 12), 1, 1)}; align: center; value: ${[...stack, i].join(',')} - ${(n + i) % 12}; width: 5; zOffset: 0`}\r\n      >\r\n        <Dod rep={rep+1} sat={0.3} stack={[...stack, i]} n={(n + i) % 12} />\r\n      </Entity>)\r\n      // .filter((n, i) => i % 2)\r\n    }\r\n  </Entity>;\r\n\r\nexport default Dod;","// import * as Tone from 'tone'\r\nimport _ from 'lodash';\r\nimport PitchClass from './pitchClass';\r\nimport PitchDetector from 'pitchdetect';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport useMidiClock from \"./useMidiClock\";\r\nimport {Entity} from 'aframe-react';\r\nimport {HSVtoHex} from \"./color\";\r\n\r\nconst PitchClassCollections = ({}) => {\r\n\r\n  const spacing = 0.75;\r\n\r\n  const [collEl, setCollEl] = useState();\r\n  const collRef = useCallback(setCollEl, []);\r\n\r\n\r\n  const { reset } = useMidiClock(({ tick }) => {\r\n    if (tick % 24 === 0) console.log(tick);\r\n\r\n    if (collEl) {\r\n      collEl.object3D.position.set(0, 0, (tick / 96) * spacing);\r\n    }\r\n  });\r\n\r\n  window.reset = reset;\r\n\r\n  useEffect(() => {\r\n    const handleKeyup = ({code, key}) => {\r\n      // if (key === 'r') setIs180(is180 => !is180);\r\n      // if (code === 'Space') audioContext.resume();\r\n    };\r\n\r\n    window.addEventListener('keyup', handleKeyup);\r\n    return () => window.removeEventListener('keyup', handleKeyup);\r\n  }, []);\r\n\r\n  const colls = [[2, 5, 9], [7, 11, 2], [0, 4, 7]];\r\n\r\n  return (// https://www.npmjs.com/package/aframe-animation-component\r\n    <Entity\r\n      _ref={collRef}\r\n      position={{x: 0, y: 0, z: -2}}\r\n      scale={{x: 4, y: 4, z: 4}}\r\n    >\r\n      {\r\n        _.range(50)\r\n          .map(i => 50 - i)// draw order\r\n          .map(i => ({ coll: colls[i % colls.length], z: i * -spacing}))\r\n          .map(({coll, z}) => (\r\n            <React.Fragment key={z}>\r\n              <Entity\r\n                material={{\r\n                  // blending: 'subtractive',\r\n                  color: '#040404',\r\n                  opacity: 0.45,\r\n                }}\r\n                position={{ x: 0, y: 0, z: z - 0.01}}\r\n                rotation={{x: 90, y: 0, z: 0}}\r\n                primitive='a-cylinder'\r\n                scale={{ x: 1, y: 0.001, z: 1}}\r\n              />\r\n              {_.range(12)\r\n                .map(n => {\r\n                  const r = 0.25;\r\n                  const theta = n * (Math.PI * 2) / 12;\r\n\r\n                  return {\r\n                    n,\r\n                    x: r * Math.sin(theta),\r\n                    y: r * Math.cos(theta),\r\n                  };\r\n                })\r\n                .map(({n, s = 0.5, x, y}) => (\r\n                  <PitchClass\r\n                    darkened={!_.includes(coll, n)}\r\n                    key={n}\r\n                    n={n}\r\n                    position={{x, y, z}}\r\n                    scale={{x: s, y: s, z: s}}\r\n                  />))}\r\n            </React.Fragment>\r\n          ))\r\n      }\r\n\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default PitchClassCollections;\r\n","import _ from \"lodash\";\r\nimport React, {useCallback, useEffect, useState} from \"react\";\r\nimport useMidi from \"./useMidi\";\r\nimport usePrevious from \"./usePrevious\";\r\nimport {Entity} from \"aframe-react\";\r\nimport {HSVtoHex} from \"./color\";\r\n\r\nconst PcSpiralWindController = ({noteToDimensions}) => {\r\n  const [midiInEl, setMidiInEl] = useState();\r\n  const [{midiInDevice}] = useMidi();\r\n  const prevMidiInDevice = usePrevious(midiInDevice);\r\n\r\n  useEffect(() => {\r\n    const handleMidi = (evt) => {\r\n      // console.log(evt)\r\n      const {note: {number: n}, velocity: vel, type} = evt;\r\n      const opacity = vel / (0.1 + vel);\r\n      const {s, x, y, z} = noteToDimensions(n);\r\n      midiInEl.setAttribute('material', 'opacity', opacity);\r\n      if (type === 'noteon') {\r\n        midiInEl.note = n; // FIXME Hack\r\n        midiInEl.object3D.position.set(x, y, z + 0.01);\r\n        midiInEl.object3D.scale.set(s * 1.1, s * 1.1, s * 1.1);\r\n        midiInEl.setAttribute('material', 'color', HSVtoHex(n / 12, 0.75, 0.5));\r\n      }\r\n    };\r\n\r\n    const handleCC = ({ controller: { number }, value }) => {\r\n      if (number === 2) { // breath control\r\n        const vel = value / 128;\r\n        const opacity = vel / (0.1 + vel);\r\n        midiInEl.setAttribute('material', 'opacity', opacity);\r\n      }\r\n    };\r\n\r\n    const handlePitchbend = ({ value }) => {\r\n      // console.log(value)\r\n      const n = midiInEl.note || 0;\r\n      const bendAmount = value * 2;\r\n      const {s, x, y, z} = noteToDimensions(n + bendAmount);\r\n      midiInEl.object3D.position.set(x, y, z + 0.01);\r\n      midiInEl.object3D.scale.set(s * 1.1, s * 1.1, s * 1.1);\r\n    };\r\n\r\n    if (midiInEl) {\r\n      if (midiInDevice) {\r\n        console.log('new midiInDevice: ', _.get(midiInDevice,'name'), 'prev: ', _.get(prevMidiInDevice, 'name'));\r\n        midiInDevice.addListener('noteon', 'all', handleMidi);\r\n        midiInDevice.addListener('noteoff', 'all', handleMidi);\r\n        midiInDevice.addListener('controlchange', 'all', handleCC);\r\n        midiInDevice.addListener('pitchbend', 'all', handlePitchbend);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (midiInDevice) {\r\n        console.log('removing listeners for', _.get(midiInDevice, 'name'));\r\n        midiInDevice.removeListener('noteon');\r\n        midiInDevice.removeListener('noteoff');\r\n        midiInDevice.removeListener('controlchange');\r\n        midiInDevice.removeListener('pitchbend');\r\n      }\r\n    }\r\n  }, [midiInEl, midiInDevice, noteToDimensions, prevMidiInDevice]);\r\n\r\n  const midiInRef = useCallback(setMidiInEl, []);\r\n\r\n  return (\r\n    <Entity\r\n      _ref={midiInRef}\r\n      primitive='a-sphere'\r\n      material={{\r\n        blending: 'additive',\r\n        color: HSVtoHex(1, 0, 1),\r\n        opacity: 0,\r\n        transparent: true,\r\n      }}\r\n      radius={0.07}\r\n    />\r\n  )\r\n}\r\n\r\nexport default PcSpiralWindController;\r\n","import {useEffect, useRef} from \"react\";\r\n\r\nexport default (value) => {\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  });\r\n  return ref.current;\r\n}\r\n","import _ from 'lodash';\r\nimport PcSpiralWindController from './pcSpiralWindController';\r\nimport PitchClass from './pitchClass';\r\nimport PitchDetector from 'pitchdetect';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport useMidi from \"./useMidi\";\r\nimport {Entity} from 'aframe-react';\r\nimport {ftomf} from \"./util\";\r\nimport {HSVtoHex} from \"./color\";\r\n\r\nconst audioContext = new AudioContext();\r\n\r\n// FIXME HACK\r\nwindow.audioContext = audioContext;\r\n\r\n\r\nconst PitchClassSpiral = ({\r\n  depthMax = 1,\r\n  isAlwaysCounterClockwise = false,\r\n  rMax = 0.75,\r\n  rMin = 0,\r\n  noteRange = [34, 99],\r\n  // notesHighlighted = [0, 2, 4, 5, 7, 9, 11],\r\n  pcsHighlighted= [0, 2, 4, 5, 7, 9, 11],\r\n}) => {\r\n  const [is180, setIs180] = useState(true);\r\n  const [detector, setDetector] = useState();\r\n  const [pitchDetectEl, setPitchDetectEl] = useState();\r\n\r\n\r\n\r\n  const noteToDimensions = n => {\r\n    const step = n / 128;\r\n    const r = (is180 ? 1 : 1.5) * rMax - ((is180 ? 1 : 1.5) * rMax - rMin) * step;\r\n\r\n    return {\r\n      n,\r\n      s:  0.75 - n / 192,\r\n      x: r * (is180 && isAlwaysCounterClockwise ? -1 : 1) * Math.sin(n * Math.PI / 6 + 0.01), // +0.01 to fix floating point error in animation library\r\n      y: r * Math.cos(n * Math.PI / 6 + 0.01),\r\n      z: is180\r\n        ? depthMax - depthMax * step\r\n        : depthMax * step,\r\n    };\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleKeyup = ({code, key}) => {\r\n      if (key === 'r') setIs180(is180 => !is180);\r\n      if (code === 'Space') audioContext.resume();\r\n    };\r\n\r\n    window.addEventListener('keyup', handleKeyup);\r\n    return () => window.removeEventListener('keyup', handleKeyup);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('el', pitchDetectEl, 'detector', detector);\r\n\r\n    const handlePitch = (stats, pitchDetector) => {\r\n      const {frequency, detected, rms} = stats;\r\n\r\n      // https://math.stackexchange.com/q/57429/398343\r\n      // const opacity = 1 - Math.exp(-2 * rms);\r\n      const opacity = rms / (0.1 + rms);\r\n      const n = ftomf(frequency);\r\n      const {s, x, y, z} = noteToDimensions(n);\r\n      pitchDetectEl.setAttribute('material', 'opacity', detected ? opacity : 0);\r\n      pitchDetectEl.object3D.position.set(x, y, z + 0.01);\r\n      pitchDetectEl.object3D.scale.set(s, s, s);\r\n\r\n      if (_.isFinite(n)) {\r\n        pitchDetectEl.setAttribute('material', 'color', HSVtoHex(n / 12, 0.5, 1));\r\n      }\r\n    };\r\n\r\n    if (audioContext && !detector && pitchDetectEl) {\r\n      setDetector(new PitchDetector({\r\n        context: audioContext,\r\n\r\n        // input: audioBufferNode, // default: Microphone input\r\n\r\n        interpolateFrequency: true, // default: true\r\n\r\n        onDebug: handlePitch,\r\n\r\n        // Minimal signal strength (RMS, Optional)\r\n        // minRms: 0.1,\r\n\r\n        // Detect pitch only with minimal correlation of: (Optional)\r\n        // minCorrelation: 0.9,\r\n\r\n        // Detect pitch only if correlation increases with at least: (Optional)\r\n        minCorrelationIncrease: 0.5,\r\n\r\n        // Note: you cannot use minCorrelation and minCorreationIncrease\r\n        // at the same time!\r\n\r\n        // Signal Normalization (Optional)\r\n        normalize: \"rms\", // or \"peak\". default: undefined\r\n\r\n        // Only detect pitch once: (Optional)\r\n        stopAfterDetection: false,\r\n\r\n        // Buffer length (Optional)\r\n        length: 1024, // default 1024\r\n\r\n        // Limit range (Optional):\r\n        minNote: 32, // by MIDI note number\r\n        maxNote: 128,\r\n\r\n        // minFrequency: 440,    // by Frequency in Hz\r\n        // maxFrequency: 20000,\r\n\r\n        minPeriod: 2,  // by period (i.e. actual distance of calculation in audio buffer)\r\n        maxPeriod: 512, // --> convert to frequency: frequency = sampleRate / period\r\n\r\n        // Start right away\r\n        start: true, // default: false\r\n      }));\r\n      // window.detector = detector;\r\n    } else if (detector && !pitchDetectEl) {\r\n      detector.stop();\r\n      detector.destroy();\r\n    }\r\n  }, [audioContext, detector, is180, pitchDetectEl]);\r\n\r\n\r\n\r\n  const pitchDetectRef = useCallback(setPitchDetectEl, []);\r\n\r\n\r\n  // const midiInPitchClasses = _(12)\r\n  //   .range()\r\n  //   .map(n => _(midiIn)\r\n  //     .pickBy((v, i) => i % 12 === n)\r\n  //     .values()\r\n  //     .sum())\r\n  //   .value();\r\n\r\n  // TODO: position by freq, not 12TET pitch\r\n\r\n  return (// https://www.npmjs.com/package/aframe-animation-component\r\n    <Entity\r\n      events={{\r\n        click: () => {\r\n          audioContext.resume()\r\n        },\r\n      }}\r\n      position={{x: 0, y: 0, z: -6}}\r\n      scale={{x: 4, y: 4, z: 4}}\r\n    >\r\n      {_.range(noteRange[0], noteRange[1] + 1)\r\n        .map(noteToDimensions)\r\n        .map(({n, s, x, y, z}) => (\r\n          <React.Fragment key={n}>\r\n            <Entity\r\n              line={{\r\n                color: 'black',\r\n                opacity: 0.3,\r\n                start: _.pick(noteToDimensions(n + 0.25), ['x', 'y', 'z']),\r\n                end: _.pick(noteToDimensions(n + 0.75), ['x', 'y', 'z']),\r\n                visible: n < noteRange[1],\r\n              }}\r\n            />\r\n\r\n            <PitchClass\r\n              darkened={!_.includes(pcsHighlighted, n%12)}\r\n              n={n}\r\n              position={{x, y, z}}\r\n              scale={{x: s, y: s, z: s}}\r\n            />\r\n          </React.Fragment>\r\n          ))\r\n      }\r\n\r\n      <PcSpiralWindController\r\n        noteToDimensions={noteToDimensions}\r\n      />\r\n\r\n      {/* TODO intervals   */}\r\n      {/*<Entity*/}\r\n      {/*  line={{*/}\r\n      {/*    color: 'white',*/}\r\n      {/*    opacity: 0.3,*/}\r\n      {/*    start: _.pick(noteToDimensions(60), ['x', 'y', 'z']),*/}\r\n      {/*    end: _.pick(noteToDimensions(65), ['x', 'y', 'z']),*/}\r\n      {/*  }}*/}\r\n      {/*/>*/}\r\n\r\n\r\n      <Entity\r\n        _ref={pitchDetectRef}\r\n        primitive='a-sphere'\r\n        material={{\r\n          blending: 'additive',\r\n          color: HSVtoHex(1, 0, 1),\r\n          opacity: 0,\r\n          transparent: true,\r\n        }}\r\n        radius={0.1}\r\n      />\r\n    </Entity>\r\n  );\r\n};\r\n\r\nexport default PitchClassSpiral;\r\n","import 'aframe-touch-look-controls';\r\nimport Camera from './camera';\r\nimport ColtraneCircle from \"./coltraneCircle\";\r\nimport Dod from './dod';\r\nimport PitchClassCollections from \"./pitchClassCollections\";\r\nimport PitchClassSpiral from \"./pitchClassSpiral\";\r\nimport React from 'react';\r\nimport {Entity, Scene} from 'aframe-react';\r\nimport {Route, Switch} from 'react-router-dom';\r\n\r\n// Note: needs https to enter VR\r\n\r\nconst VR = ({match: {path}}) => (\r\n  <Scene\r\n    // fog={{type: 'linear', color: '#000', near: 1, far: 10}}\r\n  >\r\n    <a-assets>\r\n      {/*<img id=\"groundTexture\" src=\"https://cdn.aframe.io/a-painter/images/floor.jpg\"/>*/}\r\n      {/*<img id=\"skyTexture\" src=\"https://cdn.aframe.io/a-painter/images/sky.jpg\"/>*/}\r\n    </a-assets>\r\n\r\n    <Switch>\r\n      <Route path={`${path}/coltrane`} component={ColtraneCircle}/>\r\n      <Route path={`${path}/dod`} component={Dod}/>\r\n      <Route path={`${path}/pitchClassCollections`} component={PitchClassCollections}/>\r\n      <Route path={`${path}/pitchClassSpiral`} component={PitchClassSpiral}/>\r\n    </Switch>\r\n\r\n\r\n    {/*<Entity primitive=\"a-plane\" src=\"#groundTexture\" rotation=\"-90 0 0\" height=\"100\" width=\"100\"/>*/}\r\n    {/*<Entity primitive=\"a-light\" type=\"ambient\" color=\"#445451\"/>*/}\r\n    {/*<Entity primitive=\"a-light\" type=\"point\" intensity=\"2\" position=\"2 4 4\"/>*/}\r\n\r\n    {/*<Entity*/}\r\n    {/*  height=\"2048\"*/}\r\n    {/*  primitive=\"a-sky\"*/}\r\n    {/*  radius=\"30\"*/}\r\n    {/*  rotation=\"90 0 0\"*/}\r\n    {/*  src=\"#skyTexture\"*/}\r\n    {/*  theta-length=\"90\"*/}\r\n    {/*  width=\"2048\"*/}\r\n    {/*/>*/}\r\n    {/*<Entity*/}\r\n    {/*  height=\"2048\"*/}\r\n    {/*  primitive=\"a-sky\"*/}\r\n    {/*  radius=\"30\"*/}\r\n    {/*  rotation=\"90 0 180\"*/}\r\n    {/*  src=\"#skyTexture\"*/}\r\n    {/*  theta-length=\"90\"*/}\r\n    {/*  width=\"2048\"*/}\r\n    {/*/>*/}\r\n\r\n    <Camera />\r\n\r\n    <Entity\r\n      // events={{}}\r\n      id=\"leftHand\"\r\n      oculus-touch-controls=\"hand: left\"\r\n    />\r\n    <Entity\r\n      id=\"rightHand\"\r\n      oculus-touch-controls=\"hand: right\"\r\n    />\r\n\r\n  </Scene>\r\n);\r\n\r\nexport default VR;\r\n","import { fraction } from 'mathjs';\r\n\r\nexport const toOctave = (r) => r > 2\r\n  ? toOctave(r / 2)\r\n  : r < 1\r\n    ? toOctave(r * 2)\r\n    : r;\r\n\r\nexport const intToRatio = (i) => fraction(toOctave(i));\r\n\r\n// TODO: n-dimensions\r\nexport const coordToRatio = (x, y) => {\r\n  const raw = Math.pow(3, x) * Math.pow(5, y);\r\n  return fraction(toOctave(raw));\r\n}\r\n\r\n// for(let threes = -5; threes <= 5; threes++) {\r\n//   for(let fives = -5; fives <= 5; fives++) {\r\n//     let f = coordToRatio(threes, fives);\r\n//     console.log(`${f.n}/${f.d}`)\r\n//   }\r\n// }\r\n","// import 'aframe-animation-component';\r\nimport 'aframe';\r\nimport 'aframe-look-at-component';\r\nimport Banjo from './banjo';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Guitar from './guitar';\r\nimport Intro from './intro';\r\nimport MultTableMod12 from './multTableMod12';\r\nimport NumpadMod12 from './numpadMod12';\r\nimport OSC from 'osc-js';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Mandelbrot from './mandelbrot';\r\nimport Mandolin from './mandolin';\r\nimport Midi from './midi';\r\nimport RatioLightship from './ratioLightship';\r\nimport Staff from './staff';\r\nimport Tonnetz from './tonnetz';\r\nimport Ukulele from './ukulele';\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\nimport VR from './vr';\r\nimport {\r\n  AppBar,\r\n  IconButton,\r\n  Menu,\r\n  MenuItem,\r\n  Toolbar,\r\n} from '@material-ui/core';\r\nimport {BrowserRouter as Router, Route, Link} from 'react-router-dom';\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport {Menu as MenuIcon, WatchLater as MidiClockIcon} from '@material-ui/icons';\r\nimport _ from 'lodash';\r\nimport {MicOffOutlined, MicOutlined} from '@material-ui/icons';\r\n\r\nimport { intToRatio } from \"./fns\";\r\n\r\nwindow.intToRation = intToRatio;\r\n\r\nconst doWhenAframeLoaded = () => {\r\n  if (typeof AFRAME === 'undefined') {\r\n    setTimeout(doWhenAframeLoaded, 100);\r\n    return;\r\n  }\r\n\r\n  const oscHost = {\r\n    host: window.location.hostname,\r\n    port: '8080',\r\n    secure: true,\r\n  };\r\n  const osc = new OSC({\r\n    plugin: new OSC.WebsocketClientPlugin(oscHost),\r\n  });\r\n  osc.open();\r\n  window.osc = osc;\r\n\r\n  // window.sendOsc = (address, ...args) => osc.send(new OSC.Message(address, ...args));\r\n\r\n  // osc.on('/midiSeq/clear', () => clearSeq());\r\n\r\n  // osc.on('/midiSeq/beat', ({args: [beat]}) => setBeat(beat));\r\n\r\n  // WIP\r\n  window.AFRAME.registerComponent('midi', {\r\n    init: function() {\r\n      // this.onOsc = (i, e) => {};\r\n\r\n      this._onOscId = osc.on('/midi/*', ({address, args: [note, vel]}) => {\r\n        const instrument = _.last(address.split('/'));\r\n        if (this.onOsc) this.onOsc({ instrument, note, vel });\r\n      });\r\n\r\n    },\r\n\r\n    tick: function (time, timeDelta) {\r\n      if (this.onTick) this.onTick(time, timeDelta);\r\n    },\r\n\r\n    remove: function() {\r\n      osc.off('/midi/*', this._onOscId);\r\n    },\r\n  });\r\n\r\n  window.AFRAME.registerComponent('osc', {\r\n    init: function() {\r\n      // this.onOsc = (i, e) => {};\r\n\r\n      this._onOscId = osc.on('/midi/*', ({address, args: [note, vel]}) => {\r\n        const instrument = _.last(address.split('/'));\r\n        if (this.onOsc) this.onOsc({ instrument, note, vel });\r\n      });\r\n\r\n    },\r\n\r\n    tick: function (time, timeDelta) {\r\n      if (this.onTick) this.onTick(time, timeDelta);\r\n    },\r\n\r\n    remove: function() {\r\n      osc.off('/midi/*', this._onOscId);\r\n    },\r\n  });\r\n}\r\ndoWhenAframeLoaded();\r\n\r\nconst routes2d = [\r\n  ['Mod12 Multiplication Tables', '/multTableMod12', MultTableMod12],\r\n  ['PC-Number Notepad', '/numpadMod12', NumpadMod12],\r\n  ['OSC Dataviz', '/osc', OSC, true],\r\n  ['PC Tonnetz', '/tonnetz', Tonnetz],\r\n  ['Banjo PCs', '/banjo', Banjo],\r\n  ['Guitar PCs', '/guitar', Guitar],\r\n  ['Mandolin PCs', '/mandolin', Mandolin],\r\n  ['Ukulele PCs', '/ukulele', Ukulele],\r\n  ['Staff', '/staff', Staff],\r\n  ['Mandelbrot', '/mandelbrot', Mandelbrot],\r\n  ['Ratio Lightship', '/ratioLightship', RatioLightship],\r\n];\r\n\r\nconst App = () => {\r\n  const prefersDarkMode = true; //FIXME useMediaQuery('(prefers-color-scheme: dark)');\r\n\r\n  const theme = React.useMemo(\r\n    () =>\r\n      createMuiTheme({\r\n        palette: { // https://material-ui.com/customization/palette/\r\n          action: {\r\n            active: '#660000',\r\n          },\r\n          primary: {\r\n            main: '#330033'\r\n          },\r\n          type: prefersDarkMode ? 'dark' : 'light',\r\n        },\r\n      }),\r\n    [prefersDarkMode],\r\n  );\r\n\r\n  // Menu open/close\r\n  const [menuAnchorEl, setMenuAnchorEl] = React.useState(null);\r\n  const handleMenuButtonClick = ({ currentTarget }) => setMenuAnchorEl(currentTarget);\r\n  const handleMenuClose = () => setMenuAnchorEl(null);\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CssBaseline/>\r\n      <Router basename={process.env.PUBLIC_URL}>\r\n        <Route path=\"/\" exact component={Intro}/>\r\n\r\n        <Route path=\"/vr\" component={VR} />\r\n\r\n        {routes2d.map(([title, path, component], key) => (\r\n          <Route {...{ component, key, path }} />\r\n        ))}\r\n\r\n        <AppBar\r\n          color=\"transparent\"\r\n          onClick={() => {\r\n            // if (window.audioContext) { // FIXME HACK\r\n            //   window.audioContext.resume();\r\n            //   window.detector.start();\r\n            // }\r\n          }}\r\n          position=\"fixed\"\r\n          style={{\r\n            top: 'auto',\r\n            bottom: 0,\r\n          }}\r\n        >\r\n          <Toolbar>\r\n            <IconButton\r\n              edge=\"start\"\r\n              color=\"inherit\"\r\n              aria-label=\"open drawer\"\r\n              onClick={handleMenuButtonClick}\r\n            >\r\n              <MenuIcon/>\r\n            </IconButton>\r\n\r\n            <Menu\r\n              anchorEl={menuAnchorEl}\r\n              open={!!menuAnchorEl}\r\n              onClose={handleMenuClose}\r\n            >\r\n              <MenuItem>\r\n                <Link style={{ color: 'lightgrey'}} onClick={handleMenuClose} to=\"/\">Introduction</Link>\r\n              </MenuItem>\r\n              <MenuItem disabled divider >2D</MenuItem>\r\n              {routes2d.map(([title, url, component, isDevOnly], idx) => !isDevOnly && (\r\n                <MenuItem key={idx}>\r\n                  <Link style={{ color: 'pink'}} onClick={handleMenuClose} to={url}>{title}</Link>\r\n                </MenuItem>\r\n              ))}\r\n              <MenuItem disabled divider>VR</MenuItem>\r\n              {[\r\n                ['Coltrane Circle', '/vr/coltrane'],\r\n                ['Dod', '/vr/dod'],\r\n                ['PitchClassCollections', '/vr/pitchClassCollections'],\r\n                ['PitchClassSpiral', '/vr/pitchClassSpiral'],\r\n              ].map(([title, url], idx) => (\r\n                <MenuItem key={idx}>\r\n                  <Link style={{ color: 'cyan'}} onClick={handleMenuClose} to={url}>{title}</Link>\r\n                </MenuItem>\r\n              ))}\r\n            </Menu>\r\n\r\n            <Midi />\r\n\r\n            <IconButton\r\n              edge=\"start\"\r\n              color=\"inherit\"\r\n              // onClick={handleMidiMenuButtonClick(true)}\r\n            >\r\n              <MicOffOutlined />\r\n            </IconButton>\r\n            <IconButton\r\n              edge=\"start\"\r\n              color=\"inherit\"\r\n              // onClick={handleMidiMenuButtonClick(true)}\r\n            >\r\n              <MicOutlined />\r\n            </IconButton>\r\n          </Toolbar>\r\n        </AppBar>\r\n      </Router>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n\r\nReactDOM.render(<App/>, document.querySelector('#sceneContainer'));\r\n"],"sourceRoot":""}